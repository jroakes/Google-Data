CN107040781A - The Real-Time Video Encoder speed control switched using dynamic resolution - Google Patents
The Real-Time Video Encoder speed control switched using dynamic resolution Download PDFInfo
- Publication number
- CN107040781A CN107040781A CN201611225434.7A CN201611225434A CN107040781A CN 107040781 A CN107040781 A CN 107040781A CN 201611225434 A CN201611225434 A CN 201611225434A CN 107040781 A CN107040781 A CN 107040781A
- Authority
- CN
- China
- Prior art keywords
- bit rate
- frame
- encoded
- resolution ratio
- video flowing
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Granted
Links
Classifications
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/10—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding
- H04N19/102—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the element, parameter or selection affected or controlled by the adaptive coding
- H04N19/124—Quantisation
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/10—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding
- H04N19/134—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the element, parameter or criterion affecting or controlling the adaptive coding
- H04N19/146—Data rate or code amount at the encoder output
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/10—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding
- H04N19/134—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the element, parameter or criterion affecting or controlling the adaptive coding
- H04N19/167—Position within a video image, e.g. region of interest [ROI]
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/10—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding
- H04N19/169—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the coding unit, i.e. the structural portion or semantic portion of the video signal being the object or the subject of the adaptive coding
- H04N19/17—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the coding unit, i.e. the structural portion or semantic portion of the video signal being the object or the subject of the adaptive coding the unit being an image region, e.g. an object
- H04N19/172—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the coding unit, i.e. the structural portion or semantic portion of the video signal being the object or the subject of the adaptive coding the unit being an image region, e.g. an object the region being a picture, frame or field
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/10—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding
- H04N19/189—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the adaptation method, adaptation tool or adaptation type used for the adaptive coding
- H04N19/192—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the adaptation method, adaptation tool or adaptation type used for the adaptive coding the adaptation method, adaptation tool or adaptation type being iterative or recursive
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/10—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding
- H04N19/189—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the adaptation method, adaptation tool or adaptation type used for the adaptive coding
- H04N19/192—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the adaptation method, adaptation tool or adaptation type used for the adaptive coding the adaptation method, adaptation tool or adaptation type being iterative or recursive
- H04N19/194—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the adaptation method, adaptation tool or adaptation type used for the adaptive coding the adaptation method, adaptation tool or adaptation type being iterative or recursive involving only two passes
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/10—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding
- H04N19/189—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the adaptation method, adaptation tool or adaptation type used for the adaptive coding
- H04N19/196—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the adaptation method, adaptation tool or adaptation type used for the adaptive coding being specially adapted for the computation of encoding parameters, e.g. by averaging previously computed encoding parameters
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/50—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using predictive coding
- H04N19/59—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using predictive coding involving spatial sub-sampling or interpolation, e.g. alteration of picture size or resolution
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/85—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using pre-processing or post-processing specially adapted for video compression
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/90—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using coding techniques not provided for in groups H04N19/10-H04N19/85, e.g. fractals
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N21/00—Selective content distribution, e.g. interactive television or video on demand [VOD]
- H04N21/20—Servers specifically adapted for the distribution of content, e.g. VOD servers; Operations thereof
- H04N21/23—Processing of content or additional data; Elementary server operations; Server middleware
- H04N21/234—Processing of video elementary streams, e.g. splicing of video streams, manipulating MPEG-4 scene graphs
- H04N21/2343—Processing of video elementary streams, e.g. splicing of video streams, manipulating MPEG-4 scene graphs involving reformatting operations of video signals for distribution or compliance with end-user requests or end-user device requirements
- H04N21/234363—Processing of video elementary streams, e.g. splicing of video streams, manipulating MPEG-4 scene graphs involving reformatting operations of video signals for distribution or compliance with end-user requests or end-user device requirements by altering the spatial resolution, e.g. for clients with a lower screen resolution
- H04N21/234372—Processing of video elementary streams, e.g. splicing of video streams, manipulating MPEG-4 scene graphs involving reformatting operations of video signals for distribution or compliance with end-user requests or end-user device requirements by altering the spatial resolution, e.g. for clients with a lower screen resolution for performing aspect ratio conversion
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N21/00—Selective content distribution, e.g. interactive television or video on demand [VOD]
- H04N21/20—Servers specifically adapted for the distribution of content, e.g. VOD servers; Operations thereof
- H04N21/23—Processing of content or additional data; Elementary server operations; Server middleware
- H04N21/234—Processing of video elementary streams, e.g. splicing of video streams, manipulating MPEG-4 scene graphs
- H04N21/2343—Processing of video elementary streams, e.g. splicing of video streams, manipulating MPEG-4 scene graphs involving reformatting operations of video signals for distribution or compliance with end-user requests or end-user device requirements
- H04N21/23439—Processing of video elementary streams, e.g. splicing of video streams, manipulating MPEG-4 scene graphs involving reformatting operations of video signals for distribution or compliance with end-user requests or end-user device requirements for generating different versions
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N21/00—Selective content distribution, e.g. interactive television or video on demand [VOD]
- H04N21/20—Servers specifically adapted for the distribution of content, e.g. VOD servers; Operations thereof
- H04N21/25—Management operations performed by the server for facilitating the content distribution or administrating data related to end-users or client devices, e.g. end-user or client device authentication, learning user preferences for recommending movies
- H04N21/266—Channel or content management, e.g. generation and management of keys and entitlement messages in a conditional access system, merging a VOD unicast channel into a multicast channel
- H04N21/2662—Controlling the complexity of the video stream, e.g. by scaling the resolution or bitrate of the video stream based on the client capabilities
Abstract
The present invention relates to a kind of Real-Time Video Encoder speed control of use dynamic resolution switching.Dynamic resolution switches to the single-pass and bilateral coding of video flowing to realize target bit rate.Single-pass encoder determines whether the coding bit rate of frame meets target bit rate.If it is not, then will be compared for the quantization parameter encoded to frame with minimum and maximum threshold value, to determine the need for adjusting video resolution.Bilateral encoder is encoded using quantization parameter to input frame, and determines whether the video resolution that adjustment is encoded during second is logical to frame based on the bit rate encoded to input frame.It can limit to adjust resolution ratio based on the encoder on the motion search area for encoding frame.
Description
Background technology
Digital video frequency flow represents video usually using frame sequence or rest image.Each frame can include multiple pieces, its
The information of the value for color, brightness or the other attributes for describing pixel can be included again.Data volume in exemplary video streams is very big, and
And the transmission and storage of video can use huge calculating or the communication resource.Due to being related to mass data in video data, because
This needs high performance compression for transmission and storage.Additionally, it is desirable to can based on can with connection be spread with the resolution ratio optimized
Transmission quality video data.
The content of the invention
Disclosed herein is realize the target bits for being encoded to video flowing for switching using dynamic resolution
The system of rate, the aspect of method and apparatus.Device according to an aspect of the present invention include at least one processor, its by with
The first frame performed in multiple frames of the instruction stored in non-physical storage medium to recognize video flowing is set to, to represent to quantify
First bit rate of parameter is encoded to the first frame, is recognized in response to being encoded to the first frame on motion search area
The limitation of one or more encoders, the target bit rate of the first bit rate and the first frame is compared, and by quantization parameter
It is compared with one in minimum quantization threshold value and maximum quantization threshold value, in response to the first bit rate and target bit rate are entered
Row compares and is compared one in quantization parameter and minimum quantization threshold value and maximum quantization threshold value and adjusts at least one
Individual coding parameter, recognizes the second frame of video flowing, uses at least one coding parameter adjusted with the second bit rate to second
Frame is encoded, and sends in output bit flow the first frame of coding and the second frame of coding.
Device according to another aspect of the present invention includes at least one processor, and it is configured as performing in non-physical
The instruction stored in storage medium is encoded with recognizing the input frame in multiple frames using input quantization parameter to input frame,
One or more encoders limitation on motion search area is recognized in response to being encoded to input frame, in response to defeated
Enter frame to be encoded and generate bit number, adjusted based on the bit number and for the target bit rate encoded to input frame
At least one whole coding parameter, is encoded to generate coding by using at least one described coding parameter to input frame
Frame, and send in output bit flow the frame of the coding.
Device according to another aspect of the present invention includes at least one processor, and it is configured as performing in non-physical
The instruction stored in storage medium, to recognize the input frame in multiple frames, to represent the first bit rate pair of constant quantization parameter
Input frame is encoded, and one or more encoders on motion search area are recognized in response to being encoded to input frame
Limitation, one in the smallest target bit rate and maximum target bit rate of the first bit rate and input frame is compared, and is rung
One in first bit rate and smallest target bit rate and maximum target bit rate is compared and adjusts at least one by Ying Yu
Individual coding parameter, is encoded to generate the frame of coding, Yi Ji by using at least one described coding parameter to input frame
The frame of the coding is sent in output bit flow.
Embodiment, appended claims and accompanying drawing it is described in detail below in disclose these and other side of the disclosure
Face.
Brief description of the drawings
When read in conjunction with the accompanying drawings, the present invention can be best understood from the following detailed description.Unless otherwise indicated, it is no
Then identical drawing reference numeral represents similar elements in various figures.
Figure 1A is to show the target bits for being encoded to the video flowing overshooted due to maximized quantization parameter
The figure of rate.
Figure 1B is to show the target bits that the video flowing for the undershoot to the quantization parameter due to minimum is encoded
The figure of rate.
Fig. 2 is the schematic diagram that Video coding conciliates code system.
Fig. 3 can be achieved on the block diagram of the example of the computing device of dispatching station or receiving station.
Fig. 4 is the figure of exemplary video streams that are to be encoded and then decoding.
Fig. 5 is the block diagram of the video compression system according to the one side instructed herein.
Fig. 6 is the block diagram of the video decompression system according to the other side instructed herein.
Fig. 7 is the flow chart for realizing the example of the process of target code bit rate in being encoded in single-pass.
Fig. 8 is the flow chart for realizing the example of the process of target code bit rate in being encoded in bilateral.
Embodiment
Rate control algorithm in video encoder is intended to keep coding when the complexity of input data is changed over time
Device produces constant bit rate.The quantization parameter of each frame can be adjusted by the bit quantity generated based on previous frame
(QP) constant bit rate is realized.Generally, higher quantization reduces bit rate, and relatively low quantization increase bit rate.Quantify
Parameter indicates the ratio that the data of video flowing are quantified by encoder.That is, using higher quantization parameter in encoder
In the case of, quantization stage is related to for the higher reduction of the video data of higher quantization parameter and for relatively low quantization
The relatively low reduction of the video data of parameter.Resulting quantitation video data indicate that the frame for the video flowing for including data is encoded
Bit rate.Framing is given generally, for video flowing, will cause relatively low frame bit rate using higher quantization parameter,
And it will cause higher frame bit rate using relatively low quantization parameter.
However, according to the complexity of video sequence and the various abilities of encoder, it is understood that there may be for the given video of coding
Stream can not meet the situation of target bit rate.This is probably because QP has been limited to maximum threshold (for example, wherein entering one
The increase of step reduces video quality on resolution ratio by producing obvious vision artefact (visual artifacts)
QP value), but bit rate is still not low enough, causes bit rate to overshoot.As an alternative, it may be caused to video quality using big QP
Harmful compiling artefact (coding artifacts).Similarly, if it is desired to optimize the video matter of user under given bandwidth
Amount, and QP has reached minimum value threshold value (for example, wherein further reduce does not have to the video quality improved on resolution ratio
Effective QP value), then it may have no idea further to improve video quality.Therefore, Consumer's Experience is damaged.
Figure 1A and 1B are shown for respectively to the amount overshooting and due to minimum due to maximized quantization parameter
Change the figure for the target bit rate that the video flowing of parameter and undershoot is encoded.Trunnion axis indicates the video flowing encoded by encoder
The continuous progress of frame, and the quantization parameter that vertical axes instruction is used in the quantization stage of the encoder of framing.For right
Minimum QP threshold values 100 and maximum QP threshold values 102 that the frame of video flowing is encoded are illustrated as the perseverance relative to target bit rate 104
Definite value.The figure is also indicated, according to data encoded, only by increaseing or decreasing QP 106, may unavailable target bits
Rate 104.For example due to the complexity to being encoded including the input data to framing, cause the Possible waves of frame bit rate 108.
As shown in figure 1, frame bit rate 108 increases as the data of video flowing become more complicated.In response to frame bit
The increase of rate 108, encoder increases QP 106 to attempt the target bit rate 104 of maintenance video flowing.However, final, QP 106
Maximum QP threshold values 102 are reached, therefore be cannot be further increased, but frame bit rate 108 is still not up to target bit rate 104, because
Positive data encoded is still too big and can not realize target bit rate 104.This is referred to as bit rate overshoot, because frame bit rate
108 are still higher than target bit rate 104, although maximum QP threshold values 102 are limited.Similarly, as shown in Figure 1B, encoder can be with
Reduce QP 106, wherein determining because frame bit rate 108 is too low, so unrealized target bit rate 104.If however, frame ratio
Special rate 108 is maintained at target bit rate below 104 but regardless of minimum QP threshold values 100 are reached, then causes bit rate undershoot.
Therefore, conventional codec can not realize the constant bit rate for encoded video data by only adjusting QP.This
Outside, although some encoders may be inserted into the key frame for coding, but the solution to key frame at least entering
It is not optimal for the reason for necessarily causing bitrate peaks during row compiling.On the contrary, the present disclosure describes the contracting of dynamic reference frame
Put, to improve the performance of speed control by switching resolution ratio during encoding.Thus, for example, being formed by encoder
Internally scaled reference frame completes speed control before its prediction signal.Describe the single-pass for being encoded to video flowing
With bilateral encoder.In bilateral encoder, the first logical use constant quantization device is encoded to the frame of video flowing, and second
Lead to which known frame in advance be complicated and which be readily in the case of be each frame optimization ground distributing bit.Retouch herein
The further detail below of dynamic reference frame scaling is stated, wherein initial reference can wherein realize its system.
Fig. 2 is the schematic diagram that Video coding conciliates code system 200.Dispatching station 202 can for example be retouched with such as Fig. 3
The computer of the inside configuration for the hardware stated.However, other suitable embodiments of dispatching station 202 are possible.For example, hair
202 processing of seeing off can be distributed in multiple equipment.
Network 204 can be with linkup transmit station 202 and receiving station 206, the coding and decoding for video flowing.Specifically, may be used
With the encoded video stream in dispatching station 202, and coded video flowing can be decoded in receiving station 206.Network 204 can be with
It is such as internet.Network 204 can also be LAN (LAN), wide area network (WAN), VPN (VPN), honeycomb electricity
Telephone network or any other device by the video stream from dispatching station 202 to (in this example) receiving station 206.
In one example, receiving station 206 can be the calculating of the inside configuration with the hardware described in such as Fig. 3
Machine.However, other suitable embodiments of receiving station 206 are possible.For example, the processing of receiving station 206 can be distributed in
In multiple equipment.
The other embodiment that Video coding conciliates code system 200 is possible.For example, embodiment can omit network
204.In another embodiment, video flowing can be encoded, and be then stored for later time and be transferred to reception
Stand 206 or any other equipment with memory.In one embodiment, receiving station 206 is received (for example, via network
204th, computer bus and/or some communication paths) coding video flowing, and store video flowing be used for decode later.Showing
In example embodiment, RTP (RTP) is used for the video that coding is transmitted by network 204.In another embodiment
In, the host-host protocol in addition to RTP, such as the video flow host-host protocol based on HTTP can be used.
When in video conferencing system in use, for example, dispatching station 202 and/or receiving station 206 can include it is as described below
Coding and decoding video flowing both abilities.For example, receiving station 206 can be video conference participants, it is from video conference
Server (for example, dispatching station 202) receives the video bit stream of coding to be decoded and be watched, and further by their own
Video bit stream encoded and be sent to videoconference server be used for decoded and watched by other participants.
Fig. 3 can be achieved on the block diagram of the example of the computing device 300 of dispatching station or receiving station.For example, computing device 300
One or two in Fig. 2 dispatching station 202 and receiving station 206 can be realized.Computing device 300 can include multiple calculate
The form of the computing system of equipment, or can be the form of single computing device, such as mobile phone, tablet PC, knee
Laptop computer, notebook, desktop computer etc..
CPU 302 in computing device 300 can be traditional CPU.As an alternative, CPU 302 can be energy
An equipment or multiple equipment for enough any other types for manipulating or handling the information for existing or developing later now.Although institute
Disclosed embodiment can be put into practice with single processor (for example, CPU 302) as shown, but can be used more than one
Individual processor is come the advantage in terms of realizing speed and efficiency.
In embodiments, the memory 304 in computing device 300 can be read-only storage (ROM) equipment or random
Access memory (RAM) equipment.The storage device of any other suitable type may be used as memory 304.Memory 304 can be with
Including by the codes accessed using bus 312 of CPU 302 and data 306.Memory 304 can also include the He of operating system 308
Application program 310, application program 310 includes at least one program for allowing CPU 302 to perform method described herein.For example,
Application program 310 can include applying 1 to N, and it also includes the video compiling application for performing method described herein.Computing device
300 can also include additional storage 314, and it may, for example, be the storage card being used together with mobile computing device.Because depending on
Frequency communication session can include substantial amounts of information, so they can be stored in additional storage 314 whole or in part, and
And needed to be loaded into memory 304 according to processing.
Computing device 300 can also include one or more output equipments, such as display 318.In one example, show
It can be the touch-sensitive display for combining display with the operable tactile sensor inputted with sensing touch to show device 318.Display
318 can be coupled to CPU 302 via bus 312.In addition to display 318 or it is used as the alternative of display 318, Ke Yiti
Allow for user program perhaps or otherwise use other output equipments of computing device 300.When output equipment be display or
During including display, display can be realized in a variety of ways, including shown by liquid crystal display (LCD), cathode-ray tube (CRT)
Show that device or light emitting diode (LED) display (such as OLED display) are realized.
Computing device 300 can also include image sensing apparatus 320 (for example, camera) or exist or open later now
Hair can sense any other image sensing apparatus 320 of image (such as image of the user of operating computing device 300), or
Person can communicate with image sensing apparatus 320.Image sensing apparatus 320 may be oriented such that its point operation computing device
300 user.In one example, can configure image sensing apparatus 320 position and optical axis so that visual field include and display
The direct neighbor of device 318 and from the region of its visual display 318.
Computing device 300 can also include sound sensing equipment 322 (for example, microphone) or exist now or after
Any other sound sensing equipment of the sound that can be sensed near computing device 300 of exploitation, or communicate.Sound sensing
Equipment 322 may be oriented such that the user of its point operation computing device 300, and can be configured as operating in user
The sound sent by user, such as voice or other language are received during computing device 300.
Although the CPU 302 and memory 304 of computing device 300 are described as being integrated into individual unit by Fig. 3, can
To utilize other configurations.CPU 302 operation can be across can be with direct-coupled or across many of LAN or other networks
Individual machine (each machine has one or more processors) and be distributed.Memory 304 can be distributed across multiple machines, such as
Network memory or the memory in multiple machines of operation of computing device 300 are performed.Although being depicted here
For single bus, but the bus 312 of computing device 300 can be made up of multiple buses.In addition, additional storage 314 can be with
Other components of computing device 300 are directly coupled to, or can be via network access, and such as storage card can be included
Multiple units of single integrated unit or such as multiple storage cards.Therefore computing device 300 can be come with various configurations
Realize.
Fig. 4 is the figure of the example of video flowing 400 that is to be encoded and then decoding.Video flowing 400 includes video sequence 402.
In next stage, video sequence 402 includes multiple consecutive frames 404.Although three frames are depicted as consecutive frame 404, video sequence
Row 402 can include any amount of consecutive frame 404.Then consecutive frame 404 can be further subdivided into single frame, example
Such as, frame 406.In next stage, frame 406 can be divided into a series of segmentations or plane 408.For example, segmentation 408 can be allowed
The frame subset of parallel processing.Segmentation 408, which can also be, can be separated into video data the frame subset of seperate color.For example, color
The frame 406 of color video data can include luminance plane and two colorimetric planes.Segmentation 408 can be entered at varying resolutions
Row sampling.
No matter whether frame 406 is divided into segmentation 408, and frame 406 can be further subdivided into block 410, and block 410 can be included
Corresponding to the data of 16 × 16 pixels in such as frame 406.Block 410 can also be arranged to include one from pixel data
Or the data of multiple planes 408.Block 410 can also be any other suitable size, such as 4 × 4 pixels, 8 × 8 pixels, 16
× 8 pixels, 8 × 16 pixels, 16 × 16 pixels or bigger.Unless otherwise stated, term block and macro block herein can be mutual
Change and use.
Fig. 5 is the block diagram of the encoder 500 according to embodiment.As set forth above, it is possible to be such as stored in by providing
Computer software programs in reservoir (for example, memory 304) realize encoder 500 in dispatching station 202.Computer software
Program can include machine instruction, cause when the machine instruction is by such as CPU 302 computing device dispatching station 202 with
Mode described in Fig. 5 is encoded to video data.Encoder 500 is also implemented as being included in such as dispatching station
Specialized hardware in 202.In an embodiment being especially desired to, encoder 500 is hardware coder.Encoder 500 has
Have with the next stage with perform in the forward path (shown in real connection line) various functions using use video flowing 400 as input Lai
Produce the bit stream 520 of coding or compression：Forecast period 502, conversion stages 504, quantization stage 506 and entropy are compiled within the frame/frames
The code stage 508.Encoder 500 can also include reconstruct path (being shown by virtually connecting wiring) to reconstruct the coding for following block
Frame.In Figure 5, encoder 500 has the various functions performed with the next stage in reconstruct path：Quantification stage 510, inversion
Change stage 512, reconstruction stage 514 and loop filtering stage 516.The other structures modification of encoder 500 can be used for video
Stream 400 is encoded.
When video flowing 400 is rendered for coding, each frame 406 can be handled in units of block.Within the frame/frames
At forecast period 502, infra-frame prediction (intra-frame prediction) (also referred to as infra-frame prediction (intra can be used
Prediction)) or inter prediction (inter-frame prediction) (also referred to as inter prediction (inter
Prediction)) each piece is encoded.It is in any case possible to form prediction block.In the situation of infra-frame prediction
Under, can be from the sample formation prediction block in previously encoded and reconstruct present frame., can be from one in the case of inter prediction
Sample formation prediction block in the reference frame of individual or multiple previous construction.
Next, again referring to Fig. 5, from current block prediction block can be subtracted at forecast period 502 within the frame/frames residual to produce
Poor block (also referred to as residual error).Conversion stages 504 use block-based conversion to be conversion coefficient by real transform in such as frequency domain.
Conversion coefficient is converted to discrete magnitude subvalue by quantization stage 506 using quantizer values or quantization level, and it is referred to as quantization transform system
Number.For example, conversion coefficient can with divided by quantizer values and be truncated.Then, the conversion coefficient of 508 pairs of quantizations of entropy code stage enters
Row entropy code.Together with the other information for being decoded to block, (it can include for example used pre- the coefficient of entropy code
Survey type, alternative types, motion vector and quantizer values) it is then exported to the bit stream 520 of compression.Various skills can be used
Art (such as variable-length compiling (VLC) or arithmetic compiling) formats the bit stream 520 of compression.The bit stream 520 of compression is also
The video flowing of coding or the video bit stream of coding can be referred to as, and these terms will be used herein interchangeably.
Reconstruct path (being shown by virtually connecting wiring) in Fig. 5 can be used to ensure that encoder 500 and decoder 600 (below
Description) both compression bit stream 520 is decoded using identical reference frame.Reconstruct path is performed similarly to below more
The function for the function of occurring during the decoding process being discussed in detail, is included in the conversion coefficient of 510 pairs of quantizations of quantification stage
Carry out quantification and inverse transformation carried out to the conversion coefficient of quantification in the inverse transformation stage 512 with produce derivative residual block (
Referred to as derivative residual error).In reconstruction stage 414, the prediction block predicted at forecast period 502 within the frame/frames can be added to and led
Residual error is counted to create reconstructed blocks.The loop filtering stage 516 can apply to reconstructed blocks to reduce such as blocking artifact (blocking
Artifacts distortion).
Other modifications of encoder 500 can be used for encoding the bit stream 520 of compression.For example, based on non-shifting
Encoder can directly quantify residual signals for some pieces or frame, without conversion stages 504.In another embodiment party
In formula, encoder can make quantization stage 506 and quantification stage 510 be combined into the single stage.
Fig. 6 is the block diagram of decoder 600 according to another embodiment.Decoder 600 can be deposited for example by providing
The computer software programs stored up in memory 304 are realized in receiving station 206.Computer software programs can refer to including machine
Order, causes receiving station 206 in the way of described in Fig. 6 to video counts when computing device of the machine instruction by such as CPU302
According to being decoded.Decoder 600 can also be realized in the hardware being included in such as dispatching station 202 or receiving station 206.
Similar to the reconstruct path of encoder 500 discussed herein above, decoder 600 includes following rank in one example
Section with perform various functions with from the bit stream 520 of compression produce outputting video streams 616：Entropy decoding stage 602, quantification stage
604th, inverse transformation stage 606, within the frame/frames forecast period 608, reconstruction stage 610, loop filtering stage 612 and block elimination filtering
Stage 614.The other structures variant of decoder 600 can be used for decoding the bit stream 520 of compression.
When the bit stream 520 that compression is presented is used to decode, can by the compression of 602 pairs of entropy decoding stage bit stream 520
Interior data element is decoded, to produce the transformation series manifold of quantization.The conversion coefficient of 604 pairs of quantizations of quantification stage is carried out
Quantification (for example, by the way that the conversion coefficient of quantization is multiplied by into quantizer values), and conversion of the inverse transformation stage 606 to quantification
Coefficient carry out inverse transformation, to produce derivative residual error, the derivative residual error can with by the inverse transformation stage 512 in encoder 500
What is created is identical.Using the header information decoded from the bit stream 520 of compression, decoder 600 can be used and predicted within the frame/frames
Stage 608 creates pre- with (for example, in forecast period 502 within the frame/frames) prediction block identical for being created in encoder 500
Survey block.In reconstruction stage 610, prediction block can be added to derivative residual error to create reconstructed blocks.The loop filtering stage 612 can be with
Applied to reconstructed blocks to reduce blocking artifact.Other filtering can be applied to reconstructed blocks.In this example, by the block elimination filtering stage
614 are applied to reconstructed blocks to reduce block distortion, and result is output as into outputting video streams 616.Outputting video streams 616 can also claim
For the video flowing of decoding, and term will be used interchangeably herein.Other modifications of decoder 600 can be used for compression
Bit stream 520 decoded.Regarded for example, decoder 600 can produce output in the case of no block elimination filtering stage 614
Frequency stream 616.
Fig. 7 and Fig. 8 using resolution ratio namely for being scaled to realize constant target bit in single-pass and bilateral coding
The flow chart of the process 700 and 800 of rate.Process 700 and 800 can be realized to help in such as system of computing device 300
The coding of video flowing.Process 700 and 800 may be implemented as example by computing device (such as dispatching station 202 or receiving station 206)
The software program of execution.Software program can include the machine readable instructions being stored in such as memory of memory 304, machine
Device readable instruction is when by such as CPU 302 computing device so that in computing device implementation procedure 700 or process 800
One.Process 700 and 800 can also be realized using hardware in whole or in part.As described above, some computing devices can have
The step of multiple memories and multiple processors, and in this case, each process 700 and 800 or operation can be used
Different processor and memory are distributed.The use of the term " processor " and " memory " of singulative herein is included only
Computing device with a processor or memory and the equipment with multiple processors or memory, each processing
Device or memory, which can be used in, to be performed some steps but is not necessarily used for performing the Overall Steps recorded.
For the purpose of simplifying the description, each process 700 and 800 is depicted and described as series of steps or operation.However, according to
The step of disclosure and operation can occur in various order and/or simultaneously.In addition, according to the step of the disclosure or operation can be with
Occur together with other steps not presented and described herein or operation.In addition, the step of simultaneously not all is shown or operation are all needed
Realize the method according to disclosed theme.Can be to one in each frame repetitive process 700 or 800 of input signal.
With reference to Fig. 7, at operation 702, pass through sets target bit rate, initial Q P, minimum QP threshold values and maximum QP threshold values
Value, for being encoded in single-pass in scaled and started with the process 700 for the target bit rate for realizing relative constancy using resolution ratio.This
A little values can indicate the initial resolution that video flowing is being encoded.At operation 704, encoder is using initial Q P to video flowing
The first frame encoded.If carrying out the frame bit rate that coding causes to meet target bit rate to the first frame, operation 706 is led to
Cross and return to operation 704 to prepare the encoder encoded for the next frame to video flowing.Otherwise, process 700 is proceeded to
In the triggering adjustment period of operation 708, it is determined in video data using filtering logic with the presence or absence of vibration.If do not shaken
Swing, then operate 708 prepares the encoder encoded for the next frame to video flowing by returning to operation 704.Otherwise,
Process 700 proceeds to the adjustment period initiated at operation 710.
At operation 710, determine that frame bit rate is unsatisfactory for whether target bit rate is due to overshoot or undershoot.In frame bit
Rate is overshooted in the case of exceeding target bit rate (overshoot), for example, because the resolution that QP is being encoded for video flowing
It is too low for rate.Occurs undershoot in the case where frame bit rate is less than target bit rate (undershoot), for example, because QP is for video
It is too high for the resolution ratio that stream is being encoded.In spite of overshoot or undershoot is determined, will hereinafter video flowing be adjusted
One or more coding parameters, to improve the quality of video flowing.To the matter of video flowing when coding parameter can be included in adjustment
Amount or the influential any value of visual representation.In embodiments, coding parameter includes but is not limited to QP, video resolution, most
Big QP threshold values and minimum QP threshold values.The adjustment carried out below by encoder depend on bit rate problem whether due to overshoot or under
Punching.
If operation 710 determines there is bit rate overshoot, process 700 proceeds to operation 712, wherein it is currently QP to determine
Setting value (operation 710 be executed only once in the case of its can be operation 702 at set initial Q P) whether etc.
In the value currently set for maximum QP threshold values.If it is not, then increasing QP at operation 714, the operation is by returning to operation
704 prepare the encoder encoded for the next frame to video flowing using increased QP.If however, QP value etc.
In the value of maximum QP threshold values, then QP cannot be further increased, because it has reached the highest of the resolution ratio relative to video flowing
Virtual value.Therefore, at operation 716, process 700 reduces the resolution ratio of video flowing, and it includes resetting minimum QP threshold values and maximum
The value of QP threshold values.Operation 716 reduces to reduce QP value also based on resolution ratio.Operation 716 is then by returning to operation
704, prepare the coding for being encoded to next frame using new resolution ratio and QP, minimum QP threshold values and maximum QP threshold values
Device.
If on the contrary, operation 710 determines there is bit rate undershoot, process 700 proceeds to operation 718, wherein determining
(in the case where operation 710 is executed only once, it can be the initial of the setting at operation 702 to the value currently set for QP
QP) whether it is equal to the current value set for minimum QP threshold values.If it is not, then reducing QP at operation 720, the operation is by returning
The encoder for returning to operation 704 and preparing to be encoded for the next frame to video flowing using the QP of reduction.If however, QP
Value be equal to minimum QP threshold values value, then QP can not further reduce, because it has reached the resolution ratio relative to video flowing
Lowest effective value.Therefore, at operation 722, process 700 increases the resolution ratio of video flowing, and this includes resetting minimum QP threshold values
With the value of maximum QP threshold values.Operation 722 also increases QP value based on the increase of resolution ratio.Then, operation 722 is by returning to
Operation 704, the volume for being encoded to next frame is prepared using new resolution ratio and QP, minimum QP threshold values and maximum QP threshold values
Code device.
If the source of higher resolution can use, in coding bit rate undershoot target bit rate or more than some threshold value all the time
Number of times in the case of undershoot target bit rate, another option is that increase video resolution.For example, in user's selection with 360p points
Resolution watches video, but his or her bandwidth allows in the case of being watched with higher resolution, can increase video resolution
The ultimate resolution of streaming can be carried out in his or her connection to video by being added to user.
In bilateral coding, for the frame to video flowing encoded first it is logical include, for example by detect by pair and
The corresponding input frame of first frame of video flowing carries out the bit number of coding generation, determines which frame can based on constant quantization parameter
Can it is too difficult or too easily coding.If the bit number generated indicates that input frame is too difficult or too easy, encoder can be in coding
The second of correspondence frame adjusts the resolution ratio of video flowing when logical.By this way, bilateral coding can be by knowing during first is logical
The potential situation of other undershoot and overshoot and necessary adjustment is carried out so that effectively encoded video stream is big to prevent on logical second
Most undershoots and overshoot.The amount of undershoot or overshoot can indicate that every dimension needs to adjust the degree of resolution ratio.
Referring now to Figure 8, operation 802 at, for being encoded in bilateral in scale to realize relative constancy using resolution ratio
The process 800 of target bit rate started by sets target bit rate and QP initial value.At operation 804, institute is used
The target bit rate and QP values of setting is received and coding input frame.In response to being encoded to input frame, given birth at operation 806
Into bit number.Bit number indicates the bit rate that input frame is encoded.Depending on the size of the bit generated, process 800 can be after
Continue to the adjustment period of the coding parameter (for example, video resolution) for adjusting video flowing.In embodiments, it can be based on
Whether frame bit rate falls the external determination for being made regarding whether to proceed to adjustment period in specified range, in the specified range
It is interior, change QP cause desired video quality (for example, not on resolution ratio visible compiling artefact video streaming).Example
Such as, if frame bit rate is in the 100 to 200kbps of target bit rate, operation 808 can be determined without adjustment period.
In the case of without adjustment, process 800 proceeds to operation 816, wherein QP values based on earlier set generate coding
Frame, the frame of the coding is then sent at operation 818 as a part for outputting video streams.In embodiments, it can be used
Mark come be compiled in operation 808 at determination.
If determining to need to carry out the adjustment to video resolution at operation 808, process 800 proceeds to operation 810,
Whether the necessity of its determination adjustment is due to input frame coding bit rate undershoot or overshoot target bit rate.In the situation of overshoot
Under, at operation 812, for example, adjust one or more coding parameters by reducing the resolution ratio of video flowing.In the feelings of undershoot
Under condition, at operation 814, for example, one or more coding parameters are adjusted by increasing the resolution ratio of video flowing.
In embodiments, the square root that the weighting of percentage bit rate deviation can be used inverse, such as Snew=√ (1/
(α*Bdev)), to determine the adjustment to video resolution, wherein SnewRepresent that the new scaling of resolution ratio often ties up ratio, α represents to add
Weight parameter, and BdevExpression and the deviation of bitrate range.For example, causing to be less than 2 percent carrying out input frame coding
Ten overshoot and weighting parameters is set to for the moment, and the input frame of the video flowing with 1280 × 720 resolution ratio can lead to
Cross Snew=√ (1/ (1*1.2))=0.913 is scaled, so as to cause 1168 × 657 new streaming resolution ratio.Similarly,
When causing 50 percent serious undershoot to input frame progress coding, zoom ratio can be changed into Snew=√ (1/ (1*0.5))
=1.414.In this way it is possible to adjust resolution video stream so that it is encoded with 1810 × 1018.By weighting parameters
α is adjusted to that new frame bit rate can be caused to be encoded as the median closer to tolerance interval (for example, 100kbps higher than 1
150kbps in the range of to 200kbps).
After being adjusted to video resolution, process 800 proceeds to operation 816, wherein corresponding to the volume of input frame
The frame of code is encoded as a second logical part of video flowing.Then, at operation 818, it regard the frame of coding as output video
The part transmission of stream.
Resolution ratio scaling can provide the further benefit beyond those described above.For example, resolution ratio scaling can be improved
Not yet find the encoder for the acceptable motion vector for inter prediction for utilizing set up motion search window area
Performance.This is typically due to the excessive use of infra-frame prediction and causes the compression of difference.By downscaled video stream in this case,
Because there is the less pixel to be encoded, bit rate reduces, and the absolute movement amount in video flowing also reduces.This can
To improve the utilization of search window.
In embodiments, and in response to determining undershoot at operation 810, operation 814 includes reducing motion search area
The size in domain, it can also replace reducing video resolution or be completed as the supplement of video resolution is reduced.Similarly, respond
In operation 810 at determine overshoot, operation 812 include increase motion search area sizes come replace increase video resolution or
It is used as the supplement of increase video resolution.In embodiments, only for input frame some color components (for example, its brightness
And/or chroma pixel values) carry out the change to the size of motion search area.
In embodiments, for example, in response to being encoded at operation 804 to input frame, can recognize for motion
One or more encoders limitation of region of search.Encoder limitation can indicate the motion vector wherein found by encoder
500 exceed the situation of threshold value, for example, wherein video flowing includes fast moving scenes, it includes exceeding encoder 500 with given point
Resolution fully represents the amount of exercise of the ability of scene.In embodiments, indicate that motion vector exceedes in response to encoder limitation
Threshold value, can reduce the resolution ratio of video flowing.
In embodiments, the size of motion search area is not subjected to change.For example, being implemented as hard in encoder 500
In the case of part encoder, motion search area can be statically set as N × M size, and wherein N and M can be identical
Or different values.Therefore, if the high resolution of video flowing is in N × M, motion search area can only cover the one of input frame
Part.The point midway of motion search area can for example relative to the input frame to be covered initial part initial reference position
Put and be defined (for example, the current block or the point midway of piece to be encoded).However, in embodiments, can reduce and regard
The resolution ratio of frequency stream, for example to improve encoder 500 by causing motion search area to cover the major part of input frame
Detect the ability of the motion in motion search area.As discussed above, can be based on threshold value or for motion search area
Other encoders limitation, by this way (for example, be used as operation 808 at determine whether adjust coding parameter a part)
Make the decision for reducing resolution ratio.Reducing resolution ratio causes being covered by motion search area as a result based on input frame
Partial reference position resets the point midway of motion search area.Similarly, in embodiments, can based on threshold value or
Other encoders limit to increase the resolution ratio of video flowing.For example, resolution ratio less than motion search area size (for example,
Wherein motion search area will cover the situation for exceeding whole input frame) in the case of, encoder 500 can be by point of video flowing
Resolution increase is the size equal to motion search area.Therefore, the point midway of motion search area will be located in due course or
It is maintained at the reference position of input frame.As it is used herein, term " midpoint " refers to the center on correspondingly-sized.
Although herein in regard to Fig. 8 two-way coding discuss on motion search area one or more encoders limit
System, still, they also have an application in single-pass coding context, all as discussed with respect to FIG. 7.For example, adjustment video
The coding parameter of first frame of stream can include encoder limitation of the identification for motion search area (for example, as in operation
A part for triggering adjustment is determined at 708) and limit the resolution ratio for reducing (or increase) video flowing based on encoder.In embodiment party
In formula, changing resolution ratio by this way causes the point midway of motion search area on the first frame as a result by moving
The reference position of the part of region of search covering is reset.
In another embodiment that encoder 500 is hardware coder, the parameter of motion search is from block to block and frame
Keep identical to frame, except the point midway of motion search area changes with the block for the frame being encoded.Therefore, resolution is worked as
When rate changes, more or less motions can be captured by the change of resolution ratio.For example, when there is quick motion, by
Capture and more done more physical exercises in same search region in low resolution, so change resolution ratio can provide some pieces of frame in
More preferably matching, and therefore relatively low residual error is provided.
The target bit rate set in the initial operation of process 700 and 800 can be the variable bit rate for being subjected to fluctuation.
This fluctuation may be caused by the connection speed of the user of streamed video or the change of network connection type.For example, in user
During initially by the WiFi connections that become unavailable come streamed video, video flowing can be switched to LTE connections.Due to each net
Network connection type can indicate the target bit rate for being used to most preferably watch given video flowing in given resolution ratio of their own, institute
May expect to utilize the embodiment of disclosed rate control process to be encoded for the single-pass of target variable bit rate and double
Logical coding.
The aspect of coding and decoding as described above illustrates some examples of coding and decoding technology.However, should manage
Solution, compression, decompression, conversion or any are may mean that as the coding and decoding of those terms used in claim
The processing or change of other data.
Word " example " is used herein to mean that as example, example or explanation.It is described herein as " example "
Any aspect or design be not necessarily to be construed as relative to other side or design be preferred or favourable.On the contrary, using word
Language " example " is intended to that concept is presented in a concrete fashion.As used in this application, term "or" is intended to indicate that inclusive
"or" rather than exclusive "or".That is, unless otherwise indicated or clear from the context, otherwise " X include A or
B " is intended to indicate that any naturally inclusive arrangement.If that is, X includes A；X includes B；Or X includes both A and B, then
" X includes A or B " to satisfaction under any previous examples.In addition, explicitly indicating that odd number shape unless otherwise indicated or from the context
Formula, the article " one " and " one " otherwise used in the application and appended claims should generally be interpreted to mean " one or
It is multiple ".In addition, term " embodiment " used throughout or " embodiment " are not intended as expression identical embodiment
Or embodiment, unless so description.
Dispatching station 202 and/or receiving station 206 (and including being stored thereon by encoder 500 and decoder 600 and/or
Thus the algorithm that performs, method, instruction etc.) it can be realized in hardware, software or its any combinations.Hardware can include example
Such as computer, intellectual property (IP) core, application specific integrated circuit (ASIC), programmable logic array, optical processor, programmable patrol
Collect controller, microcode, microcontroller, server, microprocessor, digital signal processor or any other suitable circuit.
In the claims, term " processor " is appreciated that includes any aforementioned hardware either individually or in combination.Term " letter
Number " and " data " be used interchangeably.In addition, the part of dispatching station 202 and receiving station 206 not necessarily must be real in an identical manner
It is existing.
In addition, in one aspect, for example, dispatching station 202 or receiving station 206 can be used with the general of computer program
Computer or general processor realize that the computer program performs any corresponding side as described herein when executed
Method, algorithm and/or instruction.Addition or alternatively, it is, for example, possible to use can include is used to perform any side as described herein
Special-purpose computer/processor of method, algorithm or other hardware of instruction.
Dispatching station 202 and receiving station 206 can realize on the computer for example in video conferencing system.As an alternative, send out
See off 202 can realize on the server, and receiving station 206 can realize in the equipment separated with server, such as hand
Hold communication equipment.In this case, dispatching station 202 can use encoder 500 by vision signal of the research content for coding,
And the vision signal of coding is sent to communication equipment.Then, then communication equipment can use decoder 600 to regard coding
Frequency signal is decoded.As an alternative, communication equipment can decode the content being locally stored on a communications device, for example, not by sending out
See off the contents of 202 transmissions.It is other it is suitable transmission and receive implementation be available.For example, receiving station 206 can be
Generally fixed personal computer rather than portable communication device, and/or the equipment including encoder 500 can also be including solution
Code device 600.
It can use or count from such as tangible computer in addition, all or part of of embodiments of the present invention can be used
The form for the computer program product that calculation machine computer-readable recording medium is accessed.Computer is available or computer-readable medium can be being capable of example
Described program is such as visibly included, stores, transmits or transmits to be used by any processor or be used in combination with any processor
Any equipment.The medium can be such as electronics, magnetic, optics, electromagnetism or semiconductor devices.Other suitable media
It is available.
Above-described embodiment, embodiment and aspect has been described to be readily appreciated that the present invention, and does not limit this hair
It is bright.On the contrary, it is contemplated that covering the various modifications being included within the scope of the appended claims and equivalent arrangements, its scope is accorded with
Broadest explanation is closed, with including allowed by law all such modifications and equivalent structure.
Claims (20)
1. a kind of device for Real-Time Video Encoder speed control, including：
At least one processor, at least one described processor is configured as performing the instruction stored in non-physical storage medium
With：
Recognize the first frame of multiple frames of video flowing；
First frame is encoded with the first bit rate for representing quantization parameter；
In response to being encoded to first frame, recognize that one or more encoders on motion search area are limited；
The target bit rate of first bit rate and first frame is compared, and by the quantization parameter and minimum
One changed in threshold value and maximum quantization threshold value is compared；
In response to first bit rate and the target bit rate are compared and by the quantization parameter and the minimum
One in quantization threshold and the maximum quantization threshold value is compared, and adjusts at least one coding parameter；
Recognize the second frame of the multiple frame of the video flowing；
At least one coding parameter adjusted is used to be encoded with the second bit rate to second frame；And
Coded the first frame and the second coded frame is sent in output bit flow.
2. device according to claim 1, wherein, if first bit rate is less than the target bit rate, and
The quantization parameter is more than the minimum quantization threshold value, then adjusting at least one described coding parameter includes：
Reduce the quantization parameter.
3. device according to claim 1, wherein, if first bit rate is less than the target bit rate, and
The quantization parameter is less than or equal to the minimum quantization threshold value, then adjusting at least one described coding parameter includes：
Increase the resolution ratio of the video flowing；
Increase the quantization parameter；And
Based on minimum quantization threshold value and the maximum quantization threshold value described in the increased resolution adjustment of institute.
4. device according to claim 1, wherein, if first bit rate is more than the target bit rate, and
The quantization parameter is less than the maximum quantization threshold value, then adjusting at least one described coding parameter includes：
Increase the quantization parameter.
5. device according to claim 1, wherein, if first bit rate is more than the target bit rate, and
The quantization parameter is more than or equal to the maximum quantization threshold value, then adjusting at least one described coding parameter includes：
Reduce the resolution ratio of the video flowing；
Reduce the quantization parameter；And
Based on minimum quantization threshold value described in the resolution adjustment reduced and the maximum quantization threshold value.
6. device according to claim 1, wherein, at least one described coding parameter of adjustment includes：
Limit to reduce the resolution ratio of the video flowing based on one or more of encoders；
The reference position of first frame is determined with the resolution ratio reduced；And
The reference position based on first frame resets the point midway of the motion search area.
7. device according to claim 1, wherein, at least one described coding parameter includes at least one in the following
It is individual：The resolution ratio of the video flowing, the quantization parameter, the minimum quantization threshold value and the maximum quantization threshold value.
8. a kind of device for Real-Time Video Encoder speed control, including：
At least one processor, at least one described processor is configured as performing the instruction stored in non-physical storage medium
With：
Recognize the input frame of multiple frames of video flowing；
The input frame is encoded using input quantization parameter；
In response to being encoded to the input frame, recognize that one or more encoders on motion search area are limited；
Bit number is generated in response to being encoded to the input frame；
At least one coding ginseng is adjusted based on the bit number and for the target bit rate encoded to the input frame
Number；
The input frame is encoded by using at least one described coding parameter to generate the frame of coding；And
The frame of the coding is sent in output bit flow.
9. device according to claim 8, wherein, if in response to described in being encoded and being generated to the input frame
Bit number indicates the frame bit rate less than the target bit rate, then adjusts at least one described coding parameter described including increase
The resolution ratio of video flowing, and the frame of the coding is generated including being encoded with the increased resolution ratio of institute to the input frame.
10. device according to claim 8, wherein, if in response to the institute that the input frame is encoded and generated
State bit number to indicate to be more than the frame bit rate of the target bit rate, then adjusting at least one described coding parameter includes reducing institute
Stating the resolution ratio of video flowing, and generate the frame of the coding includes compiling the input frame with the resolution ratio reduced
Code.
11. device according to claim 8, wherein, at least one described coding parameter of adjustment includes：
Based on the bit number and the target bit rate, indicate whether at least one described coding parameter is carried out using mark
Adjustment.
12. device according to claim 8, wherein, at least one described coding parameter of adjustment includes：
Limit to reduce the resolution ratio of the video flowing based on one or more of encoders；
The reference position of the input frame is determined with the resolution ratio reduced；And
The reference position based on the input frame, resets the point midway of the motion search area.
13. device according to claim 8, wherein, at least one described coding parameter is included in the following at least
One：The resolution ratio of the input quantization parameter, coded quantization parameter and the video flowing.
14. device according to claim 8, wherein, the input quantization parameter is constant.
15. a kind of device for Real-Time Video Encoder speed control, including：
At least one processor, at least one described processor is configured as performing the instruction stored in non-physical storage medium
With：
Recognize the input frame of multiple frames of video flowing；
The input frame is encoded with the first bit rate for representing constant quantization parameter；
In response to being encoded to the input frame, recognize that one or more encoders on motion search area are limited；
By a progress in the smallest target bit rate and maximum target bit rate of first bit rate and the input frame
Compare；
In response to by described one in first bit rate and the smallest target bit rate and the maximum target bit rate
It is individual to be compared, adjust at least one coding parameter；
The input frame is encoded by using at least one described coding parameter to generate the frame of coding；And
The frame of the coding is sent in output bit flow.
16. device according to claim 15, wherein, if first bit rate is less than the minimum target bit
Rate, then adjusting at least one described coding parameter includes increasing the resolution ratio of the video flowing, and generates the frame of the coding
Including being encoded with the increased resolution ratio of institute to the input frame.
17. device according to claim 15, wherein, if first bit rate is more than the maximum target bit
Rate, then adjusting at least one described coding parameter includes reducing the resolution ratio of the video flowing, and generates the frame of the coding
Including being encoded with the resolution ratio reduced to the input frame.
18. device according to claim 15, wherein, at least one described coding parameter of adjustment includes：
Based on the bit number of first bit rate for indicating to encode the input frame and in the minimum target ratio
Target bit rate between special rate and the maximum target bit rate, indicates that at least one described coding parameter is using mark
It is no to be adjusted.
19. device according to claim 15, wherein, at least one described coding parameter of adjustment includes：
Limit to reduce the resolution ratio of the video flowing based on one or more of encoders；
The reference position of the input frame is determined with the resolution ratio reduced；And
The reference position based on the input frame resets the point midway of the motion search area.
20. device according to claim 15, wherein, at least one described coding parameter is included in the following at least
One：The constant quantization parameter, the smallest target bit rate, the maximum target bit rate, coded quantization parameter and institute
State the resolution ratio of video flowing.
Applications Claiming Priority (2)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US15/000,097 | 2016-01-19 | ||
US15/000,097 US10356406B2 (en) | 2016-01-19 | 2016-01-19 | Real-time video encoder rate control using dynamic resolution switching |
Publications (2)
Publication Number | Publication Date |
---|---|
CN107040781A true CN107040781A (en) | 2017-08-11 |
CN107040781B CN107040781B (en) | 2020-11-03 |
Family
ID=57822055
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
CN201611225434.7A Active CN107040781B (en) | 2016-01-19 | 2016-12-27 | System, method and apparatus for controlling real-time video encoder rate |
Country Status (9)
Country | Link |
---|---|
US (1) | US10356406B2 (en) |
JP (1) | JP6714695B2 (en) |
KR (1) | KR102118573B1 (en) |
CN (1) | CN107040781B (en) |
AU (1) | AU2016388357B2 (en) |
CA (1) | CA3001672C (en) |
DE (2) | DE202016008214U1 (en) |
GB (1) | GB2546887B (en) |
WO (1) | WO2017127213A1 (en) |
Cited By (7)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN109819263A (en) * | 2017-11-22 | 2019-05-28 | 腾讯科技（深圳）有限公司 | Method for video coding, device, computer equipment and storage medium |
WO2019205831A1 (en) * | 2018-04-27 | 2019-10-31 | 腾讯科技 (深圳) 有限公司 | Method and device for video encoding, storage medium, and equipment |
CN110692247A (en) * | 2017-08-14 | 2020-01-14 | 谷歌有限责任公司 | Composite motion compensated prediction |
CN111279700A (en) * | 2017-09-29 | 2020-06-12 | 超威半导体公司 | Adjustable modulation coding scheme for improving video stream robustness |
CN111601109A (en) * | 2020-05-13 | 2020-08-28 | 西安万像电子科技有限公司 | Image data processing method, device and system |
CN111819846A (en) * | 2018-11-26 | 2020-10-23 | 谷歌有限责任公司 | Secure and cross-device consistent video compression |
CN113115107A (en) * | 2021-04-15 | 2021-07-13 | 深圳鸿祥源科技有限公司 | Handheld video acquisition terminal system based on 5G network |
Families Citing this family (20)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN111031340B (en) * | 2016-02-26 | 2023-01-13 | 网络洞察力知识产权公司 | Method for adaptively transmitting data stream and node in communication network |
US10162936B2 (en) * | 2016-03-10 | 2018-12-25 | Ricoh Company, Ltd. | Secure real-time healthcare information streaming |
US10362307B2 (en) * | 2016-09-09 | 2019-07-23 | Hanwha Techwin Co., Ltd. | Quantization parameter determination method and image capture apparatus |
DE112018002112T5 (en) | 2017-04-21 | 2020-01-16 | Zenimax Media Inc. | SYSTEMS AND METHODS FOR RENDERING & PRE-CODED LOAD TREASURY-BASED CODER-ADDRESS-RELATED APPLICATIONS |
KR102315524B1 (en) * | 2017-06-16 | 2021-10-21 | 한화테크윈 주식회사 | A method for adjusting bitrate of the image and image capture apparatus |
CN109151481B (en) * | 2017-06-28 | 2022-03-15 | 腾讯科技（深圳）有限公司 | Method, device, system, equipment and medium for transmitting and receiving pictures |
CN109151470B (en) * | 2017-06-28 | 2021-03-16 | 腾讯科技（深圳）有限公司 | Coding resolution control method and terminal |
US11146608B2 (en) | 2017-07-20 | 2021-10-12 | Disney Enterprises, Inc. | Frame-accurate video seeking via web browsers |
CN109413427B (en) * | 2017-08-17 | 2022-04-08 | 腾讯科技（深圳）有限公司 | Video frame coding method and terminal |
US10659514B2 (en) | 2018-03-28 | 2020-05-19 | Arlo Technologies, Inc. | System for video monitoring with adaptive bitrate to sustain image quality |
WO2019191983A1 (en) * | 2018-04-04 | 2019-10-10 | 深圳市大疆创新科技有限公司 | Encoding method and device, image processing system, and computer readable storage medium |
CN108769681B (en) * | 2018-06-20 | 2022-06-10 | 腾讯科技（深圳）有限公司 | Video encoding method, video decoding method, video encoding apparatus, video decoding apparatus, computer device, and storage medium |
CN108924553B (en) * | 2018-06-20 | 2021-10-08 | 腾讯科技（深圳）有限公司 | Video encoding method, video decoding method, video encoding apparatus, video decoding apparatus, computer device, and storage medium |
US10554975B1 (en) | 2018-09-30 | 2020-02-04 | Tencent America LLC | Method and apparatus for video coding |
CN110572654B (en) * | 2019-09-27 | 2024-03-15 | 腾讯科技（深圳）有限公司 | Video encoding and decoding methods and devices, storage medium and electronic device |
CN113038136B (en) * | 2019-12-25 | 2022-10-11 | 成都鼎桥通信技术有限公司 | Video self-adaptive adjustment method and device |
FR3105904B1 (en) | 2019-12-26 | 2023-03-10 | Thales Sa | Allocation method for low-speed link |
US20220312018A1 (en) * | 2021-03-23 | 2022-09-29 | Samsung Electronics Co., Ltd. | Electronic device to encode video with max quantum parameter control and the method thereof |
CN114650437B (en) * | 2022-03-14 | 2024-04-16 | 百果园技术(新加坡)有限公司 | Video publishing method, device, equipment and storage medium |
CN114827669B (en) * | 2022-03-31 | 2023-08-18 | 杭州网易智企科技有限公司 | Video data transmission method, device, medium and equipment |
Citations (5)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
EP1351517A2 (en) * | 2002-03-28 | 2003-10-08 | Sony United Kingdom Limited | Data compression for multi-generation images |
CN102006471A (en) * | 2009-09-02 | 2011-04-06 | 索尼电脑娱乐公司 | Picture-level rate control for video encoding |
US8077772B2 (en) * | 2007-11-09 | 2011-12-13 | Cisco Technology, Inc. | Coding background blocks in video coding that includes coding as skipped |
EP2579593A1 (en) * | 2011-10-04 | 2013-04-10 | Thomson Licensing | Adaptive quantisation for intra-encoded image blocks |
CN103686172A (en) * | 2013-12-20 | 2014-03-26 | 电子科技大学 | Code rate control method based on variable bit rate in low latency video coding |
Family Cites Families (34)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
JP3773585B2 (en) * | 1996-03-29 | 2006-05-10 | 富士通株式会社 | Image encoding device |
AU2003248178B2 (en) | 1997-12-23 | 2006-07-06 | Thomson Licensing S.A. | Low noise encoding and decoding apparatus and method |
US6192154B1 (en) | 1998-01-26 | 2001-02-20 | International Business Machines Corporation | Two-pass encoding method of digital motion video sequences for constant-or variable bit rate |
US6343098B1 (en) * | 1998-02-26 | 2002-01-29 | Lucent Technologies Inc. | Efficient rate control for multi-resolution video encoding |
US6650704B1 (en) | 1999-10-25 | 2003-11-18 | Irvine Sensors Corporation | Method of producing a high quality, high resolution image from a sequence of low quality, low resolution images that are undersampled and subject to jitter |
US6674796B1 (en) | 2000-02-14 | 2004-01-06 | Harmonic, Inc. | Statistical multiplexed video encoding for diverse video formats |
EP1139669A1 (en) * | 2000-03-28 | 2001-10-04 | STMicroelectronics S.r.l. | Coprocessor for motion estimation in digitised video sequence encoders |
JP4258694B2 (en) * | 2000-10-06 | 2009-04-30 | 日本電気株式会社 | Moving picture coding method, moving picture coding apparatus, moving picture decoding apparatus, and moving picture communication system including them |
US20020071052A1 (en) | 2000-12-07 | 2002-06-13 | Tomoaki Itoh | Transmission rate control method |
US6785334B2 (en) | 2001-08-15 | 2004-08-31 | Koninklijke Philips Electronics N.V. | Method for transmission control in hybrid temporal-SNR fine granular video coding |
US7050502B2 (en) * | 2001-09-18 | 2006-05-23 | Matsushita Electric Industrial Co., Ltd. | Method and apparatus for motion vector detection and medium storing method program directed to the same |
GB2387055A (en) | 2002-03-28 | 2003-10-01 | Sony Uk Ltd | Data compression method including target data quantity allocation |
US6728315B2 (en) | 2002-07-24 | 2004-04-27 | Apple Computer, Inc. | Method and apparatus for variable accuracy inter-picture timing specification for digital video encoding with reduced requirements for division operations |
US7519115B2 (en) * | 2003-03-31 | 2009-04-14 | Duma Video, Inc. | Video compression method and apparatus |
US7352808B2 (en) * | 2004-01-29 | 2008-04-01 | International Business Machines Corporation | System and method for the dynamic resolution change for video encoding |
US7697608B2 (en) * | 2004-02-03 | 2010-04-13 | Sony Corporation | Scalable MPEG video/macro block rate control |
US20060056511A1 (en) * | 2004-08-27 | 2006-03-16 | University Of Victoria Innovation And Development Corporation | Flexible polygon motion estimating method and system |
KR100631743B1 (en) | 2004-11-26 | 2006-10-11 | 삼성전자주식회사 | Method and apparatus for efficient transmission of scalable bitstream |
JP4251291B2 (en) | 2004-12-22 | 2009-04-08 | 日本ビクター株式会社 | Moving picture coding apparatus and moving picture coding method |
US7602997B2 (en) | 2005-01-19 | 2009-10-13 | The United States Of America As Represented By The Secretary Of The Army | Method of super-resolving images |
US7983341B2 (en) * | 2005-02-24 | 2011-07-19 | Ericsson Television Inc. | Statistical content block matching scheme for pre-processing in encoding and transcoding |
WO2006098226A1 (en) * | 2005-03-14 | 2006-09-21 | Matsushita Electric Industrial Co., Ltd. | Encoding device and dynamic image recording system having the encoding device |
US8077775B2 (en) | 2006-05-12 | 2011-12-13 | Freescale Semiconductor, Inc. | System and method of adaptive rate control for a video encoder |
US8250618B2 (en) | 2006-09-18 | 2012-08-21 | Elemental Technologies, Inc. | Real-time network adaptive digital video encoding/decoding |
US20090110062A1 (en) * | 2007-10-30 | 2009-04-30 | The Hong Kong University Of Science And Technology | Optimal heegard-berger coding schemes |
US8139607B2 (en) | 2008-01-21 | 2012-03-20 | At&T Intellectual Property I, L.P. | Subscriber controllable bandwidth allocation |
CN102027745A (en) | 2008-05-16 | 2011-04-20 | 夏普株式会社 | Video recording apparatus |
US8396114B2 (en) * | 2009-01-29 | 2013-03-12 | Microsoft Corporation | Multiple bit rate video encoding using variable bit rate and dynamic resolution for adaptive video streaming |
US8270473B2 (en) * | 2009-06-12 | 2012-09-18 | Microsoft Corporation | Motion based dynamic resolution multiple bit rate video encoding |
GB2501402B (en) | 2010-12-21 | 2015-06-24 | Syndiant Inc | Spatial light modulator with storage reducer |
US9071841B2 (en) * | 2011-05-17 | 2015-06-30 | Microsoft Technology Licensing, Llc | Video transcoding with dynamically modifiable spatial resolution |
WO2013033458A2 (en) * | 2011-08-30 | 2013-03-07 | Divx, Llc | Systems and methods for encoding and streaming video encoded using a plurality of maximum bitrate levels |
US9094684B2 (en) | 2011-12-19 | 2015-07-28 | Google Technology Holdings LLC | Method for dual pass rate control video encoding |
US9578342B2 (en) * | 2013-06-24 | 2017-02-21 | Dialogic Corporation | Rate control algorithm for scalable video encoding with disposable P-frames |
-
2016
- 2016-01-19 US US15/000,097 patent/US10356406B2/en active Active
- 2016-12-20 GB GB1621731.7A patent/GB2546887B/en active Active
- 2016-12-22 DE DE202016008214.1U patent/DE202016008214U1/en active Active
- 2016-12-22 WO PCT/US2016/068216 patent/WO2017127213A1/en active Application Filing
- 2016-12-22 JP JP2018519380A patent/JP6714695B2/en active Active
- 2016-12-22 CA CA3001672A patent/CA3001672C/en active Active
- 2016-12-22 AU AU2016388357A patent/AU2016388357B2/en active Active
- 2016-12-22 DE DE102016125353.7A patent/DE102016125353A1/en active Pending
- 2016-12-22 KR KR1020187010575A patent/KR102118573B1/en active IP Right Grant
- 2016-12-27 CN CN201611225434.7A patent/CN107040781B/en active Active
Patent Citations (6)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
EP1351517A2 (en) * | 2002-03-28 | 2003-10-08 | Sony United Kingdom Limited | Data compression for multi-generation images |
US8077772B2 (en) * | 2007-11-09 | 2011-12-13 | Cisco Technology, Inc. | Coding background blocks in video coding that includes coding as skipped |
CN102006471A (en) * | 2009-09-02 | 2011-04-06 | 索尼电脑娱乐公司 | Picture-level rate control for video encoding |
CN103402099A (en) * | 2009-09-02 | 2013-11-20 | 索尼电脑娱乐公司 | Picture-level rate control for video encoding |
EP2579593A1 (en) * | 2011-10-04 | 2013-04-10 | Thomson Licensing | Adaptive quantisation for intra-encoded image blocks |
CN103686172A (en) * | 2013-12-20 | 2014-03-26 | 电子科技大学 | Code rate control method based on variable bit rate in low latency video coding |
Cited By (15)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN110692247A (en) * | 2017-08-14 | 2020-01-14 | 谷歌有限责任公司 | Composite motion compensated prediction |
CN110692247B (en) * | 2017-08-14 | 2023-08-08 | 谷歌有限责任公司 | Prediction for composite motion compensation |
CN111279700A (en) * | 2017-09-29 | 2020-06-12 | 超威半导体公司 | Adjustable modulation coding scheme for improving video stream robustness |
CN111279700B (en) * | 2017-09-29 | 2024-03-05 | 超威半导体公司 | Adjustable modulation coding scheme for improving video stream robustness |
WO2019100783A1 (en) * | 2017-11-22 | 2019-05-31 | 腾讯科技（深圳）有限公司 | Video encoding method, computer apparatus, and storage medium |
CN109819263A (en) * | 2017-11-22 | 2019-05-28 | 腾讯科技（深圳）有限公司 | Method for video coding, device, computer equipment and storage medium |
US11032539B2 (en) | 2017-11-22 | 2021-06-08 | Tencent Technology (Shenzhen) Company Limited | Video coding method, computer device, and storage medium |
CN109819263B (en) * | 2017-11-22 | 2022-08-19 | 腾讯科技（深圳）有限公司 | Video coding method, video coding device, computer equipment and storage medium |
US11388403B2 (en) | 2018-04-27 | 2022-07-12 | Tencent Technology (Shenzhen) Company Limited | Video encoding method and apparatus, storage medium, and device |
WO2019205831A1 (en) * | 2018-04-27 | 2019-10-31 | 腾讯科技 (深圳) 有限公司 | Method and device for video encoding, storage medium, and equipment |
CN111819846A (en) * | 2018-11-26 | 2020-10-23 | 谷歌有限责任公司 | Secure and cross-device consistent video compression |
CN111819846B (en) * | 2018-11-26 | 2024-04-16 | 谷歌有限责任公司 | Method, system and computer readable medium for secure and cross-device consistent video compression |
CN111601109A (en) * | 2020-05-13 | 2020-08-28 | 西安万像电子科技有限公司 | Image data processing method, device and system |
CN113115107B (en) * | 2021-04-15 | 2021-12-28 | 深圳鸿祥源科技有限公司 | Handheld video acquisition terminal system based on 5G network |
CN113115107A (en) * | 2021-04-15 | 2021-07-13 | 深圳鸿祥源科技有限公司 | Handheld video acquisition terminal system based on 5G network |
Also Published As
Publication number | Publication date |
---|---|
JP6714695B2 (en) | 2020-06-24 |
JP2019501554A (en) | 2019-01-17 |
US20170208328A1 (en) | 2017-07-20 |
AU2016388357B2 (en) | 2020-02-13 |
CA3001672C (en) | 2020-07-14 |
DE202016008214U1 (en) | 2017-04-28 |
GB2546887A (en) | 2017-08-02 |
AU2016388357A1 (en) | 2018-04-12 |
GB201621731D0 (en) | 2017-02-01 |
US10356406B2 (en) | 2019-07-16 |
DE102016125353A1 (en) | 2017-07-20 |
KR102118573B1 (en) | 2020-06-03 |
CN107040781B (en) | 2020-11-03 |
GB2546887B (en) | 2020-04-15 |
WO2017127213A1 (en) | 2017-07-27 |
KR20180054717A (en) | 2018-05-24 |
CA3001672A1 (en) | 2017-07-27 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
CN107040781A (en) | The Real-Time Video Encoder speed control switched using dynamic resolution | |
US20220353534A1 (en) | Transform Kernel Selection and Entropy Coding | |
CN111066326B (en) | Machine learning video processing system and method | |
CN107534669B (en) | Single stream transmission method for multi-user video conference | |
US10321138B2 (en) | Adaptive video processing of an interactive environment | |
CN107027032B (en) | Method and device for partitioning motion vector of last frame | |
CN110169068B (en) | DC coefficient sign coding scheme | |
KR20220146647A (en) | Dynamic parameter selection for quality-normalized video transcoding | |
US20220415039A1 (en) | Systems and Techniques for Retraining Models for Video Quality Assessment and for Transcoding Using the Retrained Models | |
US9210424B1 (en) | Adaptive prediction block size in video coding | |
US10820014B2 (en) | Compound motion-compensated prediction | |
WO2023082520A1 (en) | Image processing method and apparatus, storage medium, and electronic device |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
PB01 | Publication | ||
PB01 | Publication | ||
SE01 | Entry into force of request for substantive examination | ||
SE01 | Entry into force of request for substantive examination | ||
CB02 | Change of applicant information | ||
CB02 | Change of applicant information |
Address after: American CaliforniaApplicant after: Google limited liability companyAddress before: American CaliforniaApplicant before: Google Inc. |
|
GR01 | Patent grant | ||
GR01 | Patent grant |