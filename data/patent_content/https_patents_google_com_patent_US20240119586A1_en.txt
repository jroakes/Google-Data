US20240119586A1 - Synthetic Generation of Clinical Skin Images in Pathology - Google Patents
Synthetic Generation of Clinical Skin Images in Pathology Download PDFInfo
- Publication number
- US20240119586A1 US20240119586A1 US17/768,419 US202017768419A US2024119586A1 US 20240119586 A1 US20240119586 A1 US 20240119586A1 US 202017768419 A US202017768419 A US 202017768419A US 2024119586 A1 US2024119586 A1 US 2024119586A1
- Authority
- US
- United States
- Prior art keywords
- images
- skin
- gan
- synthetic
- pathology
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Pending
Links
- 230000007170 pathology Effects 0.000 title claims description 58
- 238000012549 training Methods 0.000 claims abstract description 74
- 238000000034 method Methods 0.000 claims abstract description 50
- 238000013434 data augmentation Methods 0.000 claims abstract description 5
- 230000003190 augmentative effect Effects 0.000 claims description 11
- 238000007781 pre-processing Methods 0.000 claims description 9
- 230000000694 effects Effects 0.000 claims description 8
- 238000013527 convolutional neural network Methods 0.000 claims description 6
- 230000003902 lesion Effects 0.000 claims description 5
- 201000001441 melanoma Diseases 0.000 claims description 4
- 206010004146 Basal cell carcinoma Diseases 0.000 claims description 2
- 208000016604 Lyme disease Diseases 0.000 claims description 2
- 238000011156 evaluation Methods 0.000 abstract description 7
- 230000003211 malignant effect Effects 0.000 abstract description 4
- 238000012360 testing method Methods 0.000 description 11
- 238000002474 experimental method Methods 0.000 description 6
- 238000013519 translation Methods 0.000 description 6
- 239000003086 colorant Substances 0.000 description 5
- 238000013256 Gubra-Amylin NASH model Methods 0.000 description 4
- 238000003909 pattern recognition Methods 0.000 description 4
- 238000004092 self-diagnosis Methods 0.000 description 4
- 206010027145 Melanocytic naevus Diseases 0.000 description 3
- 208000009077 Pigmented Nevus Diseases 0.000 description 3
- 230000004913 activation Effects 0.000 description 3
- 238000001994 activation Methods 0.000 description 3
- 230000006978 adaptation Effects 0.000 description 3
- 238000013135 deep learning Methods 0.000 description 3
- 238000002059 diagnostic imaging Methods 0.000 description 3
- 238000010801 machine learning Methods 0.000 description 3
- 238000010606 normalization Methods 0.000 description 3
- 101100153586 Caenorhabditis elegans top-1 gene Proteins 0.000 description 2
- 101100370075 Mus musculus Top1 gene Proteins 0.000 description 2
- 206010039796 Seborrhoeic keratosis Diseases 0.000 description 2
- 238000002679 ablation Methods 0.000 description 2
- 230000015572 biosynthetic process Effects 0.000 description 2
- 230000008859 change Effects 0.000 description 2
- 238000001514 detection method Methods 0.000 description 2
- 230000006870 function Effects 0.000 description 2
- 238000003384 imaging method Methods 0.000 description 2
- 230000001575 pathological effect Effects 0.000 description 2
- 238000012545 processing Methods 0.000 description 2
- 201000003385 seborrheic keratosis Diseases 0.000 description 2
- 208000017520 skin disease Diseases 0.000 description 2
- 238000001228 spectrum Methods 0.000 description 2
- 238000003786 synthesis reaction Methods 0.000 description 2
- 206010061728 Bone lesion Diseases 0.000 description 1
- 235000016936 Dendrocalamus strictus Nutrition 0.000 description 1
- YIEDSISPYKQADU-FMQUCBEESA-N Diacetylaminoazotoluene Chemical compound C1=C(C)C(N(C(C)=O)C(=O)C)=CC=C1\N=N\C1=CC=CC=C1C YIEDSISPYKQADU-FMQUCBEESA-N 0.000 description 1
- 206010028980 Neoplasm Diseases 0.000 description 1
- 230000003044 adaptive effect Effects 0.000 description 1
- 238000013459 approach Methods 0.000 description 1
- 201000011510 cancer Diseases 0.000 description 1
- 238000013145 classification model Methods 0.000 description 1
- 229940021231 clearskin Drugs 0.000 description 1
- 238000013136 deep learning model Methods 0.000 description 1
- 229950010345 diacetazotol Drugs 0.000 description 1
- 238000003745 diagnosis Methods 0.000 description 1
- 238000010586 diagram Methods 0.000 description 1
- 238000003748 differential diagnosis Methods 0.000 description 1
- 201000010099 disease Diseases 0.000 description 1
- 208000037265 diseases, disorders, signs and symptoms Diseases 0.000 description 1
- 238000009472 formulation Methods 0.000 description 1
- 238000003709 image segmentation Methods 0.000 description 1
- 230000010365 information processing Effects 0.000 description 1
- 210000004185 liver Anatomy 0.000 description 1
- 230000036210 malignancy Effects 0.000 description 1
- 238000013507 mapping Methods 0.000 description 1
- 201000006844 melanomatosis Diseases 0.000 description 1
- 230000000116 mitigating effect Effects 0.000 description 1
- 239000000203 mixture Substances 0.000 description 1
- 238000003058 natural language processing Methods 0.000 description 1
- 230000001537 neural effect Effects 0.000 description 1
- 210000000056 organ Anatomy 0.000 description 1
- 238000007427 paired t-test Methods 0.000 description 1
- 230000008569 process Effects 0.000 description 1
- 230000000135 prohibitive effect Effects 0.000 description 1
- 230000009467 reduction Effects 0.000 description 1
- 230000011218 segmentation Effects 0.000 description 1
- 201000000195 skin tag Diseases 0.000 description 1
- 206010041823 squamous cell carcinoma Diseases 0.000 description 1
- 239000013589 supplement Substances 0.000 description 1
- 230000000007 visual effect Effects 0.000 description 1
- 239000011800 void material Substances 0.000 description 1
- 230000037303 wrinkles Effects 0.000 description 1
Images
Classifications
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T7/00—Image analysis
- G06T7/0002—Inspection of images, e.g. flaw detection
- G06T7/0012—Biomedical image inspection
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T11/00—2D [Two Dimensional] image generation
- G06T11/001—Texturing; Colouring; Generation of texture or colour
-
- G—PHYSICS
- G16—INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR SPECIFIC APPLICATION FIELDS
- G16H—HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA
- G16H10/00—ICT specially adapted for the handling or processing of patient-related medical or healthcare data
- G16H10/60—ICT specially adapted for the handling or processing of patient-related medical or healthcare data for patient-specific data, e.g. for electronic patient records
-
- G—PHYSICS
- G16—INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR SPECIFIC APPLICATION FIELDS
- G16H—HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA
- G16H50/00—ICT specially adapted for medical diagnosis, medical simulation or medical data mining; ICT specially adapted for detecting, monitoring or modelling epidemics or pandemics
- G16H50/70—ICT specially adapted for medical diagnosis, medical simulation or medical data mining; ICT specially adapted for detecting, monitoring or modelling epidemics or pandemics for mining of medical data, e.g. analysing previous cases of other patients
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20081—Training; Learning
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20084—Artificial neural networks [ANN]
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20092—Interactive image processing based on input by user
- G06T2207/20104—Interactive definition of region of interest [ROI]
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/30—Subject of image; Context of image processing
- G06T2207/30004—Biomedical image processing
- G06T2207/30088—Skin; Dermal
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/30—Subject of image; Context of image processing
- G06T2207/30004—Biomedical image processing
- G06T2207/30096—Tumor; Lesion
Definitions
- This disclosure relates to a method and machine learning architecture for synthetic generation of clinical images of skin with various pathological conditions, such as melanoma, squamous cell carcinoma, skin tag, etc.
- the methodology allows for the ability to generate synthetic images and in the process modify the size of the pathology, the type of pathology and/or the underlying skin color.
- GANs Generative Adversarial Networks
- synthetically generated images can be used as training images which supplement real clinical images as input for training a skin condition classifier, e.g., deep convolutional neural network, for example to remove bias in the training set and/or provide more examples of rare conditions in a variety of different types of skin colors.
- the synthetic skin images can be provided or made available to clinicians or the public as examples of skin pathologies for various skin colors and facilitate education, or informal self-diagnosis.
- databases for image search engines may have large collections of images of a particular pathology (e.g., Lyme disease) in people having white skin, but lack images of the pathology in people with dark skin.
- the inventors provide a way to generate synthetic skin images to make such image databases much more representative, remove bias in the databases, and provide examples of rare conditions across the entire spectrum of human skin color.
- the disclosure is directed to a method of synthetic generation of clinical skin images with pathology.
- the method makes use of a heterogeneous dataset in the form of a multitude of ground truth annotated clinical skin images presenting a variety of pathologies and obtained from a multitude of patients with varying degrees of skin color.
- An example is given of a dataset in the form of 49,920 images generated by a teledermatology service.
- the images were annotated with ground truth by board certified dermatologists to differentiate among 26 common skin conditions and an additional ‘other’ category.
- the dataset of skin images was generated by consumer grade cameras, e.g., cameras embodied in smart phones, tablets or off-the shelf consumer cameras, in contrast to datasets of images generated by special purpose equipment (dermascope images).
- the images in the dataset include extraneous features including hair, clothing, etc. and the background is unique to each individual and non-uniform across the dataset.
- a preprocessing step is performed on the dataset: creating one or more region of interest (ROI) bounding boxes for each image such that the pathology present in the clinical skin images is prominent within such bounding boxes, thereby creating a more uniform version of the data set.
- ROI bounding boxes are referred to as “cropped images” in this document. This more uniform version is referred to as the “training set” below.
- the methodology then includes a step of training a generative adversarial network (GAN) with the input pairs ⁇ x i ; m i ⁇ , the GAN including a generator producing a synthetic image and a discriminator trained to discriminate between real images and synthetic images.
- GAN generative adversarial network
- the generator and discriminator are trained to minimize a plurality of loss components so as to improve the realism of the synthetic images produced by the generator, as discussed in detail below.
- the methodology then includes a final step of supplying a semantic map (e.g., defining a particular pathology, and skin color) to the trained GAN and responsively generating the synthetic image.
- a semantic map e.g., defining a particular pathology, and skin color
- This synthetic image shows the particular pathology and skin color as specified in the semantic map.
- the method can be performed iteratively by generating a series of synthetic images wherein during the repeated iterations the component of the semantic map encoding skin color is varied. For example, in this manner a given pathology can be reproduced but the skin color in the image is progressively darkened so as to span the full spectrum of human skin color variation.
- the synthetic images created in accordance with this method can be used to augment a training set used for developing a skin condition classifier, and improve the performance of the classifier, e.g., its ability to correctly classify rare skin conditions or skin conditions that are poorly represented in a training set.
- a method for training a skin condition classifier includes steps of obtaining a heterogeneous dataset, in the form of a multitude of ground truth annotated clinical skin images presenting a variety of pathologies and obtained from a multitude of patients with varying degrees of skin color, to improve the signal to noise ratio.
- the clinical skin images are generated with consumer grade cameras.
- This heterogeneous dataset is a training set for training a machine learning classifier, and in this method the previously described step of preprocessing the heterogeneous dataset is optional and not required.
- the method includes the step of adding to the training set a multitude of synthetic images generated from a trained generative adversarial network (GAN) to as to increase the number of images in the training set reflective of rare skin conditions and/or remove bias present in the dataset, thereby producing an augmented training set.
- GAN trained generative adversarial network
- the method then includes a step of training a deep convolutional neural network to classify skin conditions from the augmented training set.
- the synthetic images are augmenting an image database with the synthetic image, so as to make the images available for search and retrieval.
- the image database could be made available for training clinicians, e.g., nurse practitioners or general practitioners, in advanced training of dermatologist, or education and informal self-diagnosis by the general population.
- FIG. 1 is a flow chart showing a method of training a GAN and generating a synthetic skin image.
- FIG. 2 illustrates one example of several original, uncropped images from a clinical dataset on the left, with varying size, scale and quality, and the result of pre-processing step on the right in which the images are cropped to smaller ROIs so as to increase the signal to noise ratio.
- FIG. 3 illustrates another example of an original, uncropped clinical image taken with a consumer grade camera on the left and cropped images on the right with clear skin condition in focus.
- FIG. 4 is an illustration of a GAN model architecture which generates synthetic skin images.
- the architecture includes a Generator and a Discriminator.
- a semantic map encoding the skin condition, size, region of presence and the skin color is passed through the Generator to produce a synthetic image.
- the Generator is a modified U-Net (see O. Ronneberger, et al., U - net: Convolutional networks for biomedical image segmentation . International Conference on Medical image computing and computer-assisted intervention, pages 234-241. Springer, (2015), the content of which is incorporated by reference herein), where the deconvolution layers are replaced with a resizing layer followed by a convolution to mitigate the checkerboard effect.
- the Discriminator has a fully-convolutional architecture. The two architectures are trained to minimize four loss components: reconstruction loss for the whole image, reconstruction loss for the region of the condition, feature matching loss for the second to last activation layer of the Discriminator, and the min-max GAN loss.
- FIG. 5 shows comparisons between real images and synthetic images generated from the architecture of FIG. 4 for eight different skin conditions; for each condition the real image is shown in the left-hand column and the synthetic image is shown in the right hand column.
- FIG. 6 shows examples of synthetic images of six different skin conditions with the underlying skin color varied in six different degrees for each condition.
- FIG. 7 shows examples of synthetic images of six different skin conditions with the size of the pathology in each condition varied in six different sizes.
- FIG. 8 is a flow chart showing a method of training a classifier using a training set of images augmented with synthetic images in order to reduce bias and improve the ability of the classifier to classify rare conditions.
- FIG. 9 is a block diagram of a system configured for generating synthetic skin images.
- FIGS. 10 A and 10 B are plots showing the results of a Human Turing test on real images and synthetic images generated from the GAN model of this disclosure; results for discriminating between real and synthetic images are shown in FIG. 10 A , whereas results for whether images correctly describe the respective skin condition are shown in FIG. 10 B . Error bars represent standard deviation.
- FIG. 1 is an overview of our method of generating synthetic skin images with pathology.
- the method makes use of a heterogeneous dataset 100 in the form of a multitude of ground truth annotated clinical skin images 102 A, 104 A, 106 A, etc. presenting a variety of pathologies and obtained from a multitude of patients with varying degrees of skin color. Each image is associated with an annotation 102 B, 104 B, 106 B etc., which identifies the associated pathology or condition in the image.
- An example of the dataset 100 is given in detail below.
- the images 102 A, 104 A etc. were annotated with ground truth by board certified dermatologists to differentiate among 26 common skin conditions and an additional ‘other’ category.
- a preprocessing step 110 is performed on the dataset: creating one or more region of interest (ROI) bounding boxes for each image such that the pathology present in the clinical skin images is prominent within such bounding boxes, thereby creating a more uniform version of the data set.
- ROI region of interest
- This more uniform version is referred to as the “training set” below, and shown in FIG. 1 as 120 .
- the images 122 A, 122 A etc. in FIG. 1 are the cropped regions of the original image with the pathology and the annotations 102 B, 104 B etc., are carried forward and present and associated with each cropped image as shown at 122 B, 124 B etc.
- N is the number of cropped images in the training set.
- training set includes a very large number of cropped image/annotation pairs, typically many thousands of such pairs.
- the methodology then includes a step 140 of training a generative adversarial network (GAN) (see FIG. 4 and the following discussion) with the input pairs ⁇ x i : m i ⁇ , the GAN including a generator 202 ( FIG. 4 ) producing a synthetic image and a discriminator 204 ( FIG. 4 ) trained to discriminate between real images and synthetic images.
- GAN generative adversarial network
- the generator and discriminator are trained to minimize a plurality of loss components so as to improve the realism of the synthetic images produced by the generator, discussed in detail below.
- the methodology then includes a final step 150 of supplying a semantic map (e.g., defining a particular pathology, and skin color, and size) to the trained GAN and responsively generating the synthetic image 160 as specified in the semantic map.
- This synthetic image shows the particular pathology and skin color, per the semantic map.
- This last step can be repeated in many iterations while changing one or more of the parameters of the semantic map and holding the others constant, e.g., to generate a series of synthetic images of a given pathology with different shades of underlying skin color.
- FIGS. 2 and 3 show the heterogeneous nature of this dataset.
- the region occupied by the skin condition varies significantly and the backgrounds are non-uniform and unique to each individual image (walls, hospitals, clothing, etc.).
- the signal to noise ratio is very low in most of the images.
- m i ⁇ R W ⁇ H is its corresponding semantic map ( 210 , FIG. 4 ) that encodes the skin color, the skin condition present in the image 212 , its size and the location of the condition in the image.
- m is not unique.
- the variations can be modeled by a conditional probability distribution P (x
- the semantic map 210 is an RGB image.
- the R-channel encodes the skin color and the condition is encoded in the G & B channels by a non-zero value corresponding to its ROI bounding box(es).
- An example is shown in FIG. 4 at 210 .
- the problem of synthetic image generation reduces to mapping any arbitrary semantic map to a corresponding skin condition image.
- the original Pix2Pix generator implementation makes use of transposed convolution layers. Using deconvolution layers for image generation can results in “checkerboard” effect. The problem was resolved by replacing each deconvolution layer with a nearest-neighbor resizing layer followed by a convolution layer. These layers are shown in the Generator at 214 and 216 .
- the original Pix2Pix loss function uses the L1 distance between the original 212 and synthetic image 160 as a loss function component.
- a generator model's reconstruction performance is more important in the condition ROI compared to its surrounding skin. Therefore, we add a condition-specific reconstruction term which is simply the L1 distance between the condition ROIs in the synthetic and real images 160 and 212 .
- Feature matching loss enforces the generated images to follow the statistics of the real data through matching the features of generated and real images in a chosen layer(s) of the discriminator. It is computed as the L2 distance between the activations of synthetic images in a chosen discriminator layer (or layers) and that of the real images. Apart from improving the quality of generated images, feature matching loss results in a more stable training trajectory. We used the output of the discriminator's second last convolutional layer to compute the feature matching loss.
- the resulting model has four loss terms: reconstruction loss, condition-specific reconstruction loss, min-max GAN loss, and feature-matching loss.
- Grid-search hyperparameter selection was performed to choose the weighting coefficients for each loss component. During model training, these loss terms are all minimized in order to improve the realism of the generated images 162 .
- training set 110 of FIG. 1 we trained a DermGAN model ( FIG. 4 , as explained above) to generate synthetic skin images with a chosen skin color, skin condition, as well as the size and region of the condition.
- a DermGAN model FIG. 4 , as explained above
- FIG. 5 Examples of our generated images are shown in FIG. 5 .
- the left hand column shows samples of real images and the right hand column shows samples of generated synthetic images.
- FIG. 6 depicts examples of this experiment, in which the encoded skin color of a semantic map is replaced with each of the six types.
- the DermGAN model is able to change the background skin color while adjusting the condition itself to reflect this change. For instance, for Melanocytic Nevus, the generated image for the darker tone has also a darker mole, which mimics real data.
- FIG. 7 shows examples of this experiment, in which the size of the bounding box of a semantic map is gradually increased.
- the visual appearance also changes, which is consistent with real world occurrences.
- a perfect objective evaluation of GAN-generated images remains a challenge.
- One widely-used measure is the inception score that works as a surrogate measure of the diversity and the amount of distinct information in the synthetic images. It is computed as the average KL-divergence between the class probabilities assigned to a synthetic sample by an Inception-V3 model trained on the ImageNet dataset and the average class probabilities of all synthetic samples.
- the main drawback that makes the use of inception score inadmissible in our case is that it assumes the classes in the data set at hand to be a subset of the 1000 ImageNet classes.
- Another widely-used measure is the Frechet Inception Distance (FID).
- FID directly measures the difference between the distribution of generated and real images in the activation space of the “Pool 3” layer of the Inception-V3 model.
- the first test was a Turing test with 10 participants. Each participant was asked to choose the skin images they found realistic in a collection of 80 real and 80 randomly selected synthetic images. On average the true positive rate (TPR) (the ratio of real images correctly selected) is 0.52 and the false positive rate (FPR) (the ratio of synthetic images detected as real) is 0.30. Results for each condition are demonstrated in FIG. 10 ( a ) , with average TPR ranging from 0.51 to 0.69 and average FPR from 0.37 to 0.50. As expected, the TPR is higher than FPR for all conditions. However, the high FPR rate among all conditions indicates the high fidelity of synthetic images.
- TPR true positive rate
- FPR false positive rate
- the second experiment was designed to measure the medical relevance of the synthetic images.
- two board certified dermatologists answered a set of 16 questions. In each question, the participants were asked to choose the images relevant to a given skin condition among a combined set of real and randomly selected synthetic images.
- the average recall (ratio of related images correctly chosen) is 0.61 and 0.45 for the real and synthetic images respectively. Results for each condition are shown in FIG. 10 ( b ) , with recall ranging from 0.3 to 1.00 for real images and from 0.00 to 0.67 for synthetic images.
- a method 800 for training a skin condition classifier includes a step 802 of obtaining a heterogeneous dataset, in the form of a multitude ground truth annotated clinical skin images (see FIG. 1 , 100 ) presenting a variety of pathologies and obtained from a multitude of patients with varying degrees of skin color.
- the clinical skin images are generated with consumer grade cameras.
- the heterogeneous dataset is a training set for training a classifier, and the preprocessing step on the heterogeneous dataset described previously is not required.
- the method includes a step 806 of adding to the training set a multitude of synthetic images generated from a trained generative adversarial network (GAN) to as to increase the number of images in the training set reflective of rare skin conditions and/or remove bias present in the dataset, thereby producing an augmented training set.
- GAN trained generative adversarial network
- the method continues with a step 808 of training a classifier, such as a deep convolutional neural network, to classify skin conditions from the augmented training set.
- the synthetic images are augmenting an searchable image database with the synthetic image(s), so as to make the images available for search and retrieval.
- the image database could be made available for training clinicians, e.g., nurse practitioners or general practitioners, in advanced training of dermatologist, or education and informal self-diagnosis by the general population.
- a processing unit 902 e.g., general purpose computer
- the GAN including a generator ( FIG. 4 , 202 ) producing a synthetic image and a discriminator ( FIG.
- the processing unit is configured to generate a synthetic clinical skin image with pathology from an input comprising a semantic map 906 .
- the semantic map is defined so as to specify a pathology type, pathology size, or skin color.
- the loss components minimized in training of the GAN include reconstruction loss, lesion-specific reconstruction loss, min-max GAN loss, and feature matching loss.
- the generator is configured with a nearest-neighbor resizing layer followed by a convolution layer to thereby reduce a checkerboard effect in generated images.
Abstract
Description
- This disclosure relates to a method and machine learning architecture for synthetic generation of clinical images of skin with various pathological conditions, such as melanoma, squamous cell carcinoma, skin tag, etc. The methodology allows for the ability to generate synthetic images and in the process modify the size of the pathology, the type of pathology and/or the underlying skin color.
- The combination of large scale data and advances in computing has catalyzed the success of supervised deep learning in many domains including computer vision, natural language processing and speech recognition. Over the last few years, several efforts have been made to apply supervised deep learning to various medical imaging tasks, such as disease classification, detection of suspicious malignancy and organ segmentation on different imaging modalities including ophthalmology, pathology, radiology, cardiology, and dermatology.
- Despite this progress, developing effective deep learning models for these tasks remains non-trivial mainly due to the data hungry nature of such algorithms. Most previous efforts that report expert-level performance required large amounts of expert annotated data (multiple thousands and sometimes even millions of training examples). However, the cost of obtaining expert-level annotations in medical imaging is often prohibitive. Moreover, it is nearly impossible to collect diverse datasets that are unbiased and balanced. Most of the data used in medical imaging and other healthcare applications come from medical sites which may disproportionately serve certain specific patient demographics and be underrepresented in other patient demographics. Such datasets also tend to have very few examples of rare conditions because they naturally occur sparingly in the real world. Models trained on such biased and unbalanced datasets tend to perform poorly on test cases drawn from under-represented populations or on rare conditions.
- There has been remarkable progress in generative machine learning models in recent years. Generative Adversarial Networks (GANs) in particular, have emerged as the de facto standard for generating diverse and high quality sample images. These networks are described in detail in the following publication: I. Goodfellow, et al., Generative adversarial nets, Advances in Neural Information Processing Systems, vol. 263 pp. 2672-2680 (2014). The entire content of the Goodfellow et al. article is incorporated by reference herein. Such networks have been effectively used in many applications, including super-resolution, text-to-image generation, and in the medical domain, generating medical records, liver lesion images, bone lesion images and anomaly detection.
- In dermatology, prior efforts on applying generative models to synthesize images have focused on datasets of dermoscopic images. Dermoscopic images are acquired using specialized equipment (dermatoscopes) in order to have a clean, centered, and zoomed-in image of the skin condition under normalized lighting. However, access to dermatoscopes is limited: they are often only available in dermatology clinics and are used to examine certain lesion conditions. On the other hand, clinical images are taken by consumer grade cameras (point-and-shoot cameras or smartphones), and are thus much more accessible to general users. Such images can be used either in a tele-dermatology setting, where patients or general practitioners can send such photographs to dermatologists for diagnosis, or to directly leverage Al based tools for informal patient self-diagnosis. However, acquisition of such images is not part of the standard clinical workflow, leading to a data void to develop well-performing skin disease classification models. Last but not least, unlike dermoscopic images, clinical images of skin conditions have diverse appearances in terms of scale, perspective, zoom effects, lighting, blur and other imaging artifacts. In addition, the presence of hair, various skin colors, and body parts, age-induced artifacts (e.g., wrinkles), and background also contribute to the diversity of clinical data. Such diversity makes it challenging for generative models to learn the underlying image representation.
- To the best of our knowledge, no prior work has attempted to synthesize clinical images (i.e., images obtained with consumer grade cameras) with skin pathology.
- In this document, we provide a system and method for generating synthetic images of skin with pathology taken by consumer grade cameras. We formulate the problem as an image to image translation framework and use an adapted version of the existing GAN-based image translation architectures. Specifically, our model learns to translate a semantic map with a pre-specified skin condition, its size and location, and the underlying skin color, to a realistic image that preserves the pre-specified traits. In this way, images of rare skin conditions in minority demographics can be generated to diversify existing datasets for the downstream skin condition classification task. We demonstrate via both GAN evaluation metrics and qualitative tests that the generated synthetic images are of high fidelity and represent the respective skin condition. When we use the synthetic images as additional data to train a skin condition classifier, we observe that the model improves on rare malignant classes while being comparable to the baseline model overall.
- Thus, in one aspect, synthetically generated images can be used as training images which supplement real clinical images as input for training a skin condition classifier, e.g., deep convolutional neural network, for example to remove bias in the training set and/or provide more examples of rare conditions in a variety of different types of skin colors. Additionally, the synthetic skin images can be provided or made available to clinicians or the public as examples of skin pathologies for various skin colors and facilitate education, or informal self-diagnosis. For example, databases for image search engines may have large collections of images of a particular pathology (e.g., Lyme disease) in people having white skin, but lack images of the pathology in people with dark skin. The inventors provide a way to generate synthetic skin images to make such image databases much more representative, remove bias in the databases, and provide examples of rare conditions across the entire spectrum of human skin color.
- In one aspect, the disclosure is directed to a method of synthetic generation of clinical skin images with pathology. The method makes use of a heterogeneous dataset in the form of a multitude of ground truth annotated clinical skin images presenting a variety of pathologies and obtained from a multitude of patients with varying degrees of skin color. An example is given of a dataset in the form of 49,920 images generated by a teledermatology service. The images were annotated with ground truth by board certified dermatologists to differentiate among 26 common skin conditions and an additional ‘other’ category. The dataset of skin images was generated by consumer grade cameras, e.g., cameras embodied in smart phones, tablets or off-the shelf consumer cameras, in contrast to datasets of images generated by special purpose equipment (dermascope images).
- The images in the dataset include extraneous features including hair, clothing, etc. and the background is unique to each individual and non-uniform across the dataset. To improve the signal to noise ratio, a preprocessing step is performed on the dataset: creating one or more region of interest (ROI) bounding boxes for each image such that the pathology present in the clinical skin images is prominent within such bounding boxes, thereby creating a more uniform version of the data set. These images within ROI bounding boxes are referred to as “cropped images” in this document. This more uniform version is referred to as the “training set” below.
- The methodology further includes a step of, for each image in the training set created as described above, generating a corresponding semantic map m that encodes the skin color, pathology, size and location of the pathology within the image (ROI), thereby generating input pairs {xi; mi} where xi is an image in the training set, and i=1 . . . N, where N is the number of cropped images in the training set;
- The methodology then includes a step of training a generative adversarial network (GAN) with the input pairs {xi; mi}, the GAN including a generator producing a synthetic image and a discriminator trained to discriminate between real images and synthetic images. The generator and discriminator are trained to minimize a plurality of loss components so as to improve the realism of the synthetic images produced by the generator, as discussed in detail below.
- The methodology then includes a final step of supplying a semantic map (e.g., defining a particular pathology, and skin color) to the trained GAN and responsively generating the synthetic image. This synthetic image shows the particular pathology and skin color as specified in the semantic map.
- In one possible example, the method can be performed iteratively by generating a series of synthetic images wherein during the repeated iterations the component of the semantic map encoding skin color is varied. For example, in this manner a given pathology can be reproduced but the skin color in the image is progressively darkened so as to span the full spectrum of human skin color variation. As another example, one can do repeated iterations of generating synthetic images and the component of the semantic map encoding pathology is varied while maintaining the component of the semantic map encoding skin color constant. This will produce a variety of skin pathologies (including rare or unrepresented pathologies in the dataset) in a given skin color. One could of course vary both the skin color, size, and/or pathology semantic components in an iterative generation of synthetic images with varying skin color, pathology size and pathology type.
- As noted above, the synthetic images created in accordance with this method can be used to augment a training set used for developing a skin condition classifier, and improve the performance of the classifier, e.g., its ability to correctly classify rare skin conditions or skin conditions that are poorly represented in a training set.
- In this aspect, a method for training a skin condition classifier includes steps of obtaining a heterogeneous dataset, in the form of a multitude of ground truth annotated clinical skin images presenting a variety of pathologies and obtained from a multitude of patients with varying degrees of skin color, to improve the signal to noise ratio. In one example the clinical skin images are generated with consumer grade cameras. This heterogeneous dataset is a training set for training a machine learning classifier, and in this method the previously described step of preprocessing the heterogeneous dataset is optional and not required.
- The method includes the step of adding to the training set a multitude of synthetic images generated from a trained generative adversarial network (GAN) to as to increase the number of images in the training set reflective of rare skin conditions and/or remove bias present in the dataset, thereby producing an augmented training set.
- The method then includes a step of training a deep convolutional neural network to classify skin conditions from the augmented training set.
- As noted above, one possible clinical use of the synthetic images is augmenting an image database with the synthetic image, so as to make the images available for search and retrieval. The image database could be made available for training clinicians, e.g., nurse practitioners or general practitioners, in advanced training of dermatologist, or education and informal self-diagnosis by the general population.
-
FIG. 1 is a flow chart showing a method of training a GAN and generating a synthetic skin image. -
FIG. 2 illustrates one example of several original, uncropped images from a clinical dataset on the left, with varying size, scale and quality, and the result of pre-processing step on the right in which the images are cropped to smaller ROIs so as to increase the signal to noise ratio. -
FIG. 3 illustrates another example of an original, uncropped clinical image taken with a consumer grade camera on the left and cropped images on the right with clear skin condition in focus. -
FIG. 4 is an illustration of a GAN model architecture which generates synthetic skin images. The architecture includes a Generator and a Discriminator. A semantic map encoding the skin condition, size, region of presence and the skin color is passed through the Generator to produce a synthetic image. The Generator is a modified U-Net (see O. Ronneberger, et al., U-net: Convolutional networks for biomedical image segmentation. International Conference on Medical image computing and computer-assisted intervention, pages 234-241. Springer, (2015), the content of which is incorporated by reference herein), where the deconvolution layers are replaced with a resizing layer followed by a convolution to mitigate the checkerboard effect. The Discriminator has a fully-convolutional architecture. The two architectures are trained to minimize four loss components: reconstruction loss for the whole image, reconstruction loss for the region of the condition, feature matching loss for the second to last activation layer of the Discriminator, and the min-max GAN loss. -
FIG. 5 shows comparisons between real images and synthetic images generated from the architecture ofFIG. 4 for eight different skin conditions; for each condition the real image is shown in the left-hand column and the synthetic image is shown in the right hand column. -
FIG. 6 shows examples of synthetic images of six different skin conditions with the underlying skin color varied in six different degrees for each condition. -
FIG. 7 shows examples of synthetic images of six different skin conditions with the size of the pathology in each condition varied in six different sizes. -
FIG. 8 is a flow chart showing a method of training a classifier using a training set of images augmented with synthetic images in order to reduce bias and improve the ability of the classifier to classify rare conditions. -
FIG. 9 is a block diagram of a system configured for generating synthetic skin images. -
FIGS. 10A and 10B are plots showing the results of a Human Turing test on real images and synthetic images generated from the GAN model of this disclosure; results for discriminating between real and synthetic images are shown inFIG. 10A , whereas results for whether images correctly describe the respective skin condition are shown inFIG. 10B . Error bars represent standard deviation. -
FIG. 1 is an overview of our method of generating synthetic skin images with pathology. The method makes use of aheterogeneous dataset 100 in the form of a multitude of ground truth annotatedclinical skin images annotation dataset 100 is given in detail below. Theimages images preprocessing step 110 is performed on the dataset: creating one or more region of interest (ROI) bounding boxes for each image such that the pathology present in the clinical skin images is prominent within such bounding boxes, thereby creating a more uniform version of the data set. This more uniform version is referred to as the “training set” below, and shown inFIG. 1 as 120. Theimages FIG. 1 are the cropped regions of the original image with the pathology and theannotations - The methodology further includes a step of, for each (cropped) image in the training set created as described above, generating a corresponding semantic map in that encodes the skin color, pathology, size and location of the pathology within the image (ROI), thereby generating input pairs {xi; mi} where xi is an image in the training set 120, and i=1 . . . N, wherein N is the number of cropped images in the training set. It will be noted that there may be more than one cropped image for each
image dataset 100; the main thing is that training set includes a very large number of cropped image/annotation pairs, typically many thousands of such pairs. - The methodology then includes a
step 140 of training a generative adversarial network (GAN) (seeFIG. 4 and the following discussion) with the input pairs {xi: mi}, the GAN including a generator 202 (FIG. 4 ) producing a synthetic image and a discriminator 204 (FIG. 4 ) trained to discriminate between real images and synthetic images. The generator and discriminator are trained to minimize a plurality of loss components so as to improve the realism of the synthetic images produced by the generator, discussed in detail below. - The methodology then includes a
final step 150 of supplying a semantic map (e.g., defining a particular pathology, and skin color, and size) to the trained GAN and responsively generating thesynthetic image 160 as specified in the semantic map. This synthetic image shows the particular pathology and skin color, per the semantic map. This last step can be repeated in many iterations while changing one or more of the parameters of the semantic map and holding the others constant, e.g., to generate a series of synthetic images of a given pathology with different shades of underlying skin color. - With the above discussion in mind, the following discussion will explain the dataset 100 (
FIG. 1 ), preprocessing step, and GAN model (FIG. 4 ) training and use in more detail. -
Dataset 100 andPreprocessing Step 110 - For the work described in this document, we used a dataset provided by a tele-dermatology service, collected in 17 clinical sites in two U.S. states from 2010 to 2018. This dataset consisted of 9,897 cases and 49,920 images; each case contains one or more high resolution (resolution range: 600×800 to 960×1280) images obtained from consumer grade cameras. Ground truth of the skin condition was established for each case by an aggregated opinion of several board-certified dermatologists to differentiate among 26 common skin conditions and an additional ‘other’ category. It is important to note that even though the 26 skin conditions are known to be highly prevalent, the dataset itself was unbalanced, especially for certain malignant conditions like Melanoma, which had less than 200 examples. More details on the original dataset can be found in Y. Liu, et al., A deep learning system for differential diagnosis of skin diseases, arXiv preprint arXiv:1909.05382 (2019).
- In addition to the skin condition, we make use of two additional pieces of information: 1) for each condition, its presence in the image is marked by a Region of Interest (ROI) bounding box (
FIGS. 1(b) ) and 2) the skin color given for each case based on the Fitzpatrick skin color scale that ranges from Type I (“pale white, always burns, never tans”) to Type VI (“darkest brown, never burns”). Both the ROI and the skin color annotations are determined by the aggregated opinions of several dermatologist-trained annotators. - The left hand side of
FIGS. 2 and 3 shows the heterogeneous nature of this dataset. As stated previously, the region occupied by the skin condition varies significantly and the backgrounds are non-uniform and unique to each individual image (walls, hospitals, clothing, etc.). As a result, the signal to noise ratio is very low in most of the images. To alleviate this problem, using the annotated ROI bounding boxes, in the preprocessing step 102 we create a more uniform version of the dataset where the skin conditions is prominent in each mage. We devise a simple heuristic that crops a random window around an ROI or a group of adjacent ROIs while removing the presence of background information. This results in 40,000 images of size 256×256 for training the generative models and 24,000 images for evaluation. Examples of the cropped, ROI images forming the training set for the GAN model are shown in the right hand side ofFIGS. 2 and 3 . - Problem Formulation and Generation of Semantic Maps m
- Given a set of input-output pairs {(xi, mi}N i=1, for each real image (212,
FIG. 4 ) xi∈RW×H×C, mi∈RW×H is its corresponding semantic map (210,FIG. 4 ) that encodes the skin color, the skin condition present in theimage 212, its size and the location of the condition in the image. For a fully defined semantic map m, due to the possible variations (amount of hair on the skin, shooting angles, lighting conditions, morphology of the condition, etc.), the corresponding image x is not unique. The variations can be modeled by a conditional probability distribution P (x|m). Our goal is to be able to sample from P (x|m) for arbitrary and valid m. This image to image translation problem can be addressed using the conditional GAN framework (see M. Mirza et al., Conditional generative adversarial nets. arXiv preprint arXiv:1411.1784 (2014)) which has been successfully used in similar settings. See e.g., P. Isola, J.-Y. Zhu et al. Image-to-image translation with conditional adversarial networks. Proceedings of the IEEE conference on computer vision and pattern recognition, pages 1125-1134 (2017); T.-C. Wang, et al., High-resolution image synthesis and semantic manipulation with conditional Bans, Proceedings of the IEEE conference on computer vision and pattern recognition, pages 8798-8807 (2018). - For each image in our dataset, the
semantic map 210 is an RGB image. The R-channel encodes the skin color and the condition is encoded in the G & B channels by a non-zero value corresponding to its ROI bounding box(es). An example is shown inFIG. 4 at 210. Given the pairs of preprocessed skin images and their semantic maps, the problem of synthetic image generation reduces to mapping any arbitrary semantic map to a corresponding skin condition image. - DermaGAN Model Architecture (
FIG. 4 ) - The Pix2Pix model (see the Isola et al. article cited previously) gives a two-fold solution to this problem: An encoder-decoder architecture such as U-Net (see the Ronneberger et al. article cited previously) is trained with an L1 reconstruction loss to reproduce a given real image from its semantic map. This is the
Generator 202 ofFIG. 4 , which is trained to produce a generatedsynthetic image 160. The main drawback, however, is that such a model producesblurry images 160 that lack the details of a realistic image. Therefore, a second model (Discriminator 204 ofFIG. 4 ), in the form of a fully convolutional neural network withlayers 220 is added to discriminate real images (212) from synthetic ones (160) by looking at them on a patch level. The addition of this min-max GAN loss results in generation of realistic images with fine-grained details. Subsequent work by others improved the Pix2Pix method by applying various adaptations to the original algorithm: using several discriminator networks with various patch-sizes, progressively growing the size of generated images, using conditional normalization layers instead of instance normalization layers, and so forth. See e.g., T. Park, et al., Semantic image synthesis with spatially adaptive normalization, Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, pages 2337-2346 (2019); Y. Choi et al., Stargan: Unified generative adversarial networks for multi-domain image-to-image translation. Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, pages 8789-8797 (2018). Similarly, in our work, based on the specifics of our data modality we apply three main adaptations to the original Pix2Pix algorithm: - 1. Checkerboard Effect Reduction
- The original Pix2Pix generator implementation makes use of transposed convolution layers. Using deconvolution layers for image generation can results in “checkerboard” effect. The problem was resolved by replacing each deconvolution layer with a nearest-neighbor resizing layer followed by a convolution layer. These layers are shown in the Generator at 214 and 216.
- 2. Condition-Specific Loss
- The original Pix2Pix loss function uses the L1 distance between the original 212 and
synthetic image 160 as a loss function component. For skin condition images, a generator model's reconstruction performance is more important in the condition ROI compared to its surrounding skin. Therefore, we add a condition-specific reconstruction term which is simply the L1 distance between the condition ROIs in the synthetic andreal images - 3. Feature Matching Loss
- Feature matching loss enforces the generated images to follow the statistics of the real data through matching the features of generated and real images in a chosen layer(s) of the discriminator. It is computed as the L2 distance between the activations of synthetic images in a chosen discriminator layer (or layers) and that of the real images. Apart from improving the quality of generated images, feature matching loss results in a more stable training trajectory. We used the output of the discriminator's second last convolutional layer to compute the feature matching loss.
- All in all, the resulting model has four loss terms: reconstruction loss, condition-specific reconstruction loss, min-max GAN loss, and feature-matching loss. Grid-search hyperparameter selection was performed to choose the weighting coefficients for each loss component. During model training, these loss terms are all minimized in order to improve the realism of the generated images 162.
- Using the pre-processed dataset (“training set” 110 of
FIG. 1 ), we trained a DermGAN model (FIG. 4 , as explained above) to generate synthetic skin images with a chosen skin color, skin condition, as well as the size and region of the condition. In order to focus more on the critical and rare conditions, of the 26 classes in the original data, we choose 8 conditions that have fewer samples compared to other classes (17% of the dataset combined). Examples of our generated images are shown inFIG. 5 . For each condition, the left hand column shows samples of real images and the right hand column shows samples of generated synthetic images. - Synthetic Images with Different Skin Colors
- In this and the subsequent experiment below, we trained a DermGAN model on all of the 26 conditions of the dataset to represent synthetic images reflective of wider demographics than were present in the original dataset. For a given semantic map in the test set, we vary the encoded background color parameter in the semantic map and observe the respective changes in the generated image.
FIG. 6 depicts examples of this experiment, in which the encoded skin color of a semantic map is replaced with each of the six types. As illustrated in the figure, the DermGAN model is able to change the background skin color while adjusting the condition itself to reflect this change. For instance, for Melanocytic Nevus, the generated image for the darker tone has also a darker mole, which mimics real data. - Synthetic Images with Different Sizes of Skin Colors
- For a given semantic map, we can vary the sizes of the pathological region for each skin condition and observe the respective changes in the generated image.
FIG. 7 shows examples of this experiment, in which the size of the bounding box of a semantic map is gradually increased. We observe that as the size of the skin condition changes, the visual appearance also changes, which is consistent with real world occurrences. - GAN Evaluation Metrics
- A perfect objective evaluation of GAN-generated images remains a challenge. One widely-used measure is the inception score that works as a surrogate measure of the diversity and the amount of distinct information in the synthetic images. It is computed as the average KL-divergence between the class probabilities assigned to a synthetic sample by an Inception-V3 model trained on the ImageNet dataset and the average class probabilities of all synthetic samples. The main drawback that makes the use of inception score inadmissible in our case is that it assumes the classes in the data set at hand to be a subset of the 1000 ImageNet classes. Another widely-used measure is the Frechet Inception Distance (FID). FID directly measures the difference between the distribution of generated and real images in the activation space of the “Pool 3” layer of the Inception-V3 model. We perform an ablation study of the DermGAN model. Results on our test set (24,000 images) are reflected in Table 1 (confidence intervals are for 50 trials).
-
TABLE 1 Ablation study of GAN evaluation FID score No condition- No checker- specific No feature board effect reconstruction matching Real Data Derm GAN mitigation loss loss FID 83.6 ± 2.5 122.4 ± 3.4 151.6 ± 3.4 174.0 ± 4.7 140.7 ± 2.5 (±1.96 STD) - Human Turing Test
- For a subjective measure of how realistic the generated images are, we conducted two qualitative experiments. The first test was a Turing test with 10 participants. Each participant was asked to choose the skin images they found realistic in a collection of 80 real and 80 randomly selected synthetic images. On average the true positive rate (TPR) (the ratio of real images correctly selected) is 0.52 and the false positive rate (FPR) (the ratio of synthetic images detected as real) is 0.30. Results for each condition are demonstrated in
FIG. 10(a) , with average TPR ranging from 0.51 to 0.69 and average FPR from 0.37 to 0.50. As expected, the TPR is higher than FPR for all conditions. However, the high FPR rate among all conditions indicates the high fidelity of synthetic images. - The second experiment was designed to measure the medical relevance of the synthetic images. In this experiment, two board certified dermatologists answered a set of 16 questions. In each question, the participants were asked to choose the images relevant to a given skin condition among a combined set of real and randomly selected synthetic images. The average recall (ratio of related images correctly chosen) is 0.61 and 0.45 for the real and synthetic images respectively. Results for each condition are shown in
FIG. 10(b) , with recall ranging from 0.3 to 1.00 for real images and from 0.00 to 0.67 for synthetic images. For Melanocytic nevus, Melanoma, and Seborrheic Keratosis/Irritated Seborrheic Keratosis (SK/ISK), synthetic images were identified to better represent the respective skin condition, indicating that our approach is able to preserve the clinical characteristics of those skin conditions. - Synthetic Images as Data Augmentation for Training a Skin Condition Classifier
- We first trained a MobileNet model (see A. G. Howard et al., Efficient convolutional neural networks for mobile vision applications arXiv preprint arXiv:1704.04861 (2017)) on our original (uncropped) data to differentiate between 27 skin condition classes (26 plus “other”) from a single image. This baseline model achieves a top-1 accuracy of 0.496 on a test set of 5206 images, with poor performance on some of the rare conditions. To help alleviate this issue, we generated 20,000 synthetic images using the 8-class DermGAN model (
FIG. 4 ) and added them to the existing training data. We trained another MobileNet skin condition classifier using this augmented dataset and evaluated its performance on the same test set. While the top-1 accuracy remains relatively unchanged (p=0.56 using paired T-test), performance improves for some of the malignant relatively rare classes: Melanoma F1 score increases from 0.148 ([0.067, 0.193], 95% confidence interval using bootstrapping) to 0.282 ([0.110, 0.356]), whereas Basal cell carcinoma F1 score increases from 0.428 ([0.343, 0.439]) to 0.458 ([0.301, 0.534]), though at the cost of misclassifying Melanocytic nevus (0.113 decrease in F1). For the other 5 classes, the performances between the two models are comparable. Conventional data augmentation techniques (flipping, saturation, jitters) were used in both of the training setups. - In summary, the synthetic images created in accordance with this method can be used to augment a training set used for developing a skin condition classifier, and improve the performance of the classifier, e.g., its ability to correctly classify rare skin conditions or skin conditions that are poorly represented in a training set. In particular, as shown in
FIG. 8 , amethod 800 for training a skin condition classifier includes astep 802 of obtaining a heterogeneous dataset, in the form of a multitude ground truth annotated clinical skin images (seeFIG. 1, 100 ) presenting a variety of pathologies and obtained from a multitude of patients with varying degrees of skin color. In one example the clinical skin images are generated with consumer grade cameras. In this example, the heterogeneous dataset is a training set for training a classifier, and the preprocessing step on the heterogeneous dataset described previously is not required. The method includes astep 806 of adding to the training set a multitude of synthetic images generated from a trained generative adversarial network (GAN) to as to increase the number of images in the training set reflective of rare skin conditions and/or remove bias present in the dataset, thereby producing an augmented training set. The method continues with astep 808 of training a classifier, such as a deep convolutional neural network, to classify skin conditions from the augmented training set. - As noted above, one possible clinical use of the synthetic images is augmenting an searchable image database with the synthetic image(s), so as to make the images available for search and retrieval. The image database could be made available for training clinicians, e.g., nurse practitioners or general practitioners, in advanced training of dermatologist, or education and informal self-diagnosis by the general population.
- In yet another aspect, it will be appreciated that we have disclosed an apparatus configured for generating a synthetic clinical skin image with pathology. In particular, referring to
FIG. 9 , amemory 900 stores a multitude (N) of input pairs {xi; mi}, in the form of images xi and a corresponding semantic map mi that encodes the skin color, pathology and location of the pathology within the image xi and i=1 . . . N. A processing unit 902 (e.g., general purpose computer) executes a generative adversarial network (GAN) 904 trained from the input pairs. The GAN including a generator (FIG. 4, 202 ) producing a synthetic image and a discriminator (FIG. 4, 204 ) trained to discriminate between real images and synthetic images, wherein the generator and discriminator are trained to minimize a plurality of loss components so as to improve the realism of the synthetic images. The processing unit is configured to generate a synthetic clinical skin image with pathology from an input comprising asemantic map 906. - In one embodiment, the semantic map is defined so as to specify a pathology type, pathology size, or skin color. The loss components minimized in training of the GAN include reconstruction loss, lesion-specific reconstruction loss, min-max GAN loss, and feature matching loss. In one configuration, the generator is configured with a nearest-neighbor resizing layer followed by a convolution layer to thereby reduce a checkerboard effect in generated images.
- We have described a method for generating synthetic clinical images with skin conditions as seen in a tele-dermatology setting. We frame the problem as an image to image translation task and propose DermGAN (
FIG. 4 ), an adaptation of the popular Pix2Pix GAN architecture. Using the proposed framework we are able to generate realistic images for pre-specified skin conditions. We demonstrate that when varying the skin color or the size and location of the condition, the synthetic images can reflect such changes, while maintaining the characteristics of the respective skin condition. We further demonstrate that our generated images are of high fidelity using objective GAN evaluation metrics and qualitative tests. When using the synthetic images as data augmentation for training a skin condition classifier, the model is comparable to baseline while demonstrating improved performance on rare skin conditions.
Claims (22)
Priority Applications (1)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US17/768,419 US20240119586A1 (en) | 2019-10-28 | 2020-10-13 | Synthetic Generation of Clinical Skin Images in Pathology |
Applications Claiming Priority (3)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US201962926783P | 2019-10-28 | 2019-10-28 | |
PCT/US2020/055346 WO2021086594A1 (en) | 2019-10-28 | 2020-10-13 | Synthetic generation of clinical skin images in pathology |
US17/768,419 US20240119586A1 (en) | 2019-10-28 | 2020-10-13 | Synthetic Generation of Clinical Skin Images in Pathology |
Publications (1)
Publication Number | Publication Date |
---|---|
US20240119586A1 true US20240119586A1 (en) | 2024-04-11 |
Family
ID=73139418
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
US17/768,419 Pending US20240119586A1 (en) | 2019-10-28 | 2020-10-13 | Synthetic Generation of Clinical Skin Images in Pathology |
Country Status (3)
Country | Link |
---|---|
US (1) | US20240119586A1 (en) |
EP (1) | EP4042377A1 (en) |
WO (1) | WO2021086594A1 (en) |
Families Citing this family (5)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
EP4367638A1 (en) * | 2021-07-06 | 2024-05-15 | PAIGE.AI, Inc. | Systems and methods to process electronic images for synthetic image generation |
US11393574B1 (en) | 2021-07-06 | 2022-07-19 | PAIGE.AI, Inc. | Systems and methods to process electronic images for synthetic image generation |
CN117710686A (en) * | 2022-08-24 | 2024-03-15 | 漳州松霖智能家居有限公司 | Scalp hair detection method, system and equipment |
EP4354452A1 (en) * | 2022-10-11 | 2024-04-17 | Koninklijke Philips N.V. | Medical image search and retrieval |
CN117893450A (en) * | 2024-03-15 | 2024-04-16 | 西南石油大学 | Digital pathological image enhancement method, device and equipment |
Family Cites Families (4)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US9886758B2 (en) * | 2016-03-31 | 2018-02-06 | International Business Machines Corporation | Annotation of skin image using learned feature representation |
CN108198620B (en) * | 2018-01-12 | 2022-03-22 | 洛阳飞来石软件开发有限公司 | Skin disease intelligent auxiliary diagnosis system based on deep learning |
CN108961272B (en) * | 2018-07-02 | 2021-10-26 | 浙江工业大学 | Method for generating skin disease image based on deep convolution countermeasure generation network |
CN109785399B (en) * | 2018-11-19 | 2021-01-19 | 北京航空航天大学 | Synthetic lesion image generation method, device, equipment and readable storage medium |
-
2020
- 2020-10-13 WO PCT/US2020/055346 patent/WO2021086594A1/en active Application Filing
- 2020-10-13 EP EP20803351.4A patent/EP4042377A1/en active Pending
- 2020-10-13 US US17/768,419 patent/US20240119586A1/en active Pending
Also Published As
Publication number | Publication date |
---|---|
EP4042377A1 (en) | 2022-08-17 |
WO2021086594A1 (en) | 2021-05-06 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
Ghorbani et al. | Dermgan: Synthetic generation of clinical skin images with pathology | |
US20240119586A1 (en) | Synthetic Generation of Clinical Skin Images in Pathology | |
WO2021036616A1 (en) | Medical image processing method, medical image recognition method and device | |
Reddy et al. | A novel computer-aided diagnosis framework using deep learning for classification of fatty liver disease in ultrasound imaging | |
Deligiannidis et al. | Emerging trends in image processing, computer vision and pattern recognition | |
Rasti et al. | Automatic diagnosis of abnormal macula in retinal optical coherence tomography images using wavelet-based convolutional neural network features and random forests classifier | |
Goceri | Comparison of the impacts of dermoscopy image augmentation methods on skin cancer classification and a new augmentation method with wavelet packets | |
Liu et al. | A remote sensing image enhancement method using mean filter and unsharp masking in non-subsampled contourlet transform domain | |
Laghari et al. | How to collect and interpret medical pictures captured in highly challenging environments that range from nanoscale to hyperspectral imaging | |
Maiti et al. | Automatic detection and segmentation of optic disc using a modified convolution network | |
Nie et al. | Recent advances in diagnosis of skin lesions using dermoscopic images based on deep learning | |
McCartney et al. | A zero-shot learning approach to the development of brain-computer interfaces for image retrieval | |
Prakash et al. | Meningioma brain tumor detection and classification using hybrid CNN method and RIDGELET transform | |
Bowen et al. | Visual stream connectivity predicts assessments of image quality | |
Korevaar et al. | Failure to achieve domain invariance with domain generalization algorithms: An analysis in medical imaging | |
Jai-Andaloussi et al. | Content Based Medical Image Retrieval based on BEMD: optimization of a similarity metric | |
Tawfeeq et al. | Predication of Most Significant Features in Medical Image by Utilized CNN and Heatmap. | |
Kumar et al. | An efficient framework for brain cancer identification using deep learning | |
Go et al. | Generation of Structurally Realistic Retinal Fundus Images with Diffusion Models | |
Chilukamari | A computational model of visual attention. | |
Lin et al. | MCI Conversion Prediction Based on Transfer Learning | |
Tuhin et al. | Detection and 3d visualization of brain tumor using deep learning and polynomial interpolation | |
de Almeida Simões | Image Quality Improvement of Medical Images using Deep Learning for Computer-aided Diagnosis | |
Sharma | Spontaneous facial micro expression recognition and analysis using varying resolutions | |
Sarah et al. | Generalizing deep learning models for medical image classification |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
AS | Assignment |
Owner name: GOOGLE LLC, CALIFORNIAFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:NATARAJAN, VIVEK;LIU, YUAN;COZ, DAVID;AND OTHERS;REEL/FRAME:059577/0243Effective date: 20220407Owner name: GOOGLE LLC, CALIFORNIAFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:NATARAJAN, VIVEK;LIU, YUAN;COZ, DAVID;AND OTHERS;REEL/FRAME:059577/0570Effective date: 20220407 |
|
AS | Assignment |
Owner name: T.J.SMITH AND NEPHEW,LIMITED, UNITED KINGDOMFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNOR:QUINTANAR, FELIX CLARENCE;REEL/FRAME:061050/0498Effective date: 20191014 |
|
STPP | Information on status: patent application and granting procedure in general |
Free format text: DOCKETED NEW CASE - READY FOR EXAMINATION |