CN110832278B - Rendering map data using descriptions of grid differences - Google Patents
Rendering map data using descriptions of grid differences Download PDFInfo
- Publication number
- CN110832278B CN110832278B CN201780059808.9A CN201780059808A CN110832278B CN 110832278 B CN110832278 B CN 110832278B CN 201780059808 A CN201780059808 A CN 201780059808A CN 110832278 B CN110832278 B CN 110832278B
- Authority
- CN
- China
- Prior art keywords
- map image
- raster map
- client device
- raster
- difference
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Active
Links
- 238000009877 rendering Methods 0.000 title claims description 9
- 238000000034 method Methods 0.000 claims description 58
- 238000012545 processing Methods 0.000 claims description 11
- 230000004044 response Effects 0.000 claims description 4
- 238000010586 diagram Methods 0.000 description 7
- 230000002452 interceptive effect Effects 0.000 description 6
- 239000013598 vector Substances 0.000 description 6
- 239000003086 colorant Substances 0.000 description 2
- 238000004891 communication Methods 0.000 description 2
- 238000013507 mapping Methods 0.000 description 2
- 230000008520 organization Effects 0.000 description 2
- 230000002085 persistent effect Effects 0.000 description 2
- XLYOFNOQVPJJNP-UHFFFAOYSA-N water Substances O XLYOFNOQVPJJNP-UHFFFAOYSA-N 0.000 description 2
- 230000005540 biological transmission Effects 0.000 description 1
- 239000000872 buffer Substances 0.000 description 1
- 238000010276 construction Methods 0.000 description 1
- 239000012634 fragment Substances 0.000 description 1
- 230000006870 function Effects 0.000 description 1
- 230000014509 gene expression Effects 0.000 description 1
- 238000012986 modification Methods 0.000 description 1
- 230000004048 modification Effects 0.000 description 1
- 230000000007 visual effect Effects 0.000 description 1
Classifications
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T1/00—General purpose image data processing
- G06T1/20—Processor architectures; Processor configuration, e.g. pipelining
-
- G—PHYSICS
- G01—MEASURING; TESTING
- G01C—MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY
- G01C21/00—Navigation; Navigational instruments not provided for in groups G01C1/00 - G01C19/00
- G01C21/26—Navigation; Navigational instruments not provided for in groups G01C1/00 - G01C19/00 specially adapted for navigation in a road network
- G01C21/34—Route searching; Route guidance
- G01C21/36—Input/output arrangements for on-board computers
- G01C21/3667—Display of a road map
- G01C21/367—Details, e.g. road map scale, orientation, zooming, illumination, level of detail, scrolling of road map or positioning of current position marker
-
- G—PHYSICS
- G01—MEASURING; TESTING
- G01C—MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY
- G01C21/00—Navigation; Navigational instruments not provided for in groups G01C1/00 - G01C19/00
- G01C21/38—Electronic maps specially adapted for navigation; Updating thereof
- G01C21/3863—Structures of map data
- G01C21/387—Organisation of map data, e.g. version management or database structures
- G01C21/3878—Hierarchical structures, e.g. layering
-
- G—PHYSICS
- G01—MEASURING; TESTING
- G01C—MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY
- G01C21/00—Navigation; Navigational instruments not provided for in groups G01C1/00 - G01C19/00
- G01C21/38—Electronic maps specially adapted for navigation; Updating thereof
- G01C21/3863—Structures of map data
- G01C21/387—Organisation of map data, e.g. version management or database structures
- G01C21/3881—Tile-based structures
-
- G—PHYSICS
- G01—MEASURING; TESTING
- G01C—MEASURING DISTANCES, LEVELS OR BEARINGS; SURVEYING; NAVIGATION; GYROSCOPIC INSTRUMENTS; PHOTOGRAMMETRY OR VIDEOGRAMMETRY
- G01C21/00—Navigation; Navigational instruments not provided for in groups G01C1/00 - G01C19/00
- G01C21/38—Electronic maps specially adapted for navigation; Updating thereof
- G01C21/3885—Transmission of map data to client devices; Reception of map data by client devices
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L67/00—Network arrangements or protocols for supporting network services or applications
- H04L67/01—Protocols
- H04L67/10—Protocols in which an application is distributed across nodes in the network
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L67/00—Network arrangements or protocols for supporting network services or applications
- H04L67/01—Protocols
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L69/00—Network arrangements, protocols or services independent of the application payload and not provided for in the other groups of this subclass
- H04L69/30—Definitions, standards or architectural aspects of layered protocol stacks
- H04L69/32—Architecture of open systems interconnection [OSI] 7-layer type protocol stacks, e.g. the interfaces between the data link level and the physical level
- H04L69/322—Intralayer communication protocols among peer entities or protocol data unit [PDU] definitions
- H04L69/324—Intralayer communication protocols among peer entities or protocol data unit [PDU] definitions in the data link layer [OSI layer 2], e.g. HDLC
Abstract
The web server receives an indication of a first raster map image from a client device, the first raster map image depicting a geographic map of a region and a zoom level. The web server obtains a second raster map image corresponding to the geographic area and the zoom level, and generates a description of the indicated pixel differences between the first raster map image and the second raster map image. The web server then provides the determined description of the pixel difference to the client device for generating a second raster map image at the client device.
Description
Technical Field
The present disclosure relates to interactive digital maps, and more particularly, to efficiently transferring changes to raster map images to client devices via a communication network.
Background
The background description provided herein is for the purpose of generally presenting the context of the disclosure. Work of the presently named inventors, to the extent it is described in this background section, as well as aspects of the description that may not otherwise qualify as prior art at the time of filing, are neither expressly nor impliedly admitted as prior art against the present disclosure.
Interactive digital maps displayed on computing devices for various geographic applications typically depict numerous geographic features such as outlines of roads, villages, and towns, bodies of water, buildings, and the like. The geographic features displayed as part of the digital map may have different appearances at different magnification levels of the digital map, which are commonly referred to as "zoom levels". Typically, a digital map may be made up of multiple tiles (tiles) or some fixed-size portion, depending on the zoom level.
In general, the map server may provide the map data to the client device as a raster format according to which the map image is described in pixels or as a map image in an extensible format (e.g., vector graphics format) that relies on mathematical descriptions of shapes. In the former case, the map image is typically ready for display on the client device. In the latter case, the client device first interprets the map data locally to generate raster map images at a relatively high computational cost, and then displays these map images.
Transmitting map data in image format typically occupies a significant amount of bandwidth. Further, when a new version of the grid map image showing the digital map becomes available, or when a server adds new information such as traffic to the digital map, the server transmits the new grid map image to replace the old version.
Disclosure of Invention
One embodiment of these techniques is a method for efficiently providing digital map data to a client device that may be implemented in a network server. The method includes receiving, from a client device, an indication of a first raster map image depicting a geographic map of a region and a zoom level at the client device. The method also includes obtaining, by the one or more processors, a second raster map image corresponding to the geographic area and the zoom level, and generating a description of the indicated pixel difference between the first raster map image and the second raster map image. The method further includes providing the determined description of the pixel difference to a client device for generating a second raster map image at the client device.
Another embodiment of these techniques is a method for rendering a digital map. The method includes receiving, at a client device, a first raster map image from a web server, the first raster map image depicting a geographic map of a region and a zoom level at a first time, and transmitting, at a second time subsequent to the first time, an indication of the first raster map image to the web server. The method also includes receiving, from the network server, a description of a pixel difference between the first raster map image and a second raster map image to be displayed at the client device. Further, the method includes generating a second raster map image using the first raster map image and the description of pixel differences, and displaying the second raster map image at the client device.
Yet another embodiment of these techniques is a client device that includes processing hardware, a display device coupled to the processing hardware, and a non-transitory computer-readable memory coupled to the processing hardware. The memory stores instructions that, when executed by the processing hardware, cause the client device to: (i) receiving a first raster map image from a web server, the first raster map image depicting a geographic map of a region and a zoom level at a first time, (ii) transmitting an indication of the first raster map image to the web server at a second time after the first time, (iii) receiving a description of pixel differences between the first raster map image and a second raster map image to be displayed at a client device from the web server, (iv) generating a second raster map image using the description of the first raster map image and the pixel differences, and (v) displaying the second raster map image via a display device.
Drawings
FIG. 1 is a block diagram of an example computing system in which techniques for generating map images using descriptions of grid differences may be implemented;
FIG. 2 is a conceptual diagram illustrating a portion of a quadtree that may organize grid map tiles in the system of FIG. 1, some of which include multiple versions;
FIG. 3 is a diagram illustrating the use of grid map images and difference grid map images to generate a map image of a geographic area that may be implemented in the system of FIG. 1;
FIG. 4 is a flow chart of an example method for generating a difference grid map image that may be implemented in the map server of FIG. 1; and
FIG. 5 is a flow diagram of an example method for generating an updated map image using an initial grid map image and a difference grid map image that may be implemented in the client device of FIG. 1.
Detailed Description
SUMMARY
In accordance with the techniques of this disclosure, a client device provides an indication of grid map images available at the client device to a web server for a geographic region and a zoom level. The raster map image may be a versioned raster map tile, and the indication from the client device may specify a version number of the raster map tile. More generally, the client device may provide an indication of the available raster map image by indicating the geographic area and the level of magnification (e.g., zoom level) in any suitable manner. In some cases, the client device also specifies an information layer such as traffic or weather that has been included in the raster map image.
For example, when the network server determines that a newer version of the raster map image for the same geographic area and zoom level is available, the indication provided by the client device to the network server may include an implicit request for a new raster map image. In other cases, the indication may include an explicit request for a new raster map image, for example, when the client device requests that certain information layers be added to or removed from the available raster map images. Further, the indication may include implicit and explicit requests for new map images. In an example scenario, a client device indicates version V of a grid map tile at the client device N And request traffic is added to the digital map, and the web server determines version V of the grid map tile N+1 Can be used.
In any event, the web server may determine which new raster map image should be available at the client device and determine the pixel difference between the new raster map image and the raster map image already available at the client device. For example, the network server may determine that the version of the grid map tile at the client device is not the latest version of the grid map tile. The web server may also determine whether the differences between the versions are significant, e.g., whether a measure of the differences exceeds a certain threshold. To this end, the web server may retrieve pre-stored grid map tiles from the database according to the indicated version and the new version, or render the grid map tiles if needed, and compare individual pixels in the map tiles.
The web server may then generate a description of the differences between the raster map images and provide the description to the client device. In some implementations, the web server provides a description of the differences to the client device in the form of a "difference" raster map image (and, if tiling is used, a difference map tile). The difference grid map image may be overlaid on or otherwise combined with a version of the grid map image already available at the client device. In an example embodiment, the difference grid map image includes transparent pixels for each pixel in the grid map image that is already available that remains unchanged. In a typical case, many pixels in the difference grid map image are transparent and identical to each other, making the difference grid map image highly compressible.
Example computing Environment
FIG. 1 is a block diagram of an example computing system 10 in which a map data server 12 provides map data to a client device 14 via a communication network 16 for rendering an interactive digital map using the differential raster map image technique of the present disclosure. The map data server 12 is coupled to a map database 18 that stores map data.
The map data server 12 may be implemented as a single device or as a group of devices. One or more of these devices may include one or more processors 30, a network interface 32, a database interface 33, and a non-transitory computer-readable memory 34 storing instructions executable on the one or more processors 30. As discussed in detail below, these instructions may implement, among other software components, a difference raster image generation module 36, which difference raster image generation module 36 generates a description of differences between raster map images for use on a client device. More generally, the map data server 12 may include any suitable type of processing hardware configured to generate the disclosed map raster image.
The client device 14 may be a desktop computer, a laptop computer, a tablet computer, another type of portable device such as a smartphone, a wearable device, or the like. More generally, techniques for generating map image layers may be utilized in all suitable computing devices. The client device 14 may include a network interface 42, the network interface 42 being configured to communicate with the map data server 12 and other devices via the network 16 using any suitable protocol, the network 16 may be a Wide Area Network (WAN), a Local Area Network (LAN), etc., and the client device 14 may include any suitable number of wired and/or wireless links. The client device 14 may also include a touch screen 44, the touch screen 44 being configured to receive typed input and gesture-based input and to display images generated by various applications executing on the client device 14, including a geographic application 46. In other implementations, the client device 14 may include an output-only display and receive input via a keyboard, mouse, microphone, sensor configured to detect 2D and/or 3D gestures, or the like. In addition, client device 14 may include one or more general-purpose processors 40, non-transitory computer-readable memory 48, and a graphics card 50 (e.g., including one or more graphics processing units, or GPUs) having buffers and program memory that stores vertex shaders and pixel shaders. Memory 48 may include persistent components (e.g., a hard disk)
And non-persistent components (e.g., RAM). In other implementations, the client device 14 may include additional components or, conversely, may not include some of the components shown in fig. 1.
In the example embodiment shown in fig. 1, the geographic application 46 is stored in the memory 48 as a set of instructions executed by the one or more processors 40. The geographic application 46 may generate an interactive digital map and, based on the implementation and/or scenario, obtain navigation directions, provide data related to the geographic positioning business, retrieve and display geographic business data such as coupons and offers, and the like. For example, depending on the implementation, the geographic application 46 may operate as a standalone application or as a component of another application, such as a web browser. As discussed in more detail below, the geographic application 46 includes a raster map image rendering module 60, which raster map image rendering module 60 operates on raster map tiles 52 and a difference raster image in some implementations.
With continued reference to FIG. 1, the map database 18 may be implemented in a single storage device or in multiple storage devices. Map database 18 may store map data including descriptions of the geometry of various map features such as buildings and other structures, roads, parks, bodies of water, and the like. In addition to roads designed for the vehicle, the map data may describe a bike path, a sidewalk, a railroad track, a shipping route, an aviation route, and the like. Map features may be defined in a vector graphics format according to which images are described in terms of geometric primitives based on mathematical expressions, or another suitable scalable format. Depending on the implementation, the map features may be defined in two dimensions (2D) only, as wire frames applying grid textures in three dimensions (3D), as 2D polygons "squeezed" into a third dimension (2.5D), etc. For example, in some cases, the map data may also include a grid map image in bitmap format. In addition, the map data may also include text labels and various forms of metadata, such as links to remote resources.
Further, the map data server 12 may organize and provide map data to client devices using map tiling. Map tiles generally correspond to the 2D organization of geospatial data into quadtrees. Each tile at a given zoom level is divided into four tiles at the next level, up to the top level of magnification. Similarly, 3D organization of geospatial data may be implemented using octree, where a cube volume contains map geometry at a certain zoom level, and is subdivided into eight cube volumes at the next zoom level, each of the eight cube volumes typically containing more detailed map geometry. To map the surface of the earth onto the plane of the 2D representation, an ink-card-holder projection or another suitable projection may be used. Although the following examples refer to map data organized as 2D map tiles, the LOD and style parameter determination techniques of the present disclosure may be extended to 3D map data organized as octree.
The term "map tile" in the following discussion refers to a grid map tile, i.e., an image defined in terms of pixels rather than vectors or other non-pixel indicators, unless otherwise specified. For ease of explanation, the discussion below primarily refers to grid map tiles. However, it should be noted that the techniques of the present disclosure may be applied to any suitable grid map image.
Fig. 2 schematically shows a fragment of the quadtree 100 into which the grid map tiles may be organized. The tiles include at discrete zoom level Z N A grid map tile 102 of a geographic region R. The four grid map tiles 104A-D collectively cover the geographic region R at the next zoom-in region, i.e., the discrete zoom level Z N+1 . More specifically, grid map tile 104A covers the northwest quadrant of grid map tile 102, grid map tile 104B covers the northeast quadrant of grid map tile 102, grid map tile 104C covers the southwest quadrant of grid map tile 102, and grid map tile 104D covers the southeast quadrant of grid map tile 102. For example, grid map tiles 102 and 104A-D may be stored in map database 18, where the relationship between these grid map tiles is indicated by an appropriate link or index.
As shown in fig. 2, there are three versions of grid map tile 104C: v (V) N 、V N+1 And V N+2 And two versions of grid map tile 104D: v (V) M And V M+1 . In some embodiments, map database 18 stores these multiple versions of grid map tiles 104C and 104D. The map data server 12 may use not only the unique identifier to retrieve and expect the geographic area and locationGrid map tiles corresponding to a zoom level are desired, and particular grid map tiles may also be retrieved. In other words, version V of grid map tile 104D M And V M+1 May have a separate unique identifier. In other embodiments, the map database 18 stores not only the latest version of these raster map tiles, but also information that allows the difference raster image generation module 36 to reconstruct a previous version of these raster map tiles.
For example, the map data server 12 may generate new versions of grid map tiles in response to various changes to geographic features in the real world or due to improvements in map data quality. Further, where the grid map tiles reflect dynamic information such as road closures, store hours of operation, traffic, etc., the map data server 12 may generate new versions of the grid map tiles relatively frequently.
Efficient rendering of digital maps using raster map images
In an example operation, the client device 14 provides an indication of grid map tiles 52 available to the geographic application 46. As a more specific example, the user of the client device 14 may request that the viewport be repositioned according to a gesture or other type of user input, the viewport defining the currently viewable portion of the interactive digital map. The responding geographic application 46 may determine that the repositioned viewport now covers the grid map tile 52, and possibly other grid map tiles. The client device 14 may indicate that the grid map tile 52 has an identifier I (which in turn may indicate that the map tile 52 is centered on (X, Y) and has a zoom level Z i ) And version V M 。
In an example operation, the difference raster image generation module 36 queries the database 18 to determine a newer version V of the raster map tile 52 in response to the received indication N Is available, wherein N>M. The module 36 determines version V M And V N The difference between, generate a difference grid map tile, compress the difference grid map tile to reduce bandwidth usage, and transmit the difference grid map tile to the client device 14. Ground (floor)Upon receiving the difference grid map tile, the processing application 46 decompresses the difference grid map tile and overlays the difference grid map tile on version V of the map tile 52 M Version V of map tile 52 is efficiently generated above N . The geographic application 46 may also use a newer version V of the map tile 52 N To replace version V of map tile 52 in memory 48 M 。
For clarity, diagram 100 of fig. 3 shows an example grid map tile 152 in combination with a difference grid map tile 154 that generates grid map tile 154. The grid map tile 152 in this example is version V M And grid map tile 156 is version V N Wherein N is>M. In other words, version N is newer than version M. Notably, versions N and M need not be contiguous, and in general there may be one or more intermediate versions between versions N and M.
As shown in diagram 100, an example pixel P in grid map tile 152 x1,y1 Having color value C 1 While the same pixel P in grid map tile 156 x1,y1 Having color value C 2 . The difference grid map tile 154 will thus value C 2 Stored in pixel P x1,y1 Is a kind of medium. On the other hand, example pixel P in grid map tile 152 x2,y2 Having color value C 3 And the same pixel P in grid map tile 156 x2,y2 Having the same colour value C 3 . Difference grid map tile 154 thus stores a value of 0, or some other value indicative of transparency, at pixel P x2,y2 Is a kind of medium. The difference grid map tile 154 generally includes a large number of pixels having the same value that indicates transparency, with many of these pixels defining successive regions of the same value pixels. These large areas allow differential grid map tile 154 to be compressed efficiently.
Referring back to fig. 1, difference raster image generation module 36 may generate difference raster map tile 154 using raster map tiles 152 and 156, and raster map image rendering module 60 may generate raster map tile 154 using raster map tile 152 and difference raster map tile 154.
More specifically, module 36 may obtain grid map tiles 152 and 156 and compare pairs of pixels in the same location (i, j) in the two grid map tiles. In some implementations, module 36 may simply determine pixel P in grid map tile 152 i,j Whether there is a pixel P in grid map tile 156 i,j The same exact value, and thus pixel P from grid map tile 156 i,j Or transparent color values for inclusion in difference grid map tile 154. In another embodiment, module 36 may evaluate each of the R (red), G (green), and B (blue) channels of a pixel separately and weigh the differences in any suitable manner. Thus, module 36 may compare the value of the R channel of one pixel to the value of the R channel of another pixel, the value of the G channel of one pixel to the value of the G channel of another pixel, and so on. For example, in yet another embodiment, module 36 may determine pixel P of two grid map tiles x1,y1 Two different colors C in (a) 1 And C 2 Vector distance between them. Vector distance can be understood as the distance of a point (x 1 ,y 1 ,z 1 ) And (x) 2 ,y 2 ,z 2 ) Distance between, where x 1 And x 2 Respectively C 1 And C 2 The value of the R component of (2); y is 1 And y 2 Respectively C 1 And C 2 The value of the G component of (2); z 1 And z 2 Respectively C 1 And C 2 The value of the B component of (c).
Further, in some embodiments, the difference raster image generation module 36 determines whether the difference between pixel pairs exceeds a certain threshold D TH . When the difference does not exceed the threshold D TH When module 36 assigns a transparent color value to a corresponding pixel in the difference grid tile. Module 36 may compare the vector distance between the colors of the two pixels to a threshold D TH Compare, or compare each channel-specific difference to a threshold D TH A comparison is made to determine if any of R, G and B channel differences exceeds a threshold D TH . More generally, module 36 may apply threshold D in any suitable manner TH 。
In some implementations, the difference raster image generation module 36 uses another threshold T TH To determine whether a sufficiently large number of pixels in the two grid map tiles are different in order to determine whether the module 36 should generate and transmit a difference grid map tile. Threshold T TH May be defined in absolute terms of the entire grid map tile, e.g., if the number of pixels changed is ≡T TH Module 36 generates a difference grid map tile. Alternatively, the threshold T TH The percentage of pixels in the grid map tile that are changed may be defined. As a further alternative, the threshold T TH The number of varying densities of pixel values may be defined such that model 36 generates a difference grid map tile when different pixels are concentrated in a portion of the grid map tile, but does not generate a difference grid map tile when the same number of different pixels are more evenly distributed across the grid map tile. Yet another option includes comparing the grid map tiles piece by piece to determine whether any one of the tiles of the grid map is sufficiently different from the corresponding tile in the newer version of the grid map tiles.
Example methods for generating and applying difference raster images
For clarity, some techniques for generating and applying difference raster images are discussed next with reference to the flowcharts of fig. 3 and 4. These flowcharts illustrate methods that may be implemented as a set of instructions stored on a computer-readable medium and executable on one or more processors. For example, the method of fig. 4 may be implemented in the server 12 and the method of fig. 4 may be implemented in the client device 14. However, these or similar methods may also be implemented in other suitable devices.
Referring first to FIG. 4, the method 200 may be implemented in a difference raster image generation module 36, such as discussed above, or in another suitable module or set of communicatively interconnected modules. The method 200 begins at block 202, where an indication of raster images available at a client device is received. The raster image depicts a geographic map of a region at a certain zoom level. If the map tiling technique outlined above is used, the indication received at block 202 may include a unique identifier (e.g., id= "3452323590") of the grid map tile in the map database 18. In addition to identifying the geographic area and zoom level covered by the grid map tile, the identifier may also indicate a version of the grid map tile. In another embodiment, the identifier indicates a date on which the grid map tile was cached at the client device, which the map server may use to determine what images the grid map tile contains. Further, in some scenarios, the indication received at block 202 identifies one or more information layers added to the "base" grid map tile. These information layers may include traffic, public traffic routes, weather, and the like. Further, for example, the indication may specify that certain markers or other graphical elements are added to the base grid map tile to depict the search results.
In general, the indication received at block 202 may include any suitable parameter or combination of parameters that the map server may use to explicitly determine the content of the raster map image available at the client device.
At block 204, a new raster map image of the same geographic area at the same zoom level is identified. For example, the new grid map image may correspond to the new version of the grid map tile specified at block 202. In another scenario, the new raster map image corresponds to the same version of the raster map tile, but includes a new information layer. The new raster map image also corresponds to an information layer removed from the raster map image available at the client device. The new grid map image may be retrieved from a database or generated at a map server if necessary.
Next, at blocks 206-214, the grid map image already available at the client device and the individual pixels of the new grid map image are compared. In particular, at block 206, a pair of pixels P in the same location in two raster map images i Is selected. If the two pixelsIf the difference in values of (1) is within some allowable range (or is not present), then flow proceeds to block 210 where the transparent pixel is at pixel P in the difference raster image i Is generated. Otherwise, flow proceeds to block 212 where pixels from the new map image are included in the difference raster image as pixel P i Is a shared location of (c). If there are more pixels to compare (block 214), flow returns to block 206.
At block 216, the number of non-transparent pixels in the difference grid map image is compared to a threshold. If the number exceeds the threshold, at block 218, the difference grid map image is transmitted to the client device. In some embodiments, the difference grid map image is compressed prior to transmission. Because the difference grid map image typically contains a large number of transparent pixels in consecutive blocks, the difference grid map image is highly compressible. The method ends after block 218. If the number does not exceed the threshold, the method 200 is complete after block 216.
FIG. 5 is a flow chart of an example method 300, which method 300 may be implemented in the client device 14 of FIG. 1 or another suitable device for generating an updated map image using an initial grid map image and a difference grid map image.
The method 300 begins at block 302, where an indication of a raster map image available at a client device is provided to a web server. As discussed above, the indication may include or be accompanied by an implicit or explicit request for an updated grid map image. The implicit request may simply indicate the version of the grid map tile that the client device has stored in its local memory. For example, the client device may generate the implicit request when the viewport is repositioned on the interactive digital map, or according to some schedule of examination of grid map tiles cached in local memory (e.g., after some grid map tiles have been stored in local memory for more than X days). On the other hand, an explicit request may indicate that the user wishes to see an additional information layer, a mark at a specific location, etc.
At block 304, a difference raster image is received from a web server. The difference raster image may be compressed. A typical difference raster image includes transparent pixels and non-transparent pixels to be displayed on corresponding pixels in a raster map image that is already available to the client device. In some cases, at block 304, an indication that the difference raster image is not needed or available is received, in which case the method ends after block 304.
In other implementations, the description of the differences between the new grid map image and the grid map images available at the client device has a format other than the difference grid map image. For example, the description of the difference may be a list of pixel coordinates and new values: ((x) 1 ,y 1 ,C 1 )、(x 2 ,y 2 ,C 2 )、……、(x N ,y N ,C N ))。
Next, at block 306, a new raster map image is generated by layering the difference raster image over the raster map image available at the client device. To this end, any suitable image layering technique may be used. At block 308, the generated raster map image is displayed via a user interface.
Other considerations
In general, the techniques of this disclosure may be implemented as a portable device, a non-portable device, a stand-alone navigation system, a navigation system built into a vehicle head unit, a wearable device, and so on. Furthermore, these techniques are generally applicable to outdoor and indoor maps. Furthermore, while the above examples refer primarily to geographic application 46, these techniques may similarly be implemented in an Application Program Interface (API) that may be invoked by other software applications, such as a web browser.
Various operations of the example methods described herein may be performed, at least in part, by one or more processors that are temporarily configured (e.g., via software) or permanently configured to perform the relevant operations. Whether temporarily configured or permanently configured, such a processor may constitute a processor-implemented module that operates to perform one or more operations or functions. In some example embodiments, the modules referred to herein may comprise processor-implemented modules.
Similarly, the methods or routines described herein may be at least partially processor-implemented. For example, at least some operations of the methods may be performed by one or more processors or processor-implemented hardware modules. The performance of certain operations may be distributed among one or more processors, residing not only within a single machine, but also across multiple machines. In some example embodiments, one or more processors may be located in a single location (e.g., within a home environment, an office environment, or as a server farm), while in other embodiments, the processors may be distributed across several locations.
The one or more processors may also be operative to support performance of related operations in a cloud computing environment or as software as a service (SaaS). For example, at least some of the operations may be performed by a set of computers (as examples of machines including processors) that are accessible via a network (e.g., the internet) and via one or more suitable interfaces (e.g., application Program Interfaces (APIs)).
The performance of certain operations may be distributed among one or more processors, residing not only within a single machine, but also across multiple machines. In some example embodiments, one or more processors or processor-implemented modules may be located in a single geographic location (e.g., within a home environment, within an office environment, or within a server farm). In other example embodiments, one or more processors or processor-implemented modules may be distributed across several geographic locations.
Further, for illustrative purposes only, the figures depict some embodiments of a system 100 for aligning visual indicators on a navigation map and a mapping system 700 in a mapping system. Those skilled in the art will readily recognize from the following discussion that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles described herein.
Upon reading this disclosure, those of skill in the art will understand additional alternative structural and functional designs for using differential raster images. Thus, while particular embodiments and applications have been illustrated and described, it is to be understood that the disclosed embodiments are not limited to the precise construction and components disclosed herein. Various modifications, changes and variations apparent to those skilled in the art may be made in the arrangement, operation and details of the methods and apparatus disclosed herein without departing from the spirit and scope defined in the appended claims.
Claims (16)
1. A method in a network server (12) for providing digital map data to a client device (14), the method comprising:
receiving an indication of a first raster map image from a client device (14), the first raster map image depicting a geographic area and a geographic map (202) of a certain zoom level at the client device (14);
obtaining, by one or more processors, a second raster map image (204) corresponding to the geographic area and the zoom level;
generating, by the one or more processors, a description of the indicated pixel difference between the first and second raster map images, including a difference raster map image to be layered on the first raster map image at the client device (14), wherein generating the difference raster map image further includes:
generating transparent pixels (210) in the difference raster map image for pixels in the indicated first raster map image that have differences below a threshold relative to corresponding pixels in the same location in the second raster map image; and
generating non-transparent pixels (212) in the difference grid map image for pixels in the indicated first grid map image that have a difference of the threshold or a difference above the threshold relative to corresponding pixels in the same location in the second grid map image; and
-providing the determined description of the pixel difference to the client device (14) for generating the second raster map image (218) at the client device (14).
2. The method of claim 1, wherein the first raster map image corresponds to a versioned map tile, and wherein receiving the indication of the first raster map image comprises receiving a version number of the map tile.
3. The method as recited in claim 2, further comprising:
in response to receiving the version number of the map tile, determining a most current version of the map tile available for the geographic area and the zoom level,
wherein the second raster map image corresponds to the latest version of the map tile.
4. The method of claim 1, wherein receiving the indication of the first raster map image comprises receiving an indication of the geographic area and the zoom level.
5. The method as recited in claim 1, further comprising:
an indication of a data layer to be added to the first raster map image at the client device (14) or to be removed from the first raster map image at the client device (14) is received from the client device (14) to generate the second raster map image.
6. The method of claim 1, wherein generating the description of the pixel difference between the first raster map image and the second raster map image includes comparing pixels at certain locations within the first raster map image to pixels at the same locations within the second raster map image to determine whether a color difference exceeds a threshold, including comparing each of red, green, and blue channels, respectively.
7. The method of claim 1, wherein providing the description of the determined pixel difference to the client device (14) (218) is in response to a determination (216) made by the one or more processors that the determined difference exceeds a threshold.
8. The method according to claim 1, wherein the method further comprises:
after providing the description of the determined pixel difference, receiving from the client device (14) an indication of the second raster map image available at the client device (14);
obtaining, by one or more processors, a third raster map image corresponding to the geographic area and the zoom level;
determining that a metric value of a difference between the third raster map image and the second raster map image is below a threshold; and
an indication is provided that the second raster map image is up-to-date for the client device (14).
9. A method for rendering a digital map, the method comprising:
receiving, at a client device (14), a first raster map image from a network server (12), the first raster map image depicting a geographic map of a geographic area and a zoom level at a first time;
-transmitting an indication of the first raster map image to the network server (12) at a second time subsequent to the first time;
-receiving a description of pixel differences between the first raster map image and a second raster map image to be displayed at the client device (14) from the network server (12), comprising a difference raster map image, wherein the difference raster map image further comprises:
for pixels in the first raster map image having a difference below a threshold relative to corresponding pixels in the same location in the second raster map image, transparent pixels in the difference raster map image; and
for pixels in the first raster map image having a difference of the threshold or a difference above the threshold relative to corresponding pixels in the same location in the second raster map image, non-transparent pixels in the difference raster map image;
generating the second raster map image by layering the difference raster map image on the first raster map image; and
the second raster map image is displayed at the client device (14).
10. The method as recited in claim 9, further comprising:
-transmitting an indication of a data layer to the network server (12) to generate the second raster map image, the data layer being a data layer to be added to the first raster map image at the client device (14) or a data layer to be removed from the first raster map image at the client device (14).
11. The method of claim 9, wherein the first raster map image corresponds to a versioned map tile, and wherein transmitting the indication of the first raster map image includes transmitting a version number of the map tile.
12. The method of claim 9, wherein transmitting the indication of the first raster map image includes transmitting an indication of the geographic area and the zoom level.
13. A client device (14), comprising:
processing hardware;
a display device coupled to the processing hardware; and
a non-transitory computer readable memory coupled to the processing hardware, the memory storing instructions that, when executed by the processing hardware, cause the client device (14) to:
receiving a first raster map image from a network server (12), the first raster map image depicting a geographic area and a geographic map at a zoom level at a first time,
at a second time, subsequent to the first time, transmitting an indication of the first raster map image to the network server (12),
-receiving a description of pixel differences between the first raster map image and a second raster map image to be displayed at the client device (14) from the network server (12), comprising a difference raster map image, wherein the difference raster map image further comprises:
for pixels in the first raster map image having a difference below a threshold relative to corresponding pixels in the same location in the second raster map image, transparent pixels in the difference raster map image; and
for pixels in the first raster map image having a difference of the threshold or a difference above the threshold relative to corresponding pixels in the same location in the second raster map image, non-transparent pixels in the difference raster map image,
generating the second raster map image by layering the difference raster map image on the first raster map image, and
the second raster map image is displayed via the display device.
14. The client device (14) of claim 13, wherein the instructions further cause the client device (14) to transmit an indication of a data layer to the network server (12) to generate the second raster map image, the data layer being a data layer to be added to the first raster map image at the client device (14) or a data layer to be removed from the first raster map image at the client device (14).
15. The client device (14) of claim 13, wherein the first raster map image corresponds to a versioned map tile, and wherein to transmit the indication of the first raster map image, the instructions cause the client device (14) to transmit a version number of the map tile to the network server (12).
16. The client device (14) of claim 13, wherein the instructions cause the client device (14) to transmit an indication of the geographic area and the zoom level to the web server (12).
Applications Claiming Priority (3)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US15/278,018 US10319062B2 (en) | 2016-09-27 | 2016-09-27 | Rendering map data using descriptions of raster differences |
US15/278,018 | 2016-09-27 | ||
PCT/US2017/052741 WO2018063915A1 (en) | 2016-09-27 | 2017-09-21 | Rendering map data using descriptions of raster differences |
Publications (2)
Publication Number | Publication Date |
---|---|
CN110832278A CN110832278A (en) | 2020-02-21 |
CN110832278B true CN110832278B (en) | 2023-11-10 |
Family
ID=60009736
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
CN201780059808.9A Active CN110832278B (en) | 2016-09-27 | 2017-09-21 | Rendering map data using descriptions of grid differences |
Country Status (4)
Country | Link |
---|---|
US (1) | US10319062B2 (en) |
EP (1) | EP3519769A1 (en) |
CN (1) | CN110832278B (en) |
WO (1) | WO2018063915A1 (en) |
Families Citing this family (9)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
EP3614366A4 (en) * | 2017-11-22 | 2020-12-23 | Micware Co., Ltd. | Map information processing device, map information processing method, and map information processing program |
US11330030B2 (en) * | 2019-07-25 | 2022-05-10 | Dreamworks Animation Llc | Network resource oriented data communication |
US11182949B2 (en) * | 2019-07-25 | 2021-11-23 | Dreamworks Animation Llc | Pack tile |
CN112053280B (en) * | 2020-09-04 | 2024-04-12 | 北京百度网讯科技有限公司 | Panoramic map display method, device, equipment and storage medium |
US11755845B2 (en) | 2021-06-18 | 2023-09-12 | International Business Machines Corporation | Automated process for generating natural language descriptions of raster-based weather visualizations for output in written and audible form |
US11455089B1 (en) * | 2021-07-26 | 2022-09-27 | Quantarium Group, LLC | Smart mapping |
CN117128947A (en) * | 2023-03-13 | 2023-11-28 | 荣耀终端有限公司 | Grid map generation method and server |
CN116164758B (en) * | 2023-04-26 | 2023-11-03 | 九识(苏州)智能科技有限公司 | Method, device, medium, equipment and system for updating high-precision point cloud map |
CN117171288B (en) * | 2023-11-02 | 2024-01-12 | 中国地质大学（武汉） | Grid map analysis method, device, equipment and medium |
Citations (1)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN105393282A (en) * | 2013-05-15 | 2016-03-09 | 谷歌公司 | Efficient composition and rendering of graphical elements |
Family Cites Families (19)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US8843850B2 (en) * | 1999-07-22 | 2014-09-23 | Tavusi Data Solutions Llc | Graphic-information flow for visually analyzing patterns and relationships |
US20030231190A1 (en) * | 2002-03-15 | 2003-12-18 | Bjorn Jawerth | Methods and systems for downloading and viewing maps |
US7107285B2 (en) * | 2002-03-16 | 2006-09-12 | Questerra Corporation | Method, system, and program for an improved enterprise spatial system |
US7373244B2 (en) * | 2004-04-20 | 2008-05-13 | Keith Kreft | Information mapping approaches |
US7925982B2 (en) * | 2006-09-01 | 2011-04-12 | Cheryl Parker | System and method of overlaying and integrating data with geographic mapping applications |
US7734412B2 (en) * | 2006-11-02 | 2010-06-08 | Yahoo! Inc. | Method of client side map rendering with tiled vector data |
US20100321399A1 (en) * | 2009-06-18 | 2010-12-23 | Patrik Ellren | Maps from Sparse Geospatial Data Tiles |
US8223172B1 (en) * | 2011-09-26 | 2012-07-17 | Google Inc. | Regional map zoom tables |
US8560600B2 (en) * | 2011-09-26 | 2013-10-15 | Google Inc. | Managing map elements using aggregate feature identifiers |
US20130093750A1 (en) * | 2011-10-12 | 2013-04-18 | Google Inc. | Use of banding to optimize map rendering in a three-dimensional tilt view |
US8243102B1 (en) * | 2011-10-12 | 2012-08-14 | Google Inc. | Derivative-based selection of zones for banded map display |
US8896630B1 (en) * | 2011-10-24 | 2014-11-25 | Google Inc. | Keeping map labels consistent across multiple zoom levels |
US9305107B2 (en) * | 2011-12-08 | 2016-04-05 | Google Inc. | Method and apparatus for pre-fetching place page data for subsequent display on a mobile computing device |
US9441975B2 (en) * | 2012-06-05 | 2016-09-13 | Apple Inc. | System and method for generating signal coverage information from client metrics |
US9429435B2 (en) * | 2012-06-05 | 2016-08-30 | Apple Inc. | Interactive map |
US9396508B2 (en) * | 2013-05-15 | 2016-07-19 | Google Inc. | Use of map data difference tiles to iteratively provide map data to a client device |
US9201898B2 (en) * | 2013-05-15 | 2015-12-01 | Google Inc. | Efficient fetching of map tile data |
US20150188977A1 (en) * | 2013-11-04 | 2015-07-02 | Google Inc. | Verifying Content Rendering on a Client Device |
EP3120340B1 (en) * | 2014-03-15 | 2019-05-08 | Urban Engines, Inc. | Solution for highly customized interactive mobile maps |
-
2016
- 2016-09-27 US US15/278,018 patent/US10319062B2/en active Active
-
2017
- 2017-09-21 CN CN201780059808.9A patent/CN110832278B/en active Active
- 2017-09-21 WO PCT/US2017/052741 patent/WO2018063915A1/en unknown
- 2017-09-21 EP EP17778422.0A patent/EP3519769A1/en not_active Ceased
Patent Citations (1)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN105393282A (en) * | 2013-05-15 | 2016-03-09 | 谷歌公司 | Efficient composition and rendering of graphical elements |
Also Published As
Publication number | Publication date |
---|---|
US10319062B2 (en) | 2019-06-11 |
EP3519769A1 (en) | 2019-08-07 |
WO2018063915A1 (en) | 2018-04-05 |
US20180089791A1 (en) | 2018-03-29 |
CN110832278A (en) | 2020-02-21 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
CN110832278B (en) | Rendering map data using descriptions of grid differences | |
US10424111B2 (en) | Split tile map rendering | |
US9417777B2 (en) | Enabling quick display transitions between indoor and outdoor map data | |
US9811879B2 (en) | Keeping map labels consistent across multiple zoom levels | |
US8237745B1 (en) | Label positioning technique to reduce crawling during zoom activities | |
CA2820284C (en) | Architectures and methods for creating and representing time-dependent imagery | |
US20140347383A1 (en) | Map rendering using interpolation of style parameters across zoom levels | |
JP4251218B2 (en) | Information processing apparatus, image display apparatus, information processing system, control method therefor, and program for causing computer to execute the method | |
US9134886B2 (en) | Providing indoor facility information on a digital map | |
US20120050285A1 (en) | 3d building generalization for digital map applications | |
US8294710B2 (en) | Extensible map with pluggable modes | |
US9721363B2 (en) | Encoding polygon data for fast retrieval and rendering | |
US20150332481A1 (en) | Indexed uniform styles for stroke rendering | |
Fukuda et al. | Improvement of registration accuracy of a handheld augmented reality system for urban landscape simulation | |
TW200926056A (en) | Geospatial data system for selectively retrieving and displaying geospatial texture data based upon user-selected point-of-view and related methods | |
Yu et al. | A hybrid system of expanding 2D GIS into 3D space | |
Wu et al. | GPU ray casting method for visualizing 3D pipelines in a virtual globe | |
JP7086180B2 (en) | Dynamic styling of digital maps | |
CN113495933A (en) | Vector tile display method and system | |
US20230065027A1 (en) | Gpu-based digital map tile generation method and system | |
US20190156465A1 (en) | Converting Imagery and Charts to Polar Projection | |
JP4672493B2 (en) | 3D graphic display device and 3D graphic display method | |
Liu et al. | An effective spherical panoramic LoD model for a mobile street view service | |
Bektaş et al. | Survey of true 3d and raster level of detail support in gis software | |
US20150242992A1 (en) | Blending map data with additional imagery |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
PB01 | Publication | ||
PB01 | Publication | ||
SE01 | Entry into force of request for substantive examination | ||
SE01 | Entry into force of request for substantive examination | ||
GR01 | Patent grant | ||
GR01 | Patent grant |