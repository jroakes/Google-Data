Safe wireless e-commerce system with wireless network domains
The application is to be on February 22nd, 2000, denomination of invention to be the applying date for " the safe wireless e-commerce system with wireless network domains ", application number: the dividing an application of 00805563.7 Chinese invention patent application.
Invention field
The present invention relates to secure e-business issue and sell, have with a kind of than in the past more simply, more fast and more inexpensive method provide software to strengthen and the ability of new feature.Secure e-business combines three critical functions: reprogrammable software or other content (also be commonly referred to as " product ", comprise service); Wireless data service; And safety (encrypting the & checking).
Background of invention
Secure e-business uses the convenience of wireless data service available in the phone as the client a kind of method that in their phone, increases or change characteristic to be provided.And the client can realize these purposes in a few minutes, and the family or the commercial affairs that are suitable for the client are used.
Secure e-business provides lot of advantages, comprising: the easier issue, sale and the income that are used for the software specific features are collected; It is out-of-date that flexible and upgradeable telephony platform-this has reduced; Prevent theft-of-service and clone's ability; More reduce Cost of Guarantee under the news at the software Hotfix; The convenience of wireless reprogrammed.
Summary of the invention
In one aspect; The present invention provides a kind of transaction method of in the wireless E-commerce system, carrying out; Wherein this system comprises that a wireless carriers certification authority with root public-key certificate has the attribute mechanism of the digital certificate that is independent of the root public-key certificate with at least one, and wherein attribute mechanism can be visited through a wireless network by a wireless client device.Digital certificate is sent to wireless device by dependency mechanism, and under the mandate of wireless carriers, wireless client device uses the digital certificate and the root key certificate of preloaded in the wireless client device that attribute mechanism is verified.Be sent to wireless client device to an attribute (software, service, right/permission or other content item) through wireless network, and finally launch in wireless client device.
Can come the payment of attribute is concluded the business through transmitting one second digital certificate and use this second digital certificate of root public-key certificate checking to attribute mechanism from certification authority from wireless client device.
In yet another aspect, the present invention provides a kind of transaction method of in the wireless E-commerce system, carrying out, and comprising: between the wireless client device and the first attribute mechanism, set up a radio communication; Be sent to wireless client device to first attribute through wireless network; Producing one can be by the electronic certificate of second attribute mechanism checking; Between the wireless client device and the second attribute mechanism, set up radio communication; Ask second attribute to the second attribute mechanism; At the second attribute mechanism this electronic certificate of identification; Be sent to wireless device to second attribute from the second attribute mechanism.
Can be sent to the second attribute mechanism to electronic certificate from the first attribute mechanism through a connection between the first attribute mechanism and the second attribute mechanism, perhaps can comprise through wireless client being sent to the second attribute mechanism to electronic certificate from the first attribute mechanism.
A wireless E-commerce system has also been described.
List of abbreviations
AA attribute mechanism
The API API
CA certification authority
DER distinguishes coding rule (ASN.1)
The EC elliptic curve
The GSM global system for mobile communications
The ID identifier
The ME mobile device
PER compressed encoding rule (ASN.1)
The PIN Personal Identification Number
The PK public keys
The PKI Public Key Infrastructure
RA registration body
RSA RSA (Rivest, Shamir, Adleman) public key algorithm
SHA-1 SHA 1
The SIM Subscriber Identity Module
The SMS Short Message Service
The WAP WAP
WIM wireless identification module
The WML WML
WMLScript WML script
The WDP Wireless Datagram Protocol
The WTLS Wireless Transport Layer Security
The accompanying drawing summary
Fig. 1 is the block scheme according to the safe wireless e-commerce system of first aspect present invention.
Fig. 2 is that the software of the wireless client device of presentation graphs 1 is installed and the process flow diagram of setting up procedure.
Fig. 3 is illustrated in the scene perhaps to launch the process flow diagram of the process of the software in the wireless device to software download at the scene to wireless device.
Fig. 4 is the block scheme according to the safe wireless e-commerce system of second aspect present invention.
Fig. 5 is the process flow diagram of operation steps of the system of presentation graphs 4.
Accompanying drawing specifies
The overall safety model adopts encrypts API and the bottom Encryption Tool case that basic unit's security feature is provided; Can set up other stack layer above that; Wireless Transport Layer Security (WTLS) API for example, certificate standardization and such as the wireless applications of wireless application protocol (wap) browser.Each entity and the relation of Fig. 1 display system.
The computing machine (dialing, Ethernet, cable or the like) 13 of client through using wireless telephone 11 or other wireless device and land line phone 12 or internet accessible is connected with secure e-business system 10.Various servers 15,16,17,18 in the system 10 are carried out the task of secure e-business.No matter be directly to connect 13 visits through the Internet, also be to use a routine call 12 and operator's talk, the client can be input to the secure e-business system 10 on the Web server 16 to an order.
Web server 16 is communicated by letter with certificate agency server 15 to issue a new product certification.This certificate will guarantee only to have target phone 11 can obtain and use new feature.Because this phone comprises a product certification from software server 17 (in manufacturing plant time) at first, in the term of life of phone, will keep an audit-trail, or responsibility.According to the content of certificate, phone 11 can not be operated the software that it is not allowed to.System 10 also comprises a copy of the certificate of this phone, so it has the record of the powers and functions of this phone.
Certificate agency server 15 is servers that in the secure e-business system, produce and issue public-key certificate and license passport.
License passport allows the software product of the operation of equipment appointment such as wireless telephone.Leave before the manufacturing plant and subsequently when buying new software to the equipment issue licenses book of each production.License passport comprises the part of the sequence number of this equipment as data, and when digitally signing these data by CA, data will only be given the phone with this sequence number right to use software license, be unmodifiable and in design, make sequence number.Therefore, these certificates can only be used by target side, and any other side can't use.
The public-key certificate equipment that makes can break the wall of mistrust through CA.CA digitally signs this certificate, states that one has the following public keys that is associated with it by what its sequence number was represented to locking equipment.
Web server 16 is the front-end servers that are used for the secure e-business system.It can be a series of servers (that is, order processing or the like is chargeed in order input), but is considered to an entity conceptive.This server comprises order entry system, and the client is through this system's input order.Can carry out online ordering or utilize phone to order through the WWW through operator.This server is accomplished the order input through the information (user name, Equipment Serial Number, credit card or the like) of at first verifying the user.Then, Web server sends to CA to a request to the new permit book.CA sends to this equipment to license passport.License passport can send by CA " release " or under the requirement of this equipment.Now, this equipment is held new license passport, and has been authorized to use new software.
All software products that software server 17 is sold the supplier of system/operator can be used.It can be a series of servers, comprises various manufacturing planies server, but is considered to an entity conceptive.The function of software server 17 is digitally to sign software product, and software product and respective certificate (being known as product certification) can be downloaded.
The function of WAP Proxy Server 18 is to be the HTML syntactic translation WML sentence structure (the Internet is to wap protocol), and vice versa.
Certificate is the foundation stone of secure e-business system; The description of digital certificate can be found in following source: American National Standard draft X9.68-199x: " be used to move, based on the digital certificate of account and high transaction volume financial sector "; From combination with standard portion of man of Bank of America-National Trust & Savings Association; 1120Connecticut Avenue, NW Washington DC 20036.
Variety of protocol in the secure e-business system 10 is operated (perhaps reading/certificate of analysis perhaps increase/modification/deletion certificate) with technology to certificate.Each equipment in the system (server 16,17 and 18 with wireless device 11) has one or more certificates.They all have one and put letter root certificate, and this certificate is the public-key certificate from the CA of CA server 15.In this case, just can the deployment secure e-commerce system.
Be description below to basic certificate type and the use of certificate in the phone term of life.
Public-key certificate comprises the information of relating to wireless device 11 its public keys.This accomplishes through carrying out hash to related data.This certificate comprises above-mentioned data and hash result.The people whether any this public keys of hope checking belongs to this equipment only needs these data are carried out hash once more, and verifies that it is matched with the hash result of storing with certificate.
In addition, hash is digitally signed by a certification authority.In this model, CA is the certification authority of putting letter.That is, sign aforementioned hash result with the private key of CA.Any people with the public keys that is used for CA can verify the hash of this encryption.Subsequently; If the hash results match of checking is in the hash of the certificate data of user's calculating; This tells user (i) because the public keys of CA can correctly be verified the hash of signature; This certificate is necessarily by the CA signature of putting letter, (ii) because the private key of object can verify that this certificate belongs to this object by the data of public keys signature.
License passport comprises the information that is associated wireless device 11 with some right to access.Specifically, license passport comprises the field that is used for software product and Equipment Serial Number at least.The software product field comprises a product identifiers.This identifier gives permission of this equipment and uses this product.If the internal sequence that embeds in equipment number is matched with the sequence number of license passport, this equipment can move the software product of appointment.As in the public-key certificate, the data in the license passport are signed by hash and by CA.Because this equipment can not be to this certificate of signature check (only if CA suffers damage) of CA, this equipment can not be verified the license passport of forgery.
Product certification is associated a content item or main body (for example software product name) with a fingerprint.In the case, fingerprint is the hash of software product.Therefore, any people with a software product and products thereof certificate can be through comparing the hash result of storing in the hash of this software of user's calculating and the certificate come the integrality of verifying software.With the same in public-key certificate, the hash result in the product certification is digitally signed by Motorola CA.Therefore, when the user compares the hash result of hash of calculating and product certification, coupling mean this software product and Motorola CA the product of digital signing be same.
Described various infrastructure device and certificate role in system, the deployment way of secure e-business system will be described now.
Use the simple descriptive system of the example that equipment was taken place how to work with the lower part.Select the example of a phone, be included in when in the manufacturing plant phone being set what takes place, when the user starts and use phone, what takes place, and when the user hopes to obtain a new feature, what takes place.
Each phone in the manufacturing plant had some built-in unique trait before delivery.Physically, phone must comprise: the ROM that (i) can be used for moving unmodifiable certification authentication code; (ii) can be used for Store Credentials EEPROM (visit of cert storage area must be limited) and (iii) unmodifiable unique sequence number (perhaps at ROM, laser ablation, write once memory, or the like in).
In manufacturing plant, for phone produces a public-key certificate (step 100 of Fig. 2).This can be by software server 17, CA server 15, or produce by phone self.CA server 15 is self-signing certificate and keep one of which copy (step 101) digitally.Installation has the phone (102) of public-key certificate of himself public-key certificate and CA.(as its certificate of CA signature of root certification authority).The key hypothesis is meant in manufacturing plant, have to put a communication network.In this environment, the generation of the public-key certificate of phone, it is by the signature of CA, and the transmission of the public keys of certificate and CA in phone is considered to safe.
Also issue one or more license passports (step 104) in manufacturing plant.Manufacturing plant sends a request with signature license passport (step 105) to CA server 15 (the perhaps software server 17 under the root mechanism at CA server 15).Manufacturing plant provides the sequence number of CA information and phone, and wherein this CA information is the information that should have which software license or product about this phone.License passport comprises following information: (i) sign of CA (issuer); The (ii) sequence number of phone (main body); (iii) this phone is permitted the tabulation of the software product of operation; (iv) (with the private key encryption of CA) summary (software hash) of said modules signature.In step 106, be installed in license passport in the phone.
License passport can comprise a plurality of permissions in a certificate, perhaps a plurality of license passports can be arranged, permission of each certificate.Two kinds of methods all allow.CA self will keep a copy of the license passport of phone.
Now, phone gets into the software programming stage.Phone must comprise the software of various amounts according to the content of ordering, and-some basic versions add (optional) supplementary features.Manufacturing plant must be installed to correct software package in the phone.Software package comprises that software self adds a product certification (perhaps more generally, a content item certificate).Software server 17 is to produce a product certification (step 110) as each software product under the same mechanism of CA.Software and product certification all are stored on the software server 17.Software server 17 is in charge of software product and is made them can be used for downloading.At step 112 install software bag and certificate (being the software of digital signing) thereof.
The purpose of certificate is that (promptly related) interrelates with specific names (for example software product name and main version name) software product.The form of this association can be the predefine regular (for example allowing the browser version 1.x of all the future version browsers between version 1.0 and the version 2 .0) that of the ProductName that is associated with the certificate of ProductName searches the new product name that tabulation and a sign allowed.Certificate comprises the title of software and the hash of software product.How to hope to check the people of the integrality of this software to carry out hash and compare a hash that finds in it and the product certification to this software.Certificate is signed by software server.Software server self has a public-key certificate by the CA signature, has so kept a belief line.
Product certification comprises following information: (i) sign of software server (issuer); (ii) software product name (main body); The (iii) hash of software product; (iv) (with the private key encryption of software server) summary of the signature of said modules.
A copy of software server 17 retained product certificates.Should be noted that the function of CA 16 all right executive software servers 17, CA will be responsible for all certificates of three types in the case.
When leaving manufacturing plant, phone is equipped with: (i) public-key certificate of CA; The (ii) public-key certificate of phone; (iii) one or more license passports; (iv) one or more product certifications.
Series of steps, the user just takes place when starting phone.At first, its all product certification (step 130) of the startup software test of phone.That is, be that each software product in the phone calculates hash, and with certificate in the hash of storing compare.And, must set up belief line to CA.Because product certification is by software server rather than by the CA signature, phone will obtain the public-key certificate (this should only take place once, and phone will be stored in the public-key certificate of software server in the storer afterwards) of software server from CA.Then, its all license passport of the startup software test (step 135) of phone.This be the unmodifiable sequence number of phone and with license passport that product is associated in compare between the sequence number stored.If their couplings allow the software product that identifies in the phone operation license passport so.The software product that identifies in this certificate must be matched with the software product file-name field in the product certification.In two steps, the startup software of phone compares the public-key certificate of the digital signature of certificate and CA (in manufacturing plant, installing) to guarantee not install the certificate of forgery.
Under the situation of user's desired modifications phone, for example launch an option or buy a new feature (seeing following Example), obtain a new license passport with software product self and products thereof certificate.Following steps take place.At first, the user buys this characteristic through Web server 16.Through phone or world wide web access, the user offers Web server 16 to necessary information, the product (step 16) that comprises the sequence number of name, address, credit card number, phone and hope to buy.Web server 16 these information of checking also produce an order ticket that also is given the user.Suppose to have checked client's credit, Web server 16 sends to CA server 15 to the sequence number of phone together with the title of purchase software product, to obtain a new license passport.Make this license passport can download to phone (step 204).The user can start a sequence to obtain this certificate.This new permit book of phone check.If the install software product still is not activated (not having license passport) in manufacturing plant, it will be activated (step 220).If in phone, do not find software product, will send a request to software server to obtain this product (step 226).
As an optional step; Software server 17 can be configured to only send the software product of encryption to the user who verifies, so that prevent the overload of wireless network and prevent that unauthorized user from obtaining software code (although phone can not move this software under the situation that does not have the valid license book).This accomplishes through between software server 17 and phone 11, set up a WTLS connection through WAP Proxy Server 18.Each side has a public-key certificate by a public CA signature, makes them trust the other side's certificate.Use a Diffie-Hellman, derive a key and use it for software product and product certification are encrypted.Then, software server sends to phone to software product and product certification aloft, and this product certification of phone check should be bought then and accomplish.
Notice that in this model if download is interrupted or software is bad, the user can attempt downloading any number of times again.
Must be sent at phone under the situation of a repair shop, it is effortless having a plurality of characteristics can make renewal or modification to phone in the secure e-business system.For example, if for a certain reason, issue the user to a different telephone, repair shop should transfer to all the elements of existing telephone (software and product certification) in the new phone.Before producing one group of new permit book for the sequence number of new phone, this new phone can not operating software.Repair shop uses its public-key certificate to show the right that it has as evidence to CA, thereby to CA request new permit book.The license passport of CA record existing telephone.For new phone is issued the new permit book, and be put into the license passport of existing telephone in the certificate revocation lists.If for a certain reason, repair shop need copy to software in the new phone, and can't from existing telephone, duplicate this software, still can download this software (and product certification) from software server as previously mentioned.
Through realizing this secure e-business system, can be sent to phone to the software of new feature, renewal and software Hotfix with timely effective and efficient manner for the client.The client can realize that required almost is to make a profit instant cycling time from the easy property of executing the task and its.And the security feature of building in the system will reduce theft-of-service or clone's generation.
Following Example help to be explained in some real world potential solution available in the secure e-business environment.
Example 1-obtains the current application program that is not present in the phone
A user is just also hoping to use on the phone at them the German/English Translation device of a speech excitation in overseas trip.This user can buy this German/English Translation device software product from producer or vendor.This user will download to this application program in the phone, and on phone local ground, rather than foundation structure operation this German/English Translation device through the ISP.If the user plans often to use this characteristic, the cost efficiency of above-mentioned way is higher.The user has a kind of sense that has.As long as the user holds this phone, it just has this software.This software local operation in phone.The user is without this characteristic of aerial use, thereby eliminated any potential end of service condition, bandwidth or through the amount problem, or unexpected foundation structure fault-time.The user is that this characteristic is to producer or dealer rather than ISP's paying.
Example 2-strengthens telephony feature
A user hopes can use the characteristic of storing in the phone through downloaded software (if phone does not comprise this software when buying) or through making, can use present new Web-browser available on phone.The user connects Web server 16 (or 1-800 number), buys the additional option of phone according to instruction, and waits for that a bit of time downloads or launch the software with new Web-browser function.The user has obtained instant satisfaction through using this characteristic in a few minutes after buying.Because it is lower to offer the required system overhead of user to this characteristic through electronic download, so the cost of this characteristic is lower.Because certificate agency should be concluded the business through 15 checkings of CA server, in fact can eliminate theft-of-service.
Example 3-software Hotfix upgrades
Be published to a software Hotfix in the zone (for example, under free assurance) that will in existing telephone, install.How the indication user starts this phone begins a download that comprises this update software.Another option is that the ISP can automatically upgrade phone when phone is served, know this upgrading and need not the user.The user need be the actual maintenance depot that returns in this unit.The renewal of subscriber phone be according to minute rather than the fate that in maintenance depot, spends carry out.An instant electronical record of software download is retained in the system 10, rather than relies on the on-site maintenance report.Some upgrading can need not user's agreement and carry out automatically, thereby eliminates any service disruption.Its cost is minimum, because in this process, do not relate to any maintenance depot.
Example 4-metering service
User hope travel to and fro between work during use the audio books in his automobile.This user can buy an audio books there from an ISP.Utilize a secure data service that allows metering service (perhaps every book or per minute) to connect and obtain the right to use.In other option, two-way communication allows user's time-out/continuation transmission.This is one is not having irrealizable new COS under the situation of secure e-business.
Therefore, the wireless E-commerce system of having described has the radio network gateway 18 to wireless network 19, and the wireless client device 11 with a unique voip identifiers utilizes wireless network 19 to communicate.Described at least one server and can be coupled to radio network gateway, content item digital content certificate that is sent to wireless device and keeps these content items and the digital permission certificate that is used to permit these content items.In a preferred embodiment, server 17 transmits content, and CA server 15 keeps the digital permission certificate.This at least one server is permitted the record of associated content project for each wireless client that is associated with this system keeps a permissions records that is used for this client and one with each.In other words, CA server 15 keeps a database or tabulation, and is wherein relevant and comprise and permit associated content project (for example software product) the permission of wireless client ID and each Customer ID (but perhaps certificate).
Described when a new content item is associated with an existing digital permission certificate that is associated with voip identifiers, wireless client can be asked the digital permission certificate checking of this new projects' content.Preferably through being reloaded into content second wireless client with second identifier, the content replication of first wireless client with first identifier to second wireless client; In at least one server, with one between the respective record of second identifier and first client permission and first client's content item new related replacement first identifier and first client permits and the respective record of first client's content item between first related; And be second customer authentication, first client permission and first client's content item, thereby second client can bear first client's function.
Also described a kind of method of operate wireless e-commerce system, having comprised: kept at least one server, be used for the digital content certificate of content item and be used for the digital permission certificate with the permission of associate; For keeping record and one of a permission that is used for this client, each wireless client that is associated with system permits the record of associated content project at this at least one server with each; Between at least one server and wireless client device, set up communication through radio network gateway; Be sent to content item the wireless device that has unique identifier in the system; Utilize at least one server authentication content item; Verify a permission with associate; When having verified content item, launch this content item at the wireless client place with permission.
When a title that is used for content item and a digital permission certificate that is associated with the unique identifier of wireless device are related in advance, preferably verify the permission of this content item.Alternatively; The title of this content item satisfies the predefine rule of the digital permission certificate that is associated with the unique identifier of wireless device; For example, it falls into the scope of the version number that allows, and shows that it is a upgrading with the preparatory content associated project of digital permission certificate.
Described secure e-business system provides a solution, makes it possible on wireless network, carry out software marketing.This system be for the client provide E-business service strong, efficiently with user-friendly method.
Said system has a wireless application protocol (wap) server or gateway 18, but should be appreciated that can use any radio network netgate, WAP only is a kind of agreement easily.The alternative aspect of present descriptive system, it also in the wap protocol environment, should be appreciated that, can use other agreement.
The WAP server of safe wireless e-commerce system and the further details of WAP layer are described now.In the file " WAP framework standard " [WAPARCH] of the WAP Forum on April 30th, 1998, one group of wap protocol in transmission, safety, affairs, session and the application layer has been described.The WAP security function comprise on April 30th, 1998 WAP Forum Wireless Transport Layer Security [WAPWTLS] and can use the application layer security of WML script [WMLScript] visit.The safety that provides among the WAP can be multiple rank.In the simplest situation, use Anonymity Key to exchange the generation that is used for an encryption channel between server and the client; In next stage, server provides one to the certificate that returns an entity that is mapped to customer trust; At last, client self can have a private key and public-key certificate, make other entity identification that it can be in network himself.Be described in more detail below the required foundation structure and the process of putting gateway system of checking that is used to realize server and client.Term used herein " server " is not limited to a special-purpose WAP gateway, and can comprise third party and the content/ISP who uses wap protocol.Can be at URL:http: //www.wapforum.org/ finds above-mentioned and standard other wap protocol layer.
Except above-mentioned file, can be with reference to following content: " Wireless Control Message Protocol standard " [WAPWCMP] of the WAP Forum on April 30th, 1998; The WAP identification module standard [WIM] of the WAP Forum on March 12nd, 1999; The ANSI draft on March 1st, 1999 is used to move, based on digital certificate [X968] account and financial sector high transaction volume; In February, 1998, IEEE P1363/D1a (draft version 1a) [P1363], " standard criterion that is used for public-key encryption ", URL:http: //grouper.ieee.org/groups/1363/; In November, 1993, PKCS#1:RSA encryption standard, version 1.5 [PKCS1], RSA laboratory; In November, 1998, PKCS#15: with crypto token information standard [PKCS15], working draft version 1.0, RSA laboratory.
In order to describe the further aspect of e-commerce system, following content is described: security domain; The attribute that will issue in this system/protect; Distribute to the attribute entitlement (it should be noted that some attribute is by having more than a territory) in territory; Foundation structure with the distribution of the registration that is used for the territory member and checking and attribute.
" territory " or " security domain " be one under single mechanism controls and use the inside nomenclature scheme of a definition, the Public Key Infrastructure of algorithm and strategy.Territory mechanism is that a territory root certification authority with global unique name flows.This allows the territory to produce agreement and is joined together to form a global PKI.This entity that the public keys that in the territory, has through entity of authentication is registered in the territory is one " territory member ".Below be possible WAP territory, some in them or all will be mentioned: manufacturing plant; Network; Operator; The wireless service supplier; Content/ISP (for example, banking territory); Put the third party territory (for example, independently authentication proxy or mechanism) of letter; Equipment owner (automobile transportation provider domain); And equipment user (individual territory).
" attribute " is a characteristic (can be considered to a title) or a right (that is, a permission for example allows to use a service of being bought).The example of attribute is that the object that has (for example catalogue and file, hardware and interface) and the right/permission that has (are for example called out; Setting up network connects; Send SMS message; Read/write/updating file and catalogue; Configuration device hardware; Accesses network management station.
In order to realize this security infrastructure, 10 registrations of WAP public key systems and checking WAP territory member, and issue attribute.Notice that " issue " speech comprises " being published to the buyer "; That is, the user can buy attribute, perhaps service in for example using.
WAP PKI foundation structure comprises a plurality of discretionary securities territory that links together through cross-certification.This cross-certification is the part of the service roaming agreement between ISP and the system operator.The cross-certification process is made by two territory root CA and is used for issuing each other cross-certificate; Thereby authorize mutual root certificate (key).Cross-certificate comprises the address of one or more intermediate field check servers usually, and can comprise and the relevant out of Memory of cross-certification agreement.For the wireless technology industry, cross-certification can be similar with the generation of roaming agreement.In a security domain, the algorithm in this territory, nomenclature scheme and strategy are confirmed by the owner in this territory.During the cross-certification process, reach an agreement on interoperability issue in each territory, and the configuration check server is to allow to carry out the certificate check.
The classification of WAP operation is: classification 0: anonymous authentication only; Classification 1: only server authentication; Classification 2: server and customer authentication.Do not pay close attention to classification 0 here, because it does not relate to PKI.Classification 1 relates to the checking of server to client.These servers can be had by the wireless service supplier, perhaps can be the third-party server that service is provided in network.Through being included in these third-party server among the WAP PKI, the wireless service supplier representes the special state of the approval of these services or mark.Classification 2 operations allow a client (mobile subscriber) to be registered as a member in the territory and obtain the interests in this territory.This possibly relate to and third-party specific agreement, for example discount or special service.Can issue the little Attribute certificate that interrelates with their territory private key to the territory member, this certificate representes that service or the special rights bought are permitted.
Attribute certificate has two types: service or the product certification (i) bought just look like every month order, and do not need the special program of cancelling; (ii) system operation allows, and this is issued the attribute with the special system configuration right that allows the user.A kind of attribute in back can use or be presented to authorized user by wireless service supplier office worker.
Several territories below have been described.The use in some territory in these territories is described now.
Equipment owner territory is a territory that need not to relate to the wireless service supplier, is used to be provided with equipment user and user's overview/privilege.This can accomplish in the following manner, that is, let the ISP give ISP's domain identifier of equipment owner and attribute so that revise their account configuration.Perhaps, the equipment owner can become an attribute mechanism in the ISP territory.Although the equipment owner need issue certificate so that allow them that some right is arranged to the office worker in big Automobile Transportation Company, the equipment owner preferably has his territory, and the equipment owner is not the territory that necessarily needs him.Although owing to for required function more simply device (using the ISP territory) can be arranged, do not expect just to adopt at first equipment owner territory, this system has also provided equipment owner territory.
The manufacturing plant territory is used for equipment bootstrapping, equipment OS code upgrade and characteristic.
The wireless service supplier territory and/or the network operation quotient field can be used for the WAP gateway authentication, content provider's authentication, and the user characteristics issue, User Recognition (getting in touch) with the account, the WTA script, air system is revised, and issues certificate to allow system configuration to the office worker.Content/ISP territory can be used to have the entity (for example bank) of awareness of safety to move their territory, carries out cross-certification to utilize the operation of ISP territory, perhaps directly registers the wireless user.
Notice that a user can be the member (key with an authentication) in any territory.A territory is used to issue certificate to permit other side in the system; Can on equipment, control in a simple manner should permission.
Here will be to the ISP with reference to the focus of the further discussion of figure 4, Virtual network operator and manufacturing plant territory.
Fig. 4 representes a CA 400 (being embodied as a server).Certification authority be one in response to from the checking request of legal registration body and issue/upgrade/recall the entity of the certificate that has public keys.CA holds a private key, and this key is used to sign the certificate that has territory member's key.CA also produces client's bills through charging computer 402 by a wireless service supplier or Virtual network operator management through radio network controller 401 controls and operate wireless network.
A plurality of attribute mechanisms 404,405 and 406 (shown three, but can have a lot) have been shown.Attribute mechanism is an entity, produces the certificate of giving the territory member attribute assignment.Its example can be a mobile phone manufacturing plant 404, bookman 405 and wireless software supplier 406.
AA can communicate by letter with terminal user (client) equipment 450 through radio network gateway 420.
Customer equipment 450 best (but be not must) has a subscriber identity module (SIM) 452.This is a smart card in the wireless system, contains user identification and verification information.SIM can also be used to move the application program that needs security context.Customer equipment preferably also has WAP identification module (WIM), so that for service and the data storage service relevant with the use of WAP safe floor an interface is provided.WIM uses PKCS15 as Format Object.WIM can be an interface layer to SIM 452, and perhaps it can be to have SIM or other card that carries the WIM interface above that, or a software token on the wireless device 450.
The all items of Fig. 4 belongs to territory 500, and territory 500 is a wireless carriers territory in the present embodiment.Territory 500 can have higher registration body, and this registration body is one and is authorized to ask issue/recall/entity of new authentication more to CA or AA.Registration body can be considered with an account manager similar on function, and responsible member registration and/or attribute assignment.Enrollment process is, through issuing the territory certificate that comprises user's public keys, makes this key of authentication in a territory.
Server 400 is check servers.The check server is one and is configured so that check the server of territory member's certificate.The territory of carrying out cross-certification is supposed to provide addressable check server, and these check servers obtain and the certification of proof chain.When existence had the territory of local nomenclature scheme, this service was important.Because these schemes may not be understood by an external domain, be necessary to provide the check service.Being configured to the check server of communicating by letter with one or more external domains is to check server between a territory.In addition, but the check server can be territory members for those self not have acquisition and check the thin client of the ability of a certificate chain that the local domain check is provided.
Might in system, store a plurality of wireless service suppliers territory.If a client utilizes WIM tag card (having individual and key information on it) in a system, to switch the supplier, some problem can appear.If the user only obtains another card from new supplier, all personal information will be lost so.Therefore, the best practice is (but not necessarily), from the personal information that is independent of the ISP, separates ISP's specific information.Preferably, also provide a device to produce a WIM software token that will be used for a new WIM card of initialization by the user.
Hope the commercial company to mobile subscriber's sale service or content for some, the security domain with them is favourable.Consider that from the risk management reason this is necessary for some financial service.The key in these territories must separate with other territory with application program, makes that the owner be sure of any distorting can not be arranged.Although might in WIM, store certificate and the key from any territory, this separation can realize with the multiple mode that need not to describe.Except the separation to storage object, equipment must guarantee that the territory application program is not distorted.
Any territory member possibly become an attribute mechanism.The wireless service supplier is published to dealer to the system management attribute, these dealer by in the territory of including them in the attribute of selling them-promptly, sell the service ticket (for example, be used for above-mentioned new software, perhaps be used for perhaps service in other) of a purchase.
Three type of effective loads are arranged: compact service load, organize the special-purpose service load in service load (WAP service load wherein is a type) and territory (only effective in local domain).
For the dealer definition that makes operation A A server 404-406 is used for the simple attributes of the service/content that their sell, need a method represent that a given attribute service load is dealer's service load and representes this particular Seller.Because the expection service load can not understood by in addition anyone of dealer, the practical structures of service load is inessential.The methods that three kinds of identification dealer attribute service loads are arranged: if (i) dealer has an organization identification symbol, it can be in this identifier its type of giving a definition; (ii) dealer's sign symbol can be assigned with under WAPOID; (iii) the ID of a dealer scheme can and be adopted for the special-purpose service load definition in their territory in the territory.
Attribute certificate preferably limits if having time, that is, have time expiration and will carry out regular update.In the random time of a certificate of check, expire if digitally embed the time expiration of this certificate, then should the check failure.
A mobile client perhaps periodically utilizes the validity of a vendor server of Network Check (404-406) when using for the first time.Client's (wireless device 450 or SIM 452 can be considered to a client) is for this purpose through radio network gateway 402 contact check servers.In addition, the wireless service supplier can offer a website, enumerates out the state of territory dealer.Whether this website can also refer to illustrate this dealer no longer has been a territory member who puts letter; That is, their certificate has been recalled.
With reference now to Fig. 5 describe dealer (that is, AA) or other NE with ability of AA be sent to a client to content and receive the step of the paying of this content.
At first, a client (450 or 452) connects through radio network gateway 420 and AA server 404 in step 510.AA is sent to the client to a digital certificate in step 515.This client is at this AA certificate of step 520 checking.This proof procedure that carries out in the customers' place is identical with other certification authentication mode of having described, and can realize, because the client has installed the public-key certificate of CA 400.It uses this public-key certificate to verify AA.The reason of this checking is, because the client hopes to confirm that this AA is trusted by the wireless service supplier.This will make the user be sure of, with operate as normal, it can not cause interruption to the content that will be transmitted by AA when being sent to wireless device 450, identical in the expense that will pay and the advertisement, can upgrade, or the like.There is o lot of reasons all to make the user possibly hope to guarantee that AA is by wireless service supplier authentication.
Then, exchange takes place to transmit the paying that is used for the content that the client will receive to AA between client and AA.This transaction can be carried out in every way.AA notify the client he the expense of the content that will receive what are, client authorization is to the payment (if the user so selects) of this expense.For example, the client can provide credit card details (step 535), the AA server can set up with a credit card server be connected with carry out one the transaction (step 530).Alternatively, the client can be sent to AA server (step 535) (this need not to describe) to electronic cash.In a preferred alternative, the client can be sent to a certificate AA (step 540) of authentication in wireless service supplier territory 500 (promptly by CA 400 authentications and have the public-key certificate of CA 400).The AA server is this certificate of step 545 checking (use and be stored in the root public-key certificate in the AA server), and AA has been ready to be sent to the client to content item (attribute).When being sent to the client to content item (step 550), AA order CA charges (step 555) by predetermined payout to the client, and CA400 order charging computer 401 is added to this expense on client's the bill (step 560).(step 570) launched this content item in the customers' place simultaneously.
Launching of content item can have various ways; For example carry out a software application or to the upgrading or the Hotfix of a software application; Or show a newspaper, or a stock quote service is provided, or open wireless world wide web access to a stream-type video service or music service; Or transmit E-ticket or concert tickets, or a lot of other example.In fact, various AA 404,405,406 provide a virtual radio shopping center with common charging mechanism, and this billing mechanism is the billing mechanism of wireless service provider.
If execution in step 535 or 525 are not the online certificate check (step 540 and 545) of the absolute demand AA certificate that carries out the client, but best work like this.As one to the substituting of the step (step 520) of checking AA certificate, the client can only check the AA tabulation (or AA revocation lists) of an announcement.And this territory provides a service that is used for when recalling a customer's certificate notice dealer, and therefore as the substituting of step 545, AA can check this tabulation.Certainly, if utilize electronic cash or credit card that the client is charged, then omit step 555 and 560.
Although several territories possibly be useful, the unnecessary user of making becomes the member in these territories through obtaining a user key.Under the situation of a phone, as previously mentioned, if hope that manufacturing plant can register the user to the upgrading of user's direct marketing apparatus characteristic.But this also can be through accomplishing through the issue in ISP territory or to the distribution of device identifier.The leading subscriber key is more worthless in the manufacturing plant territory.This territory is preferably used in checking from makers' characteristic and upgrade script.
If security domain of Virtual network operator operation possibly need client's key, but only for the client (that is Virtual network operator office worker) that will be authorized to carry out from the network operation of mobile device.Common customer checking to Virtual network operator is not absolute necessary.
The wireless service supplier receives special concern for encryption key distribution user's situation.When the service of buying makes, in the WIM card, distribute client's key.Client's key in the wireless service supplier territory allows a member in this territory to assert a sign that interrelates with supplier account.Then, the third party of ISP or its mandate can sell content/service in this territory.Client's key also allows some client (if, ISP office worker) to use this system to represent that to network it has the network operation permission.
For the service and the content provider of the independent security domain of needs except wireless supplier, preferably issue client's key and it is stored among the WIM.Allow the territory to specify any nomenclature scheme consistent, and these territories are responsible for guaranteeing that this scheme is consistent in inside with their network.The inside directory service in a territory must be configured to the parsing home domain name.Title can be a polytype, comprises e-mail address, the IP address, and dns name is claimed, and account number.Adopt the commercial company in (or settle a bargain and adopt) territory can dispose this naming mechanism to be fit to their commerce and system's needs.
AA 404,405 and 406 can communicate with the exchange electronic certificate through link 408 and 409 each other.For example, AA 404 can be to its client's advertisement, and the service of buying it will be won the credit of the service that AA 405 is provided for the client.When a client when AA 404 buys a content item, AA 404 produces an automatic voucher, sends it to AA 405, identifies the client with ID and the credit that belongs to this client.When the client is established to the connection of AA 405, the discount of from the expense of AA 405, deducting that is won to this particular customer of customer notification.If this client buys a service from AA 405, AA 405 can collect value or its part of this discount authority to AA 404.One skilled in the art will appreciate that this scheme can have a lot of modification.For example, can count in the charging computer accumulation of CA 400, these are counted and can use at any one place in AA 404-406.Alternatively, can be sent to client 450 or 452 rather than between AA, transmit to voucher, make the client to be sent to the next AA in the virtual radio shop to voucher.Use described for the public public-key certificate of all members in territory 500, realize this a kind of scheme in back especially easily, because any AA in the territory is easy to verify the reliability of this voucher.
Now for for the purpose of complete, provide further other details of whole secure e-business system.
Catalogue is organized as: territory mechanism name-fully qualified this locality describe name-key hash, the certificate hash, or key ID or territory mechanism name-key hash, the certificate hash.In a territory, territory mechanism name is an implicit expression.A complete qualified local name is a local name unique in this territory; In some cases, this is issuer and the combination (main body is with respect to issuer) of main body name in the certificate.For physical name uses certificate or key hash (not describing the name part) separately is more not preferred, because it can produce difficulty in directory search and certificate chain check.
The title that issuer under root has comprises: a certificate hash and an optional description name, a key hash and an optional description name, or an integer key identifier and a description name.Use the integer key identifier and describe name shorter and the title of readability more can be provided.
Verifier has the device that is used for when transaction needs are handled a certificate chain, obtaining the certificate of necessity path.Under many circumstances, ending entity certificate self will not be sent out, and only send one or more titles and obtain the certificate of any needs to allow verifier.In a territory, can make said process simple through using a determinacy path nomenclature scheme, wherein this nomenclature scheme allows directly to check the path from (issuer, main body) to obtaining certificate.If this nomenclature scheme is not carried out said process in the inside of a certificate, must provide a device to obtain correct path so in this certificate outside.For the check between the territory of carrying out cross-certification, advise that a territory provides a safety verification service that is used for its certificate.If the certificate from other territory will be internally checked in a territory, it it must be understood that nomenclature scheme and the algorithm that uses in other territory so.
In some cases, CA possibly have one list preset time more than a valid certificate.This possibly take place during predetermined the restarting (re-key) of CA.When attempting to follow a certificate chain, when certain this chain of point allows a plurality of possibility, may produce a problem.Have several method to solve this problem: (i) trial and error, owing to need inspection to be used for a plurality of signatures of a coupling, this method efficient is lower; (ii) use comprises one and is used for the key of CA and AA or the name type of certificate hash.This has solved uncertainty, but makes title longer; (iii) use key identifier with the name described.A kind of method in back is a method for optimizing.
Suppose that some equipment can not handle the certificate chain that is used in the territory check, in X9.68, defined a check service.Through being provided, the check server realizes this service in a territory.The address of these servers can be represented as service load or the otherwise configuration in the CA certificate.The client of this service must can check the signature in the response, thus it must have the check server certificate maybe can check this certificate.A thin client receives an indication of the territory mechanism of its certificate of hoping check and this certificate; This territory is it oneself.The client sends to a check server to a check request.This server is beamed back the check response of a signature.
For checking between the territory, the territory makes some service can be used for other territory.Cross-certificate is through providing one to be used to provide the address of the server of these services to represent to obtain these services wherefrom.Check service is checked between the server between a check client (it can be a check server territory in) and territory and is operated.The check server is expected and can be got in touch and check the reliability (signature) from the response of the check server in another territory between territory.Notice, this means that the check server must can use the algorithm from other territory between the territory.The check server is the member in a plurality of territories between the territory, therefore can verify the signature in other territory.A thin client receives it and hopes the certificate of check and the territory mechanism of this certificate; This certificate territory is not it.This client sends to a territory check server to a check request.Notice that these servers can be represented as service load or be stored in other places in the root certificate.The check server notices that this territory is outside.It determines whether the cross-certificate that exists one to have represented territory.If no, turn back to this client to a check failure response.(notice,, can skip over this third step) if the client knows the address of check server between a territory.If having a cross-certificate and this server is to check server between a territory, it is handled itself and should ask; Otherwise check of its signature asks and sends it between a territory of listing in the cross-certificate to check server.Check this request of server authentication and oneself this certificate of checking perhaps are delivered to an internal inspection server in other territory to this request between this territory.Sign this result and turn back to the check server of this client's initial contact.This check server authentication should respond, and oneself signed and was somebody's turn to do response, and it is turned back to the client.
The check service allows to be verified from a certificate in another territory from an entity requests in a territory.Need return an invalid response, only if this server can confirm this certificate current be effective.The reason of this failure preferably is provided.
Each territory is selected will be at the algorithm that is used for digital signature, data encryption, secret key encryption and cryptographic key agreement of inside use.And, provide operable maximum keys sizes in this territory by territory root CA keys sizes.The territory member must have encryption software/hardware that realization has the territory algorithm of maximum keys sizes.And a territory member must have secure loading and the territory root ca certificate of storage or the territory root ca certificate information of a compressed format.
Define a territory, so that be the fixing use therein algorithm of efficiency reasons.When a territory was selected to have the RSA of given root key size, algorithm and keys sizes were known for each client in this territory.This make be another algorithm effects of mobile client support be significantly-each neofield that this client adds is a potential new algorithm.In fact, for security reasons, some territory even possibly not allow to use other field code is even this algorithm is identical.
A territory root CA is illustrated in algorithm actual in this territory, inner nomenclature scheme and strategy.Strategy comprises following information: what the territory carried out to member's sign of relating to the account and guaranteed, carries out what program and assurance for the third party who in the territory, issues Attribute certificate.And, be kept for the specific policy that each cross-certification is reached an agreement on.
The process of cross-certification be one therein two discretionary security territories give the process of the other side's formal approval.This is through being produced and signed a cross-certificate object that comprises other territory root certificate (or its hash) and come digitally to accomplish by each territory.And, can check the address of server and the indication of contract agreement between IncFlds.
For having when the service ordering by the ISP territory in the system of personalized SIM or WIM smart card, member's registration is included in storage member's certificate and key on the WIM card.
For the system that does not have smart card, be stored in key and certificate in the WIM software token.Member's key is by lexical or textual analysis information protection.This information is connected with a hush values that is used for this equipment of storage, and through a secure hash, so that produce the keys for encryption/decryption that is used to protect user's private key.
Member's certificate also maintains this member's account, and is imported in ISP member's catalogue.In some system, actual member's certificate possibly not be stored in WIM from but only remain in the system on one's body.For this use, member's certificate can be used as a safety container that is used for account information, and a client only needs to offer system to its sign; System obtains required certificate.For the territory except the ISP, enrollment process need define one and be stored in the secured fashion among the WIM to key, and each territory is guaranteed to information.
System bootstrapping relates to the loading of territory root certificate and client's key.Notice, except client's signature key, also load the key that is used for data encryption, secret key encryption and cryptographic key agreement.The signature key that is used for the client must only be used for signature.The key that is used for other purpose also is loaded.At first, manufacturing plant territory root certificate is loaded onto in the mobile device.This certificate is used to enable the secure loading (if necessary) of other territory root certificate.In the system that does not have security service supplier supply option, manufacturing plant provides certificate to the ISP, gives a supply of ISP attribute.This attribute allows the ISP that their root certificate is installed in phone.
Be necessary to load safely and store the territory certificate.At first, the equipment manufacturing certificate is loaded onto in the equipment as stated.Then, load ISP and Virtual network operator certificate.In case loaded effective service supplier and Virtual network operator certificate, the control of the attribute that these territories obtain their territory is had.The manufacturing plant territory loses the control of any attribute that it is not had in the equipment that is provided.
For the system with SIM, wireless service supplier root certificate and client's key and certificate be issue on card before being issued the user.The device that is used to produce with the contact customer key guarantees only have a contact for a card, and signature key can not be confirmed by ISP or their office worker.Personalization process is related to people account one by one to the public keys (and private key) that is used for a card.
For the system that does not have tag card, use root credentials loading ISP of manufacturing plant and Virtual network operator certificate to guarantee loading process.Manufacturing plant gives the ISP certificate authority, allows their signature keys to load script.This equipment must guarantee only to use the request of a correct authentication to load a territory root certificate.
The plan restart during, each CA or AA only issue certificate again.Equipment must be able to be accepted the certificate change order by the certificate of owner's signature of certificate.
When the CA except root or AA key are compromised, can order WIM with this key of new key replacement from the message of root.Use root to mean that more rudimentary CA need not have their disaster recovery key for this purpose, have only root to need a key that is used for this purpose.
When a root key was compromised, hope can have suitable program to allow to recover and need not setting up new registration procedure of all territory members.Reason for this reason, each territory preferably have the disaster recovery public keys and the territory root public keys that are used for being stored securely in the territory of WIM.This special use disaster recovery key must be maintained in the separate payment, and this system is not connected with any network, only if carrying out disaster recovery.Hope that the position of this key physically separates with the territory root key.Disaster recovery message is to be used for the message that order WIM automatically replaces a root key.Need current root key and disaster recovery key all to sign the root public keys and change message.During another signature is invalid receiving that one of them signature is examined request, must cause WIM to be under an embargo.Also need support one by disaster recovery key message signature, total ban SIM/WIM card.In a word, disaster recovery process is: (i) root by current root key and the signature of disaster key changes message; (ii) the message of total ban WIM can be by root or the signature of disaster recovery key; (iii) the reception of a partial invalidity request must cause WIM to be under an embargo.
Member device have be associated with it, can be used to conclude the business or the key of authentication.These keys are usually by a PIN code and certain " maximum number of attempts " inactive protocol protection.When equipment of report is stolen, and this report self with certain mode by authentication the time, if someone attempts the equipment that uses this quilt to steal, hope that this system can cause a card remotely to remove key.
Therefore; Describe one and in the wireless E-commerce system, carried out transaction method; Wherein this system comprises that a wireless carriers certification authority with root public-key certificate has the attribute mechanism of the digital certificate that is independent of the root public-key certificate with at least one, and wherein attribute mechanism can be visited through a wireless network by a wireless client device.According to said method, between wireless client device (450 or 452) and attribute mechanism (404,405 or 405), set up radio communication.Digital certificate is sent to wireless device by dependency mechanism, and under the mandate of wireless carriers, wireless client device uses the digital certificate and the root public-key certificate of preloaded in the wireless client device that attribute mechanism is verified.Be sent to wireless client device to an attribute through wireless network, and finally launch this attribute in wireless client device.
Can come the payment of attribute is concluded the business through transmitting one second digital certificate and use this second digital certificate of root public-key certificate checking to attribute mechanism from certification authority from wireless client device.Preferably be sent to an instruction dependency mechanism charging computer of wireless carriers, to be increased to a project wireless carriers bill that is used for this wireless client device.
Can be pre-loaded onto second digital certificate in the Subscriber Identity Module by wireless carriers, perhaps can be pre-loaded onto in the wireless communicator at following second digital certificate of the mandate of wireless carriers.
A kind of transaction method of in the wireless E-commerce system, carrying out has also been described; This system comprises a wireless carriers certification authority and at least the first and second attribute mechanisms with root public-key certificate; Attribute mechanism has first and second digital certificates that are independent of the root public-key certificate, and wherein attribute mechanism can be visited through a wireless network by a wireless client device.This method comprises: between the wireless client device and the first attribute mechanism, set up a radio communication; Be sent to wireless client device to first attribute through wireless network; Producing one can be by the electronic certificate of second attribute mechanism checking; Between the wireless client device and the second attribute mechanism, set up radio communication; Ask second attribute to the second attribute mechanism; At second attribute mechanism identification electronic certificate; Be sent to wireless device to second attribute from the second attribute mechanism.Generation can be comprised by the step of the electronic certificate of second attribute mechanism checking: a connection through between the first attribute mechanism and the second attribute mechanism is sent to the second attribute mechanism to electronic certificate from the first attribute mechanism, perhaps can comprise through wireless client being sent to the second attribute mechanism to electronic certificate from the first attribute mechanism.
Also described a kind of wireless E-commerce system, having comprised: a wireless carriers certification authority server with root public-key certificate; Can be coupled at least one attribute authority server of wireless carriers certification authority server, have the digital certificate that is independent of the root public-key certificate; Wireless client device with the root public-key certificate that is pre-loaded onto wherein; Be coupled to wireless client device the wireless network of at least one attribute authority server; Demo plant in the wireless client device is used for using the root public-key certificate that is pre-loaded onto wireless client device that wireless client device is verified digital certificate; The device that is used to send, be associated (for example, server 18 or gateway 420) and be used for receiving the device (for example, the radio receiver in the wireless device 450) of an attribute through wireless network with the attribute authority server; Be used for launching the device of this attribute at the wireless client device place.