JP7069359B2 - Methods and systems for improving cancer detection using deep learning - Google Patents
Methods and systems for improving cancer detection using deep learning Download PDFInfo
- Publication number
- JP7069359B2 JP7069359B2 JP2020570510A JP2020570510A JP7069359B2 JP 7069359 B2 JP7069359 B2 JP 7069359B2 JP 2020570510 A JP2020570510 A JP 2020570510A JP 2020570510 A JP2020570510 A JP 2020570510A JP 7069359 B2 JP7069359 B2 JP 7069359B2
- Authority
- JP
- Japan
- Prior art keywords
- cancer
- model
- probability
- stage
- global
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Active
Links
- 206010028980 Neoplasm Diseases 0.000 title claims description 259
- 201000011510 cancer Diseases 0.000 title claims description 257
- 238000001514 detection method Methods 0.000 title claims description 130
- 238000000034 method Methods 0.000 title claims description 120
- 238000013135 deep learning Methods 0.000 title description 30
- 238000002591 computed tomography Methods 0.000 claims description 151
- 238000012549 training Methods 0.000 claims description 50
- 238000013527 convolutional neural network Methods 0.000 claims description 47
- 206010058467 Lung neoplasm malignant Diseases 0.000 claims description 43
- 201000005202 lung cancer Diseases 0.000 claims description 43
- 208000020816 lung neoplasm Diseases 0.000 claims description 43
- 210000004072 lung Anatomy 0.000 claims description 41
- 238000012216 screening Methods 0.000 claims description 30
- 230000008569 process Effects 0.000 claims description 18
- 238000013517 stratification Methods 0.000 claims description 18
- 238000012935 Averaging Methods 0.000 claims description 11
- 238000005457 optimization Methods 0.000 claims description 9
- 230000011218 segmentation Effects 0.000 claims description 5
- 238000012546 transfer Methods 0.000 claims 1
- 210000004556 brain Anatomy 0.000 description 49
- 210000001519 tissue Anatomy 0.000 description 28
- 238000003384 imaging method Methods 0.000 description 25
- 238000002595 magnetic resonance imaging Methods 0.000 description 23
- 208000010877 cognitive disease Diseases 0.000 description 22
- 208000028698 Cognitive impairment Diseases 0.000 description 17
- 230000007246 mechanism Effects 0.000 description 17
- 238000010586 diagram Methods 0.000 description 15
- 238000012360 testing method Methods 0.000 description 14
- 208000024827 Alzheimer disease Diseases 0.000 description 13
- 238000013136 deep learning model Methods 0.000 description 13
- 230000006870 function Effects 0.000 description 12
- 238000003745 diagnosis Methods 0.000 description 11
- 238000004422 calculation algorithm Methods 0.000 description 9
- 238000013459 approach Methods 0.000 description 8
- 238000013528 artificial neural network Methods 0.000 description 8
- 238000002600 positron emission tomography Methods 0.000 description 8
- 238000012545 processing Methods 0.000 description 8
- 230000003920 cognitive function Effects 0.000 description 7
- 238000011176 pooling Methods 0.000 description 7
- 208000014644 Brain disease Diseases 0.000 description 6
- 239000000090 biomarker Substances 0.000 description 6
- 230000001771 impaired effect Effects 0.000 description 6
- 230000010354 integration Effects 0.000 description 6
- 230000036210 malignancy Effects 0.000 description 6
- 206010056342 Pulmonary mass Diseases 0.000 description 5
- 238000004458 analytical method Methods 0.000 description 5
- 238000004364 calculation method Methods 0.000 description 5
- 210000000038 chest Anatomy 0.000 description 5
- 201000010099 disease Diseases 0.000 description 5
- 208000037265 diseases, disorders, signs and symptoms Diseases 0.000 description 5
- 208000027061 mild cognitive impairment Diseases 0.000 description 5
- 230000035945 sensitivity Effects 0.000 description 5
- 206010060862 Prostate cancer Diseases 0.000 description 4
- 208000000236 Prostatic Neoplasms Diseases 0.000 description 4
- 230000009471 action Effects 0.000 description 4
- 238000011161 development Methods 0.000 description 4
- 230000018109 developmental process Effects 0.000 description 4
- 239000000284 extract Substances 0.000 description 4
- 238000002610 neuroimaging Methods 0.000 description 4
- 230000006399 behavior Effects 0.000 description 3
- 210000004027 cell Anatomy 0.000 description 3
- 238000013145 classification model Methods 0.000 description 3
- 230000001149 cognitive effect Effects 0.000 description 3
- 238000000605 extraction Methods 0.000 description 3
- 230000003211 malignant effect Effects 0.000 description 3
- 238000007726 management method Methods 0.000 description 3
- 230000032683 aging Effects 0.000 description 2
- 230000008901 benefit Effects 0.000 description 2
- 230000008049 biological aging Effects 0.000 description 2
- 238000001574 biopsy Methods 0.000 description 2
- 238000004590 computer program Methods 0.000 description 2
- 238000002059 diagnostic imaging Methods 0.000 description 2
- 230000004927 fusion Effects 0.000 description 2
- 230000036541 health Effects 0.000 description 2
- 230000006872 improvement Effects 0.000 description 2
- 230000001537 neural effect Effects 0.000 description 2
- 238000003909 pattern recognition Methods 0.000 description 2
- 230000002685 pulmonary effect Effects 0.000 description 2
- 238000013077 scoring method Methods 0.000 description 2
- 238000001356 surgical procedure Methods 0.000 description 2
- 238000013526 transfer learning Methods 0.000 description 2
- 238000013519 translation Methods 0.000 description 2
- 206010006187 Breast cancer Diseases 0.000 description 1
- 208000026310 Breast neoplasm Diseases 0.000 description 1
- 206010012289 Dementia Diseases 0.000 description 1
- 208000019693 Lung disease Diseases 0.000 description 1
- 208000008771 Lymphadenopathy Diseases 0.000 description 1
- 206010052428 Wound Diseases 0.000 description 1
- 208000027418 Wounds and injury Diseases 0.000 description 1
- 230000002159 abnormal effect Effects 0.000 description 1
- 230000006978 adaptation Effects 0.000 description 1
- 239000008280 blood Substances 0.000 description 1
- 210000004369 blood Anatomy 0.000 description 1
- 238000012512 characterization method Methods 0.000 description 1
- 238000004891 communication Methods 0.000 description 1
- 238000013170 computed tomography imaging Methods 0.000 description 1
- 238000004195 computer-aided diagnosis Methods 0.000 description 1
- 238000002790 cross-validation Methods 0.000 description 1
- 238000002405 diagnostic procedure Methods 0.000 description 1
- 239000003814 drug Substances 0.000 description 1
- 229940079593 drug Drugs 0.000 description 1
- 230000000694 effects Effects 0.000 description 1
- 238000011156 evaluation Methods 0.000 description 1
- 238000002474 experimental method Methods 0.000 description 1
- 238000007499 fusion processing Methods 0.000 description 1
- 230000007166 healthy aging Effects 0.000 description 1
- 238000010348 incorporation Methods 0.000 description 1
- 210000001165 lymph node Anatomy 0.000 description 1
- 208000018555 lymphatic system disease Diseases 0.000 description 1
- 238000010801 machine learning Methods 0.000 description 1
- 239000003550 marker Substances 0.000 description 1
- 230000001394 metastastic effect Effects 0.000 description 1
- 206010061289 metastatic neoplasm Diseases 0.000 description 1
- 230000003557 neuropsychological effect Effects 0.000 description 1
- 238000001208 nuclear magnetic resonance pulse sequence Methods 0.000 description 1
- 230000037361 pathway Effects 0.000 description 1
- 210000002307 prostate Anatomy 0.000 description 1
- 238000001228 spectrum Methods 0.000 description 1
- 238000003325 tomography Methods 0.000 description 1
- 230000002792 vascular Effects 0.000 description 1
- 238000012800 visualization Methods 0.000 description 1
- 230000002747 voluntary effect Effects 0.000 description 1
Images
Classifications
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F18/00—Pattern recognition
- G06F18/20—Analysing
- G06F18/25—Fusion techniques
- G06F18/254—Fusion techniques of classification results, e.g. of results related to same input data
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F18/00—Pattern recognition
- G06F18/20—Analysing
- G06F18/21—Design or setup of recognition systems or techniques; Extraction of features in feature space; Blind source separation
- G06F18/213—Feature extraction, e.g. by transforming the feature space; Summarisation; Mappings, e.g. subspace methods
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F18/00—Pattern recognition
- G06F18/20—Analysing
- G06F18/24—Classification techniques
- G06F18/241—Classification techniques relating to the classification model, e.g. parametric or non-parametric approaches
- G06F18/2415—Classification techniques relating to the classification model, e.g. parametric or non-parametric approaches based on parametric or probabilistic models, e.g. based on likelihood ratio or false acceptance rate versus a false rejection rate
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N20/00—Machine learning
- G06N20/20—Ensemble learning
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/04—Architecture, e.g. interconnection topology
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/08—Learning methods
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T7/00—Image analysis
- G06T7/0002—Inspection of images, e.g. flaw detection
- G06T7/0012—Biomedical image inspection
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T7/00—Image analysis
- G06T7/10—Segmentation; Edge detection
- G06T7/11—Region-based segmentation
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T7/00—Image analysis
- G06T7/70—Determining position or orientation of objects or cameras
- G06T7/73—Determining position or orientation of objects or cameras using feature-based methods
-
- G—PHYSICS
- G16—INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR SPECIFIC APPLICATION FIELDS
- G16H—HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA
- G16H50/00—ICT specially adapted for medical diagnosis, medical simulation or medical data mining; ICT specially adapted for detecting, monitoring or modelling epidemics or pandemics
- G16H50/20—ICT specially adapted for medical diagnosis, medical simulation or medical data mining; ICT specially adapted for detecting, monitoring or modelling epidemics or pandemics for computer-aided diagnosis, e.g. based on medical expert systems
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/10—Image acquisition modality
- G06T2207/10072—Tomographic images
- G06T2207/10081—Computed x-ray tomography [CT]
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20076—Probabilistic image processing
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20081—Training; Learning
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20084—Artificial neural networks [ANN]
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20112—Image segmentation details
- G06T2207/20132—Image cropping
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/30—Subject of image; Context of image processing
- G06T2207/30004—Biomedical image processing
- G06T2207/30061—Lung
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/30—Subject of image; Context of image processing
- G06T2207/30004—Biomedical image processing
- G06T2207/30096—Tumor; Lesion
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V2201/00—Indexing scheme relating to image or video recognition or understanding
- G06V2201/03—Recognition of patterns in medical or anatomical images
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V2201/00—Indexing scheme relating to image or video recognition or understanding
- G06V2201/03—Recognition of patterns in medical or anatomical images
- G06V2201/031—Recognition of patterns in medical or anatomical images of internal organs
Description
優先権
本出願は、2018年6月18日に出願した米国仮出願第62/686,541号、および2018年8月31日に出願した米国仮出願第62/726,178号の優先権の利益を主張するものである。
Priority This application claims the priority benefit of US Provisional Application No. 62 / 686,541 filed June 18, 2018 and US Provisional Application No. 62 / 726,178 filed August 31, 2018. It is a thing.
本開示は、癌検出およびスクリーニングを改善するための方法およびシステムに関する。方法は、たとえば、コンピュータ断層撮影(CT)からの肺癌検出のためのCTデータセット、および前立腺癌検出のためのマルチモーダル磁気共鳴イメージング(MRI)を含む、様々なイメージングデータセットとともに使用するために好適である。本開示の特徴は、低線量胸部CT(LDCT)データセット、ならびに診断用胸部CTデータセットからの一般的な肺癌検出との関連で適用され得る。方法およびシステムは、深層学習方法を使用して実装され得る。 The present disclosure relates to methods and systems for improving cancer detection and screening. The method is to be used with various imaging datasets, including, for example, CT datasets for lung cancer detection from computer tomography (CT) and multimodal magnetic resonance imaging (MRI) for prostate cancer detection. Suitable. The features of the present disclosure may be applied in the context of low-dose chest CT (LDCT) datasets as well as general lung cancer detection from diagnostic chest CT datasets. Methods and systems can be implemented using deep learning methods.
縦断的(longitudinal)およびマルチモーダルイメージング技法は、癌スクリーニング診断の改善に役立つ。「縦断的イメージング」は、癌の検出および診断の際に現在または直近の画像との比較のために利用可能である、前の患者画像を指す。「マルチモーダルMRI」は、単一の磁気共鳴イメージング(MRI)検査の間に取られた複数のパルスシーケンスを指すために使用される。「マルチモーダルイメージング」という用語はまた、MRI、CTスキャン、および陽電子放射断層撮影(PET)など、被験者の異なるタイプの画像を取得することを指すために使用され、そのような画像は、同時に取得されてもそうでなくてもよい。 Longitudinal and multimodal imaging techniques can help improve cancer screening diagnosis. "Longitudinal imaging" refers to a previous patient image that is available for comparison with the current or most recent image during cancer detection and diagnosis. "Multimodal MRI" is used to refer to multiple pulse sequences taken during a single magnetic resonance imaging (MRI) examination. The term "multimodal imaging" is also used to refer to the acquisition of different types of images of a subject, such as MRI, CT scan, and positron emission tomography (PET), such images being acquired simultaneously. It may or may not be done.
典型的には、イメージングデータセットの解釈は、放射線科医が複数の時点またはモダリティにわたって画像の同じ領域を比較することによって、手動または半自動的に実行される。深層学習を使用する自動化された手法は、癌を識別および分類するために、複数の画像にわたって微妙な手掛かりを識別するための能力を提供することができる。我々は、癌検出および分類のために、縦断的またはマルチモーダルイメージングを組み込むための一般的な手法を提示する。 Interpretation of the imaging dataset is typically performed manually or semi-automatically by the radiologist comparing the same area of the image across multiple time points or modality. Automated techniques that use deep learning can provide the ability to identify subtle cues across multiple images to identify and classify cancer. We present common techniques for incorporating longitudinal or multimodal imaging for cancer detection and classification.
以下の説明では、LDCT画像からの肺癌スクリーニングのトピックを提示する。しかしながら、説明する手法は、たとえば、前立腺癌検出および分類のためのマルチモーダルMRIなど、他の癌のトピックに一般化することができる。 The following discussion presents the topic of lung cancer screening from LDCT images. However, the techniques described can be generalized to other cancer topics, for example, multimodal MRI for prostate cancer detection and classification.
背景技術として、低線量スクリーニングCTは、55～80歳の現在および前の喫煙者のための肺癌の早期検出のための推奨されるガイドラインの一部である。患者が、CTまたはX線を使用して、癌に関して年に1回スクリーニングされた、National Lung Cancer Screening Trial(NLST)の結果として、CTグループにおける患者が、X線グループにおける患者と比較して低い死亡率を有することが実証された。米国放射線学会(ACR)は、肺結節の存在および不在、結節サイズおよび密度、結節形態、ならびに腫瘍の二次的兆候(たとえば、リンパ節症)を含む、様々な発見物に基づいて画像の評価を行う、低線量肺癌スクリーニングCT症例の解釈および管理のためのLung CT Screening Reporting & Data System(Lung-RADS)(商標)ガイドラインを発表している。一般にCTスキャンからの肺癌検出との関連で、Fleischner Societyガイドラインは、癌性である場合もそうでない場合もある、肺疾患の結節の識別および特性化のための基準について記載している。Lung-RADSガイドラインおよびFleischnerガイドラインのような手動で設計されたガイドラインは、より高い一貫性、標準化、および典型的には全体的性能の改善を含む、イメージング検査の主観評価に勝る様々な利点を提供する。しかしながら、これらのシステムは、それらのシステムを定義する基準によって本質的に制限され、より複雑な解析システムが潜在的に感度と特異度の両方において性能をさらに改善するための機会を残している。 As a background technique, low-dose screening CT is part of the recommended guidelines for early detection of lung cancer for current and previous smokers aged 55-80 years. Patients in the CT group are lower than those in the X-ray group as a result of the National Lung Cancer Screening Trial (NLST), in which patients were screened annually for cancer using CT or x-ray. Demonstrated to have a mortality rate. The American Radiological Society (ACR) evaluates images based on various findings, including the presence and absence of lung nodules, nodule size and density, nodule morphology, and secondary signs of tumor (eg, lymphadenopathy). Has published Lung CT Screening Reporting & Data System (Lung-RADS) ™ guidelines for the interpretation and management of low-dose lung cancer screening CT cases. Generally in the context of lung cancer detection from CT scans, the Fleischner Society guidelines describe criteria for identifying and characterization of lung disease nodules, which may or may not be cancerous. Manually designed guidelines, such as the Lung-RADS and Fleischner guidelines, offer a variety of advantages over subjective assessment of imaging tests, including higher consistency, standardization, and typically improved overall performance. do. However, these systems are inherently limited by the criteria that define them, leaving opportunities for more complex analytical systems to potentially further improve performance in both sensitivity and specificity.
様々なソフトウェアデバイスが、肺CT画像における肺結節の高度な検出(スクリーニング、診断、またはそうでないもの)のために、アメリカ食品医薬品局(FDA)によって認可または承認されている。これらのシステムは、一般に、特異度のコストを最小限にしながら、放射線科医の読影者が結節を発見するための感度を改善するために最適化され、それによって、コンピュータ支援検出、またはCADeのカテゴリーに入る。検出器は、一般に、他の場合には見逃されることがある小さい結節(1cm未満であることが多い)を強調し、通常、結節を含んでいる可能性のある複数のエリアを強調し、臨床決定を放射線科医に委ねる。近年、診断を推進するより深い評価のために利用される、コンピュータ支援診断、またはCADxが、肺癌においてはまだであるが、放射線学の他の分野において、より大きい関心および最初の臨床的承認さえ得ている。特に、深層学習プラットフォームは、臨床的に検証されたエンドポイントに基づいて、新しいアルゴリズムを迅速に開発し、これらのシステムが臨床的結論へのそれら自体の独立した経路を決定し、高度な性能および潜在的に新しい臨床的洞察を与えることを可能にすることが期待できる。深層学習手法は、詳細評価の自動化、他の場合には報告されない微妙なホリスティックなイメージング発見物に気付くこと、ならびにCTスキャンを格付けおよび評価するための方法を統一することを行う可能性を提供する。 Various software devices have been approved or approved by the US Food and Drug Administration (FDA) for advanced detection (screening, diagnosis, or not) of lung nodules on lung CT images. These systems are generally optimized to improve the sensitivity of radiologists to detect nodules, while minimizing the cost of specificity, thereby computer-assisted detection, or CADe. Enter the category. The detector generally highlights small nodules (often less than 1 cm) that may otherwise be overlooked, and usually highlights multiple areas that may contain nodules and is clinical. Leave the decision to the radiologist. Computer-aided diagnosis, or CADx, which has been used in recent years for deeper assessments to drive diagnosis, is not yet in lung cancer, but has greater interest and even initial clinical approval in other areas of radiology. It has gained. In particular, deep learning platforms are rapidly developing new algorithms based on clinically validated endpoints, and these systems determine their own independent pathways to clinical conclusions, advanced performance and advanced performance. It can be expected to potentially provide new clinical insights. Deep learning techniques offer the possibility to automate detailed assessments, identify subtle holistic imaging findings that are not otherwise reported, and unify methods for rating and assessing CT scans. do.
いくつかの論文が、深層学習を使用するCTスキャンからの肺結節検出および診断を対象としており、これらの論文には、Xiaojie Huang他、Lung Nodule Detection in CT Using 3D Convolutional Neural Networks、The 2017 IEEE International Symposium on Biomedical Imaging、2017年4月、Francesco Ciompi他、Towards automatic pulmonary nodule management in lung cancer screening with deep learning、Scientific Reports 7、article no. 46479、2017年4月17日、Wenqing Sun他、Computer Aided lung cancer diagnosis with deep learning、Medical Imaging 2016、Proc. of SPIE vol. 9785(2016年3月)、Albert Chon他、Deep Convolutional Neural Networks for Lung Cancer Detection、Stanford University Reports(2017)、www.cs231n.stanford.edu/reports/2017/pdfs/518.pdf、およびWafaa Alakwaa他、Lung Cancer Detection and Classification with 3D Convolutional Neural Network (3D-CNN)、International Journal of Advanced Computer Science and Applications、vol. 8 no. 8. 409～417ページ(2017)が含まれる。当技術分野はまた、結節がすでに検出されたと仮定しており、悪性腫瘍のリスクの予測が生成される状況についても記載している。 Several papers have targeted lung nodule detection and diagnosis from CT scans using deep learning, including Xiaojie Huang et al., Lung Nodule Detection in CT Using 3D Convolutional Neural Networks, The 2017 IEEE International. Symposium on Biomedical Imaging, April 2017, Francesco Ciompi et al., Towards automatic pulmonary nodule management in lung cancer screening with deep learning, Scientific Reports 7, article no. 46479, April 17, 2017, Wenqing Sun et al., Computer Aided lung cancer diagnosis with deep learning, Medical Imaging 2016, Proc. Of SPIE vol. 9785 (March 2016), Albert Chon et al., Deep Convolutional Neural Networks for Lung Cancer Detection, Stanford University Reports (2017), www.cs231n.stanford. edu / reports / 2017 / pdfs / 518.pdf, Wafaa Alakwaa et al., Lung Cancer Detection and Classification with 3D Convolutional Neural Network (3D-CNN), International Journal of Advanced Computer Science and Applications, vol. 8 no. 8.409 Includes pages 417 (2017). The art also assumes that nodules have already been detected and describes situations in which predictions of risk of malignant tumors are generated.
一態様では、我々は、深層学習モデルなどのモデルのアンサンブルを使用して、CTデータセットにおける肺癌の存在/不在の確率的予測、および癌の位置を生成するための方法およびシステムについて説明する。モデルのアンサンブルは、グローバルベースで(すなわち、CTボリューム全体にわたって)、CTデータセットにおける肺組織における癌の存在の確率および位置を予測するようにトレーニングされる、3D畳み込みニューラルネットワーク(CNN)の形態における、グローバル予測的モデルを含む。したがって、グローバルモデルは、入力としてCTボリューム全体をとり、CTボリュームにおいて表された関心エリアにおける癌の存在のグローバル予測を出力し得る。このグローバルモデルのこの出力は、CTボリューム全体にわたる単一のモデルにおける癌のエンドツーエンド予測を表す。場合によっては、このグローバルモデルは、胸部CTデータセットにおいて非肺組織から肺組織を分離するための特徴を含み、肺組織のみにおける癌の存在の確率および位置を予測する。 In one aspect, we describe methods and systems for probabilistic prediction of the presence / absence of lung cancer in CT datasets and generation of cancer locations using model ensembles such as deep learning models. The model ensemble is in the form of a 3D convolutional neural network (CNN) that is trained on a global basis (ie, across the CT volume) to predict the probability and location of cancer in lung tissue in the CT dataset. , Includes a global predictive model. Therefore, the global model can take the entire CT volume as input and output a global prediction of the presence of cancer in the area of interest represented in the CT volume. This output of this global model represents an end-to-end prediction of cancer in a single model across the CT volume. In some cases, this global model includes features for separating lung tissue from non-lung tissue in chest CT data sets, predicting the probability and location of cancer presence in lung tissue alone.
アンサンブルはまた、癌検出候補(癌性である場合もそうでない場合もある、単なる結節ではなく、癌であり得る候補を含んでいる、CTデータセットにおける3Dデータの異なるクロップされたボリューム)を識別する、第1段階または検出モデルと、癌検出候補の各々に癌確率pを割り当てる、第2段階または確率モデルとを含む、2段階予測モデルを含む。2段階予測モデルのうちの検出モデルおよび確率モデルは、同じく畳み込みニューラルネットワークに基づき得る。したがって、検出モデルは、CTデータセットを処理して、イメージングされた関心領域の部分を表すCTデータセットの候補ボリュームを生成し得、確率モデルは、CTデータセットの候補ボリュームを処理して、候補ボリュームが、癌を有する患者を示すイメージングされた関心領域の部分、たとえば、1つまたは複数の癌細胞を含む部分を表す確率を決定し得る。 The ensemble also identifies cancer detection candidates (different cropped volumes of 3D data in CT data sets that may or may not be cancerous, contain candidates that may be cancer, rather than just nodules). Includes a two-stage predictive model, including a first-stage or detection model and a second-stage or probabilistic model that assigns a cancer probability p to each of the cancer detection candidates. The detection model and the probability model of the two-step prediction model can also be based on a convolutional neural network. Therefore, the detection model can process the CT dataset to generate candidate volumes for the CT dataset that represent the portion of the imaged region of interest, and the probabilistic model can process the candidate volumes for the CT dataset to generate candidates. It is possible to determine the probability that the volume represents a portion of the imaged region of interest that represents a patient with cancer, eg, a portion that contains one or more cancer cells.
実際には、3つまたは5つなど、2つ以上の異なる第2段階確率モデル、たとえば、モデルA、B、C、Dなどがあり得、各々がそれ自体のパラメータのセットをもち、各々が検出候補の各々における癌の確率の予測を作成する。そのような第2段階モデルを定義するパラメータにおける可能な違いには、1)異なるパッチサイズ(すなわち、異なるスケールで癌を検出するために、データセットにおけるクロップされた3Dデータの様々なサイズのボリューム)、2)学習率など、学習中に使用される異なる最適化パラメータ、3)トレーニングの過程の間の複数の時点でモデルをとること(各モデルがわずかに異なる予測を有するようになるように、トレーニングの過程にわたって重みが変化する)、4)トレーニング中のデータ拡大の結果としての異なるパラメータ、ならびに5)各モデルのための深度、カーネルサイズ、および畳み込みの数など、異なるモデルアーキテクチャ設定が含まれる。具体的には、一実装形態では、モデルをより大きいばらつきに触れさせるために、トレーニングデータが、トレーニング中に追加のトレーニングデータを生成するように修正され得る。たとえば、小さいランダム回転が、入力ボリュームに適用されて、追加のトレーニングボリュームが生成され得る。このデータ拡大は、アンサンブルのメンバーの間で変動し得るパラメータ、たとえば、ランダム回転の量を有する。 In practice, there can be two or more different second-stage probability models, such as three or five, for example, models A, B, C, D, etc., each with its own set of parameters, each with its own set of parameters. Make a prediction of the probability of cancer in each of the detection candidates. Possible differences in the parameters that define such a second stage model are: 1) Volumes of various sizes of cropped 3D data in the dataset to detect cancer at different patch sizes (ie, different scales). ), 2) Different optimization parameters used during training, such as learning rate, 3) Taking models at multiple points in the training process (so that each model has slightly different predictions) Includes different model architecture settings such as), 4) different parameters as a result of data expansion during training, and 5) depth, kernel size, and number of convolutions for each model. Is done. Specifically, in one implementation, the training data may be modified to generate additional training data during training in order to expose the model to greater variability. For example, a small random rotation can be applied to the input volume to generate an additional training volume. This data expansion has parameters that can vary among the members of the ensemble, such as the amount of random rotation.
次いで、グローバルモデルおよび第2段階確率モデルの各々によって生成された予測確率が、たとえば、何らかの定義関数f、またはアルゴリズムに従って結合されて、CTデータセットにおける癌/癌なしの全体的または最終確率予測(たとえば、典型的には0から100までのパーセンテージを単位として提示される「悪性尤度スコア(malignancy likelihood score)」)、および癌の可能性がある位置が生成される。1つの構成では、これらの確率はまた、既存のスコアリングスキーマに近似するために、または新しいものを定義することによってのいずれかで、新規のスコアリング方法においても使用され得る。定義関数fは、グローバルモデルの予測された確率と、第2段階モデルの各々の、すなわち、すべての癌検出候補にわたって、または加重平均の形式において計算される、各最終または全確率との平均化からなり得る。 The predicted probabilities generated by each of the global model and the second stage probability model are then combined according to some definition function f, or algorithm, for example, to make a cancer / cancer-free global or final probability prediction in the CT data set ( For example, a "malignancy likelihood score"), typically presented in units of percentages from 0 to 100, and potential cancer locations are generated. In one configuration, these probabilities can also be used in new scoring methods, either to approximate an existing scoring scheme or by defining a new one. The definition function f averages the predicted probabilities of the global model with each final or total probability of each of the second stage models, i.e., calculated over all cancer detection candidates or in the form of a weighted average. Can consist of.
したがって、一態様では、患者について取得されたコンピュータ断層撮影データセットからの肺癌スクリーニングおよび検出を改善するための方法が提供される。方法は、a)グローバルベースで、データセットにおける肺組織における癌の存在の確率を少なくとも予測するようにトレーニングされた、3次元深層畳み込みニューラルネットワークを備える、グローバル予測的モデルに、データセットを供給するステップと、b)2段階予測モデルにデータセットを供給するステップであって、2段階予測モデルが、1)データセット内の1つまたは複数の3次元癌候補の位置を検出する、第1段階検出モデルと、2)第1段階検出モデルによって検出された1つまたは複数の3次元癌候補に対して動作し、3次元癌候補の各々に癌確率pを割り当てる、第2段階確率モデルとを備える、ステップと、c)(1)グローバル予測的モデルの予測と、第2段階確率モデルによって3次元癌候補の各々に割り当てられた癌確率pとの両方を使用する、データセットにおける癌の確率の全体的予測、および(2)データセットにおける癌の位置を表す、データを生成するステップであって、癌の位置が、グローバル予測的モデルまたは2段階予測モデルのいずれかによって決定される、ステップとを含む。 Therefore, in one aspect, a method for improving lung cancer screening and detection from a computer tomography data set obtained for a patient is provided. The method a) supplies the dataset to a global predictive model with a 3D deep convolution neural network trained to at least predict the probability of cancer presence in lung tissue in the dataset on a global basis. The first step, which is a step and b) a step of supplying a dataset to a two-step predictive model, where the two-step predictive model 1) detects the location of one or more 3D cancer candidates in the dataset. A detection model and a second-stage probability model that operates on one or more 3D cancer candidates detected by the first-stage detection model and assigns a cancer probability p to each of the 3D cancer candidates. Prepare, c) (1) Probability of cancer in the dataset using both the prediction of the global predictive model and the cancer probability p assigned to each of the 3D cancer candidates by the second stage probability model. The step of generating data that represents the overall prediction of and (2) the location of the cancer in the dataset, where the location of the cancer is determined by either a global predictive model or a two-step predictive model. And include.
別の態様では、患者について取得されたコンピュータ断層撮影データセットからの肺癌スクリーニングおよび検出を改善するためのコンピュータ実施システムが開示される。システムは、a)グローバルベースで、データセットにおける肺組織における癌の存在の確率を少なくとも予測するようにトレーニングされた、3次元深層畳み込みニューラルネットワークを備える、グローバル予測的モデルと、b)2段階予測モデルであって、1)データセット内の1つまたは複数の3次元癌候補を検出する、第1段階検出モデルと、2)第1段階検出モデルによって検出された1つまたは複数の3次元癌候補に対して動作し、3次元癌候補の各々に癌確率pを割り当てる、第2段階確率モデルとを備える、2段階予測モデルと、c)(1)グローバル予測的モデルの予測と、第2段階確率モデルによって3次元癌候補の各々に割り当てられた癌確率pとを使用する、データセットにおける癌の確率の全体的予測、および(2)データセットにおける癌の位置を表す、データを生成するためのコンピュータシステム実行コードとを含む。癌の位置は、グローバル予測的モデルまたは2段階予測モデルのいずれかによって決定される。 In another aspect, a computer implementation system for improving lung cancer screening and detection from computer tomography data sets acquired for a patient is disclosed. The system is a) a global predictive model with a three-dimensional deep convolution neural network trained to at least predict the probability of cancer presence in lung tissue in a dataset on a global basis, and b) a two-step prediction. Models, 1) a first-stage detection model that detects one or more three-dimensional cancer candidates in a dataset, and 2) one or more three-dimensional cancers detected by a first-stage detection model. A two-stage prediction model with a two-stage probability model that works on candidates and assigns a cancer probability p to each of the three-dimensional cancer candidates, c) (1) prediction of a global predictive model, and a second. Generate data that represents the overall prediction of the probability of cancer in the dataset, and (2) the location of the cancer in the dataset, using the cancer probability p assigned to each of the three-dimensional cancer candidates by the staged probability model. Includes computer system executable code for. Cancer location is determined by either a global predictive model or a two-step predictive model.
1つの構成では、特徴マップに関連付けられた中間畳み込み層(intermediate convolutional layer)を各々が有する、深層畳み込みニューラルネットワークの形態をとる、複数の第2段階モデルがある。グローバル予測的モデルは、特徴マップに関連付けられた中間畳み込み層を含む。ステップc)において、データセットにおける癌の確率の全体的予測が、(1)第2段階モデルからの特徴マップを、グローバルモデルの中間畳み込み層の特徴マップにアペンドし、グローバルモデルからの予測を生成すること、または(2)グローバルモデルからの特徴マップを、第2段階モデルの中間畳み込み層の特徴マップにアペンドし、第2段階モデルの出力から予測を生成することのいずれかによって取得される。 In one configuration, there are multiple second-stage models in the form of deep convolutional neural networks, each with an intermediate convolutional layer associated with the feature map. The global predictive model includes an intermediate convolution layer associated with the feature map. In step c), the overall prediction of the probability of cancer in the dataset (1) appends the feature map from the second stage model to the feature map of the middle convolution layer of the global model to generate the prediction from the global model. Obtained by either (2) appending the feature map from the global model to the feature map of the intermediate convolution layer of the second stage model and generating a prediction from the output of the second stage model.
一態様では、患者について取得されたコンピュータ断層撮影データセットから、患者の関心領域における癌の存在の確率を決定するための方法について説明する。方法は、
a)コンピュータ断層撮影データセットから、患者が癌を有するグローバルな確率を生成するようにトレーニングされた、3次元深層畳み込みニューラルネットワークを備える、予測的モデル(グローバル予測的モデル)を使用して、コンピュータ断層撮影データセットを処理するステップと、
b)2段階予測モデルを使用して、コンピュータ断層撮影データセットを処理するステップであって、前記処理が、
1)1つまたは複数の癌細胞を表す候補関心領域として、データセットにおける1つまたは複数の3次元候補ボリュームを生成するために、検出モデルを使用して、コンピュータ断層撮影データセットを処理するステップと、
2)3次元候補ボリュームの各々のための確率を生成するために、検出モデルによって生成された1つまたは複数の3次元候補ボリュームを処理するステップであって、3次元ボリュームの各々のための確率が、3次元ボリュームが1つまたは複数の癌細胞を表す確率を示す、ステップと
を含む、ステップと、
c)患者が癌を有するグローバルな確率と、3次元候補ボリュームの各々のための確率の両方を使用して、患者が癌を有する確率を生成するステップと
を含む。
In one aspect, a method for determining the probability of cancer presence in a patient's region of interest from a computer tomography data set obtained for the patient will be described. The method is
a) Computer using a predictive model (global predictive model) with a 3D deep convolutional neural network trained to generate a global probability that a patient will have cancer from a computer tomography dataset. Steps to process the tomography dataset and
b) A step of processing a computer tomography data set using a two-step predictive model, wherein the processing is:
1) A step in processing a computer tomography dataset using a detection model to generate one or more 3D candidate volumes in a dataset as a candidate region of interest representing one or more cancer cells. When,
2) The step of processing one or more 3D candidate volumes generated by the detection model to generate probabilities for each of the 3D candidate volumes, and the probabilities for each of the 3D volumes. However, the step and the step, which indicates the probability that the three-dimensional volume represents one or more cancer cells.
c) Includes a step to generate a probability that a patient will have cancer using both the global probability that the patient will have cancer and the probability for each of the 3D candidate volumes.
各態様は、場合によっては、以下の特徴のうちの1つまたは複数を含み得る。1つまたは複数の3次元癌候補が、第1段階検出モデルによって検出された1つまたは複数の3次元癌候補に対して動作する、複数の第2段階確率モデルに提供され、第2段階確率モデルの各々が、3次元癌候補の各々に癌確率pを割り当て、複数の第2段階確率モデルの各々が、異なるモデルパラメータによって特徴付けられる。異なるモデルパラメータが、1)データセットにおけるクロップされた3Dデータの異なるボリューム、2)学習中に使用される異なる最適化パラメータ、3)トレーニングの過程の間の異なる時点でモデルをとること、4)トレーニング中のデータ拡大の結果としての異なるパラメータ、ならびに5)各モデルのための深度、カーネルサイズ、および畳み込みの数など、異なるモデルアーキテクチャ設定からなる、パラメータのグループから選択される。ステップc)において、全体的確率は、グローバルモデルによって生成されたグローバルな確率と、複数の第2段階確率モデルの各々によって算出された候補の各々のための全確率との平均を備える。グローバル予測的モデルが、データセットにおける癌の存在の確率に加えて、以下のもの、すなわち、a)癌の転帰、b)2次元における少なくとも20mmのサイズの結節の存在、c)5年以内の死亡確率、d)2年以内の癌の診断のうちの少なくとも1つを予測するようにトレーニングされる。グローバルモデルは、データセットにおける癌の存在を識別するために、基本特徴抽出器(base feature extractor)を使用し、第1段階検出モデルが、基本特徴抽出器を使用する。第1段階検出モデルおよび第2段階確率モデルは、深層畳み込みニューラルネットワークを備える。第1段階検出モデルは、データセットにおける癌の存在の確率の予測が識別された肺組織内のみでグローバルに動作するように、データセットの全ボリュームにおいて動作する。グローバル予測的モデルは、データセット内の組織を識別する肺セグメンテーション特徴(lung segmentation feature)をさらに備える。1つの構成では、方法は、データセットにおける癌の確率の全体的予測を、リスク層別化スキーマのバケットに入れる。リスク層別化スキーマは、Lung-RADS(商標)などの既存のリスク層別化スキーマに近似する。 Each embodiment may optionally include one or more of the following features: One or more 3D cancer candidates are provided in multiple 2nd stage probability models that work against one or more 3D cancer candidates detected by the 1st stage detection model, 2nd stage probability. Each of the models assigns a cancer probability p to each of the 3D cancer candidates, and each of the plurality of second-stage probability models is characterized by different model parameters. Different model parameters are 1) different volumes of cropped 3D data in the dataset, 2) different optimization parameters used during training, 3) different time points during the training process, 4) Different parameters as a result of data expansion during training, as well as 5) selected from a group of parameters consisting of different model architecture settings such as depth, kernel size, and number of convolutions for each model. In step c), the global probability comprises averaging the global probabilities generated by the global model with the total probabilities for each of the candidates calculated by each of the plurality of second-stage probability models. Global predictive models, in addition to the probability of cancer presence in the dataset, are: a) cancer outcome, b) presence of nodules of size at least 20 mm in two dimensions, c) within 5 years. Death probability, d) Trained to predict at least one of the cancer diagnoses within 2 years. The global model uses a base feature extractor to identify the presence of cancer in the dataset, and the first-stage detection model uses a base feature extractor. The first-stage detection model and the second-stage probability model include a deep convolutional neural network. The first-stage detection model operates on the entire volume of the dataset so that the prediction of the probability of cancer presence in the dataset operates globally only within the identified lung tissue. The global predictive model further comprises a lung segmentation feature that identifies the tissues in the dataset. In one configuration, the method puts the overall prediction of cancer probability in the dataset into a bucket of risk stratification schema. The risk stratification schema approximates an existing risk stratification schema such as Lung-RADS ™.
別の態様では、コンピュータ断層撮影データセットの肺癌スクリーニングの特異度を高めるための深層学習システムを生成するための方法について説明する。方法は、
a)グローバルに、コンピュータ断層撮影データセットにおける肺組織における癌の存在の確率を少なくとも予測するように、3次元深層畳み込みニューラルネットワークの形態におけるグローバル予測的モデルをトレーニングするステップであって、トレーニングが、癌の存在または不在を示すグランドトゥルースアノテーションをもつ多数のコンピュータ断層撮影データセットに対して実行される、ステップと、
b)コンピュータ断層撮影データセット内の1つまたは複数の3次元癌候補を検出するための、第1段階検出モデルをトレーニングするステップと、
c)第1段階検出モデルによって検出された1つまたは複数の3次元癌候補に対して動作する、複数の第2段階確率モデルをトレーニングするステップであって、第2段階確率モデルの各々が、3次元癌候補の各々に癌確率pを割り当て、複数の第2段階確率モデルの各々が、異なるモデルパラメータによって特徴付けられる、ステップと、
d)CTスキャンデータセットにおける癌の確率のアンサンブルまたは全体的予測を生成するために、グローバル予測的モデルおよび第2段階確率モデルの予測をアンサンブル方式で結合するためのアルゴリズムまたは関数を定義するステップと
を含む。
In another aspect, a method for generating a deep learning system for increasing the specificity of lung cancer screening in a computer tomography data set will be described. The method is
a) Globally, a step in training a global predictive model in the form of a three-dimensional deep convolutional neural network to at least predict the probability of cancer presence in lung tissue in a computer tomography dataset. Steps and steps performed on a large number of computer tomography datasets with grand truth annotations indicating the presence or absence of cancer.
b) Steps to train a first-stage detection model to detect one or more 3D cancer candidates in a computer tomography dataset, and
c) A step in training multiple second-stage probabilistic models that operate against one or more 3D cancer candidates detected by the first-stage detection model, each of which is a second-stage probabilistic model. A step, in which a cancer probability p is assigned to each of the 3D cancer candidates, and each of the multiple second-stage probability models is characterized by different model parameters.
d) With steps to define algorithms or functions to combine the predictions of the global and second-stage probability models in an ensemble fashion to generate an ensemble or overall prediction of the probability of cancer in the CT scan data set. including.
各態様は、以下の特徴のうちの1つまたは複数を含み得る。異なるモデルパラメータが、1)データセットにおけるクロップされた3Dデータの異なるボリューム、2)学習中に使用される異なる最適化パラメータ、3)トレーニングの過程の間の異なる時点でモデルをとること、4)トレーニング中のデータ拡大の結果としての異なるパラメータ、ならびに5)各モデルのための深度、カーネルサイズ、および畳み込みの数など、異なるモデルアーキテクチャ設定からなる、パラメータのグループから選択される。アルゴリズムは平均計算である。グローバル予測的モデルが、コンピュータ断層撮影データセットにおける癌の存在の確率に加えて、以下のもの、すなわち、a)癌の転帰、b)2次元における少なくとも30mmのサイズの結節の存在、c)5年以内の死亡確率、d)2年以内の肺癌の診断のうちの少なくとも1つを予測するようにトレーニングされる。グローバル予測的モデルが、コンピュータ断層撮影データセットにおいて非肺組織から肺組織をセグメント化するように、さらにトレーニングされる。1つの構成では、グローバルモデルは、統合勾配(integrated gradient)などのアテンション機構を含む。1つの構成では、方法は、複数のバケットの形態におけるリスク層別化スキーマを含み、データセットにおける癌の確率の全体的予測が、リスク層別化スキーマにおけるバケットのうちの1つに入れられる。リスク層別化スキーマは、Lung-RADS(商標)などの既存のリスク層別化スキーマに近似する。 Each embodiment may include one or more of the following features: Different model parameters are 1) different volumes of cropped 3D data in the dataset, 2) different optimization parameters used during training, 3) different time points during the training process, 4) Different parameters as a result of data expansion during training, as well as 5) selected from a group of parameters consisting of different model architecture settings such as depth, kernel size, and number of convolutions for each model. The algorithm is an average calculation. Global predictive models include the following, in addition to the probability of cancer presence in the computer tomography data set: a) cancer outcome, b) presence of nodules at least 30 mm in size in two dimensions, c) 5 Trained to predict mortality within a year, d) at least one of the diagnoses of lung cancer within 2 years. Global predictive models are further trained to segment lung tissue from non-lung tissue in a computer tomography dataset. In one configuration, the global model contains an attention mechanism such as an integrated gradient. In one configuration, the method comprises a risk stratification schema in the form of multiple buckets, and the overall prediction of cancer probability in the dataset is contained in one of the buckets in the risk stratification schema. The risk stratification schema approximates an existing risk stratification schema such as Lung-RADS ™.
態様が任意の好都合な形態で実装され得ることは諒解されよう。たとえば、態様は、有形のキャリア媒体(たとえば、ディスク)、または無形のキャリア媒体(たとえば、通信信号)であり得る、適切なキャリア媒体上で搬送され得る、適切なコンピュータプログラムによって実装され得る。態様はまた、本発明を実装するように配置されたコンピュータプログラムを実行するプログラマブルコンピュータの形態をとり得る、好適な装置を使用して実装され得る。 It will be appreciated that the embodiments can be implemented in any convenient form. For example, the embodiment can be implemented by a suitable computer program that can be carried on a suitable carrier medium, which can be a tangible carrier medium (eg, a disk) or an intangible carrier medium (eg, a communication signal). Aspects may also be implemented using suitable devices, which may take the form of a programmable computer running a computer program arranged to implement the invention.
ある態様との関連で説明される特徴が、別の態様との関連で実装され得るように、態様が結合され得ることは諒解されよう。 It will be appreciated that aspects can be combined so that the features described in the context of one aspect can be implemented in the context of another.
これらの技法について、概して肺癌との関連で説明するが、これらの技法が肺癌以外の癌に適用され得ることは諒解されよう。 These techniques are generally described in the context of lung cancer, but it should be understood that these techniques can be applied to cancers other than lung cancer.
加えて、我々は、高度な癌検出および診断のための新規の深層学習フレームワークへの、縦断的およびマルチモーダルイメージングの組込みについて、本明細書で説明する。部分的または完全な自動化によって、幅広い利用可能性を促進するための、画像ベースのスクリーニングのスケーリングが容易になる。以下の説明から諒解されるように、本開示のシステムおよび方法は、CTスキャンデータセットなど、所与のイメージングモダリティの、3Dボリュメトリックデータセットなどの縦断的画像のセットがあるときに使用され得る。システムおよび方法はまた、被験者の縦断的(前の)イメージングデータセットを含む場合も含まない場合もある、マルチモーダルデータセットのセットがある場合にも使用され得る。方法およびシステムはまた、所与の被験者について利用可能な縦断的イメージングデータセットとマルチモーダルイメージングデータセットの両方があり、癌検出および診断の精度を高めるために、以下で説明する深層学習フレームワークにおいて、それらのデータセットがすべて結合され得る状況にも拡張され得る。 In addition, we describe the incorporation of longitudinal and multimodal imaging into a novel deep learning framework for advanced cancer detection and diagnosis herein. Partial or full automation facilitates scaling of image-based screening to promote wide availability. As will be appreciated from the description below, the systems and methods of the present disclosure may be used when there is a set of longitudinal images, such as a 3D volumetric dataset, of a given imaging modality, such as a CT scan dataset. .. Systems and methods may also be used if there is a set of multimodal datasets that may or may not include longitudinal (previous) imaging datasets of the subject. Methods and systems also have both longitudinal and multimodal imaging datasets available for a given subject, in the deep learning framework described below to improve the accuracy of cancer detection and diagnosis. , Can be extended to situations where all those datasets can be combined.
一態様では、我々は、深層学習モデルのアンサンブルを使用して、最近の(たとえば、現在の)画像データセットおよび縦断的(前の)画像データセットからなる、医用画像ベースのデータセットにおける肺癌の存在/不在の確率的予測、および癌の位置を生成するための方法およびシステムについて説明する。方法は、
a)癌の存在を示すデータセットにおける特徴を抽出する、3次元深層畳み込みニューラルネットワークを備える、グローバル予測的モデルに、最近のデータセット、および場合によっては縦断的データセットを供給するステップと、
b)2段階予測モデルに、最近のデータセットおよび縦断的データセットを供給するステップであって、2段階予測モデルが、
1)現在のデータセット内の1つまたは複数の3次元癌候補を検出する、第1段階検出モデルと、
2)第1段階検出モデルによって検出された1つまたは複数の3次元癌候補に対して動作し、縦断的データセット、およびグローバルモデルからの抽出された特徴を組み込み、3次元癌候補の各々に癌確率pを割り当てる、第2段階確率モデルと
を備える、ステップと、
c)第2段階確率モデルによって3次元癌候補の各々に割り当てられた癌確率pから、データセットにおける癌の確率の全体的予測を生成するステップと
を含む。
In one aspect, we use an ensemble of deep learning models for lung cancer in a medical image-based dataset consisting of a recent (eg, current) and longitudinal (previous) image datasets. Describes probabilistic prediction of presence / absence and methods and systems for generating cancer locations. The method is
a) Steps to supply modern and possibly longitudinal datasets to a global predictive model with a 3D deep convolutional neural network that extracts features in the dataset indicating the presence of cancer.
b) The step of supplying the two-step predictive model with the latest and longitudinal datasets, which is the two-step predictive model.
1) A first-stage detection model that detects one or more 3D cancer candidates in the current dataset,
2) Acting on one or more 3D cancer candidates detected by the 1st stage detection model, incorporating longitudinal data sets and features extracted from the global model into each of the 3D cancer candidates With a second-stage probability model, assigning cancer probability p, steps,
c) Includes a step to generate an overall prediction of the probability of cancer in the dataset from the cancer probabilities p assigned to each of the 3D cancer candidates by the second stage probability model.
各態様は、場合によっては、以下の特徴のうちの1つまたは複数を含み得る。1つの構成では、最近のデータセットおよび縦断的データセットが、2段階モデルにおける検出モデルによって検出される癌候補について、ローカルに登録される。別の可能な構成では、最近のデータセットおよび縦断的データセットが、予測を生成するステップより前に、グローバルに登録される。一実施形態では、データセットは、癌スクリーニングのために得られた低線量肺CTイメージングからなる。別の実施形態では、肺CT画像が、診断検査の一部として得られる。別の実施形態では、データセットは、癌スクリーニングのために得られた磁気共鳴イメージング(MRI)データセット、または最近のPET画像データセットおよび縦断的PET画像データセットの形態である。 Each embodiment may optionally include one or more of the following features: In one configuration, recent and longitudinal datasets are registered locally for cancer candidates detected by the detection model in the two-stage model. In another possible configuration, recent and longitudinal datasets are registered globally prior to the step of generating the forecast. In one embodiment, the dataset consists of low-dose lung CT imaging obtained for cancer screening. In another embodiment, lung CT images are obtained as part of the diagnostic test. In another embodiment, the dataset is in the form of a magnetic resonance imaging (MRI) dataset obtained for cancer screening, or a recent PET image dataset and a longitudinal PET image dataset.
以下は、方法の追加の随意の特徴である。1つまたは複数の3次元癌候補が、複数の第2段階確率モデルに提供される。第2段階確率モデルの各々は、3次元癌候補の各々に癌確率pを割り当てる。1つの可能な構成では、複数の第2段階確率モデルの各々が、異なるモデルパラメータによって特徴付けられる。しかしながら、単一の第2段階モデルでは、1つまたは複数の候補を処理する際に、共有重みが使用される。異なるモデルパラメータが、1)データセットにおけるクロップされた3Dデータの異なるボリューム、2)学習中に使用される異なる最適化パラメータ、3)トレーニングの過程の間の異なる時点でモデルをとること、4)トレーニング中のデータ拡大の結果としての異なるパラメータ、ならびに5)各モデルのための深度、カーネルサイズ、および畳み込みの数など、異なるモデルアーキテクチャ設定からなる、パラメータのグループから選択される。ステップc)において、全体的確率は、複数の第2段階確率モデルの各々によって算出された候補の各々のための確率の平均を備える。1つの構成では、第1段階検出モデルおよび第2段階確率モデルは、深層畳み込みニューラルネットワークを備える。第1段階検出モデルは、データセットの全ボリュームにおいて動作する。1つの可能な構成では、グローバルモデルは、癌を示す特徴の抽出が識別された肺組織内のみで動作するように、データセット内の組織を識別する肺セグメンテーション特徴を含む。1つの構成では、方法は、データセットにおける癌の確率の全体的予測を、リスク層別化スキーマのバケットに入れる。リスク層別化スキーマは、Lung-RADS(商標)などの既存のリスク層別化スキーマに近似する。 The following are additional optional features of the method. One or more 3D cancer candidates are provided for multiple second-stage probabilistic models. Each of the second-stage probability models assigns a cancer probability p to each of the three-dimensional cancer candidates. In one possible configuration, each of the multiple second-stage probabilistic models is characterized by different model parameters. However, in a single second-stage model, shared weights are used when processing one or more candidates. Different model parameters are 1) different volumes of cropped 3D data in the dataset, 2) different optimization parameters used during training, 3) different time points during the training process, 4) Different parameters as a result of data expansion during training, as well as 5) selected from a group of parameters consisting of different model architecture settings such as depth, kernel size, and number of convolutions for each model. In step c), the overall probability comprises averaging the probabilities for each of the candidates calculated by each of the plurality of second stage probability models. In one configuration, the first-stage detection model and the second-stage probability model include a deep convolutional neural network. The first stage detection model operates on all volumes of the dataset. In one possible configuration, the global model includes lung segmentation features that identify tissue within the dataset so that extraction of features that indicate cancer works only within the identified lung tissue. In one configuration, the method puts the overall prediction of cancer probability in the dataset into a bucket of risk stratification schema. The risk stratification schema approximates an existing risk stratification schema such as Lung-RADS ™.
方法は、さらには、患者の他のタイプの画像データセット、および特にマルチモーダル画像に適用可能である。特に、別の態様では、マルチモーダル画像ベースのデータセットからの医用画像ベースの癌スクリーニングおよび検出のための方法について説明する。方法は、
a)癌の存在を示すデータセットにおける特徴を抽出する、3次元深層畳み込みニューラルネットワークを備える、グローバル予測的モデルに、マルチモーダルデータセットを供給するステップと、
b)2段階予測モデルにマルチモーダルデータセットを供給するステップであって、2段階予測モデルが、
1)マルチモーダルデータセット(たとえば、3D CT画像データセット)における画像のうちの1つの中の1つまたは複数の3次元癌候補を検出する、第1段階検出モデルと、
2)第1段階検出モデルによって検出された1つまたは複数の3次元癌候補、およびマルチモーダルデータセットにおける他の画像(PET画像およびMRI画像など)、およびグローバルモデルからの抽出された特徴において動作し、3次元癌候補の各々に癌確率pを割り当てる、第2段階確率モデルと
を備える、ステップと、
c)第2段階確率モデルによって3次元癌候補の各々に割り当てられた癌確率pから、データセットにおける癌の確率の全体的予測を生成するステップと
を含む。
The method is further applicable to other types of image datasets of patients, and especially to multimodal images. In particular, in another aspect, methods for medical image-based cancer screening and detection from multimodal image-based datasets will be described. The method is
a) Steps to feed a multimodal dataset to a global predictive model with a 3D deep convolutional neural network that extracts features in the dataset showing the presence of cancer.
b) A step that supplies a multimodal data set to a two-step predictive model, which is a two-step predictive model.
1) A first-stage detection model that detects one or more 3D cancer candidates in one of the images in a multimodal dataset (eg, a 3D CT image dataset).
2) Behavior in one or more 3D cancer candidates detected by the first-stage detection model, as well as other images in multimodal data sets (such as PET and MRI images), and features extracted from the global model. And with a second stage probability model, which assigns the cancer probability p to each of the 3D cancer candidates,
c) Includes a step to generate an overall prediction of the probability of cancer in the dataset from the cancer probabilities p assigned to each of the 3D cancer candidates by the second stage probability model.
ある態様との関連で説明される特徴が、別の態様との関連で実装され得るように、態様が結合され得ることは諒解されよう。 It will be appreciated that aspects can be combined so that the features described in the context of one aspect can be implemented in the context of another.
これらの技法について、概して肺癌との関連で説明するが、これらの技法が、前立腺または乳癌など、肺癌以外の癌に適用され得ることは諒解されよう。 Although these techniques are generally described in the context of lung cancer, it will be appreciated that these techniques can be applied to cancers other than lung cancer, such as the prostate or breast cancer.
本開示の別の態様では、患者が加齢関連脳疾患を発症するリスクがあるか否かを予測するための方法についてさらに説明する。方法は、同じ暦年齢グループに属する認知障害のある被験者および正常な被験者の3D画像(たとえば、構造的磁気共鳴イメージング(SMRI:structural magnetic resonance imaging)またはCT)のデータセットから、領域知識なしに開発された、脳年齢のための予測的モデルを利用する。方法は、
a)患者から1つまたは複数の3D画像を取得し、予測的モデルに、1つまたは複数の3D画像を供給するステップと、
b)予測的モデルを用いて、被験者のための脳年齢予測を生成するステップと、
c)脳年齢予測を、患者の実年齢と比較するステップとを含み、脳年齢予測が、患者の実年齢のものよりも実質的に大きい場合、患者が、加齢関連脳疾患を発症するリスクが高いとして識別される。
In another aspect of the disclosure, a method for predicting whether a patient is at risk of developing age-related brain disease will be further described. The method was developed without domain knowledge from a dataset of 3D images of cognitively impaired and normal subjects belonging to the same calendar age group (eg, structural magnetic resonance imaging (SMRI) or CT). Utilize a predictive model for brain age. The method is
a) Taking one or more 3D images from the patient and feeding the predictive model with one or more 3D images, and
b) Steps to generate a brain age prediction for the subject using a predictive model,
c) A patient is at risk of developing age-related brain disease if the brain age prediction is substantially greater than that of the patient's actual age, including the step of comparing the brain age prediction with the patient's actual age. Is identified as high.
本明細書は、データセットに基づく患者における癌の存在/不在の確率の予測、および存在する場合、CTデータセットにおける癌の位置の生成を目標とする、患者から取得された肺癌スクリーニングCTデータセットの評価のための深層学習方法の開発および実装形態について説明する。本開示の方法は、CTデータセットにおける肺癌検出の特異度および感度を改善する。1つの可能な実施形態では、システムは、トレーニングされた放射線科医による癌患者の診断および治療管理を助けることができる、コンピュータベースの深層学習肺癌検出およびスクリーニングツールとして構成され得る。 The present specification is a lung cancer screening CT data set obtained from a patient with the goal of predicting the presence / absence of cancer in the patient based on the dataset and, if present, generating the location of the cancer in the CT dataset. The development and implementation form of the deep learning method for the evaluation of. The methods of the present disclosure improve the specificity and sensitivity of lung cancer detection in CT datasets. In one possible embodiment, the system can be configured as a computer-based deep learning lung cancer detection and screening tool that can assist trained radiologists in diagnosing and managing treatment of cancer patients.
図1～図4、セクションIの以下の説明では、我々は、我々の深層学習モデルの全体的な概観、および縦断的イメージングデータセットまたはマルチモーダルイメージングデータセットを含まない、イメージングデータセットを用いたその使用について説明する。その概観および説明を念頭に置いて、次いで、本開示はセクションIIに進み、図5～図11とともに、最近の画像データセットおよび縦断的画像データセット、またはマルチモーダルデータセットを使用する、深層学習モデルのアンサンブルの使用について説明する。 In the following description of Figures 1-4, Section I, we used an overall overview of our deep learning model and an imaging dataset that does not include a longitudinal or multimodal imaging dataset. Its use will be described. With that overview and description in mind, this disclosure then proceeds to Section II for deep learning using modern and longitudinal image datasets, or multimodal datasets, along with FIGS. 5-11. Explain the use of model ensemble.
図1および図5のグローバルモデルの開発の、SMRI脳画像への拡張、ならびに脳年齢予測的モデルの開発、および年齢関連脳疾患のリスクが高いとして患者を識別するためのその使用が、本明細書のセクションIIIに記載される。 The extension of the development of the global model in Figures 1 and 5 to SMRI brain imaging, as well as the development of a brain age-predictive model, and its use in identifying patients as at high risk for age-related brain disease are described herein. Described in Section III of the book.
I.概観、モデルのアンサンブル、および縦断的画像データセットまたはマルチモーダル画像データセットなしのその使用(図1～図4)
本開示で説明するモデルの開発およびトレーニングのために、我々は、14,863名の患者からの42,943件のCT検査を含み、そのうちの620名が生検で確認された癌を発症した、National Lung Screening Trial(NLST)データセットを解析した。データセットにおける症例に関する追加の詳細は、アメリカ国立衛生研究所(NIH)Cancer Data Access System[https://biometry.nci.nih.gov/cdas/learn/nlst/images/]を通して入手可能であり、手短に言えば、症例は、複数の機関から低線量で得られたものであり、スライス厚は1.25mmから2.5mmまで変動し(NLSTデータセットからのより大きいスライス厚データは、検討から除去された)、スキャナベンダーは現場によって変動した。症例は、3つのグループ化されたセット、すなわち、トレーニング(70%)、チューニング(15%)、およびテスト(15%)に分割された。癌症例がすべての3つのグループ化されたセットにおいて現れることを保証するためのステップが実行されたので、症例の分割は完全にランダムであるとは限らなかった。癌の存在についてのグランドトゥルースは、患者がスクリーニング年の間に生検または手術で確認された肺癌と診断された(すなわち、真陽性)か否かの決定によって定義された。「陰性」は、NLST結果による癌の不在によって定義された(試験における患者は、6.5年の経過観察の中央値を有した)。データセットは、以下で説明するように、グローバルモデルにおける癌/癌なしに加えて、異なる二項分類を開発するために使用された、CTデータセットに関連付けられた患者のための臨床データを含む。
I. Overview, model ensembles, and their use without longitudinal or multimodal image datasets (Figures 1-4).
For the development and training of the models described in this disclosure, we included 42,943 CT tests from 14,863 patients, of whom 620 developed biopsy-confirmed cancer, National Lung Screening. The Trial (NLST) dataset was analyzed. Additional details about the cases in the dataset are available through the National Institutes of Health (NIH) Cancer Data Access System [https://biometry.nci.nih.gov/cdas/learn/nlst/images/]. In short, cases were obtained at low doses from multiple institutions and slice thicknesses varied from 1.25 mm to 2.5 mm (larger slice thickness data from the NLST dataset were removed from the study. The scanner vendors fluctuated from site to site. Cases were divided into three grouped sets: training (70%), tuning (15%), and testing (15%). Case divisions were not completely random, as steps were taken to ensure that cancer cases appeared in all three grouped sets. Grand truth about the presence of cancer was defined by the determination of whether a patient was diagnosed with (ie, true positive) lung cancer confirmed by biopsy or surgery during the screening year. "Negative" was defined by the absence of cancer as a result of NLST (patients in the study had a median follow-up of 6.5 years). The dataset contains clinical data for patients associated with the CT dataset that was used to develop different binary classifications in addition to cancer / no cancer in the global model, as described below. ..
我々の方法は、0～100%ベースの「悪性尤度スコア」(または、以下のアンサンブル確率PE)を割り当てるように設計されている。次いで、この確率予測が、しきい値処理を介して、1および2対3/4Aおよび4Bのグループ化されたLung-RADSカテゴリー、または他の知られている代替リスク層別化バケットに変換され得る。代替的な、および潜在的に完全に新しいリスクカテゴリー化バケットが、以下でさらに詳細に説明するように、我々のアンサンブル予測から定義され得る。 Our method is designed to assign a "malignant likelihood score" (or ensemble probability PE below) based on 0-100 %. This probability prediction is then transformed into 1 and 2 to 3 / 4A and 4B grouped Lung-RADS categories, or other known alternative risk stratification buckets, via thresholding. obtain. Alternative and potentially completely new risk categorization buckets can be defined from our ensemble forecasts, as described in more detail below.
高いレベルで、CTデータセットから癌確率予測を生成するための我々の手法は、従来技術を改善するものであり、その理由は、我々の手法が、グローバルベースで(すなわち、CTボリューム全体にわたって)、CTデータセットにおける肺組織における癌の存在の確率を予測するようにトレーニングされる、グローバルモデルを含むからである。場合によっては、CTボリュームにおける癌の位置が、グローバルモデルによって、たとえば、以下で説明するようなアテンション機構の使用を通して決定され得る。このグローバルモデルは、3D癌候補1、2、3、...(データセットにおいてクロップされた3Dボリューム)を識別する第1段階または「検出」モデルと、第1段階モデルによって識別された癌候補のための癌確率p1、p2、p3、...を生成する第2段階または「確率」モデルとを含む、2段階予測モデルを含む、モデルのアンサンブルの一部である。次いで、CTデータセットにおける癌の最終スコアまたは確率が、たとえば、グローバルモデルの確率と、癌検出候補にわたる第2段階確率モデルからの全体的または全確率とを平均化することによって、グローバルモデルからの結果と、第2段階予測モデルによって生成された癌確率pとを結合することによって、取得される。上述のように、好ましくは、検出候補の各々のための癌予測を個々に生成している、複数の第2段階確率モデルがあり、たとえば、以下で説明するように、そのような第2段階確率モデルのうちの4つまたは5つが、異なるパラメータを各々が有する。システムおよび方法は、CTデータセットにおける癌の全体的または最終予測確率と位置とを表すデータを生成する。
At a high level, our method for generating cancer probability predictions from CT data sets is an improvement over prior art, because our method is on a global basis (ie, across the CT volume). , Because it contains a global model that is trained to predict the probability of cancer presence in lung tissue in CT datasets. In some cases, the location of the cancer in the CT volume can be determined by a global model, for example, through the use of an attention mechanism as described below. This global model is a first-stage or "detection" model that identifies
図1は、深層学習を使用して、肺癌スクリーニングコンピュータ断層撮影データセットの特異度を改善するための、我々の方法を実施するためのシステム100の図である。患者102が、従来のCTスキャナ104に挿入され、スキャナは、従来のように3D CTデータセット106を生成する。次いで、このCTデータセット106が、グローバル予測的モデル110に供給される。グローバル予測的モデル110は、好ましくは、本質的にパターン認識器として作用し、肺組織におけるCTスキャンデータにおいて癌を認識するようにトレーニングされる、3次元深層畳み込みニューラルネットワークの形態をとる。そのようなネットワークについては、文献、たとえば、Joao Carreira他、Quo Vadis, Action Recognition? A New Model and the Kinetics Dataset、arXiv:1705.07750[cs.CV](2017)、以前に引用したHuang他の論文の380ページにおいて記載されている。Carreira他およびHuang他の論文は、参照により本明細書に組み込まれる。
FIG. 1 is a diagram of
このモデルは、グランドトゥルースアノテーション付きの多数のCTスキャンデータセットから、癌を認識するようにトレーニングされる。この場合には、National Lung Screening Trial(NLST)データセットがトレーニングのために使用された。しかしながら、トレーニングのための他のデータセットが文献において言及されており、それらを使用することができ、たとえば、Huang他の論文において言及された、Lung Image Database Consortium(LIDC)データセット、およびStanfordグループの論文において言及された、KaggleのData Science Bowl 2017 challengeにおいて使用されたCTスキャンデータセットである。一実施形態では、グラフィックス処理ユニット(gpu)メモリの効率的な使用のために、グローバルモデル110のための3D膨張(inflated)Inception V1が使用される。Inception深層畳み込みニューラルネットワークアーキテクチャについては、科学文献において記載されている。その内容が参照により本明細書に組み込まれる、以下の参考文献を参照されたい。すなわち、C. Szegedy他、Going Deeper with Convolutions、arXiv:1409.4842[cs.CV](2014年9月)、C. Szegedy他、Rethinking the Inception Architecture for Computer Vision、arXiv:1512.00567[cs.CV](2015年12月)、また、2015年8月28日に出願されたC. Szegedy他の「Processing Images Using Deep Neural Networks」という米国特許出願第14/839,452号も参照されたい。
This model is trained to recognize cancer from a large number of CT scan datasets with grand truth annotations. In this case, the National Lung Screening Trial (NLST) dataset was used for training. However, other datasets for training are mentioned in the literature and they can be used, for example, the Lung Image Database Consortium (LIDC) dataset and the Stanford group mentioned in Huang et al. The CT scan dataset used in Kaggle's Data Science Bowl 2017 challenge, mentioned in the article. In one embodiment, 3D inflated Inception V1 for
このグローバルモデル110は、グローバルベースで、データセット106における肺組織における癌の存在の確率を少なくとも予測するようにトレーニングされる。一実施形態では、このグローバルモデル110は、CTデータセットにおいて、非肺組織から肺組織を分離するために、肺セグメンテーション特徴を含む。グローバルモデルは、肺組織における癌存在の確率のみを予測する。一実施形態では、マスクR-CNNベースの肺セグメンテーションモデルが、非肺組織を取り除くために、どこでデータセットをセンタークロップするかを判断するために使用され、肺組織における癌検出のためにトレーニングされたモデルのみが、全ボリュームCTスキャンデータの代わりに使用される。この手順は、我々の予測的モデルが、肺癌(すなわち、肺組織における癌)のためのグランドトゥルースアノテーション付きデータセットにおいてのみトレーニングされたとき、非肺組織における癌の潜在的な検出の異常な可能性を除去するものである。
This
グローバルモデル110は、いくつかの二項ヘッド(binary head)または分類器(すなわち、トレーニングデータに基づいて行われることになる予測)、すなわち、NLSTにおけるスクリーニング結果、癌の転帰、および20mmよりも大きい結節の存在を用いてトレーニングされた。たとえば、グローバルモデルは、5年以内の死亡確率、および2年以内の肺癌の診断を予測するようにトレーニングされ得る。グローバルモデルはまた、すべての軸に沿ったランダムフリッピングおよびランダムシフトを含む、3Dデータ拡大を用いてトレーニングされる。
The
追加として、グローバルモデル110、ならびに2段階モデルの第2段階は、モデル予測に最も寄与するデータセットのそれらの部分/領域、すなわち、位置を基本的に識別する、統合勾配などのアトリビューション機構を含み得る。次いで、CTデータセットのこれらの部分が、画像内にアテンション機構から識別された癌領域を囲むバウンディングボックスを追加することによって強調され、それによって、CTボリュームにおける癌の可視化のためのツールをユーザに与え、モデルのアンサンブルによって生成された最終予測が信頼できるという確信をユーザに与えることができる。統合勾配アルゴリズムについては、M. Sundararajan他の論文、Axiomatic Attribution for Deep Networks、arXiv:1703.01365[cs.LG](2017年6月)において記載されており、その内容全体が参照により組み込まれる。この方法について、全体的な画像の分類における、画像における個々のピクセルのアトリビューションの関連で概念的に説明する。基本的には、画像における各ピクセルiのための統合勾配スコアIGi(または、アトリビューション重みもしくは値)が、ベースライン(ゼロ情報、あらゆるピクセル黒、α=0)から、入力画像における全情報(α=1)までの、入力画像情報内容(この例では、輝度のスペクトル)の均等スケーリング(α)を介して算出され、ただし、IGi(各ピクセルのためのスコア)が式(1)によって与えられる。
(1) IGi(image)=imagei*∫0-1▽Fi(α*image)dα
ただし、Fは、ラベルのための予測関数であり、
imageiは、i番目のピクセルの値であり、
IGi(image)は、i番目のピクセルに関する統合勾配、すなわち、i番目のピクセルのためのアトリビューションであり、
▽は、imageiに対する勾配演算子である。
In addition, the
(1) IG i (image) = image i * ∫ 0-1 ▽ F i (α * image) dα
However, F is a predictive function for labels,
image i is the value of the i-th pixel,
IG i (image) is the integration gradient for the i-th pixel, that is, the attribution for the i-th pixel.
▽ is a gradient operator for image i .
Sundararajan他の論文のセクション3は、アルゴリズムについてさらに説明しており、その説明が参照により組み込まれる。CTスキャンの場合のような3Dボリュームへのその技法の適応は、当業者の能力内で考えられる。
深層学習ニューラルネットワークにおけるアテンション機構の使用については、D. Bahdanau他の学会発表、Neural Machine Translation by Jointly Learning to Align and Translate、2014年1月(arXiv:1409.0473[cs.CL])において記載されている。ヘルスケアとの関連でのアテンション機構のさらなる説明には、Choi他、GRAM:Graph-based attention model for Healthcare Representation Learning、arXiv:1611.07012v3[cs.LG]2017年4月、およびChoi他、RETAIN:an Interpretable Predictive Model for Healthcare using Reverse Time Attention Mechanism、arXiv:1608.05745v3[cs.GL]2017年2月が含まれる。 The use of attention mechanisms in deep learning neural networks is described in D. Bahdanau et al., Neural Machine Translation by Jointly Learning to Align and Translate, January 2014 (arXiv: 1409.0473 [cs.CL]). .. For further explanation of the attention mechanism in relation to healthcare, see Choi et al., GRAM: Graph-based attention model for Healthcare Representation Learning, arXiv: 1611.07012v3 [cs.LG] April 2017, and Choi et al., RETAIN: An Interpretable Predictive Model for Healthcare using Reverse Time Attention Mechanism, arXiv: 1608.05745v3 [cs.GL] Includes February 2017.
以前に説明したように、グローバル予測的モデル110は、グローバルベースでCTデータセットにおける肺組織における癌の存在の確率を反映する、予測Pgを生成する。癌の可能性がある位置もまた、たとえば、統合勾配などのアテンション機構の使用を通して識別される。この癌確率112および位置を反映するデータは、図1の方法を実施するコンピュータシステム122のメモリ120など、メモリ内に記憶される。
As previously described, the
CTデータセット106はまた、第1段階検出モデル130および第2段階確率モデル132からなる、2段階予測モデルにも提供される。第1段階検出モデル130は、同じく3D深層CNNの形態をとり得るものであり、1つまたは複数の癌検出候補134(そのうちの3つが図1に示されている)を識別し、候補の各々のためのクロップされた3Dボリューム、たとえば、癌の可能性があるものを囲む、45mm3または90mm3ボリュームを生成する。クロップされた3Dボリュームもまた、統合勾配などのアテンション機構の代替物として、検出された癌の位置を強調するために使用され得る。我々の検出モデルは、以下の論文、すなわち、Tsung-Yo Lin他、Focal Loss for Dense Object Detection、arXiv:1708.02002[cs.CV](2017年8月)において記載されている検出モデルアーキテクチャに基づくが、3次元に一般化されるものである。このモデルは、フォーカルロス(focal loss)1段階検出器をもつRetinaNetと同様であるが、完全に3D畳み込みであり、ターゲット割当てを伴う。このモデルをトレーニングするために、NLSTデータセットにおけるすべての癌陽性およびそれらの前のもののためのバウンディングボックスが収集される。このモデルのパッチベースのトレーニングが使用されるが、検出候補を生成するために全ボリューム推論である。検出モデルは、グローバルモデル110と同じ基本特徴抽出器を使用する。一実施形態では、検出モデルはまた、異なるデータセット(LIDC)における結節検出タスクにおいて事前トレーニングされるが、結節のみがそのセットにおいてラベル付けされ、結節が癌であるか否かは分からない。
The
次いで、図1のこれらの検出候補134が、一実施形態では、同じく3次元に一般化された深層CNNの形態をとる、第2段階確率モデル132に供給され、次いで、第2段階確率モデル132が、候補の各々のための癌確率予測pを生成する。このモデルもまた、フォーカルロスを用いてトレーニングされる(上記で引用したLin他の論文を参照)。検出候補は、検出確率に基づいて、トレーニング時間にランダムにサンプリングされる。90mm3パッチでは、様々な特徴層における予測が別個に作成され、それらが別個の検出候補であるかのように結合される(図3および以下の説明を参照)。このモデルはまた、検出モデル130の重みからトレーニングを開始する。
These
たとえば、再び図1を参照すると、3つの候補134(1、2、3)がある場合、第2段階モデル132は、各候補につき1つずつ、確率のセット[p1,p2,p3]を生成する。
For example, referring again to Figure 1, if there are three candidates 134 (1, 2, 3), the
以前に上述したように、システムは、場合によっては、および好ましくは、複数の第2段階モデル、132A、132B、132C...を含む。各第2段階モデル132A、132B、132Cなどは、検出候補のための確率予測pを作成するためのパラメータの異なるセットを使用する。パラメータにおける可能な違いには、1)検出モデルによって生成された異なるパッチサイズ(すなわち、データセットにおけるクロップされた3Dデータの異なるボリューム)、たとえば、45mm3ボリュームおよび90mm3ボリューム、2)学習率など、学習中に使用される異なる最適化パラメータ、3)トレーニングの過程の間の複数の時点でモデルをとること(各モデルがわずかに異なる予測を有するようになるように、トレーニングの過程にわたって重みが変化する)、4)トレーニング中のデータ拡大の結果としての異なるパラメータ、ならびに5)各モデルのための深度、カーネルサイズ、および畳み込みの数など、異なるモデルアーキテクチャ設定が含まれる。4)の一例として、一実装形態では、モデルをより大きいばらつきに触れさせるために、トレーニングデータが、第2段階確率モデル132のトレーニング中にランダムに改変される。たとえば、一実施形態では、入力ボリュームの小さいランダム回転が生成される。このデータ拡大は、アンサンブルのメンバー(132A、132B...)の間で変動し得るパラメータ、たとえば、ランダム回転の量を有する。5)の一例として、異なる第2段階確率モデルは、各深層畳み込みニューラルネットワークであるが、各々は、異なるモデルアーキテクチャを有し、たとえば、モデルは、深度、カーネルサイズ、および/または畳み込みの数について変動する。
As previously mentioned above, the system may, and preferably includes, multiple second stage models, 132A, 132B, 132C .... Each
そのため、実際には、3つのそのような第2段階確率モデル132が図1に示されているが、実際に使用され得るそのようなモデルの数は、変動することがあり、たとえば、2、4、5、6、10またはそれ以上であり得、各々のためのモデルパラメータは、先行する段落における説明に従って変動する。
So, in practice, three such second-
図2は、図1の第2段階確率モデルによる癌確率予測、および単一の確率モデル132による候補1、2、3のセットのための全体的な癌予測の生成の図である。システムが2つ以上の第2段階モデルを含む場合、図2の手順が第2段階モデルの各々について繰り返される。クロップされた3Dボリュームの形態における候補1が、第2段階確率モデル132に適用され、癌確率予測p1が生成される。同様に、クロップされた3Dボリュームの形態における候補2が、第2段階確率モデル132に適用され、癌確率予測p2が生成される。このプロセスが、候補の各々について繰り返され、そのうちの3つが、図1の例において示されている。癌なしのための確率P(no cancer)が、式2に従って計算される。
(2) P(no cancer)=(1-p1)×(1-p2)×(1-p3)
FIG. 2 is a diagram of cancer probability prediction by the second stage probability model of FIG. 1 and generation of overall cancer prediction for a set of
(2) P (no cancer) = (1-p1) × (1-p2) × (1-p3)
次いで、モデルからの全体的な癌予測が、式3によって与えられる。
(3) P(cancer)=1-P(no cancer)。
システム内に存在する場合、第2段階モデル132B、132Cなどの各々について、同じ計算が行われる。
The overall cancer prediction from the model is then given by
(3) P (cancer) = 1-P (no cancer).
If present in the system, the same calculations are made for each of the
再び図1を参照すると、次いで、CTデータセット106における癌の存在の全体的またはアンサンブル予測であるアンサンブル予測PEが、グローバル予測的モデルの予測PG、および第2段階モデル132A、132Bなどによって生じた予測のセット[p1,p2,p3]A、[p1,p2,p3]Bなどの関数fとして計算される。一実施形態では、予測のセット[p1,p2,p3]A、[p1,p2,p3]B...が、式(2)および式(3)によってP(cancer)に変換され、PA、PB、...として書くことができ、次いで、fが平均化計算である。たとえば、3つの第2段階モデルがある場合、PEが式(4)によって与えられる。
(4) PE=(PG+PA+PB+PC)/4
ただし、PGは、たとえば、0～100のパーセンテージスケールにおける、グローバルモデル確率予測である。
Referring again to FIG. 1, the ensemble prediction PE, which is the overall or ensemble prediction of the presence of cancer in the CT data set 106, is then determined by the prediction P G of the global predictive model, and the
(4) P E = (P G + P A + P B + P C ) / 4
However, P G is a global model probability prediction, for example, on a percentage scale from 0 to 100.
アンサンブル確率PEに達するための様々なモデルの寄与についての実験は、1つまたは複数の第2段階モデルに異なる重みを提供することによって、または第2段階モデルの予測PA、PB、...と同じよりも多いかまたは少ないように、グローバルモデル予測PGに重み付けすることなどによって、平均化計算に加えて、他の可能な解決策を決めることがある。別の例として、第2段階モデル予測PA、PB、...の平均化が実行され得、次いで、この平均が、(直接または重み付けありのいずれかで)グローバルな確率PGと平均化される。異なる関数fについて図4に示されるものなど、受信者動作特性(ROC)AUCプロットの調査が、グローバルモデル予測および第2段階モデル予測を結合するために最適な関数fを決定するために使用され得る。 Experiments on the contribution of various models to reach the ensemble probability PE can be done by providing different weights to one or more second-stage models, or by predicting the second-stage model PA, P B , . In addition to the averaging calculation, other possible solutions may be determined, such as by weighting the global model prediction PG to be more or less than the same as .. As another example, an averaging of the second stage model predictions PA, P B , ... can be performed, and then this averaging is the global probability PG and averaging (either directly or with weighting). Be made. A study of receiver operating characteristic (ROC) AUC plots, such as those shown in Figure 4 for different functions f, was used to determine the optimal function f to combine global model predictions and second-stage model predictions. obtain.
追加として、グローバルモデルがニューラルネットワーク、たとえば、多数の異なる層(たとえば、畳み込み層、完全接続層、アテンション機構など)をもつ深層ニューラルネットワークである構成では、癌予測確率を生成する最終ステップは、最後の層(ただ1つの出力をもつ)である。中間畳み込み層(たとえば、最後から2番目の層)は、ただ1つの数である最終予測よりも多い場合が多い、極めて豊富な情報を含んでいる傾向がある。これらの隠れた中間ユニットまたは層は、出力(「特徴マップ」と呼ばれ、すなわち、特徴およびそれらの位置)を生じ、グローバルモデルにおける改善された最終層/分類器をトレーニングするために、この出力に第2段階モデル(同じく深層畳み込みニューラルネットワーク)の中間層の特徴マップがアペンドされ得る。これは、癌の最終またはアンサンブル確率予測を生成するために、第2段階モデルをグローバルモデルと結合する、さらに別の方法を表す。 In addition, in configurations where the global model is a neural network, eg, a deep neural network with many different layers (eg, convolution layer, fully connected layer, attention mechanism, etc.), the final step in generating the cancer prediction probability is the last. Layer (with only one output). The middle convolutional layer (eg, the penultimate layer) tends to contain a great deal of information, often more than just one number, the final prediction. These hidden intermediate units or layers produce an output (called a "feature map", ie features and their location) and this output to train an improved final layer / classifier in the global model. The feature map of the middle layer of the second stage model (also a deep convolutional neural network) can be attached. It represents yet another way to combine a second-stage model with a global model to generate final or ensemble probability predictions for cancer.
追加として、反対方向に特徴マップをアペンドすることが可能である。すなわち、図5に示されるように、グローバルモデルにおける中間層からの特徴マップが、第2段階モデルにおける中間層の特徴マップに連結され得、最終予測が第2段階モデルから生成される。したがって、いずれの方向において特徴マップをアペンドすることも可能であり、また、両方の方向も可能であり、すなわち、グローバルモデルにおける中間層からの特徴マップが、第2段階モデルにおける中間層における特徴マップに連結され、第2段階モデルにおける中間層からの特徴マップが、グローバルモデルの中間層における特徴マップに連結される。たとえば、グローバルモデルおよび第2段階モデルの開発において、第2段階モデルおよびその層を微調整し続けるが、グローバルモデル特徴をフリーズさせることができる。他の方向が可能であり、その場合、第2段階モデルがフリーズされ、第2段階モデルからグローバルモデルに特徴マップをアペンドすることで、グローバルモデルを微調整し続けることができる。モデルが完全に開発およびフリーズされると、次いで、上記で説明したように、アンサンブル確率を生成するために、いずれかの方向で、または両方の方向で、特徴マップのアペンドを実行することができる。 In addition, it is possible to append feature maps in the opposite direction. That is, as shown in FIG. 5, the feature map from the middle layer in the global model can be linked to the feature map of the middle layer in the second stage model, and the final prediction is generated from the second stage model. Therefore, it is possible to append the feature map in either direction, and both directions are possible, that is, the feature map from the middle layer in the global model is the feature map in the middle layer in the second stage model. The feature map from the middle layer in the second stage model is connected to the feature map in the middle layer of the global model. For example, in developing a global model and a second stage model, you can continue to tweak the second stage model and its layers, but freeze the global model features. Other directions are possible, in which case the second stage model freezes and you can continue to tweak the global model by appending the feature map from the second stage model to the global model. Once the model is fully developed and frozen, feature map appends can then be performed in either direction or in both directions to generate the ensemble probabilities, as described above. ..
次いで、上記で説明したようなモデルのアンサンブルの確率予測に基づいて、既存のLung-RADS(商標)リスク層別化バケットの代替物を提案することが可能である。たとえば、CTスキャン癌予測をリスクバケットに入れるために、この最終確率においてカットオフを設定することができる。一例として、仮定の確率カットオフを使用すると、0<PE<0.1である場合、それが第1のリスクバケットになる。0.1<PE<0.2である場合、それが第2のバケットになる、などである。我々の確率予測のための適切なカットオフを決定することによって、今日のLung-RADS(商標)において存在するリスクバケットと同様であるバケットを作成することが可能である。そのようなカットオフは、所与のデータセット(たとえば、NLSTデータセット)に、遡及的にアンサンブル確率を生成する方法を適用すること、ならびに、提案されたカットオフスキーマの各グループ化における患者に関連付けられた臨床データを検査すること、およびグループ化における患者における臨床データが、Lung-RADS(商標)などの既存の知られているグループ化、または設計され得る任意の新しいグループ化スキーマに一致または近似するまで、カットオフを調整することによって、確認され得る。我々は、Lung-RADS 3+、Lung-RADS 4A+、およびLung-RADS 4B/XのPPVを推定するために、以前から存在している手法を複製することを提案する。次いで、我々は、3つの既存のリスクバケットと比較するために、我々のチューンセットにおいてこれらのPPV値に一致した動作点を選定した。これらの動作点は、同じLung-RADSスコアをもつ悪性腫瘍陽性のためのLung-RADSカットオフと相関するように設計された、3+、4a+、および4b/xの「gRADS」スコアとして知られている。
It is then possible to propose an alternative to the existing Lung-RADS ™ risk stratification bucket based on the probability prediction of the model ensemble as described above. For example, a cutoff can be set at this final probability to put the CT scan cancer prediction into the risk bucket. As an example, using the hypothetical probability cutoff, if 0 <P E <0.1, it becomes the first risk bucket. If 0.1 <P E <0.2, it becomes the second bucket, and so on. By determining the appropriate cutoff for our probability prediction, it is possible to create a bucket similar to the risk bucket that exists in Lung-RADS ™ today. Such cutoffs apply a method of retroactively generating ensemble probabilities to a given dataset (eg, NLST dataset), as well as to patients in each grouping of the proposed cutoff schema. Examining associated clinical data, and clinical data in patients in grouping, match existing known grouping, such as Lung-RADS ™, or any new grouping schema that can be designed. It can be confirmed by adjusting the cutoff until it is close. We propose to duplicate the pre-existing method to estimate the PPV of Lung-
図3は、単一の第2段階モデル132によって、所与の入力癌候補3Dボリューム134のための特徴マップ、および次いで予測p1、p2、p3を生成する、マルチスケール特徴抽出方法の図である。モデル132は、層200、202、204を含む、3D Inception深層畳み込みニューラルネットワークからなる。平均プール層は、入力の矩形領域を平均化することによってダウンサンプリングする。平均プールは、予測p1の形態における分類を生成する高密度分類層(dense classification layer)206に提供される、分類のための多数の特徴(576個の特徴など)のベクトルを生成する。3D Inceptionモデルにおける他の層202および204は、追加のボリュームおよびそれぞれの分類特徴を生成し、高密度分類層は、分類予測p2およびp3を生成する。したがって、この例では、第2段階モデルに供給された単一の癌検出候補が、3つの異なる癌確率予測、p1、p2およびp3を生じる。
FIG. 3 is a diagram of a multiscale feature extraction method that produces feature maps for a given
図4は、受信者動作特性(ROC)AUC曲線としての、我々のアンサンブル方法の性能のプロットを示す。図4は、提案する方法の感度および特異度をプロットする。高特異度の動作点が、前のものなしでLung-RADS(商標)を使用する人間の読影者との比較とともに示される。深層学習モデルの受信者動作曲線下の面積は、94.2%(95%信頼区間(CI)91.0, 96.9)であった。テストセットにおいてLung-RADS(商標)を使用する放射線科医と比較すると、トレーニングされたモデルは、統計的に有意な絶対9.2%(95% CI 8.4, 10.1)高い特異度を達成し、3.4%(95% CI -5.2, 12.6)高い感度(統計的に有意ではない)を示した。放射線科医は、モデルとLung-RADS(商標)との間の不一致を定性的に検討した。予備解析は、モデルが傷と早期悪性腫瘍を区別することにおいて優れている可能性があることを示唆している。 Figure 4 shows a plot of the performance of our ensemble method as a receiver operating characteristic (ROC) AUC curve. Figure 4 plots the sensitivity and specificity of the proposed method. A high specificity operating point is shown, along with a comparison with a human reader using Lung-RADS ™ without the previous one. The area under the receiver operating curve of the deep learning model was 94.2% (95% confidence interval (CI) 91.0, 96.9). Compared to radiologists using Lung-RADS ™ in the test set, the trained model achieved a statistically significant absolute 9.2% (95% CI 8.4, 10.1) high specificity, 3.4%. (95% CI -5.2, 12.6) High sensitivity (not statistically significant) was shown. The radiologist qualitatively examined the discrepancy between the model and Lung-RADS ™. Preliminary analysis suggests that the model may be superior in distinguishing between wounds and early-stage malignancies.
したがって、本開示は、肺癌検出およびスクリーニングのための改善された深層学習手法を提示する。モデルのアンサンブルは、放射線科医によるCTスキャンデータセットにおける偽陽性の回避を助けることによって、不要な侵襲的手順(たとえば、生検、手術)の低減に潜在的に役立つことができる。 Therefore, the present disclosure presents an improved deep learning approach for lung cancer detection and screening. Model ensembles can potentially help reduce unnecessary invasive procedures (eg, biopsy, surgery) by helping radiologists avoid false positives in CT scan datasets.
II.現在の画像データセットおよび縦断的画像データセット、ならびに/またはマルチモーダル画像データセットを伴う、深層学習モデルのアンサンブル
本明細書の背景技術のセクションにおいて上述したように、縦断的画像データセット(すなわち、現在または直近の画像データセットとの比較のために利用可能な前の患者画像データセット)、およびマルチモーダル画像データセットは、診断画像における癌スクリーニング診断または癌検出の改善に役立つことができる。多くの場合、そのようなデータセットの解釈は、放射線科医が複数の時間にわたって画像の同じ領域を比較することによって、手動または半自動的に実行される。深層学習を使用する自動化された手法は、癌を識別および分類するために、複数の画像にわたって微妙な手掛かりを識別するための能力を提供することができる。我々は、本明細書のこのセクションにおいて、深層学習モデルのアンサンブルを使用する癌検出および分類のために、縦断的またはマルチモーダルイメージングを組み込むための一般的な手法を提示する。
II. Ensemble of deep learning models with current and longitudinal image datasets, and / or multimodal image datasets, as described above in the Background Techniques section of this specification. That is, previous patient image data sets available for comparison with current or recent image data sets), and multimodal image data sets can help improve cancer screening diagnosis or cancer detection in diagnostic images. .. Interpretation of such datasets is often performed manually or semi-automatically by the radiologist comparing the same area of the image over multiple hours. Automated techniques that use deep learning can provide the ability to identify subtle cues across multiple images to identify and classify cancer. In this section of the specification, we present common techniques for incorporating longitudinal or multimodal imaging for cancer detection and classification using ensembles of deep learning models.
以下の説明では、例として、現在の画像データセットおよび前の画像データセットを含む、低線量(LD)胸部コンピュータ断層撮影(CT)画像からの肺癌スクリーニングのトピックを提示する。しかしながら、説明する手法は、たとえば、前立腺癌検出および分類のための縦断的磁気共鳴イメージング(MRI)データセットなど、他の癌のトピックおよび放射線学イメージングモダリティに一般化することができる。 The following discussion presents, by example, the topic of lung cancer screening from low-dose (LD) chest computer tomography (CT) images, including current and previous image datasets. However, the techniques described can be generalized to other cancer topics and radiological imaging modalities, such as longitudinal magnetic resonance imaging (MRI) datasets for prostate cancer detection and classification.
深層学習モデルのアンサンブルは、たとえば、グローバルベースで癌の存在を示すデータセットにおける特徴を抽出する、3D Inceptionアーキテクチャを使用する、3D畳み込みニューラルネットワーク(CNN)の形態におけるグローバルモデルを含む。このグローバルモデルは、グローバルベースで(たとえば、医用画像データセットが3Dボリュメトリック画像データセットからなる場合、CTボリューム全体にわたって)、医用画像ベースのデータセットにおける癌の存在の確率および位置を予測し、この予測に関連付けられる特徴を識別または抽出するようにトレーニングされ得る。グローバル予測的モデルは、入力として、最近の画像データセット、および場合によっては縦断的画像データセットを使用する。したがって、グローバルモデルは、入力として、ボリュームデータセット全体(たとえば、最近のもの、および場合によっては縦断的データセット)をとることがあり、癌の存在を示す特徴を抽出する。場合によっては、肺癌のためのCTデータセットの一例では、このグローバルモデルは、胸部CTデータセットにおいて非肺組織から肺組織を分離するための特徴を含み、肺組織のみにおける癌の存在を示す特徴のセットを抽出する。 An ensemble of deep learning models includes, for example, a global model in the form of a 3D convolutional neural network (CNN) that uses a 3D Inception architecture to extract features in datasets that indicate the presence of cancer on a global basis. This global model predicts the probability and location of cancer in a medical image-based dataset on a global basis (for example, if the medical image dataset consists of a 3D volumetric image dataset, across the CT volume). It can be trained to identify or extract features associated with this prediction. The global predictive model uses a recent image dataset and, in some cases, a longitudinal image dataset as input. Therefore, the global model may take the entire volume dataset (eg, recent and possibly longitudinal datasets) as input to extract features that indicate the presence of cancer. In some cases, in one example of a CT dataset for lung cancer, this global model includes features for separating lung tissue from non-lung tissue in a chest CT dataset, a feature that indicates the presence of cancer in lung tissue alone. Extract a set of.
深層学習モデルのアンサンブルはまた、入力として最近の画像データセットおよび縦断的画像データセットを受信する、2段階予測モデルを含む。この2段階予測モデルは、第1段階または検出モデルと、第2段階または確率モデルとを含む。検出モデルは、現在のCTデータセットのフルボリュームにおいて動作し、癌検出候補(たとえば、CTデータセットにおいて、癌性である場合もそうでない場合もある、単なる結節ではなく、癌であり得る候補を含んでいる、CTデータセットにおける3Dデータの異なるクロップされたボリューム)を識別する。次いで、癌検出候補ボリュームは、登録または相対ランドマーク位置決め(relative landmark positioning)手順を介して、前のフルボリュームデータセットにおいて位置特定される。癌検出候補ボリュームの各々は、3D特徴抽出器、たとえば、グローバルモデルにおいて使用されるような、3D Inceptionアーキテクチャなどの深層畳み込みニューラルネットワークを含む、第2段階モデルを通過させられる。 An ensemble of deep learning models also includes a two-step predictive model that receives recent and longitudinal image datasets as inputs. This two-stage predictive model includes a first-stage or detection model and a second-stage or probabilistic model. The detection model works with the full volume of the current CT data set and can detect cancer (eg, in the CT data set, which may or may not be cancerous, not just a nodule, but a candidate for cancer. Identify different cropped volumes of 3D data in the CT dataset that contain it. The cancer detection candidate volume is then located in the previous full volume dataset via a registration or relative landmark positioning procedure. Each of the cancer detection candidate volumes is passed through a 3D feature extractor, eg, a second-stage model that includes a deep convolutional neural network such as the 3D Inception architecture used in global models.
癌検出候補の各々のための特徴抽出器からの特徴のすべて(本明細書では「特徴マップ」)が、平均プーリングおよび/または畳み込み層における演算後に連結される。これらの特徴はまた、グローバルモデルから抽出された特徴(特徴マップ)と連結される。そのような連結後、第2段階または確率モデルは、癌検出候補の各々に癌確率pを割り当てる、分類動作を(たとえば、ニューラルネットワークアーキテクチャにおける1つまたは複数の完全接続層の動作によって)実行する。言い換えれば、グローバルモデルから抽出される特徴が、第2段階モデルからの各癌検出候補パッチのための特徴と連結されるので、すべての予測が、(2段階モデルのうちの第1段階からの)結節レベルの位置情報、ならびにグローバルモデルからのグローバルコンテキストの両方に依拠するようになる。各癌検出候補のための予測が、たとえば、以下で説明するようなnoisy-or手法に基づいて計算される、イメージングデータセットのための単一の悪性度スコアに結合され得る。手短に言えば、各癌検出候補からの予測が、その候補のための悪性腫瘍の確率として解釈され、(ボリューム全体における)最終予測は、以下で説明するように、これらのROIのうちの少なくとも1つが悪性である確率である。この最終確率予測は、以下で「悪性度スコア」と呼ばれる。 All of the features from the feature extractor for each of the cancer detection candidates (“feature maps” herein) are concatenated after calculation in the mean pooling and / or convolution layer. These features are also concatenated with features (feature maps) extracted from the global model. After such concatenation, the second stage or probability model performs a classification operation (eg, by the operation of one or more fully connected layers in a neural network architecture) that assigns a cancer probability p to each of the cancer detection candidates. .. In other words, all predictions (from the first stage of the two-stage model) are concatenated with the features extracted from the global model for each cancer detection candidate patch from the second-stage model. ) Will rely on both nodule-level location information as well as the global context from the global model. Predictions for each cancer detection candidate can be combined, for example, into a single grade score for an imaging dataset, calculated based on a noisy-or approach as described below. Briefly, the predictions from each cancer detection candidate are interpreted as the probability of malignant tumors for that candidate, and the final prediction (over the volume) is at least one of these ROIs, as explained below. One is the probability of being malignant. This final probability prediction is referred to below as the "malignancy score".
悪性度スコアが与えられると、癌のあり得る位置であるボリュームにおける領域または位置が、最高スコアを引き起こした、2段階モデルのうちの第1段階または検出モデルからのサブボリュームを取ることによって、強調され得る。サブボリューム内で、統合勾配など、当技術分野で「アテンション機構」としても知られるアトリビューション方法が、より正確に位置を識別するために使用され得る。追加として、グローバルモデルにおけるアトリビューション方法が、癌予測につながる画像における複数の領域を識別するために使用され得る。これは、異常なリンパ節、または癌性の結節の周囲の血管組織さえも含み得る。 Given a grade score, the region or location in the volume that is the possible location of the cancer is highlighted by taking a subvolume from the first stage of the two-stage model or the detection model that caused the highest score. Can be done. Within the subvolume, attribution methods, also known in the art as "attention mechanisms", such as integration gradients, can be used to more accurately identify positions. In addition, attribution methods in the global model can be used to identify multiple regions in the image that lead to cancer prediction. This can include abnormal lymph nodes, or even vascular tissue around cancerous nodules.
1つの可能な構成では、3つ、5つ、または10個もなど、2つ以上の異なる第2段階確率モデル、たとえば、モデルA、B、C、Dなどがあり得、各々がそれ自体のパラメータのセットをもち、各々が、最近の画像データセットおよび前の画像データセットと、グローバルモデルおよび検出モデルから抽出された特徴の両方を使用して、検出候補の各々における癌の確率の予測を作成する。そのような第2段階モデルを定義するパラメータにおける可能な違いには、1)異なるパッチサイズ(すなわち、異なるスケールで癌を検出するために、データセットにおけるクロップされた3Dデータの様々なサイズのボリューム)、2)学習率など、学習中に使用される異なる最適化パラメータ、3)トレーニングの過程の間の複数の時点でモデルをとること(各モデルがわずかに異なる予測を有するようになるように、トレーニングの過程にわたって重みが変化する)、4)トレーニング中のデータ拡大の結果としての異なるパラメータ、ならびに5)各モデルのための深度、カーネルサイズ、および畳み込みの数など、異なるモデルアーキテクチャ設定が含まれる。具体的には、一実装形態では、モデルをより大きいばらつきに触れさせるために、トレーニングデータが、トレーニング中に追加のトレーニングデータを生成するように修正され得る。たとえば、小さいランダム回転が、入力ボリュームに適用されて、追加のトレーニングボリュームが生成され得る。このデータ拡大は、アンサンブルのメンバーの間で変動し得るパラメータ、たとえば、ランダム回転の量を有する。 In one possible configuration, there can be two or more different second-stage probability models, such as three, five, or even ten, for example, models A, B, C, D, etc., each of which is itself. Each has a set of parameters, each using both recent and previous image datasets and features extracted from global and detection models to predict the probability of cancer in each of the detection candidates. create. Possible differences in the parameters that define such a second stage model are: 1) Volumes of various sizes of cropped 3D data in the dataset to detect cancer at different patch sizes (ie, different scales). ), 2) Different optimization parameters used during training, such as learning rate, 3) Taking models at multiple points in the training process (so that each model has slightly different predictions) Includes different model architecture settings such as), 4) different parameters as a result of data expansion during training, and 5) depth, kernel size, and number of convolutions for each model. Is done. Specifically, in one implementation, the training data may be modified to generate additional training data during training in order to expose the model to greater variability. For example, a small random rotation can be applied to the input volume to generate an additional training volume. This data expansion has parameters that can vary among the members of the ensemble, such as the amount of random rotation.
第2段階確率モデルによって生成された予測確率が、たとえば、何らかの定義関数f、またはアルゴリズムに従って結合されて、医用画像ベースのデータセットにおける癌/癌なしの全体的または最終確率予測(たとえば、典型的には0から100までのパーセンテージを単位として提示される「悪性度スコア」)、および癌の可能性がある位置が生成され得る。1つの構成では、これらの確率はまた、既存のスコアリングスキーマに近似するために、または新しいものを定義することによってのいずれかで、新規のスコアリング方法においても使用され得る。定義関数fは、第2段階モデルの各々の、すなわち、すべての癌検出候補にわたって、または加重平均の形式において計算される、予測された確率の平均化からなり得る。 The predictive probabilities generated by the second-stage probability model are combined, for example, according to some definition function f, or algorithm, to make a cancer / cancer-free overall or final probability prediction (eg, typical) in a medical image-based dataset. A "malignancy score") presented in units of percentages from 0 to 100, and potential locations of cancer can be generated. In one configuration, these probabilities can also be used in new scoring methods, either to approximate an existing scoring scheme or by defining a new one. The definition function f can consist of an average of the predicted probabilities of each of the second stage models, i.e., calculated over all cancer detection candidates or in the form of a weighted average.
図5は、縦断的イメージングを用いる癌の深層学習ベースの分類のための我々のシステムおよび方法を示す。読者は、図1において上記で説明したシステムとの全体的な類似性に気付くであろうが、少しの違いがあり、図5は、入力として縦断的画像データセットを使用するための追加の能力を含み、グローバルモデルが、本質的に予測のために使用されず、むしろ、癌の存在を示すデータセットにおける特徴(すなわち、特徴マップ)を抽出するために使用され、そのような特徴が、第2段階確率モデルの抽出された特徴にアペンドまたは連結されて、1つまたは複数の検出された癌候補における癌の確率の予測が生成される。 Figure 5 shows our system and method for deep learning-based classification of cancer using longitudinal imaging. The reader will notice the overall similarity to the system described above in Figure 1, but with a few differences, Figure 5 shows the additional ability to use a longitudinal image dataset as input. The global model is not used essentially for prediction, but rather is used to extract features (ie, feature maps) in the dataset indicating the presence of cancer, such features being the first. Appended or linked to the extracted features of the two-step probability model to generate a prediction of the probability of cancer in one or more detected cancer candidates.
我々の手法は、高レベルで、現在のCTボリューム520および縦断的または前のCTボリューム522を含む、3D CTパッチにおける癌性の結節検出のための第1段階または検出モデル502Aと、後続の、第2段階または確率モデル502Bによる、トップの検出された関心領域(ROI)における悪性腫瘍予測とを含む、2段階モデル502からなる。加えて、システムは、グローバルベースで、癌を示すデータセットにおける特徴を抽出するために、現在のCTボリューム504、および場合によっては前のCTボリューム506をそれぞれ使用して、ボリューム全体において動作するエンドツーエンドグローバル畳み込みモデル500を含む。前のCTボリューム506の使用は、モデルの性能におけるわずかな改善を与えることがあり、随意であり、必要ではないものと見なされる。グローバルモデルからの特徴が、第2段階モデルから抽出された特徴にアペンドされるので、(538で示された分類器によって生成された)すべての予測が、結節レベルのローカル情報、ならびにグローバルコンテキストの両方に依拠するようになる。出力540は、以下で説明するNoisy-or手法などのアルゴリズムまたは関数を使用する、現在のCT画像データセットおよび前のCT画像データセットが与えられた、患者のための癌の確率予測である。
Our approach includes a high-level, first-stage or detection model 502A for the detection of cancerous nodules in a 3D CT patch, including a
現在の画像および縦断的画像の随意に再サンプリングされたフルボリュームが、グローバルモデル500の3D特徴抽出器(508)、たとえば、3D Inception深層CNNを通過させられて、グローバルコンテキストが取り込まれる。特徴は、1,024個の特徴チャネルをもつ、8×8×8のより小さいボリューム(510)として表される。これらの特徴が、図5の上側部分において示されるように、チャネル次元において連結され、514で示されるように、512個の特徴の畳み込み層および平均プールにおいて結合される。次いで、特徴マップが、536で示されるように、第2段階確率モデルからの特徴マップと連結される。 The voluntarily resampled full volume of the current and longitudinal images is passed through a 3D feature extractor (508) in Global Model 500, for example, a 3D Inception deep CNN to capture the global context. Features are represented as smaller volumes (510) of 8x8x8 with 1,024 feature channels. These features are linked in the channel dimension, as shown in the upper part of FIG. 5, and coupled in the convolutional layer and average pool of 512 features, as shown by 514. The feature map is then concatenated with the feature map from the second stage probabilistic model, as shown by 536.
2段階モデル502は、入力として、フルボリュームの現在の高解像度CTデータセット520、および前のフルボリュームの高解像度CTデータセット522を受信し、2段階モデルは、単に本質的に結節ではなく、癌候補を検出するようにトレーニングされる、結節検出器524の形態において、第1段階または検出モデル502Aを含む。これらの癌候補(サブボリューム)のうちの1つが、528に示される。登録または相対ランドマーク位置決め手順を使用して、このより小さいサブボリュームまたはROIはまた、前のフルボリュームCTデータセット522においても識別され、526で示される。代替的に、結節検出器524は、対応するROI526を識別するために、前のフルボリュームCTデータセットにおいて動作することができる。各サブボリュームまたはROI526、528は、3D特徴抽出器(530)、たとえば、3D Inception深層畳み込みニューラルネットワークを含む、第2段階確率モデルに移動する。3D特徴抽出器530は、共有重み、すなわち、特徴をどのように処理するかを示す重みを使用し、これらの重みは、グローバルモデルの3D特徴抽出器508の重みと同じである必要はない。小さいボリューム532は、1,024個の特徴チャネルの圧縮ボリューム(1×2×2)を表す。これらのボリュームが、図5に示されるように、チャネル次元において連結され、534で示されるような平均プーリングおよび/または畳み込み層を受けて、512個の特徴が生じる。534から生じるこの特徴マップが、536で、グローバルモデルからの512個の特徴の特徴マップと連結され、次いで、結合された1,024個の特徴が、538で示されるような分類動作を受ける(たとえば、第2段階確率モデル502Bにおける完全接続層の出力)。この分類ステップは、第1段階モデルの結節検出524によって識別されたROIの各々のための確率予測の生成である。出力540として、単一の悪性度スコアが、noisy-or手法に基づいて計算される。サブボリュームまたはROIの数は、適用例および要件に応じて変動し得ることに留意されたい。また、前のイメージングが利用可能ではない場合には、空白画像が、ネットワークを通して供給され得る。これは、モデルが空白画像を受け入れるようにトレーニングされる限り、可能である。
The two-step model 502 receives the full-volume current high-
各ROIからの予測が、noisy-or手法を使用して、ボリューム全体における出力ステップ(540)において、単一の悪性度スコアに結合され、各ROIからの予測が、そのROIのための悪性腫瘍の確率として解釈され、(ボリューム全体における)最終予測は、これらのROIのうちの少なくとも1つが悪性である確率である。 Predictions from each ROI are combined into a single grade score in the output step (540) across the volume using the noisy-or method, and the predictions from each ROI are malignant tumors for that ROI. Interpreted as the probability of, the final prediction (over the volume) is the probability that at least one of these ROIs is malignant.
ただし、P[ROI悪性腫瘍]は、所与のROIのために分類プロセス(538)によって生成された予測である。これは、上記で説明したような図1における、前のものなしのシステムのための確率予測の生成についての説明と同様である。 However, P [ROI malignancies] is a prediction generated by the classification process (538) for a given ROI. This is similar to the description of generating probability predictions for the previous non-existent system in FIG. 1 as described above.
図5において上記で説明したシステムは、前の画像データセットまたは縦断的画像データセット、および現在の画像データセットを有する、MRI、PET、またはCTスキャンなど、異なるタイプの3Dボリュメトリックデータセットに適用可能であることは諒解されよう。また、図5のシステムは、現在のデータセットおよび縦断的データセットの代わりに、マルチモーダルデータセットを有する状況にも適用可能であり、マルチモーダルデータセットにおいては、「前の」ボリューム、たとえば、図5におけるCTボリューム522の代わりに、たとえば、入力として、CTおよびMRIデータセット対、またはCTおよびPETデータセット対、またはMRI、CT、およびPETデータセットトリプレット、または、たとえば、たとえば当技術分野でマルチモーダルMRI画像データセットとして知られていることがある、異なるタイプのMRI画像を取得するようにスキャナの設定を制御することによって、単一のMRIスキャニング動作において取得されるMRI画像のセットなど、異なるタイプの3Dボリュームデータセットを有することも諒解されよう。
The system described above in Figure 5 applies to different types of 3D volumetric datasets, such as MRI, PET, or CT scans, which have a previous or longitudinal image dataset and a current image dataset. It will be understood that it is possible. The system of FIG. 5 is also applicable to situations where it has a multimodal data set instead of the current and longitudinal data sets, in which in a multimodal data set a "previous" volume, eg, Instead of the
前のモダリティ画像データセットまたは他のモダリティ画像データセットを考慮に入れる深層学習システムの一般化された図が、図6に示されている。562および560に示されるように、好ましくは、画像が重複するか、または登録内にあるように、すべての画像データセットを共通の3D座標系に持ち込むように実行される、初期融合または登録ステップがある。登録または融合の精度の度合いは、特に重大ではない。 A generalized diagram of a deep learning system that takes into account the previous modality image dataset or other modality image dataset is shown in Figure 6. Initial fusion or registration steps, preferably performed to bring all image datasets into a common 3D coordinate system, as shown in 562 and 560, preferably such that the images overlap or are in the registration. There is. The degree of accuracy of registration or fusion is not particularly significant.
次いで、グローバルモデル500は、グローバルベースで、フルボリュームにおける癌の存在を示す特徴を抽出するために、特徴抽出器508(たとえば、3D Inceptionアーキテクチャ深層畳み込みニューラルネットワーク)を用いて、フルボリューム画像データセットにおける動作を進める。これらの特徴が、チャネル次元において連結され、514で、畳み込み層および平均プーリングを受ける。グローバルモデルにおける前のモダリティ画像または他のモダリティ画像(506)の使用は、やはり随意であり、必須ではないと見なされ、前のモダリティ画像または他のモダリティ画像の使用は、全体的モデル性能をわずかに改善し得る。 The Global Model 500 then uses a feature extractor 508 (eg, a 3D Inception architecture deep convolutional neural network) to extract features that indicate the presence of cancer at full volume on a global basis. Proceed with the operation in. These features are linked in the channel dimension and at 514 undergo a convolutional layer and average pooling. The use of the previous modality image or other modality image (506) in the global model is also considered voluntary and not required, and the use of the previous modality image or other modality image has a slight overall model performance. Can be improved.
同時に、フルボリュームデータセット520、522のうちの一方が、癌検出候補528であるサブボリューム(サブボリューム1)を識別する3D検出モデル524を受け、早期融合プロセスの結果を使用して、対応するサブボリュームまたはROI526が、他方のボリューム522において識別される。この例では、検出モデル524によって識別されたn個の癌検出候補があり、ただし、nは、1以上の何らかの整数、典型的には、たとえば、2、3、または5である。したがって、n個のROIがある。n個のサブボリュームまたはROIの各々は、チャネル次元において1,024個の特徴をもつ圧縮ボリュームを生成する3D特徴抽出器530(3D Inceptionなどの深層畳み込みニューラルネットワーク)を受ける。
At the same time, one of the
これらのn個のROIの各々について、これらのボリュームがチャネル次元において連結される。追加の畳み込み層および平均プーリング(534)による処理後、次いで、各インスタンスが、グローバルモデルからの特徴マップによって連結され、次いで、538で示されるような分類動作を受けて、n個のROIの各々のための確率予測が生じる。次いで、これらの確率予測が、上記で説明したNoisy-Or手法を使用して結合される。 For each of these n ROIs, these volumes are concatenated in the channel dimension. After processing with additional convolutional layers and mean pooling (534), each instance is then concatenated by a feature map from the global model and then subjected to a classification behavior as shown in 538, each of the n ROIs. Probability prediction for. These probability predictions are then combined using the Noisy-Or method described above.
図5および図6の説明が、単一の第2段階確率モデル502Bを使用していることは諒解されよう。しかしながら、セクション1の説明において説明したように、複数の第2段階確率モデルを使用することが可能であり、その場合、第2段階確率モデルの各々がわずかに異なるモデルパラメータを有し、次いで、第2段階確率モデルの結果が、何らかの関数fに従って結合されるか、またはすべてのモデルの間で平均化され、次いで、平均化の後、Noisy-Or手法に従って、最終確率が生成される。
It can be inferred that the descriptions in Figures 5 and 6 use a single second-stage probability model 502B. However, as described in
図7A～図7Cは、NLSTデータセットとの、トレーニングを受けた読影者によるLung-RADS(商標)基準の遡及的比較に関する、現在の画像データセットおよび縦断的画像データセットありおよびなしの、図5のシステムの性能を示す、受信者動作特性曲線下面積(AUC)プロットである。 Figures 7A-7C show the current and longitudinal image datasets with and without the current and longitudinal image datasets for a retrospective comparison of the Lung-RADS ™ criteria by trained readers with the NLST dataset. It is the area under the receiver motion characteristic curve (AUC) plot which shows the performance of 5 systems.
図8A～図8Cは、2段階モデルのうちの第1段階または検出モデルによって、潜在的に癌性であるとして識別された関心領域を定義する、バウンディングボックス800を伴う、患者の縦断的CTスキャン画像である。
8A-8C are longitudinal CT scans of patients with a
図9A～図9Cは、2段階モデルのうちの第1段階または検出モデルによって、潜在的に癌性であるとして識別された関心領域を示すボックス902を伴う、患者の3つの異なるCTスキャン画像の別の例である。より大きいバウンディングボックス900は、第2段階モデルの予測モジュールが癌の確率の予測を作成するため、および周囲のコンテキスト情報を提供するために利用可能である。
9A-9C show three different CT scan images of the patient with a
図10Aおよび図10Bは、識別されたROIの中心に基づく、前のCTスキャン画像および現在のCTスキャン画像の登録の一例を示す。 FIGS. 10A and 10B show an example of registration of previous and current CT scan images based on the identified ROI center.
図11A～図11Cは、第2段階モデルにおける、統合勾配などのアテンション機構の使用の一例を示す。図11Aでは、癌性の可能性が高いと予測された関心領域を示す、CTスキャン画像1100の部分が示されている。図11Bは、図11Aの画像1100へのアテンション機構の適用の結果、すなわち、癌の可能性が高い予測に最も寄与した、画像1100の特定の領域を示すために、対比色で示される小さい領域1102を示す。図11Cでは、画像1100が再びレンダリングされているが、図11Bのアテンション機構結果1102が重ね合わせられている。簡単に言えば、図11Cの画像を調査している放射線科医が、アテンション機構の使用の結果として、癌の予測の最大の原因である画像の部分(1102)に向けられる。
FIGS. 11A-11C show an example of the use of attention mechanisms such as integration gradients in the second stage model. FIG. 11A shows a portion of
さらなる留意事項
図1のシステムは、クラウド環境において展開され得、クラウド環境では、グローバル予測的モデルおよび2段階予測的モデルが、リモートで(たとえば、モデルをトレーニングおよび開発したサービスプロバイダによって、たとえば、クラウドにおいて)実装される。この構成では、CTスキャンデータセットが、コンピュータネットワーク(たとえば、インターネット)上で送られ、サービスプロバイダは、CTデータセットが取得されるクリニックまたはオフィスに最終確率スコアおよび位置を返し、そこで、放射線科医がCTスキャンを検討中であるか、またはそこで、医師が、患者から取得されたCTスキャンに関して患者と協議し、さらなる治療を計画中であり得る。代替的に、図1のシステムは、ローカルに実装され得、すなわち、コンピューティングリソースおよび深層学習モデルは、CTデータセットが取得されるか、または、たとえば、放射線科医もしくはかかりつけ医によってワークステーション上で閲覧される、オフィス、クリニック、または病院のローカルに位置する。
Further considerations The system in Figure 1 can be deployed in a cloud environment, where a global predictive model and a two-step predictive model are remotely (eg, by the service provider who trained and developed the model, for example, in the cloud. (In) implemented. In this configuration, the CT scan data set is sent over a computer network (eg, the Internet) and the service provider returns the final probability score and location to the clinic or office where the CT data set is obtained, where the radiologist. Is considering a CT scan, or there may be a physician discussing the CT scan obtained from the patient with the patient and planning further treatment. Alternatively, the system in Figure 1 can be implemented locally, i.e., computing resources and deep learning models can be obtained with CT data sets or, for example, on a workstation by a radiologist or family doctor. Located locally in an office, clinic, or hospital, viewed at.
III.構造的ニューロイメージングおよび深層学習を使用する脳年齢の予測
このセクションは、構造的磁気共鳴イメージングデータセットからの脳年齢予測のための提案する深層学習モデルの使用について説明する。
III. Prediction of Brain Age Using Structural Neuroimaging and Deep Learning This section describes the use of a proposed deep learning model for brain age prediction from structural magnetic resonance imaging datasets.
年齢関連疾患および障害によって、社会にかかる負担が増大している。加齢の影響は被験者特有のものであるので、年齢関連の身体障害および認知障害のリスクが高い人々を識別するために、原因となる生物学的加齢プロセスのマーカーが必要とされる。構造的MRI画像は、脳における年齢関連変化を測定する際に極めて有用である。したがって、この研究の目標は、SMRI画像に基づいて、脳年齢予測アルゴリズムを開発すること、および脳における加齢関連疾患のバイオマーカーとして、予測脳年齢を調査することである。 Age-related illnesses and disabilities are increasing the burden on society. Because the effects of aging are subject-specific, markers of the causative biological aging process are needed to identify people at high risk of age-related disability and cognitive impairment. Structural MRI images are extremely useful in measuring age-related changes in the brain. Therefore, the goal of this study is to develop a brain age prediction algorithm based on SMRI images and to investigate predicted brain age as a biomarker for age-related diseases in the brain.
加齢関連疾患の早期検出には、原因となる生物学的加齢プロセスのモデルが必要である。このセクションでは、我々は、構造的磁気共鳴イメージング(SMRI)および深層学習を使用することによる脳年齢予測器について説明し、脳の加齢のマーカーとして、予測脳年齢を評価する。我々の手法は、転移学習パラダイムを使用し、高齢の被験者から収集された実際のSMRIデータにおいてトレーニングおよび検証されている点において、領域知識を必要としない。我々は、SMRI画像から脳年齢を予測するために、回帰およびバケット分類とともに、提案する畳み込みニューラルネットワーク(CNN)に基づいて、2つの異なる予測的モデルを開発した。回帰ベースのモデルおよび分類ベースのモデルは、認知機能が正常な被験者の脳年齢の予測において、それぞれ、5.54および6.44(歳)の2乗平均平方根誤差(RMSE)を達成した。さらなる解析は、同じ暦年齢グループ内の認知障害のある被験者の予測脳年齢と正常な被験者の予測脳年齢との間に実質的な差があることを示した。 Early detection of age-related diseases requires a model of the causative biological aging process. In this section, we describe a brain age predictor by using structural magnetic resonance imaging (SMRI) and deep learning, and evaluate predicted brain age as a marker of brain aging. Our method uses a transfer learning paradigm and does not require domain knowledge in that it is trained and validated in actual SMRI data collected from older subjects. We have developed two different predictive models based on the proposed convolutional neural network (CNN), along with regression and bucket classification, to predict brain age from SMRI images. Regression-based and classification-based models achieved root-mean square error (RMSE) of 5.54 and 6.44 (years), respectively, in predicting brain age in subjects with normal cognitive function. Further analysis showed that there was a substantial difference between the predicted brain age of cognitively impaired subjects and the predicted brain age of normal subjects within the same calendar age group.
このセクションで説明するモデルは、概して、図1の「グローバルモデル」110および図5のグローバルモデル500に対応し、以下で説明する作業では、我々は、図1および図5の2段階モデルを使用しなかった。 The models described in this section generally correspond to the "global model" 110 in Figure 1 and the global model 500 in Figure 5, and for the tasks described below, we use the two-stage model in Figures 1 and 5. I didn't.
この主題における我々の手法と以前の取り組みとの間の大きな違いは、1)我々が、領域知識を必要とすることなく、生のSMRI画像から関連する特徴を学習するために、深層学習を使用すること、および2)我々が、主な加齢関連疾患であるアルツハイマー病を発症するリスクがある被験者から収集されたデータを用いて、提案する手法を検証することである。以前の研究は、SMRI画像から脳年齢を予測するために、ガウス過程回帰を使用する、機械学習ベースの手法を提案している。J. H. Cole他、「Predicting brain age with deep learning from raw imaging data results in a reliable and heritable biomarker」、NeuroImage、vol. 163、115～124ページ、2017、J. H. Cole他、「Brain age predicts mortality」、Molecular Psychiatry、2017を参照されたい。しかしながら、それらの手法は、人間の脳の構造の領域知識から導出された特徴に依拠している。一方、P. Sturmfels他、「A domain guided CNN architecture for predicting age from structural brain images」、arXiv preprint arXiv:1808.04362、2018は、脳年齢を予測するために最小限の領域情報を使用する、CNNベースのアーキテクチャを提案した。しかしながら、その研究は、子供から収集されたSMRIイメージングデータを使用して実行されたものであり、高齢の患者の加齢関連疾患リスクを予測することができるか否かは不明である。 The major differences between our approach and previous efforts in this subject are: 1) We use deep learning to learn relevant features from raw SMRI images without the need for domain knowledge. To do, and 2) we use data collected from subjects at risk of developing Alzheimer's disease, a major age-related disease, to validate the proposed approach. Previous studies have proposed a machine learning-based method that uses Gaussian process regression to predict brain age from SMRI images. J. H. Cole et al., "Predicting brain age with deep learning from raw imaging data results in a reliable and heritable biomarker", NeuroImage, vol. 163, pp. 115-124, 2017, J. H. Cole et al., "Brain age predicts mortality", Molecular Psychiatry , 2017. However, these methods rely on features derived from the domain knowledge of the structure of the human brain. Meanwhile, P. Sturmfels et al., "A domain guided CNN architecture for predicting age from structural brain images," arXiv preprint arXiv: 1808.04362, 2018, uses minimal domain information to predict brain age, based on CNN. Proposed an architecture. However, the study was performed using SMRI imaging data collected from children, and it is unclear whether it can predict the risk of age-related disease in older patients.
我々は、事前トレーニングされた3D Inception-V1特徴抽出器に基づく転移学習手法を採用し、回帰および分類問題として、SMRI画像から脳年齢を予測するように再トレーニングした。このモデルは、本明細書の以前のセクションで説明した「グローバルモデル」に類似しており、いかなる領域知識も必要とせず、1)リグレッサを使用する、および2)バケット化分類器(以下で説明する)を使用する、2つの異なる方法で、脳年齢を予測した。我々は、Alzheimer's disease neuroimaging initiative(ADNI)データセットを使用して、我々の手法を評価した。回帰方法およびバケット化分類器方法は、認知機能が正常な被験者の脳年齢の予測において、それぞれ、5.54および6.44(歳)の2乗平均平方根誤差(RMSE)を達成した。加えて、さらなる解析は、回帰手法およびバケット化分類手法がそれぞれ利用されるとき、認知障害のある被験者の予測脳年齢が、彼らの暦年齢よりも平均で3.24±2.12歳および2.67±2.35歳高いことを示した。本質的に、我々の手法は、いかなる領域知識も使用せずに、SMRI画像に基づいて脳年齢を予測するためのCNNベースのモデルを利用し、我々の手法を使用することによって予測された脳年齢が、加齢関連疾患リスクを識別するために使用され得ることを実証する。 We adopted a pre-trained 3D Inception-V1 feature extractor-based transfer learning technique and retrained to predict brain age from SMRI images as a regression and classification problem. This model is similar to the "global model" described in the previous sections of this specification, without the need for any domain knowledge, 1) using a regressor, and 2) a bucketing classifier (discussed below). Predicted brain age in two different ways using). We used the Alzheimer's disease neuroimaging initiative (ADNI) dataset to evaluate our approach. Regression and bucketing classifier methods achieved root mean square error (RMSE) of 5.54 and 6.44 (years), respectively, in predicting brain age in subjects with normal cognitive function. In addition, further analysis shows that the predicted brain ages of subjects with cognitive impairment are on average 3.24 ± 2.12 years and 2.67 ± 2.35 years higher than their calendar age when regression and bucket classification methods are used, respectively. I showed that. In essence, our method utilizes a CNN-based model for predicting brain age based on SMRI images without using any domain knowledge, and the brain predicted by using our method. Demonstrate that age can be used to identify the risk of age-related disease.
方法
我々の手法の全体的な流れが、図12に示されている。図12のこのモデルは、図5の上側部分のグローバルモデルにおいて示されている。同じ物理的寸法の3D SMRI画像が、入力としてパイプラインに供給された。3D特徴抽出器が、入力画像から特徴マップを抽出するために利用された。次いで、回帰タスクまたはバケット化分類タスクとして、年齢予測を作成するために、完全接続層が利用された。
Method The overall flow of our method is shown in Figure 12. This model in Figure 12 is shown in the global model in the upper part of Figure 5. 3D SMRI images of the same physical dimensions were fed into the pipeline as input. A 3D feature extractor was used to extract the feature map from the input image. The fully connected layer was then utilized to create age predictions as a regression or bucket classification task.
データおよび前処理:我々は、我々の手法を検証するために、Alzheimer's disease neuroimaging initiative (ADNI)研究において収集されたデータを利用した。詳細については、http://adni.loni.usc.edu/を参照されたい。ADNIは、認知症、主にアルツハイマー病(AD)を発症するリスクがある高齢の被験者から、イメージングおよび血液バイオマーカーを定期的に収集する、進行中の縦断的研究である。ADNIの主要目的は、軽度認知障害(MCI)および早期アルツハイマー病の進行を測定するために、連続的な磁気共鳴イメージング(MRI)、陽電子放射断層撮影(PET)、他の生物学的マーカー、ならびに臨床的および神経心理学的評価が結合され得るか否かをテストすることになっている。我々は、1484名の一意の参加者の12,988個のSMRI画像を解析し、彼らについて、データセットから、彼らのADの臨床病期および暦年齢についてのグランドトゥルース情報が利用可能であった。ADの臨床病期は、認知機能正常(CN)、軽度認知障害(MCI)、およびアルツハイマー型認知症(AD)からなり、年齢は、50と100との間の実数である。データセットは、異なる時点において撮影された複数のSMRI画像と、患者の一部についての対応するグランドトゥルース情報とを含むものであった。このデータセットにおける3D SMRI画像は、MPRAGEシーケンスを使用して取得された。モデルトレーニングを実行する前に、我々は、生のSMRI画像を同じ物理的寸法(ボクセルサイズ)にサイズ変更し、それらのヒストグラムを均等化し、中心の周りで256×256×256(ボクセル)の形状にクロップした。 Data and pretreatment: We used the data collected in the Alzheimer's disease neuroimaging initiative (ADNI) study to validate our approach. See http://adni.loni.usc.edu/ for more information. ADNI is an ongoing longitudinal study that regularly collects imaging and blood biomarkers from older subjects at risk of developing dementia, primarily Alzheimer's disease (AD). The main objectives of ADNI are continuous magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and other biological markers to measure the progression of mild cognitive impairment (MCI) and early Alzheimer's disease. It is to be tested whether clinical and neuropsychological assessments can be combined. We analyzed 12,988 SMRI images of 1484 unique participants and for them, Grand Truth information about their AD clinical stage and calendar age was available from the dataset. The clinical stage of AD consists of normal cognitive function (CN), mild cognitive impairment (MCI), and Alzheimer's disease (AD), and the age is a real number between 50 and 100. The dataset included multiple SMRI images taken at different time points and corresponding grand truth information about some of the patients. 3D SMRI images in this dataset were acquired using the MPRAGE sequence. Before performing model training, we resize the raw SMRI images to the same physical dimensions (voxel size), equalize their histograms, and shape 256 x 256 x 256 (voxels) around the center. Cropped to.
モデル説明(図12):J. CarreiraおよびA. Zisserman、2017 IEEE Conference on Computer Vision and Pattern Recognition(CVPR)における、「Quo vadis, action recognition? a new model and the kinetics dataset」、IEEE 2017、4724～4733ページにおいて記載されているような、ImageNetデータセットにおいて事前トレーニングされたInception-V1ネットワークに基づく3D特徴抽出器が、入力画像から特徴マップを抽出するために利用された。1つの完全接続層が、年齢予測を生成するために使用された。我々は、リグレッサおよびバケット化分類器を使用して、脳年齢を予測した。バケット化分類手法では、被験者の本当の年齢が離散範囲にビニングされ、SMRI画像が属するビンを予測するために、ニューラルネットワークが使用された。我々の手法では、我々は、年齢を5つのバケット、50～60、60～70、70～80、80～90、および90～100にビニングし、それらのバケットに{1,2,3,4,5}におけるクラスラベルを割り当てた。これらのクラスラベルが、モデルトレーニング中に使用された。
Model Description (Figure 12): J. Carreira and A. Zisserman, "Quo vadis, action recognition? A new model and the kinetics dataset" at the 2017 IEEE Conference on Computer Vision and Pattern Recognition (CVPR), IEEE 2017, 4724-
評価:モデルトレーニング中に、我々は、入力データセットの50%のトレーニング小部分、25%のチューニング小部分、および25%のテスト小部分とともに、5分割相互検証(fivefold cross-validation)および患者ベースの層別化を利用した。患者ベースの層別化は、同じ患者のSMRI画像が3つのデータセットのうちの2つ以上において決して現れないことを保証するために利用された。さらに、CNNベースのモデルが、認知機能が正常な被験者のみのSMRI画像を使用してトレーニングされ、すなわち、トレーニングおよびチューニングセットは、認知障害のない被験者のみを含むものであった。我々は、健康的な加齢下でのベースライン年齢予測器を開発するために、この手法を取った。次いで、トレーニングされたモデルが、認知障害のある被験者および障害のない被験者の混合の脳年齢を予測するために使用された。回帰モデルは、実数の年齢を予測したが、バケット化分類手法は、離散値、すなわち、{55,65,75,85,95}のうちの1つを予測した。我々は、不偏テストサンプルを維持するために、テストセット中に何人かの認知障害のない被験者を含めた。第1に、我々は、チューニングセットにおいて達成された平均2乗誤差の平方根(RMSE)メトリックを使用して、モデル適合度を評価した。第2に、我々は、テストセットにおける認知障害のない被験者と障害のある被験者との間の脳年齢予測における差を評価した。我々は、テストデータセットにおける被験者のみを使用して、その解析を実行し、MCIおよびAD臨床病期にある被験者が、認知障害があると見なされた。我々は、予測年齢グループ(図14Aを参照)を見つけ出すために、バケット化分類のために使用された同じ範囲に基づいて、回帰モデルの実数化された予測年齢をグループ化した。 Rating: During model training, we performed fivefold cross-validation and patient-based, along with 50% training, 25% tuning, and 25% test subsections of the input dataset. Was used for stratification. Patient-based stratification was used to ensure that SMRI images of the same patient never appeared in two or more of the three datasets. In addition, CNN-based models were trained using SMRI images of subjects with normal cognitive function only, ie the training and tuning set included only subjects without cognitive impairment. We took this approach to develop a baseline age predictor under healthy aging. The trained model was then used to predict the mixed brain age of subjects with and without cognitive impairment. The regression model predicted the age of real numbers, while the bucket classification method predicted discrete values, that is, one of {55,65,75,85,95}. We included some non-cognitive subjects in the test set to maintain an unbiased test sample. First, we evaluated the goodness of fit using the root-mean-squared error (RMSE) metric achieved in the tuning set. Second, we evaluated differences in brain age prediction between subjects without cognitive impairment and subjects with disabilities in the test set. We performed the analysis using only the subjects in the test dataset and subjects at the MCI and AD clinical stage were considered to have cognitive impairment. We grouped the realized predicted ages of the regression model based on the same range used for the bucketing classification to find the predicted age groups (see Figure 14A).
結果
図13aおよび図13bは、それぞれ、回帰モデルおよびバケット化分類モデルのためのチューニングデータセットにおける、認知機能が正常な被験者の本当の年齢に対する予測年齢の散布プロットである。回帰モデルは、5.54のRMSEを達成したが、バケット化分類モデルは、6.44のRMSEを達成した。図14aおよび図14bは、同じ予測年齢グループにおける、認知障害のない被験者および障害のある被験者のための本当の年齢の分布のボックスプロットを示す。これらの図は、同じ年齢グループに入ると予測されたとき、認知障害のある被験者の本当の年齢の分布が、認知障害のない被験者の本当の年齢の分布よりも一貫して低い平均値を有することを示す。我々は、本当の年齢が60歳未満および90歳を超える被験者を除外しており、その理由は、テストデータセットにおいて十分なサンプルがなかったからである。加えて、認知障害のある被験者の予測年齢は、回帰手法およびバケット化分類手法において、それぞれ、彼らの暦年齢よりも平均で3.24±2.12歳および2.67±2.35歳高かった。
Results Figures 13a and 13b are scatter plots of predicted age relative to the true age of cognitively functioning subjects in tuning datasets for regression and bucketed classification models, respectively. The regression model achieved an RMSE of 5.54, while the bucketed classification model achieved an RMSE of 6.44. Figures 14a and 14b show box plots of the true age distribution for subjects without and those with disabilities in the same predicted age group. These figures have a consistently lower mean distribution of the true ages of subjects with cognitive impairment than the distribution of true ages of subjects without cognitive impairment when predicted to be in the same age group. Show that. We exclude subjects whose true age is less than 60 years and over 90 years, because there were not enough samples in the test dataset. In addition, the predicted ages of subjects with cognitive impairment averaged 3.24 ± 2.12 years and 2.67 ± 2.35 years higher than their calendar ages in regression and bucket classification methods, respectively.
結論
我々は、SMRI画像から脳年齢を予測するために、転移学習パラダイムに基づいて、2つの異なる畳み込みニューラルネットワーク(CNN)ベースの手法を開発した。我々の2つのモデルは、認知障害のない被験者の脳年齢の予測において、5.54および6.44(歳)のRMSEを達成した。さらなる解析は、同じ暦年齢グループに属する、認知障害のある被験者の予測脳年齢と正常な被験者の予測脳年齢との間に実質的な差があることを示した。したがって、我々は、予測脳年齢が、人生の早期にアルツハイマー病などの加齢関連脳疾患を発症するリスクがより高い個人を、彼らの人生の早期に識別することにおいて、臨床的に有用であることが判明し得ると考える。将来の作業において、我々は、発見したものを検証するために追加のデータを取得し、予測性能を改善するために、モデル最適化を実行するつもりである。
Conclusion We have developed two different convolutional neural network (CNN) -based methods based on the metastatic learning paradigm to predict brain age from SMRI images. Our two models achieved RMSE of 5.54 and 6.44 (years) in predicting brain age in subjects without cognitive impairment. Further analysis showed that there was a substantial difference between the predicted brain age of cognitively impaired subjects and the predicted brain age of normal subjects belonging to the same calendar age group. Therefore, we are clinically useful in identifying individuals whose predicted brain age is at higher risk of developing age-related brain disease such as Alzheimer's disease early in their lives. I think it can be found. In future work, we will acquire additional data to validate what we have discovered and perform model optimizations to improve predictive performance.
この作業の1つの可能な実施形態では、患者または被験者が加齢関連脳疾患を発症するリスクがより高いか否かを予測するためのテストが実行され得る。テストは、同じ暦年齢グループに属する、認知障害のある被験者および正常な被験者の3D画像のデータセットから、領域知識なしに開発された、脳年齢のための予測的モデルを利用する。この方法は、a)患者から1つまたは複数の3D画像を取得し、予測的モデルに、1つまたは複数の3D画像を供給するステップと、b)予測的モデルを用いて、被験者のための脳年齢予測を生成するステップと、c)脳年齢予測を、患者の実年齢と比較するステップとを含む。脳年齢予測が、患者の実年齢のものよりも実質的に大きい(たとえば、3歳、5歳、または10歳など、カスタマイズまたは調整され得るパラメータ)場合、患者は、認知障害またはアルツハイマー病などの年齢関連脳疾患を発症するリスクが高いとして識別される。「実質的に大きい」ための基準は、ユーザによって指定することができ、可能な例は、7歳または10歳である。この基準は、モデル予測の誤差の範囲よりも大きい値になると予想されるであろう。 In one possible embodiment of this task, tests may be performed to predict whether the patient or subject is at greater risk of developing age-related brain disease. The test utilizes a predictive model for brain age developed without domain knowledge from a dataset of 3D images of cognitively impaired and normal subjects belonging to the same calendar age group. This method involves a) taking one or more 3D images from the patient and feeding the predictive model with one or more 3D images, and b) using the predictive model for the subject. It includes the steps of generating a brain age prediction and c) comparing the brain age prediction with the actual age of the patient. If the brain age prediction is substantially greater than that of the patient's actual age (for example, parameters that can be customized or adjusted, such as 3 years, 5 years, or 10 years), the patient may have cognitive impairment or Alzheimer's disease. Identified as having an increased risk of developing age-related brain disease. Criteria for "substantially large" can be specified by the user, and possible examples are 7 or 10 years old. This criterion would be expected to be greater than the margin of error of the model prediction.
説明した実施形態は、モデル生成および予測のためにSMRI画像を使用するが、この方法はまた、たとえば、CTスキャン画像など、脳の他の3Dボリュメトリック画像データセットにも適用可能である。 Although the embodiments described use SMRI images for model generation and prediction, this method is also applicable to other 3D volumetric image datasets of the brain, such as CT scan images.
100 システム
102 患者
104 従来のCTスキャナ
106 3D CTデータセット、CTデータセット、データセット
110 グローバル予測的モデル、グローバルモデル
112 癌確率
120 メモリ
122 コンピュータシステム
130 第1段階検出モデル、検出モデル
132 第2段階確率モデル、第2段階モデル、単一の確率モデル、単一の第2段階モデル、モデル
132A、132B、132C 第2段階モデル
134 癌検出候補、検出候補、候補、所与の入力癌候補3Dボリューム
200、202、204 層
206 高密度分類層
500 エンドツーエンドグローバル畳み込みモデル、グローバルモデル
502 2段階モデル
502A 第1段階または検出モデル
502B 第2段階または確率モデル、第2段階確率モデル
504 現在のCTボリューム
506 前のCTボリューム、前のモダリティ画像または他のモダリティ画像
508 3D特徴抽出器、特徴抽出器
510 8×8×8のより小さいボリューム
520 現在のCTボリューム、フルボリュームの現在の高解像度CTデータセット、フルボリュームデータセット
522 縦断的または前のCTボリューム、前のフルボリュームの高解像度CTデータセット、前のフルボリュームCTデータセット、CTボリューム、フルボリュームデータセット、他方のボリューム
524 結節検出器、第1段階モデルの結節検出、3D検出モデル、検出モデル
526 対応するROI、サブボリュームまたはROI、対応するサブボリュームまたはROI
528 癌候補(サブボリューム)、サブボリュームまたはROI、癌検出候補
530 3D特徴抽出器
532 小さいボリューム
534 平均プーリングおよび/または畳み込み層、追加の畳み込み層および平均プーリング
538 分類器、分類動作、分類プロセス
540 出力、出力ステップ
800 バウンディングボックス
900 より大きいバウンディングボックス
902 ボックス
1100 CTスキャン画像、画像
1102 小さい領域、アテンション機構結果、画像の部分
100 systems
102 patient
104 Traditional CT Scanner
106 3D CT dataset, CT dataset, dataset
110 Global predictive model, global model
112 Cancer probability
120 memory
122 Computer system
130 First stage detection model, detection model
132 Second Stage Probability Model, Second Stage Model, Single Probability Model, Single Second Stage Model, Model
132A, 132B, 132C 2nd stage model
134 Cancer Detection Candidates, Detection Candidates, Candidates, Given
200, 202, 204 layers
206 High Density Classification Layer
500 End-to-end global convolution model, global model
502 2-stage model
504 Current CT volume
506 Previous CT volume, previous modality image or other modality image
508 3D feature extractor, feature extractor
510 8x8x8 smaller volume
520 Current CT Volume, Full Volume Current High Resolution CT Dataset, Full Volume Dataset
522 Longitudinal or previous CT volume, previous full volume high resolution CT dataset, previous full volume CT dataset, CT volume, full volume dataset, other volume
524 Nodule detector, 1st stage model nodule detection, 3D detection model, detection model
526 Corresponding ROI, subvolume or ROI, corresponding subvolume or ROI
528 Cancer candidate (subvolume), subvolume or ROI, cancer detection candidate
530 3D feature extractor
532 small volume
534 Average pooling and / or convolutional layer, additional convolutional layer and average pooling
538 Classifier, classification operation, classification process
540 output, output step
800 bounding box
Bounding box larger than 900
902 Box
1100 CT scan images, images
1102 Small area, attention mechanism result, image part
Claims (20)
a)グローバルベースで、前記コンピュータ断層撮影データセットにおける肺組織における癌の存在の確率を少なくとも予測するようにトレーニングされた、3次元深層畳み込みニューラルネットワークを備える、グローバル予測的モデルに、前記コンピュータ断層撮影データセットを供給するステップと、
b)2段階予測モデルに前記コンピュータ断層撮影データセットを供給するステップであって、前記2段階予測モデルが、
1)前記コンピュータ断層撮影データセット内の1つまたは複数の3次元癌候補の位置を検出する、第1段階検出モデルと、
2)前記第1段階検出モデルによって検出された前記1つまたは複数の3次元癌候補に対して動作し、前記3次元癌候補の各々に癌確率pを割り当てる、第2段階確率モデルと
を備える、ステップと、
c)(1)前記グローバル予測的モデルの前記予測と、前記第2段階確率モデルによって前記3次元癌候補の各々に割り当てられた前記癌確率pとの両方を使用する、前記コンピュータ断層撮影データセットにおける癌の確率の全体的予測、および(2)前記コンピュータ断層撮影データセットにおける癌の位置を表す、データを生成するステップであって、前記癌の位置が、前記グローバル予測的モデルまたは前記2段階予測モデルのいずれかによって決定される、ステップと
を含む、方法。 A method for improving lung cancer screening and detection from computer tomography datasets obtained for patients.
a) On a global basis, said computer tomography to a global predictive model with a three-dimensional deep convolutional neural network trained to at least predict the probability of cancer presence in lung tissue in the computer tomography dataset. The steps to supply the dataset and
b) The step of supplying the computer tomography data set to the two-step prediction model, wherein the two-step prediction model is
1) A first-stage detection model that detects the location of one or more 3D cancer candidates in the computer tomography data set.
2) It is provided with a second-stage probability model that operates on the one or more three-dimensional cancer candidates detected by the first-stage detection model and assigns a cancer probability p to each of the three-dimensional cancer candidates. , Steps and
c) (1) The computer tomography data set using both the predictions of the global predictive model and the cancer probabilities p assigned to each of the three-dimensional cancer candidates by the second stage probability model. Overall prediction of the probability of cancer in, and (2) the step of generating data representing the location of the cancer in the computer tomographic data set, wherein the location of the cancer is the global predictive model or the two steps. A method, including steps, determined by any of the predictive models.
a)癌の転帰、
b)2次元における少なくとも20mmのサイズの結節の存在、
c)5年以内の死亡確率、
d)2年以内の肺癌の診断
のうちの少なくとも1つを予測するようにトレーニングされる、請求項1から4のいずれか一項に記載の方法。 The global predictive model, in addition to the probability of the presence of the cancer in the computer tomography data set,
a) Cancer outcome,
b) The presence of nodules of at least 20 mm in size in two dimensions,
c) Death probability within 5 years,
d) The method of any one of claims 1 to 4, which is trained to predict at least one of the diagnoses of lung cancer within 2 years.
a)グローバルベースで、前記コンピュータ断層撮影データセットにおける肺組織における癌の存在の確率を少なくとも予測するようにトレーニングされた、3次元深層畳み込みニューラルネットワークを備える、グローバル予測的モデルと、
b)2段階予測モデルであって、
1)前記コンピュータ断層撮影データセット内の1つまたは複数の3次元癌候補を検出する、第1段階検出モデルと、
2)前記第1段階検出モデルによって検出された前記1つまたは複数の3次元癌候補に対して動作し、前記3次元癌候補の各々に癌確率pを割り当てる、第2段階確率モデルと
を備える、2段階予測モデルと、
c)(1)前記グローバル予測的モデルの前記予測と、前記第2段階確率モデルによって前記3次元癌候補の各々に割り当てられた前記癌確率pとを使用する、前記コンピュータ断層撮影データセットにおける癌の確率の全体的予測、および(2)前記コンピュータ断層撮影データセットにおける癌の位置を表す、データを生成するためのコンピュータシステム実行コードと
を組み合わせて備える、コンピュータ実施システム。 A computer implementation system to improve lung cancer screening and detection from computer tomography datasets obtained for patients.
a) A global predictive model with a three-dimensional deep convolutional neural network trained to at least predict the probability of cancer presence in lung tissue in said computer tomography dataset on a global basis.
b) A two-step predictive model
1) A first-stage detection model that detects one or more 3D cancer candidates in the computer tomography dataset.
2) It is provided with a second-stage probability model that operates on the one or more three-dimensional cancer candidates detected by the first-stage detection model and assigns a cancer probability p to each of the three-dimensional cancer candidates. , Two-step prediction model and
c) (1) Cancer in the computer tomography data set using the predictions of the global predictive model and the cancer probabilities p assigned to each of the three-dimensional cancer candidates by the second stage probability model. A computer implementation system comprising a combination of an overall prediction of the probability of (2) a computer system execution code for generating data representing the location of the cancer in the computer tomography data set.
a)癌の転帰、
b)2次元における少なくとも20mmのサイズの結節の存在、
c)5年以内の死亡確率、
d)2年以内の肺癌の診断
のうちの少なくとも1つを予測するようにトレーニングされる、請求項13から16のいずれか一項に記載のシステム。 The global predictive model, in addition to the probability of the presence of the cancer in the computer tomography data set,
a) Cancer outcome,
b) The presence of nodules of at least 20 mm in size in two dimensions,
c) Death probability within 5 years,
d) The system according to any one of claims 13-16, which is trained to predict at least one of the diagnoses of lung cancer within 2 years.
Applications Claiming Priority (5)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US201862686541P | 2018-06-18 | 2018-06-18 | |
US62/686,541 | 2018-06-18 | ||
US201862726178P | 2018-08-31 | 2018-08-31 | |
US62/726,178 | 2018-08-31 | ||
PCT/US2018/061956 WO2019245597A1 (en) | 2018-06-18 | 2018-11-20 | Method and system for improving cancer detection using deep learning |
Publications (2)
Publication Number | Publication Date |
---|---|
JP2021528751A JP2021528751A (en) | 2021-10-21 |
JP7069359B2 true JP7069359B2 (en) | 2022-05-17 |
Family
ID=64902378
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
JP2020570510A Active JP7069359B2 (en) | 2018-06-18 | 2018-11-20 | Methods and systems for improving cancer detection using deep learning |
Country Status (5)
Country | Link |
---|---|
US (1) | US20210225511A1 (en) |
EP (1) | EP3788546A1 (en) |
JP (1) | JP7069359B2 (en) |
CN (1) | CN112292691A (en) |
WO (1) | WO2019245597A1 (en) |
Families Citing this family (39)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US11361868B2 (en) * | 2017-08-16 | 2022-06-14 | The Johns Hopkins University | Abnormal tissue detection via modal upstream data fusion |
JP7114347B2 (en) * | 2018-06-04 | 2022-08-08 | 浜松ホトニクス株式会社 | Tomographic image prediction device and tomographic image prediction method |
CN109544534B (en) * | 2018-11-26 | 2020-10-16 | 上海联影智能医疗科技有限公司 | Focal image detection device, method and computer-readable storage medium |
US11294367B2 (en) * | 2018-12-21 | 2022-04-05 | Canvass Analytics Inc. | Predictive analysis of industrial processes |
US10936160B2 (en) * | 2019-01-11 | 2021-03-02 | Google Llc | System, user interface and method for interactive negative explanation of machine-learning localization models in health care applications |
US11165954B1 (en) * | 2019-06-19 | 2021-11-02 | Objectvideo Labs, Llc | Scene-aware custom tuned video surveillance detection system |
GB2585005B (en) * | 2019-06-24 | 2021-06-23 | Roadmetric Ltd | Training a machine to recognize a motor vehicle driver using a mobile device |
US11424037B2 (en) | 2019-11-22 | 2022-08-23 | International Business Machines Corporation | Disease simulation in medical images |
CN115362470A (en) * | 2020-01-17 | 2022-11-18 | 强生企业创新公司 | System and method for predicting risk of future lung cancer |
US11403493B2 (en) * | 2020-01-17 | 2022-08-02 | Ping An Technology (Shenzhen) Co., Ltd. | Device and method for universal lesion detection in medical images |
CN111415743B (en) * | 2020-03-17 | 2021-07-09 | 推想医疗科技股份有限公司 | Pneumonia classification method, pneumonia classification device, pneumonia classification medium and electronic equipment |
EP3893198A1 (en) * | 2020-04-08 | 2021-10-13 | Siemens Healthcare GmbH | Method and system for computer aided detection of abnormalities in image data |
EP3901903B1 (en) * | 2020-04-23 | 2023-06-14 | Siemens Healthcare GmbH | Classifying a lesion based on longitudinal studies |
KR102231698B1 (en) * | 2020-06-15 | 2021-03-24 | 주식회사 루닛 | Method for filtering normal medical image, method for interpreting medical image, and computing device implementing the methods |
EP4182844A1 (en) * | 2020-06-16 | 2023-05-24 | Verily Life Sciences LLC | Systems and methods for directly predicting cancer patient survival based on histopathology images |
CN111814726B (en) * | 2020-07-20 | 2023-09-22 | 南京工程学院 | Detection method for visual target of detection robot |
US20220068467A1 (en) * | 2020-08-31 | 2022-03-03 | International Business Machines Corporation | Simulated follow-up imaging |
US20220067509A1 (en) * | 2020-09-02 | 2022-03-03 | Alibaba Group Holding Limited | System and method for learning from partial compressed representation |
CN112201328B (en) * | 2020-10-09 | 2022-06-21 | 浙江德尚韵兴医疗科技有限公司 | Breast mass segmentation method based on cross attention mechanism |
KR20220049754A (en) * | 2020-10-15 | 2022-04-22 | 삼성에스디에스 주식회사 | Apparatus and method for training image classification model |
CN112508884A (en) * | 2020-11-24 | 2021-03-16 | 江苏大学 | Comprehensive detection device and method for cancerous region |
US20220180514A1 (en) * | 2020-12-09 | 2022-06-09 | Imidex, Inc. | Methods of assessing lung disease in chest x-rays |
CN112861480A (en) * | 2021-01-28 | 2021-05-28 | 中山大学 | Improved prediction method, system and device based on Albert model |
CN112494063B (en) * | 2021-02-08 | 2021-06-01 | 四川大学 | Abdominal lymph node partitioning method based on attention mechanism neural network |
TWI790572B (en) * | 2021-03-19 | 2023-01-21 | 宏碁智醫股份有限公司 | Detecting method and detecting apparatus related to image |
CN113191413B (en) * | 2021-04-25 | 2022-06-21 | 华中科技大学 | Prostate multimode MR image classification method and system based on foveal residual error network |
CN113284615A (en) * | 2021-06-16 | 2021-08-20 | 北京大学人民医院 | XGboost algorithm-based gastrointestinal stromal tumor prediction method and system |
CN113421176B (en) * | 2021-07-16 | 2022-11-01 | 昆明学院 | Intelligent screening method for abnormal data in student score scores |
CN113610845B (en) * | 2021-09-09 | 2024-04-26 | 汕头大学医学院附属肿瘤医院 | Construction method and prediction method of tumor local control prediction model and electronic equipment |
CN115063349A (en) * | 2022-05-18 | 2022-09-16 | 北京理工大学 | Method and device for predicting brain age based on sMRI (magnetic resonance imaging) multidimensional tensor morphological characteristics |
CN114677677B (en) * | 2022-05-30 | 2022-08-19 | 南京友一智能科技有限公司 | Method for predicting material proportion of gas diffusion layer of proton exchange membrane fuel cell |
CN114814776B (en) * | 2022-06-24 | 2022-10-14 | 中国空气动力研究与发展中心计算空气动力研究所 | PD radar target detection method based on graph attention network and transfer learning |
EP4307224A1 (en) | 2022-07-15 | 2024-01-17 | Median Technologies | Method and system for computer aided diagnosis using ensembled 2d and 3d neural networks based on medical images |
KR102583160B1 (en) * | 2022-07-18 | 2023-09-26 | 주식회사 래디센 | Method for determining the position of the nodule in the X-ray image |
CN115375665B (en) * | 2022-08-31 | 2024-04-16 | 河南大学 | Advanced learning strategy-based early Alzheimer disease development prediction method |
CN115600160B (en) * | 2022-10-20 | 2023-07-21 | 浙江大学 | Detection method for network model stealing behavior based on integral gradient interpretable algorithm |
CN115578387A (en) * | 2022-12-06 | 2023-01-06 | 中南大学 | Multimodal-based Alzheimer disease medical image classification method and system |
CN116563524B (en) * | 2023-06-28 | 2023-09-29 | 南京航空航天大学 | Glance path prediction method based on multi-vision memory unit |
CN117853490A (en) * | 2024-03-06 | 2024-04-09 | 阿里巴巴达摩院(杭州)科技有限公司 | Image processing method and training method of image processing model |
Citations (3)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US20060018524A1 (en) | 2004-07-15 | 2006-01-26 | Uc Tech | Computerized scheme for distinction between benign and malignant nodules in thoracic low-dose CT |
JP2008080121A (en) | 2006-09-28 | 2008-04-10 | General Electric Co <Ge> | Method and system for discriminating region in image |
US20090080748A1 (en) | 2002-10-18 | 2009-03-26 | Cornell Research Foundation, Inc. | System, Method and Apparatus for Small Pulmonary Nodule Computer Aided Diagnosis from Computed Tomography Scans |
Family Cites Families (14)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5873824A (en) * | 1996-11-29 | 1999-02-23 | Arch Development Corporation | Apparatus and method for computerized analysis of interstitial infiltrates in chest images using artificial neural networks |
WO2008035286A2 (en) * | 2006-09-22 | 2008-03-27 | Koninklijke Philips Electronics N.V. | Advanced computer-aided diagnosis of lung nodules |
US10265040B2 (en) * | 2015-07-13 | 2019-04-23 | Scott Anderson Middlebrooks | Method and apparatus for adaptive computer-aided diagnosis |
US11051790B2 (en) * | 2015-11-10 | 2021-07-06 | Exact Imaging, Inc. | System comprising indicator features in high-resolution micro-ultrasound images |
WO2017092615A1 (en) * | 2015-11-30 | 2017-06-08 | 上海联影医疗科技有限公司 | Computer aided diagnosis system and method |
CN106203327B (en) * | 2016-07-08 | 2019-04-19 | 清华大学 | Lung tumor identification system and method based on convolutional neural networks |
US10482633B2 (en) * | 2016-09-12 | 2019-11-19 | Zebra Medical Vision Ltd. | Systems and methods for automated detection of an indication of malignancy in a mammographic image |
CN106548192B (en) * | 2016-09-23 | 2019-08-09 | 北京市商汤科技开发有限公司 | Image processing method, device and electronic equipment neural network based |
CN106780460B (en) * | 2016-12-13 | 2019-11-08 | 杭州健培科技有限公司 | A kind of Lung neoplasm automatic checkout system for chest CT images |
CN107240102A (en) * | 2017-04-20 | 2017-10-10 | 合肥工业大学 | Malignant tumour area of computer aided method of early diagnosis based on deep learning algorithm |
US11664114B2 (en) * | 2017-05-25 | 2023-05-30 | Enlitic, Inc. | Medical scan assisted review system |
CN107563383A (en) * | 2017-08-24 | 2018-01-09 | 杭州健培科技有限公司 | A kind of medical image auxiliary diagnosis and semi-supervised sample generation system |
CN108171232B (en) * | 2017-11-15 | 2021-12-28 | 中山大学 | Deep learning algorithm-based bacterial and viral pneumonia classification method for children |
CN107945167A (en) * | 2017-11-27 | 2018-04-20 | 北京医拍智能科技有限公司 | The detecting system of chronic obstructive pulmonary disease based on deep neural network |
-
2018
- 2018-11-20 JP JP2020570510A patent/JP7069359B2/en active Active
- 2018-11-20 CN CN201880094795.3A patent/CN112292691A/en active Pending
- 2018-11-20 US US17/055,313 patent/US20210225511A1/en active Pending
- 2018-11-20 WO PCT/US2018/061956 patent/WO2019245597A1/en unknown
- 2018-11-20 EP EP18829537.2A patent/EP3788546A1/en active Pending
Patent Citations (3)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US20090080748A1 (en) | 2002-10-18 | 2009-03-26 | Cornell Research Foundation, Inc. | System, Method and Apparatus for Small Pulmonary Nodule Computer Aided Diagnosis from Computed Tomography Scans |
US20060018524A1 (en) | 2004-07-15 | 2006-01-26 | Uc Tech | Computerized scheme for distinction between benign and malignant nodules in thoracic low-dose CT |
JP2008080121A (en) | 2006-09-28 | 2008-04-10 | General Electric Co <Ge> | Method and system for discriminating region in image |
Non-Patent Citations (3)
Title |
---|
COLE JAMES H; ET AL，PREDICTING BRAIN AGE WITH DEEP LEARNING FROM RAW IMAGING DATA RESULTS IN A RELIABLE AND HERITABLE BIOMARKER，NEUROIMAGE，NL，ELSEVIER，2017年07月29日，VOL:163，PAGE(S):115-124，http://dx.doi.org/10.1016/j.neuroimage.2017.07.059 |
HEUNG-IL SUK; ET AL，HIERARCHICAL FEATURE REPRESENTATION AND MULTIMODAL FUSION WITH DEEP LEARNING FOR AD/MCI DIAGNOSIS，NEUROIMAGE，NL，ELSEVIER，2014年11月，VOL:101，PAGE(S):569-582，http://dx.doi.org/10.1016/j.neuroimage.2014.06.077 |
WAFAA ALAKWAA; ET AL，LUNG CANCER DETECTION AND CLASSIFICATION WITH 3D CONVOLUTIONAL NEURAL NETWORK (3D-CNN)，INTERNATIONAL JOURNAL OF ADVANCED COMPUTER SCIENCE AND APPLICATIONS(IJACSA)，2017年，VOL:8,NR:8，PAGE(S):409-417，https://doi.org/10.14569/IJACSA.2017.080853 |
Also Published As
Publication number | Publication date |
---|---|
EP3788546A1 (en) | 2021-03-10 |
JP2021528751A (en) | 2021-10-21 |
CN112292691A (en) | 2021-01-29 |
US20210225511A1 (en) | 2021-07-22 |
WO2019245597A1 (en) | 2019-12-26 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
JP7069359B2 (en) | Methods and systems for improving cancer detection using deep learning | |
Singh et al. | Machine learning in cardiac CT: basic concepts and contemporary data | |
Roy et al. | Deep learning for classification and localization of COVID-19 markers in point-of-care lung ultrasound | |
Farhat et al. | Deep learning applications in pulmonary medical imaging: recent updates and insights on COVID-19 | |
Soomro et al. | Artificial intelligence (AI) for medical imaging to combat coronavirus disease (COVID-19): A detailed review with direction for future research | |
US7529394B2 (en) | CAD (computer-aided decision) support for medical imaging using machine learning to adapt CAD process with knowledge collected during routine use of CAD system | |
CN111563523B (en) | COPD classification using machine-trained anomaly detection | |
EP2208183B1 (en) | Computer-aided detection (cad) of a disease | |
US20180220985A1 (en) | Classification of a health state of tissue of interest based on longitudinal features | |
US20220180514A1 (en) | Methods of assessing lung disease in chest x-rays | |
US20220301159A1 (en) | Artificial intelligence-based colonoscopic image diagnosis assisting system and method | |
US20210202072A1 (en) | Medical image diagnosis assistance apparatus and method for providing user-preferred style based on medical artificial neural network | |
US20210142480A1 (en) | Data processing method and apparatus | |
Dmitriev et al. | Visual analytics of a computer-aided diagnosis system for pancreatic lesions | |
US10957038B2 (en) | Machine learning to determine clinical change from prior images | |
Cifci | Segchanet: A novel model for lung cancer segmentation in ct scans | |
Tummala et al. | Liver tumor segmentation from computed tomography images using multiscale residual dilated encoder‐decoder network | |
Gopinath et al. | Enhanced Lung Cancer Classification and Prediction based on Hybrid Neural Network Approach | |
EP4115331A1 (en) | Class-disparate loss function to address missing annotations in training data | |
US20230162353A1 (en) | Multistream fusion encoder for prostate lesion segmentation and classification | |
US20220287647A1 (en) | Disease classification by deep learning models | |
US11742072B2 (en) | Medical image diagnosis assistance apparatus and method using plurality of medical image diagnosis algorithms for endoscopic images | |
Happila et al. | Logistic Segmentation and Multistage Categorization based Predictive Modeling of Lung Cancer | |
Riva | Breast arterial calcifications: detection, visualization and quantification through a convolutional neural network | |
Gupta et al. | Lungs Disease Classification using VGG-16 architecture with PCA |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
A521 | Request for written amendment filed |
Free format text: JAPANESE INTERMEDIATE CODE: A523Effective date: 20210118 |
|
A621 | Written request for application examination |
Free format text: JAPANESE INTERMEDIATE CODE: A621Effective date: 20210118 |
|
TRDD | Decision of grant or rejection written | ||
A01 | Written decision to grant a patent or to grant a registration (utility model) |
Free format text: JAPANESE INTERMEDIATE CODE: A01Effective date: 20220411 |
|
A61 | First payment of annual fees (during grant procedure) |
Free format text: JAPANESE INTERMEDIATE CODE: A61Effective date: 20220502 |
|
R150 | Certificate of patent or registration of utility model |
Ref document number: 7069359Country of ref document: JPFree format text: JAPANESE INTERMEDIATE CODE: R150 |