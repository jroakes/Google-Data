CN101014831B - A digital mapping system - Google Patents
A digital mapping system Download PDFInfo
- Publication number
- CN101014831B CN101014831B CN2005800139121A CN200580013912A CN101014831B CN 101014831 B CN101014831 B CN 101014831B CN 2005800139121 A CN2005800139121 A CN 2005800139121A CN 200580013912 A CN200580013912 A CN 200580013912A CN 101014831 B CN101014831 B CN 101014831B
- Authority
- CN
- China
- Prior art keywords
- map
- picture mosaic
- montage
- image
- shape
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Active
Links
Images
Abstract
Various methods, systems, and apparatus for implementing aspects of a digital mapping system are disclosed. One such method includes sending a location request from a client-side computing device to a map tile server, receiving a set of map tiles in response to the location request, assembling said received map tiles into a tile grid, aligning the tile grid relative to a clipping shape, and displaying the result as a map image. One apparatus according to aspects of the present invention includes means for sending a location request from a client-side computing device to a map tile server, means for receiving a set of map tiles in response to the location request, means for assembling said received map tiles into a tile grid, means for aligning the tile grid relative to a clipping shape, and means for displaying the result as a map image. Such an apparatus may further include direction control or zoom control objects as interactive overlays on the displayed map image, and may also include route or location overlays on the map image.
Description
The related application cross reference
The application's case is advocated the right of priority based on the 60/567th, No. 946 U.S. Provisional Patent Application case of filing an application on May 3rd, 2004, and the full text of this U.S. Provisional Patent Application case is merged in herein with way of reference.The application's case is also advocated the right of priority of the 60/555th, No. 501 U.S. Provisional Patent Application case of filing an application based on March 23rd, 2004, and the full text of this U.S. Provisional Patent Application case is incorporated herein by reference.
Technical field
Embodiment relates to the map depiction system by and large in accordance with the principles of the present invention, and more specifically relates to the map depiction system in the digital environment.
Background technology
People have developed computerized map depiction system and have been beneficial to and make itinerary.For example, the itinerary internet website exists on the market and is being that people are well-known.These websites permission users import one and have the query term of the position of asking, thereby can provide a map that is associated with the request position to the user.In addition, each well-known website allows the user to import starting point and the terminal point of travelling, uses described starting point and terminal point to calculate then and provides direct of travel to the user.
To the background knowledge of the detailed description of some aspect of the present invention, Fig. 1-4 illustrates some aspect of an exemplary traditional map trace system as hereinafter.Fig. 1 illustration one shows the web browser user interface 100 of such map requests input webpage 105.As shown in the figure, the user has imported a following desired location: 353 Main St., and Biliings, MT 45619.After input will be carried out the desired location of map depiction as shown in fig. 1, the user was subsequently by selecting one " request obtains map (Request Map) " button 110 to ask to obtain a map (usually from a remote server).Then, produce a map image at the remote server place usually, this map image transfers on user's the calculation element, and finally is shown on the web browser user interface 100 with the form of a map display web page.
Exemplary map display web page 200 on Fig. 2 illustration one web browser user interface 100.Herein, a map display web page 200 shows the result of the such map requests of doing among Fig. 1.Displayed information generally by one describe the map image 205 of the position of asking and neighboring area form.As shown in FIG. 2, on map image 205, identify the position of asking by an address icon 208, and address icon 208 is usually located at the center of map image 205.The position of asking and address icon 208 also can be shown on the The Key to Maps window 210 in the map display web page 200.Address icon 208 is a simple two-dimensional image normally, if it closely is shown in the map image 205 near other this kind icons, then can causes VC and the user is puzzled for the position of the actual indication of each icon in the map image 205 or misleads the user.
But map page 200 also the Show Button or other user interface object in order to can control the display mode of map image 205 by selecting these buttons or user interface object.For example, as shown in FIG. 2, usually provide convergent-divergent control object 220 that the user can " be amplified " or " dwindling " thereby and correspondingly influence the displaying ratio of map image 205, still make this moment the desired location of 208 marks of address icon be in the center of image usually.In addition, also can provide arrow button or other similar user interface object (for example " following arrow " arrow button 215) to make the user can " translation " described image, for example by showing that this cause is in the information of figure more that is hidden outside " south " border of map image 205, the corresponding part in shown " north " part before this in the mobile and hiding cartographic information simultaneously.As shown in FIG. 2, these image control objects are shown in beyond the borderline region of map image 205 usually, thereby can reduce to be available in the map display web page 200 the space size of map image 205.
Usually, when selecting image control object (for example the convergent-divergent control object 200 shown in Fig. 2 or arrow button 215), can transmit HTTP request to server, server can transmit a new images that comprises new cartographic information and shown to be provided with selected zoom-level then.
Particularly, just like in example system shown in Figure 3, a web browser 300 sends a HTTP who comprises the positional information of the map image of asking to a webserver 305 and asks.This HTTP request can be by forming via the position data that a web browser user interface 100 receives by data input webpage 105 as shown in fig. 1.For example, reach describedly in front as shown in FIG. 1, the user can import the following desired location that will describe map: 353 Main St., Billings, MT, 45619.The user asks to obtain direction by selection one " request obtains map (Request Map) " button 110 then, and should the selection event finally make the HTTP request shown in Fig. 3 transmit (directly or indirectly) to the webserver 305 from web browser 300.The webserver 305 sends a data base querying (" DB inquiry ") in response to this HTTP request to a map vector data storehouse 310.Map vector data storehouse 310 is generally the desired location data and determines corresponding vector and these vectors are transferred to the webserver 305.The webserver 305 usually uses the vector that receives to produce a bitmap images of required map then, and described bitmap-converted is become a kind of picture format of being supported by web browser 300 (for example GIF, PNG, JPEG etc.).The webserver 305 transfers to web browser 300-with described image then and normally it is embedded in the HTML(Hypertext Markup Language) code.Then, show described map image by web browser user interface 100 (reaching described in front as shown in FIG. 2) to the user.Therefore, when the user by for example importing a postal address or by clicking one when asking a new map view near the navigation link of current map view, web browser 300 can send the request on the border of the described new map view of an indication to the webserver 305.The webserver 305 extracts the map datum based on corresponding vector again from a database, and draws a bitmap images of described map.The webserver 305 converts described bitmap images to a kind of picture format of being supported by web browser 300 then and described image (being embedded among the HTML sometimes) is back to web browser 300 and is shown to the user.The commercial embodiment of this kind system comprise AOL company MapQuest (
Http:// www.mapquest.com), " SmartView " map based on Telcontar of Yahoo company (
Http:// maps.yahoo.com), and the MapPoint.net external member of Microsoft company (for example
Http:// maps.msn.com).
Fig. 4 illustration one is used for providing to web browser second example system of map datum.As shown in FIG. 4, a web browser 300 is to ask to a webserver 305 transmission HTTP with reference to the described same way as of Fig. 3 with the front.In case receive the HTTP request from web browser 300, the webserver 305 shown in Fig. 4 just transfers to a map raster data storehouse 410 with a data base querying (" DB inquiry ") that comprises the position data of asking.Map raster data storehouse 410 is extracted correct image according to described data base querying from a bigger map image that reproduces in advance.Then institute's requested image is transferred to the webserver 305, the webserver 305 transfers to web browser 300 with described image subsequently as previously described.Therefore, in digital mapping system shown in Figure 4, by only extracting the step that correct part in the bigger image that reproduces in advance replaces extracted vector and draw map images.The commercial embodiment of this kind system comprise Britain MultiMaps (
Http:// multimaps.com) and Australian WhereIs (
Http:// www.whereIs.com.au).It shall yet further be noted that this kind system is normally according to also producing map image for generation of the more same file based on vector of the printing edition of these maps.
The provider of some digital mapping website has noticed and can overcome some the problems referred to above by from the webserver 305 some littler images (being called " picture mosaic ") being transferred to web browser 300.Can be combined into a big image by web browser 300 picture mosaic that these are littler subsequently.For example, the TerraSerber USA website of Microsoft company (
Http:// terraserver.homeadvisor.msn.com/) currently namely use a kind of pattern splicing method to show satellite image.
Summary of the invention
The present invention discloses the whole bag of tricks, system and the equipment of the various aspects that are used for enforcement one digital mapping system.A kind of such method comprises: a position requests is sent to a map tile server from a client-side calculation element, receive the chart portfolio picture mosaic in response to described position requests, the described map tile that receives is combined into a picture mosaic grid, described picture mosaic grid is alignd with respect to a montage shape, and show described result with a map image form.A kind of the equipment of various aspects comprises according to the present invention: the member that is used for a position requests is sent to from a client-side calculation element map tile server, be used for receiving in response to described position requests the member of chart portfolio picture mosaic, be used for receiving the member that map tile is combined into a picture mosaic grid with described, be used for making described picture mosaic grid with respect to the member of montage shape alignment, and be used for showing with a map image form described result's member.This kind equipment can further comprise direction control object or convergent-divergent control object as interactive overlay image at shown map image, and also can comprise path or position overlay image at described map tile image.
Description of drawings
Incorporate in this instructions and constitute this instructions a part the accompanying drawing illustration various embodiment of the present invention.In the accompanying drawing:
Fig. 1 illustration one shows the example network browser of such map requests input webpage;
The map of the exemplary on Fig. 2 illustration one web browser shows;
Fig. 3 illustration one is based on the exemplary conventional digital map depiction system architecture of vector;
Fig. 4 illustration one is based on the exemplary conventional digital map depiction system architecture of grating;
The distributed networking system of Fig. 5 illustration one various aspects according to the present invention;
Fig. 6 be one according to the present invention the client-side of various aspects or the exemplary calcspar of server side calculation element;
The exemplary digital mapping system framework based on picture mosaic of Fig. 7 illustration one various aspects according to the present invention;
The box-like such map requests input of the exemplary set of Fig. 8 illustration one various aspects according to the present invention and map display web page;
The exemplary server side framework of Fig. 9 illustration one various aspects according to the present invention;
Figure 10 illustration one is other aspects of exemplary server side framework in accordance with the principles of the present invention;
Exemplary map image picture mosaic grid and the montage rectangle of Figure 11 illustration one various aspects according to the present invention;
Figure 12 illustration one according to the present invention various aspects with an exemplary picture mosaic grid and formed map image after a montage rectangle is compared;
Figure 13 illustration according to the present invention various aspects corresponding to basic picture mosaic mesh coordinate and the montage shape of the demonstration image of one group of exemplary;
One of Figure 14 illustration according to the present invention various aspects to web browser transmission map tile and these picture mosaics are cached on the spot the process flow diagram of the embodiment in the described web browser;
Figure 15 illustration one can be used for driving direction according to one and be shown in the process flow diagram that the embodiment on the map image uses as covering object;
Figure 16 illustration is carried out the process flow diagram of map image translation operation according to one embodiment of the invention;
Figure 17 to 21 illustration one is according to 1/3 example process of one embodiment of the invention translation montage westwards shape width;
Figure 22 illustration one is carried out the exemplary flow chart of a zoom operations according to one embodiment of the invention;
Figure 23 illustrates one and according to one embodiment of the invention one group of position mark is covered exemplary flow chart to the map image;
Figure 24 illustrate one according to the present invention various aspects have a plurality of exemplary map display web pages that cover position mark;
Figure 25 illustrate one according to the present invention the details of the exemplary of the position mark of various aspects;
Figure 26 A illustrate one according to the present invention the detailed content of the exemplary of the messagewindow of various aspects;
Figure 26 B illustrate one according to the present invention the detailed content of other exemplary of the messagewindow of various aspects;
Figure 27 illustrate one according to the present invention various aspects are coated with an exemplary map display web page of driving direction route track;
Figure 28 illustrate one according to the present invention various aspects are coated with the exemplary map display web page of a zone boundary track;
Figure 29 illustrates one according to the exemplary flow chart of one embodiment of the invention at one group of messagewindow of map image covering;
Figure 30 illustrates one and redefines the exemplary flow chart of the size of a map image display window according to one embodiment of the invention;
Figure 31 illustrates according to one embodiment of the invention has different resolution with the one group of exemplary map image picture mosaic for the letter quality of realizing map image.
Embodiment
This paper illustrates various aspects of the present invention according to a kind of equipment, system and method for acquisition and demonstration map depiction information.One of ordinary skill in the art will recognize that hereinafter explanation only is exemplary limited explanation by no means.By this disclosure, these personnel will come into plain view to other aspects of the present invention.
For example, for example can use and implement various aspects of the present invention with the computer programming language of inferior any amount: Java language, JavaScript, Java Applet technology, C, C++, Perl, Pascal, Smalltalk, FORTRAN, assembly language, HTML (being HTML (Hypertext Markup Language)), DHTML (being Dynamic Hyper Text Makeup Language), XML (being extend markup language), XLS (can expand style language), SVG (being scalable vector graphics), VML (vector markup language), Flash technology of Macromedia etc.In addition, can adopt for example various programmed methods such as program technic, OO technology or artificial intelligence technology according to the requirement of each particular.
To use identical Ref. No. to represent same or analogous parts at each accompanying drawing of presents and in illustrating in the whole text.In addition, some in this instructions is graphic is process flow diagram for example methodology and system.Should be appreciated that, each square in these process flow diagrams, and these process flow diagrams in the combination of square can implement by computer program instructions.These computer program instructions can be loaded on a computing machine or other the programmable equipment and form a machine, so that the instruction of carrying out at described computing machine or other programmable devices is formed for being implemented in the structure of defined function in the described process flow diagram square.These computer program instructions also can be stored in the computer-readable memory, described computer-readable memory can instruct a computing machine or other programmable devices with an ad hoc fashion job, so that the instruction that is stored in the described computer-readable memory forms goods that comprise for the order structure that is implemented in described process flow diagram square defined function.Described computer program instructions also can be loaded on a computing machine or other programmable devices, form one by computer-implemented process in order to carry out the sequence of operations step at described computing machine or other programmable devices, thereby make the instruction of carrying out at described computing machine or other programmable devices be provided for being implemented in the step of defined function in the described process flow diagram square.
Correspondingly, the square support in each process flow diagram reaches the combination of the step that is used for execution defined function for the combination of the structure of carrying out the defined function.Should also be clear that each square in the described process flow diagram, and described process flow diagram in the combination of square can be by carrying out implementing based on the computer system of specialized hardware or the combination of specialized hardware and computer instruction of defined function or step.
The distributed networking system 500 of Fig. 5 illustration one various aspects according to the present invention.Show among the figure that a calculation element 503 is connected to a network 505.Each server also is connected to network 505.For example, show among the figure webserver 510, a tile server 515, and a position data server 520 communicate with network 505, other server (not shown)s also can be connected to network 505 certainly.Calculation element 503 can be the device of any type that is configured to calculate, for example personal computer, mobile phone, personal digital assistant, be installed in navigational system in the automobile etc.Server 510,515 and 520 can be respectively any device that can preside over service at network 505, for example network server (network server) or webserver (webserver).Some or all map depiction information be imported to determine and/or be obtained to server 510,515 and 520 also can according to the user.Another is chosen as, and calculation element 503 can possess the ability of determining and/or obtaining direct of travel.In certain embodiments, described calculation element and each server (or its various piece) can be co-located in one or more machines.
Network 505 can be the distributed network of any type, for example LAN (Local Area Network), wide area network, switched telephone network, Intranet, the Internet or WWW.Another is chosen as, and network 505 can be direct connection the between calculation element 503 and the server 510,515 and 520.Calculation element 503, network 505 and/or server 510,515 and 520 can communicate by wired connection or the wireless connections of any type.In addition, can use the calculation element 503 that communicates with network 505, server 510,515 and 520, and other calculation element (not shown)s and/or other server (not shown)s carry out any or all function as herein described.
Fig. 6 is that a calculation element 505 or server 510, an exemplary of 515 and 520 are graphic.Calculation element/server 503/510/515/520 can comprise a bus 600, one or more processor 605, a primary memory 610, a ROM (read-only memory) (ROM) 615, a memory storage 620, one or more input media 625, one or more output unit 630, reach a communication interface 635.Bus 600 can comprise one or more conductor that can communicate between the assembly of calculation element/server 503/510/515/520.
As hereinafter describing in detail, calculation element 503 and/or server 510,515 and 520 can be carried out operation according to software instruction, and described software instruction can read in the storer 610 from another device from another computer-readable media (for example data storage device 620) or by communication interface 635.Being contained in software instruction in the storer 610 makes processor 605 carry out hereinafter institute with the process of detailed description.Another is chosen as, and can use hard-wired circuitry to replace software instruction or carries out in combination according to process of the present invention with software instruction.Therefore, each embodiment is not limited in arbitrary particular combination of hardware circuit and software.
Can use web browser (for example web browser shown in Fig. 3 and 4 300) the demonstration information on calculation element 503 (for example text message and graphical information) that comprises a web browser user interface (example as illustrated in figs. 1 and 2 web browser interface 100).Web browser 300 can comprise the visual display of any type that can show the information that receives by network shown in Fig. 5 505, for example the Web Browser of the Firefox browser of the Navigator browser of the Internet Explorer browser of Microsoft company, Netscape company, Mozilla company, PalmSource company or any other browser or other application software that can communicate with network 405.Calculation element 503 also can comprise a browser auxiliary routine.Described browser auxiliary routine can comprise plug-in unit, applet, dynamic link library (DLL) or similarly can carry out object or process.In addition, described browser auxiliary routine can be a tool bar, software push buttons or the menu of expansion can be provided for web browser 300.Another is chosen as, and described browser auxiliary routine can be the part of web browser 300, and in this kind situation, browser 300 will be carried out the function of browser auxiliary routine.
Example system general introduction and user interface
As hereinafter being described in more detail, all there are big (for example being the scale of the whole U.S.), the map raster image of adjacency under some aspect supposition of one embodiment of the invention each zoom-level in one group of appropriate discrete zoom-level.Described system produces these big raster images and is cut to the segment (for example picture mosaic of rectangle) that several its sizes are generally less than the order of magnitude of required map view in disposable off-line phase, and these picture mosaics are stored in the server side database with a kind of form of being supported by web browser.
As shown in the example in Fig. 7, as the network user during by the new map view of application software 700 (for example web browser shown in Fig. 3 and 4 300) request one, can be only at for be present in already in the web browser (or in the Cache of web browser, be shown as local storage 705 in Fig. 7, it can be embodied as the primary memory 610 shown in Fig. 6, ROM 615 and/or memory storage 620 with not limited) picture mosaic combine to produce the required minimum picture mosaic set of new view and send request to server 710.Form to the response of these HTTP picture mosaics comprises the web browser information of the described picture mosaic of high-speed cache on the spot of encouraging in header field.By carrying out one group of script, web browser will seamlessly be combined into new map view through this picture mosaic set of combination subsequently and present to the user.Because old map view still is present in the browser usually, thereby can be used as the part of translation and/or zoom operations, uses extra script to promote the transition to new map view from old map view smoothly.And, can be for example in response to the user to driving direction, the request that searches etc. of search, Yellow Page and cover position mark and route on the map tile top of reproducing in advance on the spot.In addition, can use similar techniques for example to highlight some zone and street at map image.
Fig. 8 from final user's's (for example carry out interactive user with web browser in calculation element shown in Figure 5 503 operations) angle illustrate one according to the present invention combined type such map requests and the map of various aspects shows an embodiment of pages 800.As shown in FIG. 8, page or leaf 800 comprise a map image 805, the directivity map control object 815 that covers, the convergent-divergent control object 820 that covers, position requests text entry field 825, search button 830, messagewindow 840, position mark 845, position mark shade 850, and messagewindow shade 855.As hereinafter being described in more detail, map image 805 is actually by making a picture mosaic grid have substantially the montage shape of identical size and shape with respect to one with map image 805 and aligns to produce.In one embodiment, described picture mosaic grid comprises the single map tile that several are less, and these less single map tile seamlessly are arranged in big image that is used for showing.By the well-known image soverlay technique of one of skill in the art and absolute fix technology, directivity map control object 815 and convergent-divergent control object 820 can be arranged in practically in the map image 805 itself, show the zone that is available for map image 805 in the page or leaf 800 thereby increase.In this way, can adopt size arbitrarily to map image 805, this is not limited in the map tile of entire quantity.And, can be at the center of map image 805 step point arbitrarily.In one embodiment, position enquiring text entry field 825 is embodied as single the text field, thereby need not to use a plurality of fields to stipulate to carry out each ingredient (for example its street address, city, state name or Zip code) of the desired location of map depiction.As hereinafter illustrating, in one embodiment, Fig. 8 also comprises the point 860 of keeping accounts (point 860 is not the visible features on the map image 805 usually although keep accounts) in the center of map image.
When selecting search button 830, can be in user's calculation element or in remote server analysis inputed to the desired location that will carry out map depiction text entry field 825 in, and produce and demonstration (by in the detailed process of presents described in the whole text) map image 805.Also can be repeated as map tile 840 and shown inputing to desired location in the input field 825 form after with its unprocessed form or analysis.The position that need carry out map depiction identifies with graphics mode by mark 845 and shade thereof 850 in map image 805.As hereinafter describing in detail, the effect that makes position mark visually seem to be the bidimensional form and comprise the inclination shade by use, make VC minimize-especially when the position of a plurality of position marks mutually closely near the time, and can more easily the physical location corresponding to position mark on the map be designated a point.
In user images control function aspects, directivity map control object 815 can be embodied as the pan button of one group of band arrow mark, cross for example 25% of montage shape size to be used for making map translation on the described direction of arrow.These buttons also can carry out mark, for example " west ", " north " or " northwest " by the compass orientation.As shown in FIG. 8, convergent-divergent control object 820 can comprise the button that is labeled as "+" and "-", map is amplified and dwindle single level being used for.These buttons also can carry out mark, for example " street ", " city ", " county ", " state ", " country " etc. by the geography information summary of corresponding zoom-level.Also as shown in FIG. 8, convergent-divergent control object 820 can comprise that also one has the slider bar corresponding to the discrete location of each zoom-level.From user's angle, slider bar is moved to a specific zoom-level may have the effect identical with selecting corresponding zoom-level.
Other examples as the user interface capabilities that provides in one embodiment, " click " or otherwise select a particular portion branch in the map image 805 to make the selected location move to the center of map image 805, center and zoom-level that the specific part in " double-click " or the selection map image 805 of otherwise exerting oneself then can make the selected location move to map image 805 increase simultaneously.In another embodiment, " double-click " or otherwise select the particular portion branch in the map image 805 to make the selected location move to the center of map image 805 at full tilt, click or otherwise select a position mark (mark in the map image 805 or near the mark of map image 805) then can open a messagewindow that is associated with described mark, and click subsequently or otherwise select the arbitrary part in the map image that described messagewindow is closed.In one embodiment, also support dynamically to redefine the size of map.For example, when redefining a display window 800 big or small, map image 805 in the described window is (in order to remaining in the position of previous window size center) placed in the middle again, and redefine the map size (if make it show a zone that diminishes so that new window diminishes, if perhaps new window becomes big then makes it show that one becomes big zone), and can't change zoom-level or need transmit image information again to user's web browser usually.In one embodiment, the user can " catch " angle of map image 805 or other parts (for example by when the selected angle of mouse icon positive sense by next mouse button) and it be carried out " dragging " size (for example by pressing mouse button and discharge described mouse button subsequently when mouse being moved to a selected location) to redefine map image.
An embodiment carries out the mouse drag function, wherein can be for example by pressing the user mouse button, position that mouse drag to is new until reach required map view, and subsequently release the mouse button come moving map view smoothly.In addition, also implement the map scroll function in one embodiment, wherein can only operate to move (or " translation ") map view by the arrow key on the excited users keyboard or by similar user.
In one embodiment, the whole or part postal address of input just can make map image 805 move to correspondence position and zoom to a zoom-level in the text entry field 825, and described zoom-level depends on the integrality of the address of importing.For example, can move to correspondence position when " 6936 Bristol Dr.; Berkeley CA " and zoom-level is set for close to the street rank in input, when input " Berkeley CA " only has more specifically address information, then will not move to the center in Berkeley city and set zoom-level for the city rank.And, be built with the position profile in one embodiment, if so that the user stipulate one substantially zone (for example city, state or Zip code) but not specific address, then can draw a profile to highlight described general areas (for example, shown in the position profile 2810 among Figure 28) around described general areas.This kind function can help the user to measure distance and focus on the zone of being concerned about.In addition, in one embodiment, the user goes back one group of quick position of definable (for example " family, " " work place " or " grandmother family "), when input or when otherwise selecting described quick position, can cause in map image that one " jumping " is to the operation (if the position of perhaps asking, then causes one " convergent-divergent/translation " operation enough near current location) of required quick position.
As shown in FIG. 8, an embodiment also makes up " messagewindow " function, interactive window 840 and shades 855 thereof that comprise about the more information of this represented position of mark of wherein clicking or otherwise select a position mark (for example mark 845) just can spread out the map and cover in the image 805.
In one embodiment, except input in text entry field 825 will be carried out the single position of map depiction, the user also can carry out combinatorial search, and wherein the user can stipulate the item that will search for and the position (for example " movie theatre of San Francisco " or " near the pizzeria the Mountain View ") that will carry out map depiction in single text box.And, combine with foregoing quick position, the user can name (for example " family ", " work place ") (this both can with also can be not be associated with address book or similar database or utility routine on user's calculation element) to ad-hoc location, and subsequently when inputted search item in text entry field 825 (for example when search " near the bar the work place ") use these quick titles.
Embodiment is the single text entry field 825 by as shown in Figure 8 also, or another is chosen as, and makes up by a text entry field that is used for homeposition and second text entry field (text entry field 825 and 828 as shown in Figure 27 is illustrated) that is used for the final position and drives the direction function.As another exemplary alternate embodiment, also can make up by two groups of concrete text entry fields and drive the direction function: wherein one group is used for homeposition field (street address that for example sets out, the city of setting out, state of setting out etc.), second group then is used for the final position field.At all events plant and drive direction input field interface, one embodiment of the present of invention are all implemented the client-side of route information is reproduced.Particularly, in one embodiment, server transmits the vector information that the text type direction that turns to one by one illustrates and the figure of whole route is described to the client computes device.
By client computer described driving direction figure is reproduced on the map image top of reproducing before this as a coverage diagram then.In another embodiment, in case client computer receives vector information, client computer just the calculated route overlay image pattern definition and the request of actual overlay image will be provided to server transmission one subsequently.In addition, as shown in Figure 27, drive directional control text 2730 (for example " rolling away from from Moffett Blvd. ") can be shown in map image 805 on the webpage 800 near.Click or otherwise select one of them to drive direction text and just can open a messagewindow that points to counterpart in the map image 805 (for example highway chute from the US-101 that travels southward to Moffett Blvd.).As shown in Figure 27, the enlarged drawing of counterpart in the described messagewindow displayed map image 805.
In one embodiment, messagewindow comprises " satellite " button or similar user interface object in addition, described " satellite " button or similarly user interface object when clicked or otherwise selected, can replace the diagram form enlarged drawing of map with a corresponding satellite photo of same area.Diagram form driving direction (namely describing the track of route) also can be used as an overlay image and is shown on the satellite photo top." " button or similar user interface object also can be contained in the main map image 805 (or associated with it) satellite, so that when clicked or otherwise selected, described " satellite " button can replace the map image 805 of the picture/mb-type shown in Fig. 8 with a corresponding satellite photo of same area.
The generation of server side framework and map tile
In one embodiment, by in browser, one group of map image that reproduces in advance " picture mosaic " being stitched together to show map.These map tile are to form in the following way during an off-line phase: the very large map of drawing the whole geographic area that is covered with each zoom-level in the discrete zoom-level (for example 15) of a predetermined quantity, then these maps are cut into several picture mosaics, and these picture mosaics are encoded into a suitable picture format (for example GIF).These picture mosaics of reproducing are in advance provided with the still image form by one group of server.For example, for covering whole ConUS, need more than one hundred million picture mosaics, total picture mosaic size of these picture mosaics is about the data of hundreds of gigabyte.Be not to come draw map images according to basic data when needed, but by the pre-rendered whole map of segmentation (picture mosaic) form, and when needed suitable picture mosaic is sent to client computer.Therefore, generally speaking, a set map tile only needs to client transmission once.This kind method than traditional system more reliably, faster and required bandwidth is lower.
Therefore, in the off-line procedure of a pair of user transparent, produce a group big, raster image adjacency, that reproduce in advance in the whole zone that described map system covers.For each zoom-level (for example from the street rank to country level) provides one group of such raster image.Final combination and each map image 805 (as shown in FIG. 8) of showing all are complementary with the subregion (it is shaped as rectangle usually) of one of these big predetermined raster images in user's web browser.Another is chosen as, can by cover on the map image border be complementary with background around map image or mutually the image of mixing the map image border changed over seem to be a different shape (rectangle that for example has fillet as shown in Figure 8).
In one embodiment, zoom-level is numbered 0 to Z, wherein 0 representative is close to other rank of street-level, and Z representative and street rank differ rank farthest.Be concerned about lat/lon (" lat/lon ") the point appointment arbitrarily in the zone and be defined as initial point or starting point (geographic center of the U.S. that for example adjoins).Then, under each zoom-level z, for the pixel assignment three-dimensional group of the z rank raster image that comprises this initial point (0,0, z).Use the standard computer graphics stipulations that wherein the x axial coordinate increases from left to right, the y axial coordinate increases from the top down, for the unique three-dimensional group of each pixel assignment one of each raster image (x, y, z).
Under the situation of given zoom-level z, use a coordinate transform routine with a latitude/longitude coordinates suitable to being transformed into (x, y, z) pixel coordinate, vice versa.The details of this kind conversion depends on employed map projection when forming raster image at first.
One only during the initial off-line phase (for example every some months once) that basic map information just need be carried out when great changes will take place, the raster image that each is big " cutting " becomes some rectangle picture mosaics.As shown in FIG. 9, in one embodiment, the process that produces and cut big raster image is in conjunction with the execution that cooperates of map painter storehouse 910 and commercially available RME (" enhancing engine map ") storehouse 915 by tile maker.Except other tasks, tile maker 905 guarantees that also adjacent subimage picture mosaic closely aligns along its public boundary, especially when relating to label and arrange.Be under the well-known condition of those skilled in the art in known map projection problem, may need the zone that map system covers is divided into some littler zones, and handle each littler zone respectively.
Still referring to Fig. 9, the basic map data are stored in the map datum storage area 920.In one embodiment, institute's map data stored comprises the commercially available NavTech data of being compiled RMF (enhancing format map) file by Telcontar (the commercial provider of a numerical map and navigation information).The those skilled in the art will know, RMF is a kind of binary format of the compactness of handling to be optimized at space querying.Except other tasks, one embodiment of the invention are also utilized this kind form to produce map image and are formed route information.RMF is a kind of space form, and it organizes data in the multidimensional mode, in order to will together closely be stored in the database by mutual close body in reality.In case this means an item in the data acquisition that finds a format spatially, just also can relatively easily find other close items.The those skilled in the art will know, also exist many kinds to be used for organizing other modes of data, for example organize in order or laminated tissue.Still referring to Fig. 9, in one embodiment, tile maker 905 and map painter storehouse 910 communicate to ask the map datum for making picture mosaic.Map painter storehouse 910 communicates with access information from map data storage 920 with commercially available RME storehouse 915 again.The those skilled in the art will know, the rme database support obtains request to relate to the space querying of information of two or more geographical relationship.The example is " which map body is in the set zone? " perhaps " the map body which has the priority that is higher than a certain threshold value is in the set zone? "The result of space querying transfers to tile maker 905 by map painter storehouse 905 and for generation of map tile.The resulting map tile of this picture mosaic manufacturing process is stored in the map tile storage area 900.
For arbitrary sub-area view of on user's web browser, forming described big raster image again as a map image 805, in one embodiment, the script of browser side only needs to use the picture mosaic set of the minimum that can together cover required view fully.For arbitrary set embodiment, can exist under the following compromise situation in supposition, determine the size of picture mosaic: (1) bigger picture mosaic tends to increase the size of population (aspect pixel and byte two) for forming the required picture mosaic of a set view with souning out; And (2) less picture mosaic tends to increase for forming the quantity of the required independent HTTP request of a set view.In one embodiment, use the picture mosaic size of one 128 * 128 pixels of being stored with the GIF form.Other embodiment then use the picture mosaic size of 256 * 256 pixels of being stored with GIF, JPEG or PNG form.Also can use other picture mosaic sizes and image storage format, this requirement on each particular is decided.In one embodiment, these picture mosaics form the square node of a rule thus, and this kind character is conducive to system constructing.Yet the those skilled in the art will know, can use any other dividing mode that can be divided into the picture mosaic of arbitrary shape and size at the raster image with big of the seamless combination of client-side realization to realize effect of the present invention.
Another is chosen as, and is not in the database that is stored on the server side, and in one embodiment, each picture mosaic can only be stored in one and for example can use to come in the independent file of access with inferior unique URL:
Http: //＜domain name 〉/7/-18/1/-145_12_7.gif,
Wherein the directory path 7/-18/1 in this example only depends on tile coordinates-equal (145,12,7) in this exemplary situation.
For simplicity's sake, first picture mosaic of each zoom-level z is arranged to make picture mosaic top left corner pixel coordinate for (0,0, z).This rule is conducive to by the pixel x of the top left corner pixel of picture mosaic and y coordinate being divided exactly with the width of picture mosaic respectively and highly coming to be the unique three-dimensional group of each picture mosaic assignment one.Therefore, utilize three coordinate systems altogether: latitude/longitude coordinates, pixel (x, y, z) coordinate and picture mosaic (x, y, z) coordinate.The those skilled in the art will know that this kind is arbitrarily to the specific selection of coordinate system, and be chosen to help explanation employed algorithm in one embodiment simply.Generally speaking, any compatible coordinate system all will meet the demands.Conversely, each pixel all belongs to a unique picture mosaic, and the coordinate of this picture mosaic can easily calculate.
Front-end server
In one embodiment, one front-end server (for example webserver shown in the server shown in Fig. 7 710 or Fig. 5 510) is back to each inquiry that a picture of hiding is submitted in response to the user by making a webpage, and described hiding picture comprises by the data that are implemented in the client-side code institute access among the JavaScript.Therefore, front-end server 710/510 produces dynamic HTML (" DHTML ") code with the batch processing reciprocation of moving at user browser based on JavaScript.By this kind mechanism, can in client computes device 503, implement foregoing user interface capabilities (for example map view 805 shown in translation and convergent-divergent Fig. 8), and need not and front-end server 710/510 reciprocation.But as shown in FIG. 5, client computes device 503 only fibrous root is asked and the demonstration picture mosaic from tile server 520 according to needs, and tile server 520 provides the previous picture mosaic that has produced to gather with reference to Fig. 9 is described as mentioned.
The basic working modes of front-end server 710/510 is to provide response to user's inquiry of importing in text entry field (for example field shown in Fig. 8 825) in map display page 800.When the user submits an inquiry to, client-side JavaScript code can form one comprise the content of described inquiry and map view current state the HTTP request and this information submitted to front-end server 710/510, thereby instruct the formed page to come across in the picture (or " virtual page number ") of hiding.This kind mechanism can be received as client computer and makes up the required data of map depiction system (the various features that comprise the map depiction system), for example (for example) is used for driving direction and other overlay image, lead/visible webpage and need not to reload, but still can make simultaneously browser history and/the back/forward button works by the expection mode, in order to make the user for example can implement local search, obtain direction and click to be back to local search results to returning then.In case load described virtual page number at the client computer place, the JavaScript on the homepage just can pull out described data and correspondingly adjust homepage in the following way in described virtual page number: (1) changes the HTML title; (2) change the search form; (3) use the URL of the picture mosaic that will in map image, show to replace HTML IMG reference symbol in the picture mosaic grid; (4) translation and/or convergent-divergent map show; And/or (5) are added or are replaced one or more overlay images at map.
In one embodiment, identify and handle the inquiry of following type:
1) position enquiring (for example " Berkeley ").These inquiries comprise individually manages the position.In response to this kind inquiry, front-end server 710/510 instruction client computer is with the map translation and/or zoom to this position and the border of this position of mark on display.For example, in one embodiment, " point " inquiry is (for example for a particular address, as shown in FIG. 8) can obtain a demonstration that comprises the position mark of the position of asking, and " line " inquiry is (for example for the particular street in the town, and do not stipulate the street Taoist monastic name) can obtaining one, wherein on map the line of asking to be highlighted be the demonstration of an overlay image, and " zone " inquiry (for example for a town, for example " Anytown ") can obtain one, and wherein on map image institute to be asked regional highlighting be the demonstration (as shown in Figure 28) of an overlay image.
2) local search queries (for example " pizzeria ", " post office ").These inquiries comprise commercial location title, classification or other collection of search terms, but do not comprise the geographic position.In response to this kind inquiry, technology known to the use those skilled in the art, front-end server 710/510 according to the user to the navigation of map or because inquiring about the location that a position obtains, the commercial location that near (or) search and described inquiry are complementary in current map view, and instruct client computes device 503 on map image 805, described result to be shown as one group of position mark 845/850, optionally together show with the legend of a description that is associated with map image 805 by the Search Results of each mark symbolically.
3) qualified local search queries (for example " pizzeria of Palo Alto ", " near the Pure Malt Whisky the San Francisco ").These inquiries comprise search terms and a geographic position simultaneously.In response to this kind inquiry, front-end server 710/510 instruction client computes device 503 translations and/or zoom to indicated position and display of search results in this position or on every side.Another is chosen as, be transformed into latitude/longitudinal point, this group latitude/longitudinal point is implemented local search, and set zoom-level subsequently and (show for the result to guarantee that all positions in the local search results all are shown on the map image being contained in geography information in the described inquiry, referring to Figure 24, its supposition search " the big sushi of New York ").
4) drive direction inquiry (for example " from San Francisco to New York, " " from the family to the work place, " or " from 123 Main St.Los Angeles, CA to 801 University Ave.Palo Alto, CA ").These inquiries comprise two different geographic position.As previously described, in response to this kind inquiry, in one embodiment, front-end server 710/510 can with route information with text type one by one steering direction transfer to client computer, client computer can be subsequently be shown as described route one overlay path that highlights in map image 805.Also as previously described, the user can come and these text type direction reciprocations by some part (for example clicking or otherwise select specific riding manipulation) in the described path of convergent-divergent, describes in detail with text type or the diagram form that obtains other.
Front-end server 710/510 can be embodied as several different flows of logical control of being selected according to a query classifier.Query classifier comprises that one has the position extraction apparatus of one group of template, and how this group template can resolve into each ingredient with a query string if defining, comprise search terms, geographic position identifier and writing text.For example, one for example the template of " { QUERY}{STANDALONE_CITY} " will be complementary with a simple queries by " the pizzeria palo alto " of user's input and cause the Alto to Palo, near the search of " pizzeria " the California center.The big relatively database that the extraction apparatus energy access one of described position is made up of one group of different types of location title (for example street name, city title etc.).
In one embodiment, as shown in Figure 10, front-end server 710/510 also comprises one geocoding/geographical map server 1010, described geocoding/geographical map server 1010 with not structurized evolution become a structurized position add one can be on map image 805 shown in Figure 8 geo point/line/the zone of mark.Also as shown in Figure 10, geographical map server 1010 collaborative with bore down (drill-down) servers 1015, map datum storage area 920, position data server 1000, and local search server 1010 for example communicate to handle street address, street, point of crossing, the point of being concerned about, city, block, ZIP code, county, metropolitan area, state etc. (with and international equivalent title) geographic entity.For some features such as for example street addresses, the result of conversion is single (latitude, longitude) point.And for line features such as for example street and provincial characteristics such as city for example, the result of conversion can define in these features each broken line (for example for for the street) or polygon (for example for the city).Another is chosen as, and the result of conversion can only be the bounding box of an axial alignment.
Also as shown in Figure 10, in one embodiment, front-end server 710/510 comprises that also one is used on a set geographic position or seeks the local search server 1005 of Search Results on every side.For for example query compositions such as " pizzerias of paloalto ", local search server 1005 can be carried out after wait receives the result of geocoding/geographical map server 1010.For digital mapping system, wish local search server 1010 in, to carry out and a kind ofly have that position restriction flexibly defines and apart from the local search scoring algorithm of graduation concept.The user is preferable should be able to search for the commercial location that is complementary with a set group polling item in current map view.This requires the local search code to allow to be minimum and high latitude and longitude coordinate form but not the only restriction of central point and radius form.Usually need to a certain degree apart from graduation.In other words, the result's of the definite center of map demonstration score should not be higher than the result who shows other positions in the view.For example, the search to " pizzeria of palo alto " should not give two Palo Alto pizzerias different score than the center of another more close Palo Alto because of one of them pizzeria by chance.
In one embodiment, when front end server 510/710 picks out one " driving direction " inquiry, front-end server can be transformed into source address and destination-address one group of simple steering direction one by one and a regulation along the broken line of described route (latitude, longitude) coordinate.Front-end server 510/710 can comprise along the broken line of the vector information of whole route together with one group subsequently, uses XML (for example in a vPage) that described steering direction is one by one transferred to the client computes device.In one embodiment, should organize before these transfer to client computer, front-end server can reduce the sum (for example using the well-known geometric operation of those skilled in the art to eliminate the data point that any error that when being eliminated whole group broken line is caused in this group broken line can not be higher than a certain predetermined threshold (for example one or two pixel)) of the graph data point that transfers to client computer, and the data point that each is not eliminated is assigned to one define " group " that zoom-level makes this point become visually relevant (for example the data point in the group " A " may all obtain showing, the data point in the group " B " then just requires demonstration after zoom-level has been increased to the zoom-level that surpasses corresponding to a city level view or meticulousr view etc.) under each zoom-level.
In one embodiment, during beginning, after the user imported a driving direction inquiry, map image 805 showed the skeleton diagram of whole selected route.Some part that the user can amplify described route subsequently obtains more detailed view.
In one embodiment, make up the quantity that a record keeping mechanism comes the map view that recording user asks, for example record relevant with the described map view much map area altogether of having visited of a user.Referring to foregoing Fig. 8, define a record keeping point 860 (point 860 is not a visible features usually although keep accounts) in the center of map image on map image 805.Therefore, for example, if map image 805 comprises that one is defined as 400 wide, 400 zones that pixel is high of pixel, then on level and vertical direction with other record keeping points of spaces (forming a record keeping dot grid thus) of 400 pixels.Therefore, in one embodiment, each map view comprises transaction at least one times.If the user initiates a translation, the dot grid of then keeping accounts can be with map " movement ", thereby triggers extra transaction for account when a new record keeping point enters map view.For example, if the user with map image to 200 pixels of right translation, then a new record keeping is named a person for a particular job and is entered in the view and trigger once new transaction.In one embodiment, one shows that with a set zoom-level zoom operations of a map area of before not checked also can trigger new transaction.In one embodiment, the 710/510 report transaction of client computer forward end server, front-end server 710/510 is collected Transaction Information and is used it for the purpose of carrying out the contract signing with the commercial provider of cartographic information from all users.
Client-side framework and algorithm
Can use the various technology that have in the modern network browser to implement embodiments of the invention.The common graphic feature of some embodiment is can be in the picture mosaic of one " montage shape " back combination chart portfolio.In addition, the main frame technology at user's calculation element 503 places should be able to quite efficiently, dynamically change display layout.Preferably (but and nonessential like this), the web browser of client computer should use double buffering (or similar) display to carry out this kind dynamic change to prevent flicker.For example, DHTML uses a double buffering display engine.Use among the embodiment of DHTML one, browser is carried out script function in response to events the such as for example user import, HTTP finishes and overtime.The institute that the term of execution of script webpage is done changes and all at least logically is recorded in a screen outside in the impact damper, and described screen impact damper is outward shown when script is returned control to browser.
As being described in more detail hereinafter, according to the client-side algorithm of an embodiment usually by the map tile layout is made one group of change, and subsequently the requesting host system show that these change the new picture that defines and proceed.In one embodiment, can use HTML code by as get off to make up the map display function of client-side:
<div?id＝″mapView″style＝″position:relative；overflow:hidden；″>
<div?id＝″mapDiv″style＝″position:absolute；″>
<table?id＝″mapTable″><tbody>
<tr><td><img?src＝″images/bg.gif″></td>
…
</table>
</div>
</div>
In this embodiment, the JavaScript code on the website by appropriate map tile is positioned over mapTable＜img in the key element and by mapDiv is moved translation and convergent-divergent map with respect to mapView.Therefore, in this embodiment, the client-side algorithm adopts two main graphical elements.First key element is " montage shape " (being generally a rectangle), and by described " montage shape ", the user it will be appreciated that map image 805, and it defines the shape of user's map view.Only for the purpose of explaining the client-side algorithm among the embodiment, the arbitrary pixel in the described montage shape is assigned as its initial point (for example being top left corner pixel under the situation that is a rectangle montage shape).Second key element is a picture mosaic grid, its greater than and be positioned over described montage shape back so that the user only can see the part of described grid.In the remainder to an embodiment illustration, should suppose that this grid is rectangle herein, and it only just changes size when described montage alteration of form is big or small.The those skilled in the art will know that algorithm as herein described exists various wherein these character and invalid version.
Generally speaking, described montage shape keeps fixing with respect to web browser window 800, and the Client-side scripts of various aspects will make the position of picture mosaic grid move with respect to the montage shape according to the present invention, particularly, and with translation map image 805.These two graphical elements of Figure 11 illustration, Figure 12 illustrates via the montage shape and handle the result of picture mosaic grid to be shown on webpage simultaneously.As shown in Figure 11,5 * 5 square picture mosaic grid arrays 1100 comprise 25 independent picture mosaics (each picture mosaic is defined by the boundary line of redness).One square montage shape 1110 (being shown as black rectangle) defines in the described picture mosaic grid and will be shown in subclass on the web browser of client computer as map image.In Figure 12, the border of the picture mosaic grid array 1200 of demonstration " through montage " and the border adjacency of montage shape.As previously described, the map image shown in Fig. 8 805 also is the result that a bigger picture mosaic grid array has been compared with a montage shape.Figure 13 illustration can be corresponding to basic picture mosaic mesh coordinate and the montage shape 1305 of one group of shown image (for example at the image shown in Figure 11 and 12).In Figure 13, each in 1300 interior 25 picture mosaics of 5 * 5 picture mosaic grid arrays is represented by a unique spelling figure coordinate.
In one embodiment, the montage shape is one to have the rectangle of 300 * 300 pixel fixed sizes, and is positioned at the center of webpage 800 as shown in Figure 8.In one embodiment the montage shape being embodied as a pattern is " overflow:hidden; Position:relative " and id be the DIV key element of " mapView ".The picture mosaic grid has the fixed size of 5 * 5 picture mosaics.Be implemented as an id and be the TABLE key element of " mapTable ".In 25 TD daughter elements of mapTable each all comprises single IMG element, so that place the SRC attribute that a picture mosaic only needs to change rightly the IMG element.The mapTable element is that an id is the daughter element of the DIV element of " mapDiv " and pattern=" position:absolute ".The POSITION pattern of mapView and mapDiv makes and can only by LEFT and the TOP pattern that changes mapDiv the picture mosaic grid be moved with respect to the montage shape.
Generally speaking, the picture mosaic grid can be dependent on hereinafter described various embodiment factors with respect to the size of montage shape.By and large, can use the minimum picture mosaic grid of the twice that is at least montage shape (in pixel) size (width and height two aspects).Equally, decide on the embodiment option, when the user changes the size of montage shape or shape, may need dynamically to change the size of picture mosaic grid.
For carrying out hereinafter exemplary illustrative purposes, make A and B represent width and the height (coming in picture mosaic) of picture mosaic grid respectively.For each position assignment one coordinate in the picture mosaic grid to (a, b), wherein the coordinate of position, the upper left corner be the coordinate of (0,0) and position, the lower right corner be (A-1, B-1).In computation process, may mention the position that is in outside the picture mosaic grid (a, b), i.e. wherein a＜0 or A≤a, perhaps b＜0 or B≤b.
In formed each map image, the common factor between montage shape and the picture mosaic grid will equal whole montage shape in one embodiment, and only map tile is exposed to the user by the montage shape.In the remainder of presents, this kind fact is called " common factor condition ".
Under the condition of above having made supposition and definition, (x, y z) refer to arbitrary map view to the pixel three-dimensional group of the ground pixel that people can expose by the initial point place in the montage shape uniquely.
Initialization and high-speed cache
In one embodiment, suppose and the user asked an initial map view (z), and ((z), then Client-side scripts is carried out operation as follows for xx, yy z) to belong to picture mosaic for x, y further to suppose the corresponding map pixel for x, y.At first, in any mode that can not run counter to the common factor condition picture mosaic grid is placed with respect to the montage shape.The second, will (a b) be defined as the position of the picture mosaic grid that comprises montage shape initial point now.The 3rd, on the position that each and montage shape intersect in the picture mosaic grid (a+a ', b+b '), place picture mosaic (xx+a ', yy+b ', c).The the 4th and last, show formed picture.
Generally speaking, when a picture mosaic being positioned on the picture mosaic grid position, usually will make browser check at first whether described picture mosaic is present in its Cache, and if be not present in its Cache, the request of then sending obtains the appropriate HTTP request of required picture mosaic.Look the particular host technology of a set embodiment, this HTTP request can synchronously or asynchronously be carried out.Embodiments of the invention by encourage web browser on the spot each picture mosaic of high-speed cache improve performance.Therefore, when this instruction of browser batter browser display one specific coupling, browser will be only when described picture mosaic is not present in the Cache of this browser already just from the described picture mosaic of http server request.By this kind mode, even when the view of each separation belongs to different browser session, embodiments of the invention also can comprise overlapping image and be benefited because of the map view of these separation.In fact, in case the user has checked a certain zone when online, the user just can check the same area when off-line, if only need to use this user the picture mosaic of high-speed cache already.
For realizing this kind effect, in one embodiment, is Client-side scripts by a three-dimensional group that only depends on picture mosaic (http://somedomain.com/tiles for example? x=0﹠amp; Y=0﹠amp; Z=0) URL (" resource locator ") identifies each picture mosaic respectively.Generally speaking, web browser by use one be contained in the http response that contains each picture mosaic expiration time and/or by the last modification time of picture mosaic on the last modification time of picture mosaic in the browser cache device and the server side is compared to manage its Cache.Because back a kind of in these two kinds of methods even in the time should using to obtain the picture mosaic of high-speed cache, also need the slightly high HTTP request of trace utilization cost, thereby the http server of transmission picture mosaic can be configured to report that a tediously long expiration cycle-this is to exist under the following compromise condition exploratory ground to be determined known: on the one hand, and the minimum numberization that long expiration cycle tends to make the required HTTP of picture mosaic that correctly obtains high-speed cache to ask.On the other hand, short expiration cycle can make at big map input grating and change (in practice, this can be used to replenish new road construction, perhaps utilizes the improvement to the mapping system that produces described grating) time make new picture mosaic be transmitted to web browser quickly.
Another is chosen as, can an embodiment be added (the http://www.somedomain.com/tiles for example of a version number to picture mosaic URL? x=0﹠amp; Y=0﹠amp; Z=0﹠amp; V=1.0), be configured to report one in due date in the future remote as far as possible with the http server of transmission picture mosaic, and only when needs are propagated new picture mosaic, just use certain other be used for originally transmitting to the browser batter method of new picture mosaic version number.The HTTP that this kind alternative system makes browser send the picture mosaic that obtains correct high-speed cache already asks minimized, can control fully simultaneously and when should use new picture mosaic to replace the picture mosaic of old high-speed cache.Yet this kind alternative system tends to use bigger disk space in the browser side really, because on the browser side, new picture mosaic will can not replace old picture mosaic.It should be noted that embodiments of the invention and do not rely on special use HTTP picture mosaic is transferred to web browser from server.Also can transfer other transportation protocols that the use browser is supported, for example HTTP or FTP.The those skilled in the art will know, each transportation protocol may need to use slightly that diverse ways comes the high-speed cache picture mosaic.Embodiments of the invention are also carried out exploratory algorithm according to nearest translation and zoom operations, might need which picture mosaic in the recent period to predict, reach and use free time and/or bandwidth that these picture mosaics are sent in the Cache of browser.As a kind of alternative, if free time and/or bandwidth can be exclusively used in when upgrading current sightless position in the grid and/or asking those users to ask the transition of single-stage convergent-divergent with the picture mosaic of needs.
Figure 14 illustration one is used for going out the process flow diagram of the embodiment of the described picture mosaic of high-speed cache on the spot to web browser transmission map tile and at web browser.At step 1400 place, client computer receives an alternate location (for example, the user may will carry out the position of map depiction and select the search button 830 among Fig. 8 subsequently to the text entry field 825 interior inputs one shown in Fig. 8).Next, in step 1405, the client computes device transfers to a location server (for example server shown in the position data server shown in the position data server shown in Figure 10 1000, Fig. 5 520 or Fig. 7 710) with described alternate location.Described location server is the described alternate location of analysis in step 1410 then, thereby produces position data.In step 1415, client computer receives this position data from described location server, and in step 1420, client computer uses institute's receiving position data to form a picture mosaic request.For each picture mosaic in the described picture mosaic request, client computer judges all whether the picture mosaic of asking is stored in this locality already.Particularly, in step 1425, client computer judges whether the picture mosaic of asking is stored in this locality already.
If described picture mosaic is stored in this locality already, then in step 1435, client computer is retrieved described picture mosaic from its local storage.Perhaps, if described picture mosaic is not stored in this locality already, then in step 1430, client computer is retrieved described picture mosaic from a tile server (for example tile server shown in Fig. 5 515).In step 1440, in case from the Local or Remote tile storage, retrieved the picture mosaic of asking, namely it is shown.Next, in step 1445, determine next picture mosaic request.If also there is more picture mosaic (institute's judge in step 1450) in described request, then described process loopback judges to step 1425 whether the new picture mosaic of asking is stored in this locality already in step 1425.Perhaps, if no longer there is more picture mosaic in described request, then described process finishes in step 1455.
It should be noted that most of destination host technology all provide the utilization to asynchronous HTTP request.This kind feature makes Client-side scripts one picture mosaic be positioned in the picture mosaic grid, also begin mobile picture mosaic grid subsequently before the actual arrival of described picture mosaic at a translation transition period, thereby temporarily the picture mosaic that appears mistake to the user (perhaps, another is chosen as, the space or the empty picture mosaic that have appeared).Generally speaking, decide on the particular requirement of set embodiment, can think that this kind asynchronism is than more desirable because waited for the tediously long delay that all new picture mosaics may cause all the time before moving map.In certain embodiments, use one replaces picture mosaic old in the picture mosaic grid with the static picture mosaic (and may almost be in all the time in the Cache of browser) that the map background color has color of the same race before sending asynchronous request.Another is chosen as, and a more complicated embodiment can be waited for to the time out period that all new picture mosaics have all arrived or certain is short (at first occur) and just begin moving map when expiring.In this kind embodiment, the picture mosaic of solid color will only be used in timeout condition.
Overlay image
According to an embodiment, can on the client-side all extraneous informations except the base map image (for example drive route, ad-hoc location) be depicted as overlay image and place on the map top.This kind method can be used for all extraneous informations, and this means that server does not need to use as required specific extraneous information to draw any map.For example, can use overlay image to come display position mark and route, highlight street and specific region.The those skilled in the art will know, can make up overlay image by different modes (for example by image or vector).For example, client-side JavaScript can show top placement html element element at map.With regard to foregoing code snippet, all cover element and all can be positioned among the mapDiv, so that it can be automatically mobile with map when mapDiv moves.These cover in elements some may be in when loading described webpage in the HTML code in (wherein styele=" display:none ") first, other cover elements and then can add by the JavaScript code afterwards.
Figure 15 illustration one can be used for driving direction is shown as an overlay image at map image process flow diagram according to an embodiment.In step 1500, the mode that client computer illustrates already with a kind of front receives one from the user and drives the direction request.In step 1505, client computer transfers to a location server with the direction of travel information of asking.In step 1510, with reference to as described in the explanation of the function of front-end server, described location server is analyzed described direction of travel information as the front.In step 1515, client computer receives the geographical direct of travel data of text type from described location server, as previously described.In step 1520, client computer is defined as the driving direction route track that covers in map image demonstration one and the vector that needs.In step 1525, client computer is reproduced basic map image (if not implementing this step as yet) according to the described process flow diagram of Figure 14, as previously described.In one embodiment, in step 1528, client computer will be driven direction route track subsequently and will be shown as an overlay image on the base map image.In another embodiment, be not to proceed to step 1528, but in step 1530, client computer is according to being covered from described location server request one directional image of advancing by the vector information of client computes in step 1520.In this embodiment, in step 1535, described location server forms an advance directional image and transmit it to client computer.At last, in this embodiment, in step 1540, client computer is covered in final direct of travel image on the described map image.Show that in Figure 26 one has the shown map image of the exemplary of driving directional image that covers.
In certain embodiments, some particular network browser (for example Mozilla/Firefox) possibly can't as indicated abovely be drawn vector graphics.In this kind embodiment, for example the resources such as geographical map server 1010 shown in Figure 10 can produce one and cover bitmap images (for example for one and one group of broken line of driving the directional correlation connection), and browser can be blended on the described map image by the image that this is transparent subsequently.Because browser is directly from these images of geographical map server 1010 request in this example, thereby described request is by a URL but not an agreement impact damper is made.Can be the command-line option of geographical map server 1010 with width and the color assignment of described line.
Translation
In one embodiment, can carry out the operation of map image translation as follows.At first, suppose that the user has asked on same zoom-level from a map image (x, y, z) move to a new map image (x ', y ', and suppose that described translation should form animation in n picture (wherein n=1 represents that the switching to new view should be carried out from old view single step, and that the more high described switching of n value representation simultaneously should be rendered as is more level and smooth, more be the translation of cartoon type) z).In addition, suppose on following meaning, for the size of picture mosaic grid, these two map views are " approaching " mutually: on both, the distance between these two views adds that the size of montage shape is less than the size (according to pixels counting) of picture mosaic grid at x axle and y axle.
On the basis of above-mentioned supposition and definition, picture mosaic grid " being rotated down " operation is defined as gets bottom line and make its row that becomes the top, and subsequently formed grid be arranged to make all the other positions to keep its original position with respect to the montage shape.Equally, will " rotate up " and be defined as the row that the row that makes the top becomes the bottom, and " to anticlockwise " will be defined as the row that the row that make the left side become the right side, and " to right rotation " is defined as the row that the row that make the right side become the left side at last.These rotary manipulations are used for wherein moving the situation that described picture mosaic grid will be run counter to the common factor condition originally.Certainly, also there are other modes that can realize same effect (for example by making each picture mosaic in the grid move a position), but it is found that top operation definition is efficiently.Therefore, Client-side scripts is carried out as follows.At first, make (dx, dy)=(x y)-(x ', y '), and makes that (a b) comprises the position of montage shape initial point now in the expression picture mosaic grid.Second, for each for arbitrary between 1 and n between integer i, if make the picture mosaic grid move a side-play amount i* (dx, dy)/ position that n then can intersect with the montage shape (a+a ', b+b '), picture mosaic (xx+a ', yy+b ') is positioned over position ((a+a ') mould A, (b+b ') mould B) locate.The 3rd, if desired, rotate described picture mosaic grid, (dx dy) will can not run counter to till the common factor condition until described picture mosaic grid being moved a side-play amount.The 4th, between 1 and n between each i, all described picture mosaic grid is moved a side-play amount (dx, dy)/n and show formed picture.Efficient on host computer system is decided, and may suspend certain time cycle between each picture.The those skilled in the art will know, can put upside down second step and the third step order in this process.In addition, it shall yet further be noted that by supposition n equal 1 and relaxing slightly of obtaining will produce and approach correct presenting (although some midway film may not lack several picture mosaics when translation is both out-of-level also vertical) in second step.The those skilled in the art will know that also said process will provide level and smooth translation along the map image of adjacency.
Figure 16 illustrates one and is used for carrying out the process flow diagram that the map image translation is operated according to an embodiment.In step 1600, client computer receives the order (for example by activating direction control object 815 as shown in Figure 8) of an indication one translation event from the user.In step 1605, in fact client computer makes the montage program of checking move with respect to the basic map picture mosaic.Then, in step 1610, client computer is determined as the result of translation and the position of the new picture mosaic that needs.In case determined described position, client computer just uses this position data to form a picture mosaic request in step 1615.At last, in step 1525, client computer according to shown in Figure 14 and foregoing process obtain any required picture mosaic.
Figure 17 to 21 illustration one is according to 1/3 example process of embodiment translation montage westwards shape width.Figure 17 illustrates the state that upgrades map image and picture mosaic grid before the picture mosaic in second step of described process in front, and Figure 18 then illustrates the state after finishing this step of updating.Figure 19 illustrates the state after carrying out once " to right rotation " operation according to foregoing third step, and Figure 20 then illustrates the state after showing several pictures in the 4th step.At last, Figure 21 illustrates the end-state after the translation process is finished.
The those skilled in the art will know that more big grid generally can allow to use said process that more long translation is provided smoothly.In one embodiment, use an embodiment option of grid that is slightly larger than the twice of montage shape size can realize level and smooth translation up to current map view size.Do not increase the size of picture mosaic grid for carrying out longer translation, but whole translation is divided into a series of littler translation simply, although this method may cause rough presenting slightly.
Above exemplary translation algorithm be in presenting animation in addition first picture between upgrade all essential picture mosaics.This kind method can be introduced a little delay between the user makes moment of moment of request and the actual beginning of map.For addressing this problem, an embodiment can be selected the translation of a n-picture is divided into such as n independent 1-pan.Yet itself may cause rough presenting this kind technology, and this is because may alter a great deal with the quantity of the picture mosaic that requires to upgrade for forming the required workload of each picture.A kind of more complicated embodiment is upgraded the required picture mosaic of picture in the future so that the picture mosaic quantity that needs to upgrade becomes this problem that evenly solves between each picture by predictability ground.
Convergent-divergent
In one embodiment, " convergent-divergent " refer to two views (x, y, z) with (x ', y ', z ') between transition, z ≠ z ' wherein, and wherein for the size of montage rectangle approaches mutually corresponding to the lat/lon value of these two views.Hereinafter explanation focuses in the zoom operations of following meaning around " vertically " of a lat/lon " anchor point ": comprise the same pixel that all occupies in pixel each in these two views of described anchor point in the montage shape.Usually, anchor point in the zoom operations can be the center of montage shape, but its also can be the lat/lon of a position mark (for example mark shown in Fig. 8 845), corresponding to the lat/lon of user-selected pixel or arbitrary other positions in the map image.It should be noted that can be with transition combination that translation is combined with zoom operations in some embodiment.
Generally speaking, with regard to picture mosaic was upgraded, convergent-divergent was the operation higher than translation cost, and this is because must upgrade each picture mosaic of intersecting with the montage shape.For this kind reason and because a level and smooth cartoon type convergent-divergent need carry out image scale operation of a high price, thereby an embodiment only carries out all convergent-divergents by carrying out foregoing initialization step in single picture.
Hereinafter explanation general introduction is a kind of provides the method for level and smooth cartoon type zoom operations according to an embodiment to the user, and this kind method can be used in the main frame technology (for example Flash and Java Applets) of some exemplary.For simplicity's sake, suppose that the bi-directional scaling factor difference between two zoom-level z and the z ' is 2 just, i.e. z '=z+1, and be desirably in n the cartoon picture transition is provided.In the explanation herein, " final picture " refers to by only using initialization step mentioned above to carry out convergent-divergent institute with the picture of generation in single picture.In addition, n the root that makes s (bi-directional scaling factor) equal 2.
On the basis of making these definition and supposition, an a kind of embodiment of convergent-divergent algorithm carries out as follows.At first, the final picture of combination (but not showing).The second, between 1 and n-1 between i:(a) picture mosaic that final picture is required carries out bi-directional scaling by factor s^ (n-i); (b) will be arranged to make anchor point correctly to locate through the picture mosaic of bi-directional scaling; Reach and (c) show formed picture and comprise a time-out when needed.The 3rd, show final picture.
Another is chosen as, if z '=z-1, then could be by hereinafter described to the picture mosaic in the front view but not bi-directional scaling is carried out in the picture mosaic in the final view.At first, as indicated above, the final picture of combination (but not showing).The second, between 1 and n-1 between i:(a) picture mosaic that will work as in the front view carries out bi-directional scaling by factor s^ (i); (b) will be arranged to make anchor point correctly to locate through the picture mosaic of bi-directional scaling; Reach and (c) show final picture and comprise a time-out when needed.
Should note, in second step in two kinds of embodiments mentioned above ((a) part), only must carry out bi-directional scaling to the picture mosaic that after carrying out (b) part of second step, will finally manifest by the montage shape, it shall yet further be noted that and the first step in second embodiment can be postponed to third step.In these two kinds of embodiments, all use the picture mosaic of higher zoom-level to form all midway films, this is because less for covering the required picture mosaic of same geographical area in higher zoom-level.A kind of more complicated alternate embodiment is tried hard to use from the picture mosaic of low zoom-level or by carrying out α from the two the picture mosaic of passing through bi-directional scaling of current picture and final picture and is mixed to form one " phantom " shape effect and form some midway film.In addition, the convergent-divergent transition of crossing over a plurality of zoom-level can be embodied as a series of single-stage transition.
Figure 22 illustrates one and carries out the exemplary flow chart of a zoom operations according to one embodiment of the invention.In step 2200, client computer receives a convergent-divergent behavior event and (for example activates a convergent-divergent control object 820, as shown in FIG. 8).In step 2205, client computer is determined the center of the demonstration behind the convergent-divergent.Then, in step 2210, client computer uses determined center data to form a picture mosaic request with new zoom-level.At last, client computer is reproduced map behind the convergent-divergent according to the front with reference to process shown in Figure 14.
Slide and jump
In the explanation, will consider when only carrying out level and smooth convergent-divergent and translation in the transition between the map view far away excessively apart hereinafter.For example, a current map view can show Berkeley, a street of California, but the user may select a quick position of navigation or request to obtain Manhattan, the view of a street of New York.Two kinds of exemplary methods that are used for this kind situation provided herein, it is called " slip " and reaches " jump ".
According to " slip " method of an embodiment, Client-side scripts make up final view also (utilize an independent picture mosaic grid usually) and make its with respect to old view from the directional smoothing of new view slide on front view.Another is chosen as, according to " jump " method of an embodiment, Client-side scripts at first convergent-divergent, translation then, and finally dwindle back target view again.Client-side scripts zoom to for the requirement of each particular, make described translation enough short (meter according to pixels) the lowest scale level and implement translation with described lowest scale level.One more complex embodiments this kind " shaped as frame " motion (i.e. amplification, translation, dwindle) is transformed into a more level and smooth shaped form motion.The those skilled in the art will know, compare with " slip " method, and described " jump " method needs the much bigger picture mosaic of quantity and more computational resource.
Redefine size
Main basis is decided around the website of map view, and the user can ask map view to change size and/or shape.Decide according to the option that the size that how to make the picture mosaic grid in the embodiment is relevant with the size of montage shape, this request may need to redefine the size of picture mosaic grid again.There is the possible embodiment of many kinds in this kind operation, includes but not limited to following embodiment.Suppose when front view for (z), corresponding pixel belongs to picture mosaic, and (xx, yy z), and should carry out around its initial point redefining of montage shape size for x, y.Then first step is the size/shape that redefines the montage shape.Next, if desired, then the size of picture mosaic grid is moved and increase (for example by increasing delegation in the bottom and/or increasing some row on the right side) most without prejudice to the required minimal size of common factor condition.Next, make that (a b) comprises the position of montage shape initial point now in the expression picture mosaic grid.In next step, the each position of in the picture mosaic grid, intersecting with the montage shape (a+a ', b+b ') on, the placement picture mosaic (xx+a ', yy+b ', z).Next, display frame.At last, if desired, then increase the size (for example by increase some row in bottom increase several rows and/or on the right side) of picture mosaic grid, so that the picture mosaic grid is at least the twice of montage shape size again.Can use the technology identical with forming the translation transition cartoon to form the animation that redefines big or small transition as previously described.In addition, it shall yet further be noted that if in a particular, need, then the final step that increases the picture mosaic grid can be incorporated in the initial step of mobile and increase picture mosaic sizing grid.The those skilled in the art will know that initial point is chosen arbitrarily in above illustrating, and people can't look to this condition to set up usually.Yet the those skilled in the art can easily adjust step mentioned above and take into account the extra complexity of this kind.
Position mark
As previously described, according to an embodiment, can be covered on the map image with position mark (together with other objects such as for example messagewindows) and have shade, this makes and is easier to identify its relative position.In one embodiment, shade drafting can be become to seem that described position mark stands in an inclination 45 degree vertically seemingly, be stretched one to equal 2 subduplicate factor and projection and return on the map on the perpendicular general.This kind shade can make position mark seem to be positioned on the map by three dimensional constitution, and this kind feature helps the user to identify described position mark position pointed, and also help to prevent the mutual interference of a plurality of mark phase with a kind of more accurate way.In addition, can use one to contain the anti-α passage of obscuring mark that covers to the map image and represent position mark by the PNG file.Figure 23 illustrates one and according to one embodiment of the invention one group of position mark is covered exemplary flow chart to the map image.In step 2300, client computer is from the request of user's reception to location-based information.Then, in step 2305, client computer transfers to a location server in the mode that the front had illustrated with described request.In step 2310, location server analysis described request.Next, in step 2315, client computer receives location-based information from location server.Then, in step 2325, client retrieves will cover to or otherwise be placed to mark on the map image and shadow image (retrieval or from the remote location server retrieves) on the spot.In step 2330 and 2335 (if need in a particular, then it can be put upside down), client computer is placed to (for example by it is covered to map image) on the map image respectively with shade and mark.Figure 24 illustrate one according to the present invention various aspects have a plurality of position mark exemplary map display web pages of (be labeled as " A " to " J ", it shows the result of the exemplary request in a pair of " the big sushi shop of New York " in the text field 825) that cover.
As another example of overlay image, Figure 27 illustrate one according to the present invention various aspects are coated with an exemplary map display web page of driving direction route track.Figure 27 comprises that one is used to indicate first text entry field 825 of the required address of setting out, one is used to indicate second text entry field 828 of end address, the one route track 2710 that covers that highlights corresponding to required driving direction, one group of corresponding text type is driven direction 2730, a position mark 845 and the shade 855 thereof of direction terminal point driven in indication, similar position mark and the shade 855 thereof of direction starting point are driven in one indication, reach messagewindow 2720 and the shade 855 thereof of the detail map view 2725 of a specific required manipulation (for example " rolling away from from Moffett Blvd. ") on the described route of a demonstration.Similarly, Figure 28 illustrate one according to the present invention various aspects are coated with the exemplary map display web page of a zone boundary track.
Figure 29 illustrates one according to the exemplary flow chart of one embodiment of the invention at map image one group of messagewindow of covering (for example messagewindow shown in Fig. 8 840 and shade 855 thereof).In step 2900, client computer receives the selection (for example, if the user selects a riding manipulation that produces as the result who drives the direction inquiry) of user's location information.In step 2905, client computer forms corresponding HTML code according to described positional information.For example, can be transformed into HTML by the xml code that uses XSLT (a kind of script commonly used, it can obtain) will comprise described positional information in Internet Explorer or other commercially available web browsers and form HTML code.Then, formed HTML code can be inserted in the form (for example html table shown in Figure 26 A 2605).Then, in step 2910, client computer obtains one group of section of reproducing in advance (for example one first round corner section 2610 shown in Figure 26 A, one second round corner section 2612, one the 3rd round corner section 2614, one the 4th round corner section 2615, and point to section 2622) for each fixed part that will cover the HTML window edge to the map image subsequently.In step 2915, client computer is connected these sections of reproducing in advance to form the non-fixed portions on described messagewindow border.For example, can for example by the connecting line 2620 as shown in Figure 26 A, determine the outer boundary of messagewindow by producing a line between the section of reproducing in advance at each.Then, in step 2920, as described in hereinafter, client computer is determined and is obtained one group of section of reproducing in advance that will cover subsequently to the map image with the fixed part that produces the messagewindow shadow image.In step 2922, also as described in hereinafter, client computer is connected the section that these reproduce in advance with the remainder of filling information window shadow image.
Figure 26 B shows one for the messagewindow shade 2625 (for example key element shown in Fig. 8 and 27 855) that uses with a messagewindow and the example of element thereof.Shadow image 2625 dynamically forms so that its be directly proportional corresponding to the dynamic size of the messagewindow 2600 of formation as indicated above.A kind ofly can see below for the exemplary methods that dynamically forms a shadow image 2625 that Figure 26 B is described to carry out.The height of shadow image 2625 can be set at half of height of messagewindow 2600.As shown in Figure 26 B, the size of html table shade 2625 is specified to half of the height that makes its described shade that can comprise the blurred contour (if existence) that comprises described shade.The vertical curve of the inclination of described messagewindow (for example line 2635) can form with a predetermined angular (for example angle of 45 degree) deflection by making it, with consistent with isometrical drawing.For example, skew line 2635 is set at the angle of 45 degree.Can be by using a montage rectangle only to show that the required part in the inclination hacures that reproduce in advance forms the line of these inclinations in client computer or server.Client computer is also determined one group of shadow image round corner section of reproducing in advance and is pointed to section.In Figure 26 B, for example, can be from server or obtain a messagewindow dash box round corner section 2640 and a messagewindow shade on the spot and point to section 2645.After determining the border of shadow image according to the size of messagewindow 2600, and after obtaining the appropriate section of reproducing in advance of also montage, just can determine and draw all the other connecting lines.
Also can fill to form a shade shape outward appearance to shadow image, for example shown in Figure 26 B.Be further to strengthen shade shape outward appearance, can make in the shadow image the secretlyest and/or the most obvious near the part of messagewindow bottom, when the described part in shadow image is more away from the messagewindow bottom simultaneously filling part is brightened gradually and/or fuzzy.
Again referring to Figure 29, in step 2925, client computer covers shade to map image.At last, in step 2930, client computer covers messagewindow to map image.As in the example from Fig. 8,26A, 26B and 27 as seen, this kind method can form a messagewindow that can seem to be three dimensional form when being shown on the numerical map with its shade on the whole.Optionally, can strengthen three-dimensional appearance in the following way: be arranged to make each messagewindow to arrange from north orientation south a plurality of picture mosaic windows, in order to a kind of depth perception also is provided.Also can have other options, for example each messagewindow be arranged from the east orientation west.When arranging a more than mark at map, also can use this kind method.
Referring to Figure 25, can use a kind of similar techniques is that a position mark 2500 produces the shade 2505 of inclination.
Figure 30 illustrates one and redefines the exemplary flow chart of the size of a map image display window according to one embodiment of the invention.In step 3000, client computer receives one about changing the notice (for example making the result of the action that redefines window size as the user) of map image display window size.Then, in step 3005, client computer is determined the center of map image window.Next, in step 3010, client computer judges whether window size increases.If increase, then in step 3025, client computer is defined as filling new exceptional space and the identity of any new map tile that may need, and in step 3030, client computer is from its local cache or these new picture mosaics of request from a remote server.In step 3035, the picture mosaic that client computer is new with these is positioned in the picture mosaic form array and shows new map image.Perhaps, if client computer determines window size and reduces in step 3010, then in step 3015, client computer reduces the size of montage shape window with being directly proportional.At last, in step 3020, client computer makes montage shape window be centered at the map image center again.
High resolution printed
Print the common resulting output of map image from the traditional map website relatively poor, and this is to present with screen resolution because of map view, and the order of magnitude of screen resolution usually is lower than the resolution order of magnitude of modern printer.Yet the map tile that some main frame technology (comprising employed DHTML in one embodiment) is conducive to use its resolution to be suitable for printing is come the combinatorial map view.Therefore, in one embodiment, for obtaining the more high-quality hard copy of map image, can make the picture mosaic of apparatus print resolution reconfigure map view.Because an embodiment uses HTML IMG element that picture mosaic is positioned in the picture mosaic grid, thereby two images that can use same map tile are respectively applied to show and printing purpose: the size of one of them image (for example screen_tile.gif) is 128 * 128 pixels, and the size of another image (for example print_tile.gif) is 512 * 512 pixels.Figure 31 illustrates according to one embodiment of the invention has different resolution with the one group of exemplary map image picture mosaic for the letter quality of realizing map image.The those skilled in the art will be noted that the 3rd image appearance shown in Figure 31 is a high-resolution form of first image.By this kind observations, in response to the printing request from the user, can make the picture mosaic of apparatus print resolution reconfigure the printout that current map view obtains excellence.
Be used for to carry out that the software of each step of process flow diagram shown in addressing and/or hardware can be implemented on the calculation element 503 herein and/or with server 510,515 and 520 or figure in not other calculation elements of demonstration or the combination in any of server, for example made up by an ISP's server that is connected between calculation element 503 and the network 505.And illustrated each square can also nonessentially by different order execution be carried out by illustrated exact sequence.In addition, incoherent each operation can be carried out concurrently.
The those skilled in the art should come into plain view, and in the illustrated embodiment, the various aspects of each embodiment mentioned above may be implemented in many multi-form softwares, firmware and the hardware in each figure.Actual software code or the special-purpose control hardware of various aspects can't limit the present invention to be used for implementing in accordance with the principles of the present invention.Therefore, to operation and behavior when the describing not mentioned specific software code-should be appreciated that those skilled in the art in affiliated field can according to the explanation of this paper design for software and the control hardware of implementing these aspects of each embodiment aspect some.In addition, some part of each embodiment can be embodied as " logic " that can carry out one or more functions.This kind logic can comprise for example combination of hardware, software or hardware such as application specific integrated circuit or field programmable gate array and software.
Above some example embodiments is illustrated and shows in the accompanying drawings.Yet, should be appreciated that these embodiment only are exemplary indefiniteness embodiment.The present invention should not only limit to the particular configuration and the layout that clearly disclose because the those skilled in the art will association go out various other modification.
Claims (18)
1. method that be used for to show a numerical map, it comprises:
One position requests is sent to a map tile server from a client-side calculation element;
Receive the chart portfolio picture mosaic in response to described position requests;
The described map tile that receives is combined into a picture mosaic grid;
Described picture mosaic grid is alignd with respect to a montage shape;
Show that the result of described alignment is as a map image;
Wherein said picture mosaic grid is rectangle, and when the user changed montage shape big or small, the size of described picture mosaic grid will change.
2. the method for claim 1, it further comprises the input in response to the user, comes the described map image of translation by moving described montage shape with respect to described picture mosaic grid.
3. method as claimed in claim 2, it further comprises and receives one second group of map tile and described second group of map tile inserted in the described picture mosaic grid.
4. the method for claim 1, it further comprises:
Ask in response to a user that will obtain the image of a convergent-divergent, obtain one second group of map tile;
Described second group of map tile is combined into one second picture mosaic grid; And
Make the described second picture mosaic grid with respect to described montage shape alignment and show that the result of described alignment is as the map image of a convergent-divergent.
5. method as claimed in claim 4 wherein makes the described second picture mosaic grid with respect to described montage shape alignment and shows that the result of described alignment further comprises as a map image:
The label information that acquisition is associated with described position requests;
Described label information and described picture mosaic grid is combined; And
Make picture mosaic grid after the combination with respect to described montage shape alignment and the result that shows described alignment as a map image, described map image has the outward appearance of a three-dimensional map.
6. the method for claim 1 shows that wherein the result of described alignment further comprises the control knob covering to described map image as a map image.
7. method that forms a numerical map comprises:
Receive alternative data, described alternative data comprise the information of indicating a desired location;
According to described alternative data receiving position data, described position data is indicated the physical location of described desired location;
Obtain first map tile that is associated with described desired location and first group of map tile near described first map tile;
Make up described first map tile and described first group of map tile so that described desired location is positioned near the center of a montage shape substantially;
Export the map tile after the described combination;
The result who wherein makes up described first map tile and described first group of map tile and obtain is a picture mosaic grid, and described picture mosaic grid is rectangle, and when the user changed montage shape big or small, the size of described picture mosaic grid will change.
8. method as claimed in claim 7, described first map tile of wherein said combination and described first group of map tile so that near the step that described desired location is positioned at the center of a montage shape substantially comprise:
With described montage shape localization in described picture mosaic grid top so that the described center of described montage shape is positioned at the described desired location top of described first map tile substantially.
9. method as claimed in claim 8, it further comprises and obtains the label information that is associated with described desired location.
10. method as claimed in claim 9, wherein said label information comprises a messagewindow.
11. method as claimed in claim 10 wherein dynamically forms size and the shape of described messagewindow according to the quantity of information that is associated with described desired location.
12. method as claimed in claim 11, wherein said label information further comprise a mark shade, wherein size and the shape that dynamically forms described mark shade according to described size and the shape of described messagewindow.
13. method as claimed in claim 10, it further comprises and obtains and show one or more control objects that are positioned at the map tile top after the described combination.
14. an equipment that is used for showing a numerical map, it comprises:
Send member, it is used for a position requests is sent to a map tile server from a client-side calculation element;
Receiving member, it is used for receiving the chart portfolio picture mosaic in response to described position requests;
Combined member, it is used for the described map tile that receives is combined into a picture mosaic grid;
Alignment member, it is used for described picture mosaic grid is alignd with respect to a montage shape;
Display member, it is used for showing that the result of described alignment is as a map image; And
Changing member, is rectangle if it is used for described picture mosaic grid, when the user changes montage shape big or small, changes the size of described picture mosaic grid.
15. equipment as claimed in claim 14, wherein said transmission member comprises for the member that described position requests is transformed into a map tile request.
16. equipment as claimed in claim 15 wherein saidly comprises for the member that described position requests is transformed into a map tile request:
Receiving member, it is used for receiving a latitude value and a longitude that is associated with described position requests; And
The conversion member, it is used for described latitude value and described longitude are transformed into a picture mosaic identification number.
17. equipment as claimed in claim 16, wherein said picture mosaic identification number are that the initial point with one group of picture mosaic that is associated with a numerical map is benchmark.
18. a method that is used for showing a numerical map, it comprises:
One position requests is sent to a map tile server from a client-side calculation element;
Receive the chart portfolio picture mosaic in response to described position requests;
The described map tile that receives is combined into a picture mosaic grid; And
By a montage shape localization is produced a map image in described picture mosaic grid;
Wherein said picture mosaic grid is rectangle, and when the user changed montage shape big or small, the size of described picture mosaic grid will change.
Priority Applications (2)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
CN201310302294.9A CN103398719B (en) | 2004-03-23 | 2005-02-05 | Digital mapping system |
CN201310295921.0A CN103398718B (en) | 2004-03-23 | 2005-02-05 | Digital mapping system |
Applications Claiming Priority (5)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US55550104P | 2004-03-23 | 2004-03-23 | |
US60/555,501 | 2004-03-23 | ||
US56794604P | 2004-05-03 | 2004-05-03 | |
US60/567,946 | 2004-05-03 | ||
PCT/US2005/003832 WO2005104039A2 (en) | 2004-03-23 | 2005-02-05 | A digital mapping system |
Related Child Applications (2)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
CN201310295921.0A Division CN103398718B (en) | 2004-03-23 | 2005-02-05 | Digital mapping system |
CN201310302294.9A Division CN103398719B (en) | 2004-03-23 | 2005-02-05 | Digital mapping system |
Publications (2)
Publication Number | Publication Date |
---|---|
CN101014831A CN101014831A (en) | 2007-08-08 |
CN101014831B true CN101014831B (en) | 2013-08-21 |
Family
ID=38701532
Family Applications (2)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
CN2005800139121A Active CN101014831B (en) | 2004-03-23 | 2005-02-05 | A digital mapping system |
CN2005800135120A Active CN101156158B (en) | 2004-03-23 | 2005-03-23 | Generating and serving tiles in a digital mapping system |
Family Applications After (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
CN2005800135120A Active CN101156158B (en) | 2004-03-23 | 2005-03-23 | Generating and serving tiles in a digital mapping system |
Country Status (2)
Country | Link |
---|---|
CN (2) | CN101014831B (en) |
CA (3) | CA3021979C (en) |
Cited By (1)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
WO2018085632A1 (en) * | 2016-11-04 | 2018-05-11 | Intergraph Corporation | Feature management for web map tile services |
Families Citing this family (24)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US20100131586A1 (en) * | 2008-11-25 | 2010-05-27 | Jeyhan Karaoguz | Activity overlaid mapping services |
US8554871B2 (en) * | 2009-01-30 | 2013-10-08 | Navteq B.V. | Method and system for exchanging location content data in different data formats |
JP4905483B2 (en) * | 2009-03-05 | 2012-03-28 | 株式会社デンソー | Map data update device and map data update program |
CN102054388B (en) * | 2009-11-03 | 2013-01-23 | 厦门雅迅网络股份有限公司 | Method for receiving and displaying map |
WO2011072882A1 (en) * | 2009-12-14 | 2011-06-23 | Tomtom Polska Sp.Z.O.O. | Method and apparatus for evaluating an attribute of a point of interest |
US8768067B2 (en) * | 2010-04-15 | 2014-07-01 | Microsoft Corporation | Accelerating bitmap remoting by identifying and extracting patterns from source bitmaps through parallel processing techniques |
JP5812576B2 (en) * | 2010-04-16 | 2015-11-17 | ソニー株式会社 | Information processing apparatus and program thereof |
US8280414B1 (en) * | 2011-09-26 | 2012-10-02 | Google Inc. | Map tile data pre-fetching based on mobile device generated event analysis |
CN102509183A (en) * | 2011-10-19 | 2012-06-20 | 武汉元宝创意科技有限公司 | Method for establishing emotional relationship between donor and recipient by using information technology |
US8803920B2 (en) * | 2011-12-12 | 2014-08-12 | Google Inc. | Pre-fetching map tile data along a route |
KR20130080163A (en) | 2012-01-04 | 2013-07-12 | 삼성전자주식회사 | Method for displaying digital map in client and apparatus thereof |
US9230556B2 (en) | 2012-06-05 | 2016-01-05 | Apple Inc. | Voice instructions during navigation |
US9269178B2 (en) * | 2012-06-05 | 2016-02-23 | Apple Inc. | Virtual camera for 3D maps |
US20140046923A1 (en) | 2012-08-10 | 2014-02-13 | Microsoft Corporation | Generating queries based upon data points in a spreadsheet application |
CN104423783B (en) * | 2013-09-02 | 2019-03-29 | 联想(北京)有限公司 | The method and electronic equipment of information transmission |
CN103943026B (en) * | 2014-04-24 | 2016-02-24 | 深圳市赛速科技有限公司 | A kind of impact point automatic placement method based on pixel distance |
CN104236547A (en) * | 2014-10-07 | 2014-12-24 | 谭希妤 | Inertial navigation system based internal building electronic map method and system |
CN107430632B (en) * | 2015-04-13 | 2022-01-04 | 谷歌有限责任公司 | Dynamically controlling a map viewport in accordance with user signals |
US9858697B2 (en) * | 2016-01-07 | 2018-01-02 | Livio, Inc. | Methods and systems for communicating a video image |
CN107450860B (en) * | 2017-08-15 | 2020-05-08 | 湖南安存科技有限公司 | Map file pre-reading method based on distributed storage |
CN107918930A (en) * | 2017-12-28 | 2018-04-17 | 华润电力技术研究院有限公司 | A kind of topographic map generates system |
CN110473146B (en) * | 2019-08-16 | 2022-12-27 | 苏州超擎图形软件科技发展有限公司 | Remote sensing image display method and device, storage medium and computer equipment |
CN113432593B (en) * | 2021-06-25 | 2023-05-23 | 北京华捷艾米科技有限公司 | Centralized synchronous positioning and map construction method, device and system |
CN115394178B (en) * | 2021-09-02 | 2023-11-03 | 中国地质大学（北京） | Manufacturing method of Chinese-blind bilingual labeling tactile map jigsaw teaching aid for special teaching |
Citations (6)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5559707A (en) * | 1994-06-24 | 1996-09-24 | Delorme Publishing Company | Computer aided routing system |
CN1190480A (en) * | 1994-11-04 | 1998-08-12 | 洛克系德·马丁有限公司 | Apparatus and method for constructing mosaic of data |
EP0967556A2 (en) * | 1998-06-26 | 1999-12-29 | Hewlett-Packard Company | Flat image delivery server |
US6252608B1 (en) * | 1995-08-04 | 2001-06-26 | Microsoft Corporation | Method and system for improving shadowing in a graphics rendering system |
US6321158B1 (en) * | 1994-06-24 | 2001-11-20 | Delorme Publishing Company | Integrated routing/mapping information |
CN1356668A (en) * | 2001-12-30 | 2002-07-03 | 上海交通大学 | Rolling ball method for automatically generating digital road map |
Family Cites Families (3)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
IL117053A0 (en) * | 1995-05-01 | 1996-06-18 | Motorola Inc | A display method for data images |
CN1204102A (en) * | 1998-06-04 | 1999-01-06 | 中国地图出版社 | Image processing method for electronic map |
EP1498864A4 (en) * | 2002-04-22 | 2006-12-27 | Dgs Comp | Digital altimetric map drawing method and device |
-
2005
- 2005-02-05 CA CA3021979A patent/CA3021979C/en active Active
- 2005-02-05 CA CA2820299A patent/CA2820299C/en active Active
- 2005-02-05 CN CN2005800139121A patent/CN101014831B/en active Active
- 2005-02-05 CA CA2953656A patent/CA2953656C/en active Active
- 2005-03-23 CN CN2005800135120A patent/CN101156158B/en active Active
Patent Citations (6)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5559707A (en) * | 1994-06-24 | 1996-09-24 | Delorme Publishing Company | Computer aided routing system |
US6321158B1 (en) * | 1994-06-24 | 2001-11-20 | Delorme Publishing Company | Integrated routing/mapping information |
CN1190480A (en) * | 1994-11-04 | 1998-08-12 | 洛克系德·马丁有限公司 | Apparatus and method for constructing mosaic of data |
US6252608B1 (en) * | 1995-08-04 | 2001-06-26 | Microsoft Corporation | Method and system for improving shadowing in a graphics rendering system |
EP0967556A2 (en) * | 1998-06-26 | 1999-12-29 | Hewlett-Packard Company | Flat image delivery server |
CN1356668A (en) * | 2001-12-30 | 2002-07-03 | 上海交通大学 | Rolling ball method for automatically generating digital road map |
Non-Patent Citations (1)
Title |
---|
出处同上. |
Cited By (1)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
WO2018085632A1 (en) * | 2016-11-04 | 2018-05-11 | Intergraph Corporation | Feature management for web map tile services |
Also Published As
Publication number | Publication date |
---|---|
CN101156158A (en) | 2008-04-02 |
CN101014831A (en) | 2007-08-08 |
CA3021979A1 (en) | 2005-11-03 |
CA2953656A1 (en) | 2005-11-03 |
CA3021979C (en) | 2023-09-26 |
CA2820299C (en) | 2017-02-21 |
CA2953656C (en) | 2018-11-27 |
CA2820299A1 (en) | 2005-11-03 |
CN101156158B (en) | 2011-08-31 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
CN101014831B (en) | A digital mapping system | |
US10475157B2 (en) | Digital mapping system | |
US7827507B2 (en) | System to navigate within images spatially referenced to a computed space | |
US20090116764A1 (en) | Method of constructing panoramic electronic map service | |
US20050086612A1 (en) | Graphical user interface for an information display system | |
KR20200051295A (en) | Method and computer program for providing map including real estate sales information | |
KR20030015765A (en) | Method and system for providing panorama-typed images on the internet | |
CA2562203A1 (en) | Internet census geographic information system (gis) and method of applying census data to geographic mapping applications | |
Halim | WebGD: framework for web-based GIS/database applications |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
C06 | Publication | ||
PB01 | Publication | ||
C10 | Entry into substantive examination | ||
SE01 | Entry into force of request for substantive examination | ||
C14 | Grant of patent or utility model | ||
GR01 | Patent grant | ||
CP01 | Change in the name or title of a patent holder | ||
CP01 | Change in the name or title of a patent holder |
Address after: American CaliforniaPatentee after: Google limited liability companyAddress before: American CaliforniaPatentee before: Google Inc. |