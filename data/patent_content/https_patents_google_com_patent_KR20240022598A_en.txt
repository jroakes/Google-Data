KR20240022598A - Inserting text in self-guided speech pretraining - Google Patents
Inserting text in self-guided speech pretraining Download PDFInfo
- Publication number
- KR20240022598A KR20240022598A KR1020247001572A KR20247001572A KR20240022598A KR 20240022598 A KR20240022598 A KR 20240022598A KR 1020247001572 A KR1020247001572 A KR 1020247001572A KR 20247001572 A KR20247001572 A KR 20247001572A KR 20240022598 A KR20240022598 A KR 20240022598A
- Authority
- KR
- South Korea
- Prior art keywords
- speech
- synthetic speech
- training
- audio encoder
- representation
- Prior art date
Links
- 238000012549 training Methods 0.000 claims abstract description 138
- 238000000034 method Methods 0.000 claims abstract description 81
- 238000013518 transcription Methods 0.000 claims abstract description 24
- 230000035897 transcription Effects 0.000 claims abstract description 24
- 230000015654 memory Effects 0.000 claims description 46
- 238000009826 distribution Methods 0.000 claims description 36
- 201000007201 aphasia Diseases 0.000 claims description 21
- 238000012545 processing Methods 0.000 claims description 17
- 239000012634 fragment Substances 0.000 claims description 16
- 230000003190 augmentative effect Effects 0.000 claims description 10
- 238000013528 artificial neural network Methods 0.000 claims description 6
- 230000000306 recurrent effect Effects 0.000 claims description 6
- 230000007246 mechanism Effects 0.000 claims description 5
- 230000002123 temporal effect Effects 0.000 claims description 5
- 238000004891 communication Methods 0.000 claims description 4
- 230000008569 process Effects 0.000 description 37
- 239000013598 vector Substances 0.000 description 16
- 238000003860 storage Methods 0.000 description 12
- 230000006870 function Effects 0.000 description 10
- 238000004590 computer program Methods 0.000 description 8
- 238000010586 diagram Methods 0.000 description 8
- 238000010606 normalization Methods 0.000 description 6
- 238000013434 data augmentation Methods 0.000 description 5
- 230000015572 biosynthetic process Effects 0.000 description 4
- 230000000873 masking effect Effects 0.000 description 4
- 230000003287 optical effect Effects 0.000 description 4
- 238000003786 synthesis reaction Methods 0.000 description 4
- 230000008901 benefit Effects 0.000 description 3
- 230000008859 change Effects 0.000 description 3
- 230000001755 vocal effect Effects 0.000 description 3
- 230000004913 activation Effects 0.000 description 2
- 238000001994 activation Methods 0.000 description 2
- 238000013527 convolutional neural network Methods 0.000 description 2
- 238000013135 deep learning Methods 0.000 description 2
- 230000003993 interaction Effects 0.000 description 2
- 230000006855 networking Effects 0.000 description 2
- 230000001537 neural effect Effects 0.000 description 2
- 239000004065 semiconductor Substances 0.000 description 2
- 230000003068 static effect Effects 0.000 description 2
- 239000002131 composite material Substances 0.000 description 1
- 238000010276 construction Methods 0.000 description 1
- 238000011161 development Methods 0.000 description 1
- 230000018109 developmental process Effects 0.000 description 1
- 238000005516 engineering process Methods 0.000 description 1
- 230000002452 interceptive effect Effects 0.000 description 1
- 239000004973 liquid crystal related substance Substances 0.000 description 1
- 238000010801 machine learning Methods 0.000 description 1
- 238000012423 maintenance Methods 0.000 description 1
- 238000004519 manufacturing process Methods 0.000 description 1
- 238000013507 mapping Methods 0.000 description 1
- 238000012986 modification Methods 0.000 description 1
- 230000004048 modification Effects 0.000 description 1
- 230000009467 reduction Effects 0.000 description 1
- 230000004044 response Effects 0.000 description 1
- 230000002441 reversible effect Effects 0.000 description 1
- 238000005070 sampling Methods 0.000 description 1
- 230000001953 sensory effect Effects 0.000 description 1
- 230000006403 short-term memory Effects 0.000 description 1
- 239000007787 solid Substances 0.000 description 1
- 238000007619 statistical method Methods 0.000 description 1
- 230000002194 synthesizing effect Effects 0.000 description 1
- 230000000007 visual effect Effects 0.000 description 1
Classifications
-
- G—PHYSICS
- G10—MUSICAL INSTRUMENTS; ACOUSTICS
- G10L—SPEECH ANALYSIS OR SYNTHESIS; SPEECH RECOGNITION; SPEECH OR VOICE PROCESSING; SPEECH OR AUDIO CODING OR DECODING
- G10L13/00—Speech synthesis; Text to speech systems
- G10L13/02—Methods for producing synthetic speech; Speech synthesisers
- G10L13/04—Details of speech synthesis systems, e.g. synthesiser structure or memory management
- G10L13/047—Architecture of speech synthesisers
-
- G—PHYSICS
- G10—MUSICAL INSTRUMENTS; ACOUSTICS
- G10L—SPEECH ANALYSIS OR SYNTHESIS; SPEECH RECOGNITION; SPEECH OR VOICE PROCESSING; SPEECH OR AUDIO CODING OR DECODING
- G10L13/00—Speech synthesis; Text to speech systems
- G10L13/08—Text analysis or generation of parameters for speech synthesis out of text, e.g. grapheme to phoneme translation, prosody generation or stress or intonation determination
-
- G—PHYSICS
- G10—MUSICAL INSTRUMENTS; ACOUSTICS
- G10L—SPEECH ANALYSIS OR SYNTHESIS; SPEECH RECOGNITION; SPEECH OR VOICE PROCESSING; SPEECH OR AUDIO CODING OR DECODING
- G10L15/00—Speech recognition
- G10L15/06—Creation of reference templates; Training of speech recognition systems, e.g. adaptation to the characteristics of the speaker's voice
- G10L15/063—Training
-
- G—PHYSICS
- G10—MUSICAL INSTRUMENTS; ACOUSTICS
- G10L—SPEECH ANALYSIS OR SYNTHESIS; SPEECH RECOGNITION; SPEECH OR VOICE PROCESSING; SPEECH OR AUDIO CODING OR DECODING
- G10L15/00—Speech recognition
- G10L15/08—Speech classification or search
- G10L15/16—Speech classification or search using artificial neural networks
Abstract
방법(500)은 비음성 텍스트 발화(320) 및 전사되지 않은 비합성 스피치 발화(306)를 포함하는 트레이닝 데이터를 수신하는 동작을 포함한다. 각각의 비음성 텍스트 발화는 비합성 스피치의 임의의 대응하는 음성 발화와 페어링되지 않는다. 각각의 전사되지 않은 비합성 스피치 발화는 대응하는 전사와 페어링되지 않는다. 방법은 또한 텍스트-투-스피치 모델(330)을 사용하여 수신된 트레이닝 데이터의 각각의 비음성 텍스트 발화에 대해 대응하는 합성 스피치 표현(332)을 생성하는 동작을 포함한다. 또한 방법은 오디오 인코더(210)가 공유된 스피치 및 텍스트 표현을 공동으로 학습하도록 가르치기 위해 오디오 인코더를 비음성 텍스트 발화에 대해 생성된 합성 스피치 표현 및 전사되지 않은 비합성 스피치 발화에 대해 사전 트레이닝하는 동작을 포함한다Method 500 includes receiving training data including non-speech text utterances 320 and non-transcribed non-synthetic speech utterances 306. Each non-spoken text utterance is not paired with any corresponding spoken utterance in the non-synthesized speech. Each non-transcribed, non-synthetic speech utterance is not paired with a corresponding transcription. The method also includes generating a corresponding synthetic speech representation (332) for each non-speech text utterance in the received training data using the text-to-speech model (330). The method also includes pretraining the audio encoder 210 on generated synthetic speech representations for non-speech text utterances and on non-transcribed non-synthetic speech utterances to teach the audio encoder 210 to jointly learn the shared speech and text representations. includes
Description
본 개시는 셀프 지도 스피치 사전 트레이닝에 텍스트를 삽입하는 것에 관한 것이다.This disclosure relates to inserting text into self-supervised speech pre-training.
오디오 입력을 받아 그것을 텍스트로 전사하는 ASR(Automatic Speech Recognition)은 모바일 디바이스 및 기타 디바이스에 사용되는 매우 중요한 기술이었다. 일반적으로, 자동 스피치 인식은 오디오 입력(예: 음성 발화)을 취하고 오디오 입력을 텍스트로 전사하여 사람이 말한 것의 정확한 전사를 제공하려고 시도한다. 최신 ASR 모델은 심층 신경망의 지속적인 개발에 기초하여 정확도(예: 낮은 단어 오류율(WER))와 지연(예: 사용자 말하기와 전사 사이의 지연) 모두에서 계속해서 개선되고 있다. 그러나 딥러닝 기반 ASR 모델을 개발하는데 있어 한 가지 문제는 ASR 모델의 파라미터가 트레이닝 데이터에 과적합되는 경향이 있어, 트레이닝 데이터가 충분히 광범위하지 않을 때 ASR 모델이 보이지 않는 데이터를 일반화하는데 어려움을 겪을 수 있다는 것이다. 결과적으로 더 큰 트레이닝 데이터세트에서 ASR 모델을 트레이닝하면 ASR 모델의 정확도가 향상된다. 합성된 스피치 및/또는 데이터 증강 스피치를 통합하여 ASR 모델을 트레이닝하는데 사용되는 트레이닝 데이터의 양을 늘릴 수 있다.ASR (Automatic Speech Recognition), which receives audio input and transcribes it into text, has been a very important technology used in mobile devices and other devices. Typically, automatic speech recognition takes audio input (e.g., a voice utterance) and transcribes the audio input into text, attempting to provide an accurate transcription of what a person has said. Modern ASR models continue to improve in both accuracy (e.g., low word error rate (WER)) and latency (e.g., delay between user speech and transcription) based on ongoing developments in deep neural networks. However, one problem in developing deep learning-based ASR models is that the ASR model's parameters tend to overfit the training data, so when the training data is not extensive enough, the ASR model may have difficulty generalizing to unseen data. There is. As a result, training the ASR model on a larger training dataset improves the accuracy of the ASR model. Incorporating synthesized speech and/or data-augmented speech can increase the amount of training data used to train the ASR model.
본 개시의 일 양태는 데이터 프로세싱 하드웨어에서 실행될 때 상기 데이터 프로세싱 하여금 스트리밍 및 텍스트의 공유된 표현을 공동으로 학습하기 위해 오디오 인코더를 사전 트레이닝하는 동작을 수행하게 하는 컴퓨터로 구현되는 방법을 제공한다. 동작들은 비음성 텍스트 발화 및 전사되지 않은 비합성 스피치 발화를 포함하는 트레이닝 데이터를 수신하는 동작을 포함한다. 각각의 비음성 텍스트 발화는 비합성 스피치의 임의의 대응하는 음성 발화와 페어링되지 않는다. 각각의 전사되지 않은 비합성 스피치 발화는 대응하는 전사와 페어링되지 않는다. 동작들은 또한 텍스트-투-스피치 모델을 사용하여 수신된 트레이닝 데이터의 각각의 비음성 텍스트 발화에 대해 대응하는 합성 스피치 표현을 생성하는 동작을 포함한다. 또한 동작들은 오디오 인코더가 공유된 스피치 및 텍스트 표현을 공동으로 학습하도록 가르치기 위해 오디오 인코더를 비음성 텍스트 발화에 대해 생성된 합성 스피치 표현 및 전사되지 않은 비합성 스피치 발화에 대해 사전 트레이닝하는 동작을 포함한다. One aspect of the present disclosure provides a computer-implemented method that, when executed on data processing hardware, causes the data processing to perform the operations of pre-training an audio encoder to jointly learn a shared representation of streaming and text. The operations include receiving training data including non-speech text utterances and non-transcribed non-synthetic speech utterances. Each non-spoken text utterance is not paired with any corresponding spoken utterance in the non-synthesized speech. Each non-transcribed, non-synthetic speech utterance is not paired with a corresponding transcription. The operations also include generating a corresponding synthetic speech representation for each non-speech text utterance of the received training data using a text-to-speech model. The operations also include pre-training the audio encoder on generated synthetic speech representations for non-speech text utterances and on non-transcribed non-synthetic speech utterances to teach the audio encoder to jointly learn the shared speech and text representations. .
본 개시의 구현예는 다음 구성들 중 하나 이상을 포함할 수 있다. 상기 오디오 인코더는 멀티 헤드 셀프 어텐션 메커니즘을 각각 포함하는 셀프 어텐션 레이어의 스택을 포함한다. 일부 예에서, 오디오 인코더를 사전 트레이닝하는 동작은 각각의 전사되지 않은 비합성 스피치 발화에 대해, 전사되지 않은 스피치 표현의 대응하는 인코딩된 표현을 생성하는 동작; 및 전사되지 않은 비합성 스피치 발화의 대응하는 인코딩된 표현에 적용된 대조 손실에 대해 오디오 인코더를 사전 트레이닝하는 동작; 및 각각의 합성 스피치 표현에 대해, 합성 스피치 표현의 대응하는 인코딩된 표현을 생성하는 동작; 및 상기 합성 스피치 표현의 대응하는 인코딩된 표현에 적용된 대조 손실에 대해 오디오 인코더를 사전 트레이닝하는 동작을 포함한다. Implementations of the present disclosure may include one or more of the following configurations. The audio encoder includes a stack of self-attention layers, each including a multi-head self-attention mechanism. In some examples, pre-training an audio encoder includes, for each non-transcribed, non-synthetic speech utterance, generating a corresponding encoded representation of the non-transcribed speech expression; and pre-training an audio encoder on a contrast loss applied to a corresponding encoded representation of the non-transcribed non-synthetic speech utterance; and for each synthetic speech representation, generating a corresponding encoded representation of the synthetic speech representation; and pre-training an audio encoder on a contrast loss applied to a corresponding encoded representation of the synthesized speech representation.
일부 구현예에서, 오디오 인코더를 사전 트레이닝하는 동작은 각각의 합성 스피치 표현에 대한 복수의 시간 단계들 각각에서: 보조 디코더를 사용하여 상기 대응하는 합성 스피치 표현에 대한 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포를 결정하는 동작; 상기 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포 및 상기 대응하는 합성 스피치 표현에 대응하는 비음성 텍스트 발화에 기초하여 합성 스피치 손실 항을 결정하는 동작; 및 상기 합성 스피치 손실 항에 기초하여 상기 오디오 인코더를 사전 트레이닝하는 동작을 포함한다. 여기서, 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포는 가능한 음소 라벨 또는 가능한 단어 조각 라벨 중 하나를 포함할 수 있다. In some implementations, the act of pre-training an audio encoder includes, at each of a plurality of time steps for each synthetic speech representation: generating a first possible synthetic speech recognition hypothesis for the corresponding synthetic speech representation using an auxiliary decoder; An operation that determines a probability distribution; determining a synthetic speech loss term based on a first probability distribution for the possible synthetic speech recognition hypotheses and a non-speech text utterance corresponding to the corresponding synthetic speech representation; and pre-training the audio encoder based on the synthesized speech loss term. Here, the first probability distribution for possible synthetic speech recognition hypotheses may include either possible phoneme labels or possible word fragment labels.
일부 구현예에서, 오디오 인코더를 사전 트레이닝하는 동작은 각각의 합성 스피치 표현에 대한 복수의 시간 단계들 각각에서: 다른 보조 디코더를 사용하여 가능한 음소 라벨 또는 가능한 단어 조각 라벨 중 다른 하나를 포함하는 대응하는 합성 스피치 표현에 대한 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포를 생성하는 동작; 상기 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포 및 상기 대응하는 합성 스피치 표현에 대응하는 비음성 텍스트 발화에 기초하여 다른 합성 스피치 손실 항을 결정하는 동작; 및 상기 다른 합성 스피치 손실 항에 기초하여 상기 오디오 인코더를 사전 트레이닝하는 동작을 포함한다. 상기 보조 디코더 및 상기 다른 보조 디코더는 CTC(Connection Temporal Classification) 디코더, LAS(Listen Attend Spell) 디코더 또는 순환 신경망 트랜스듀서(RNN-T) 디코더 중 하나를 각각 포함할 수 있다. In some implementations, the act of pre-training an audio encoder includes: at each of a plurality of time steps for each synthetic speech representation: generating a second probability distribution over possible synthetic speech recognition hypotheses for the synthetic speech representation; determining another synthetic speech loss term based on a second probability distribution for the possible synthetic speech recognition hypotheses and a non-speech text utterance corresponding to the corresponding synthetic speech representation; and pre-training the audio encoder based on the different synthetic speech loss terms. The auxiliary decoder and the other auxiliary decoder may each include one of a Connection Temporal Classification (CTC) decoder, a Listen Attend Spell (LAS) decoder, or a Recurrent Neural Network Transducer (RNN-T) decoder.
일부 예시에서, 상기 동작들은 상기 합성 스피치 표현에 대해 오디오 인코더를 사전 트레이닝하기 전에, 하나 이상의 합성 스피치 표현을 증강시키는 동작을 더 포함한다. 상기 합성 스피치 표현에 대해 오디오 인코더를 사전 트레이닝하는 동작은 상기 증강된 하나 이상의 합성 스피치 표현에 대해 오디오 인코더를 사전 트레이닝하는 동작을 포함할 수 있다. 비음성 텍스트 발화는 하나 이상의 언어 모델을 사용하여 생성 및/또는 선택될 수 있다.In some examples, the operations further include augmenting one or more synthetic speech representations prior to pre-training an audio encoder on the synthetic speech representation. Pre-training an audio encoder on the synthetic speech representation may include pre-training an audio encoder on the one or more augmented synthetic speech representations. Non-speech text utterances may be generated and/or selected using one or more language models.
일부 구현예에서, 상기 비음성 텍스트 발화는 배경 언어 모델 및 타겟 도메인과 연관된 전사된 스피치 발화들에 대해 트레이닝된 도메인 내 언어 모델을 사용하여 생성된다. 추가적으로 또는 대안적으로, 동작들은 오디오 인코더를 사전 트레이닝한 후에, 전사된 스피치 발화에 대해 사전 트레이닝된 오디오 인코더를 파인 튜닝하는 동작을 더 포함할 수 있다. In some implementations, the non-speech text utterance is generated using a background language model and an in-domain language model trained on transcribed speech utterances associated with the target domain. Additionally or alternatively, the operations may further include pre-training the audio encoder and then fine tuning the pre-trained audio encoder to the transcribed speech utterance.
본 개시의 다른 양태는 시스템을 제공하며, 상기 시스템은 데이터 프로세싱 하드웨어 및 메모리 하드웨어를 포함하고, 상기 메모리 하드웨어는 명령어들을 저장하며, 상기 명령어들은 데이터 프로세싱 하드웨어에서 실행될 때, 상기 데이터 프로세싱 하드웨어로 하여금 동작들은 수행하게 한다. 동작들은 비음성 텍스트 발화 및 전사되지 않은 비합성 스피치 발화를 포함하는 트레이닝 데이터를 수신하는 동작을 포함한다. 각각의 비음성 텍스트 발화는 비합성 스피치의 임의의 대응하는 음성 발화와 페어링되지 않는다. 각각의 전사되지 않은 비합성 스피치 발화는 대응하는 전사와 페어링되지 않는다. 동작들은 또한 텍스트-투-스피치 모델을 사용하여 수신된 트레이닝 데이터의 각각의 비음성 텍스트 발화에 대해 대응하는 합성 스피치 표현을 생성하는 동작을 포함한다. 또한 동작들은 오디오 인코더가 공유된 스피치 및 텍스트 표현을 공동으로 학습하도록 가르치기 위해 오디오 인코더를 비음성 텍스트 발화에 대해 생성된 합성 스피치 표현 및 전사되지 않은 비합성 스피치 발화에 대해 사전 트레이닝하는 동작을 포함한다. Another aspect of the disclosure provides a system, the system comprising data processing hardware and memory hardware, the memory hardware storing instructions, the instructions, when executed in the data processing hardware, causing the data processing hardware to perform an operation. Let them perform. The operations include receiving training data including non-speech text utterances and non-transcribed non-synthetic speech utterances. Each non-spoken text utterance is not paired with any corresponding spoken utterance in the non-synthesized speech. Each non-transcribed, non-synthetic speech utterance is not paired with a corresponding transcription. The operations also include generating a corresponding synthetic speech representation for each non-speech text utterance of the received training data using a text-to-speech model. The operations also include pre-training the audio encoder on generated synthetic speech representations for non-speech text utterances and on non-transcribed non-synthetic speech utterances to teach the audio encoder to jointly learn the shared speech and text representations. .
본 개시의 양태는 다음 선택적 구성들 중 하나 이상을 포함할 수 있다. 상기 오디오 인코더는 멀티 헤드 셀프 어텐션 메커니즘을 각각 포함하는 셀프 어텐션 레이어의 스택을 포함한다. 일부 예에서, 오디오 인코더를 사전 트레이닝하는 동작은 각각의 전사되지 않은 비합성 스피치 발화에 대해, 전사되지 않은 스피치 표현의 대응하는 인코딩된 표현을 생성하는 동작; 및 전사되지 않은 비합성 스피치 발화의 대응하는 인코딩된 표현에 적용된 대비 손실에 대해 오디오 인코더를 사전 트레이닝하는 동작; 및 각각의 합성 스피치 표현에 대해, 합성 스피치 표현의 대응하는 인코딩된 표현을 생성하는 동작; 및 상기 합성 스피치 표현의 대응하는 인코딩된 표현에 적용된 대비 손실에 대해 오디오 인코더를 사전 트레이닝하는 동작을 포함한다. Aspects of the present disclosure may include one or more of the following optional configurations. The audio encoder includes a stack of self-attention layers, each including a multi-head self-attention mechanism. In some examples, pre-training an audio encoder includes, for each non-transcribed, non-synthetic speech utterance, generating a corresponding encoded representation of the non-transcribed speech expression; and pre-training the audio encoder on the contrast loss applied to the corresponding encoded representation of the non-transcribed non-synthetic speech utterance; and for each synthetic speech representation, generating a corresponding encoded representation of the synthetic speech representation; and pre-training an audio encoder on a contrast loss applied to a corresponding encoded representation of the synthesized speech representation.
일부 구현예에서, 오디오 인코더를 사전 트레이닝하는 동작은 각각의 합성 스피치 표현에 대한 복수의 시간 단계들 각각에서: 보조 디코더를 사용하여 상기 대응하는 합성 스피치 표현에 대한 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포를 결정하는 동작; 상기 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포 및 상기 대응하는 합성 스피치 표현에 대응하는 비음성 텍스트 발화에 기초하여 합성 스피치 손실 항을 결정하는 동작; 및 상기 합성 스피치 손실 항에 기초하여 상기 오디오 인코더를 사전 트레이닝하는 동작을 포함한다. 여기서, 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포는 가능한 음소 라벨 또는 가능한 단어 조각 라벨 중 하나를 포함할 수 있다. In some implementations, the act of pre-training an audio encoder includes, at each of a plurality of time steps for each synthetic speech representation: generating a first possible synthetic speech recognition hypothesis for the corresponding synthetic speech representation using an auxiliary decoder; An operation that determines a probability distribution; determining a synthetic speech loss term based on a first probability distribution for the possible synthetic speech recognition hypotheses and a non-speech text utterance corresponding to the corresponding synthetic speech representation; and pre-training the audio encoder based on the synthesized speech loss term. Here, the first probability distribution for possible synthetic speech recognition hypotheses may include either possible phoneme labels or possible word fragment labels.
일부 구현예에서, 오디오 인코더를 사전 트레이닝하는 동작은 각각의 합성 스피치 표현에 대한 복수의 시간 단계들 각각에서: 다른 보조 디코더를 사용하여 가능한 음소 라벨 또는 가능한 단어 조각 라벨 중 다른 하나를 포함하는 대응하는 합성 스피치 표현에 대한 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포를 생성하는 동작; 상기 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포 및 상기 대응하는 합성 스피치 표현에 대응하는 비음성 텍스트 발화에 기초하여 다른 합성 스피치 손실 항을 결정하는 동작; 및 상기 다른 합성 스피치 손실 항에 기초하여 상기 오디오 인코더를 사전 트레이닝하는 동작을 포함한다. 상기 보조 디코더 및 상기 다른 보조 디코더는 CTC(Connection Temporal Classification) 디코더, LAS(Listen Attend Spell) 디코더 또는 순환 신경망 트랜스듀서(RNN-T) 디코더 중 하나를 각각 포함할 수 있다. In some implementations, the act of pre-training an audio encoder includes: at each of a plurality of time steps for each synthetic speech representation: generating a second probability distribution over possible synthetic speech recognition hypotheses for the synthetic speech representation; determining another synthetic speech loss term based on a second probability distribution for the possible synthetic speech recognition hypotheses and a non-speech text utterance corresponding to the corresponding synthetic speech representation; and pre-training the audio encoder based on the different synthetic speech loss terms. The auxiliary decoder and the other auxiliary decoder may each include one of a Connection Temporal Classification (CTC) decoder, a Listen Attend Spell (LAS) decoder, or a Recurrent Neural Network Transducer (RNN-T) decoder.
일부 예시에서, 상기 동작들은 상기 합성 스피치 표현에 대해 오디오 인코더를 사전 트레이닝하기 전에, 하나 이상의 합성 스피치 표현을 증강시키는 동작을 더 포함한다. 상기 합성 스피치 표현에 대해 오디오 인코더를 사전 트레이닝하는 동작은 상기 증강된 하나 이상의 합성 스피치 표현에 대해 오디오 인코더를 사전 트레이닝하는 동작을 포함할 수 있다. 비음성 텍스트 발화는 하나 이상의 언어 모델을 사용하여 생성 및/또는 선택될 수 있다.In some examples, the operations further include augmenting one or more synthetic speech representations prior to pre-training an audio encoder on the synthetic speech representation. Pre-training an audio encoder on the synthetic speech representation may include pre-training an audio encoder on the one or more augmented synthetic speech representations. Non-speech text utterances may be generated and/or selected using one or more language models.
일부 구현예에서, 상기 비음성 텍스트 발화는 배경 언어 모델 및 타겟 도메인과 연관된 전사된 스피치 발화들에 대해 트레이닝된 도메인 내 언어 모델을 사용하여 생성된다. 추가적으로 또는 대안적으로, 동작들은 오디오 인코더를 사전 트레이닝한 후에, 전사된 스피치 발화에 대해 사전 트레이닝된 오디오 인코더를 파인 튜닝하는 동작을 더 포함할 수 있다. In some implementations, the non-speech text utterance is generated using a background language model and an in-domain language model trained on transcribed speech utterances associated with the target domain. Additionally or alternatively, the operations may further include pre-training the audio encoder and then fine tuning the pre-trained audio encoder to the transcribed speech utterance.
본 개시의 하나 이상의 구현예의 세부 내용이 첨부 도면과 아래의 설명에서 기술된다. 다른 양태, 구성, 객체 및 이점은 아래의 설명, 도면 및 청구항으로부터 명백해질 것이다.The details of one or more implementations of the present disclosure are set forth in the accompanying drawings and the description below. Other aspects, configurations, objects and advantages will become apparent from the following description, drawings and claims.
도 1은 예시적 스피치 인식 시스템의 개략도이다.
도 2는 RNN-T(Recurrent Neural Network-Transducer) 모델 아키텍처의 개략도이다.
도 3a 및 도 3b는 스피치 인식 모델의 오디오 인코더를 사전 트레이닝하기 위한 예시적 트레이닝 프로세스의 개략도이다.
도 4는 특정 도메인에 관한 비음성 텍스트 발화를 선택하기 위한 예시적 비음성 텍스트 선택 프로세스의 개략도이다.
도 5는 스피치 및 텍스트의 공유 표현을 공동으로 학습하기 위해 오디오 인코더를 사전 트레이닝하는 방법에 대한 동작의 예시적 구성의 흐름도이다.
도 6는 본 명세서에 기술된 시스템 및 방법을 구현하는데 사용될 수 있는 예시적 컴퓨팅 디바이스의 개략도이다.
다양한 도면들에서 기호들은 동일한 엘리먼트를 표시한다.1 is a schematic diagram of an example speech recognition system.
Figure 2 is a schematic diagram of the Recurrent Neural Network-Transducer (RNN-T) model architecture.
3A and 3B are schematic diagrams of an example training process for pre-training an audio encoder of a speech recognition model.
4 is a schematic diagram of an example non-speech text selection process for selecting non-speech text utterances for a specific domain.
5 is a flow diagram of an example configuration of operations for a method to pre-train an audio encoder to jointly learn a shared representation of speech and text.
Figure 6 is a schematic diagram of an example computing device that can be used to implement the systems and methods described herein.
Symbols in the various drawings represent the same element.
자동 스피치 인식은 오디오에서 문자 시퀀스로 매핑되는 시퀀스 대 시퀀스(Seq2Seq) 모델의 도입으로 엄청난 발전을 이루었다. 동시에, TTS(텍스트-투-스피치) 또는 스피치 합성 시스템은 Seq2Seq 모델을 성공적으로 적용하여 사람의 스피치를 사람의 귀로 구별할 수 없는 자연스럽고 사실적으로 들리는 합성 스피치를 얻는다. Automatic speech recognition took a huge leap forward with the introduction of the sequence-to-sequence (Seq2Seq) model, which maps audio to character sequences. At the same time, text-to-speech (TTS) or speech synthesis systems successfully apply the Seq2Seq model to obtain natural and realistic-sounding synthesized speech that is indistinguishable from human speech by the human ear.
딥러닝 기반 ASR 모델을 개발하는데 있어 한 가지 문제는 ASR 모델의 파라미터가 트레이닝 데이터에 과적합되는 경향이 있어, 트레이닝 데이터가 충분히 광범위하지 않을 때 ASR 모델이 보이지 않는 데이터를 일반화하는데 어려움을 겪을 수 있다는 것이다. 따라서 더 큰 트레이닝 데이터세트에서 ASR 모델을 트레이닝하면 ASR 모델의 정확도가 향상된다. 예를 들어, 기계 학습이나 기타 통계 방법을 사용하면 10,000시간 이상의 전사된 스피치를 포함하는 트레이닝 데이터 세트에 대해 ASR 모델을 트레이닝할 수 있다. 그러나 트레이닝 데이터와 연관된 도메인이 추론 중에 ASR 모델이 배포될 도메인과 다른 경우 ASR 모델의 성능이 저하된다. 예를 들어 화상 회의와 연관된 도메인에서 전사된 스피치에 대해 ASR 모델을 트레이닝하는 것은 음성 검색 쿼리와 관련된 스피치를 인식하는데 덜 효과적이며 그 반대의 경우도 마찬가지이다. One problem in developing deep learning-based ASR models is that the parameters of the ASR model tend to overfit the training data, which means that the ASR model may have difficulty generalizing to unseen data when the training data is not extensive enough. will be. Therefore, training the ASR model on a larger training dataset improves the accuracy of the ASR model. For example, using machine learning or other statistical methods, an ASR model can be trained on a training data set containing more than 10,000 hours of transcribed speech. However, if the domain associated with the training data is different from the domain in which the ASR model will be deployed during inference, the performance of the ASR model deteriorates. For example, training an ASR model on transcribed speech from a domain associated with video conferencing is less effective at recognizing speech related to voice search queries, and vice versa.
합성된 스피치는 ASR 모델을 트레이닝하는데 필요한 라벨링된 인간 스피치의 양을 크게 제한하는 동시에 ASR 모델을 여러 도메인으로 이동할 수 있는 유연성을 제공할 가능성이 있다. 일반적으로 합성 스피치의 사용은 인간 스피치와 구별할 수 없는 최첨단 합성 스피치 인스턴스에도 불구하고 인간 스피치와 다르게 ASR 트레이닝에 영향을 미치는 것으로 나타났다. 합성 스피치와 인간 스피치 사이의 이러한 차이는 TTS 시스템이 해결하려고 하는 어려운 일-대-다 매핑 문제로 인해 발생하는 인간 스피치 데이터와 합성 스피치 데이터 불일치로 인해 발생하다. 즉, 사용 가능한 합성 스피치의 총 품질은 매우 높지만 합성 스피치는 인간 스피치보다 변형이 훨씬 적고 음성 불일치도 최소화된다. 결과적으로, 합성된 스피치 데이터에 대해서만 ASR 모델을 트레이닝하는 것은 추론하는 동안 실제 스피치 발화를 일반화하는데 어려움을 갖는다.Synthesized speech has the potential to greatly limit the amount of labeled human speech needed to train ASR models, while also providing the flexibility to port ASR models to multiple domains. In general, the use of synthetic speech has been shown to affect ASR training differently than human speech, despite instances of state-of-the-art synthetic speech being indistinguishable from human speech. These differences between synthetic speech and human speech are caused by inconsistencies between human speech data and synthetic speech data resulting from the difficult one-to-many mapping problem that TTS systems are trying to solve. That is, although the overall quality of available synthetic speech is very high, synthetic speech has much less variation than human speech and minimal vocal inconsistencies. As a result, training an ASR model only on synthesized speech data has difficulty generalizing to actual speech utterances during inference.
본 문서의 구현예는 ASR 모델을 트레이닝하기 위한 타겟 도메인 및/또는 타겟 언어에서 대량의 전사된 스피치(예: 비합성 스피치)가 사용가능하지 않거나 덜 널리 퍼져있는 경우 ASR 모델의 정확성을 유지하기 위해 스피치를 인식하도록 ASR 모델을 트레이닝하기 위해 합성된 스피치를 사용하는 것에 관한 것이다. 보다 구체적으로, 구현예는 스피치 및 텍스트 표현을 공동으로 학습한 다음 사용 가능한 전사된 비합성 스피치 발화를 사용하여 사전 트레이닝된 ASR 모델을 파인 튜닝(예: 웜 스타트 트레이닝)하기 위해 전사되지 않은 비합성 스피치 발화, 대응하는 합성 스피치 표현을 생성하기 위한 비음성 텍스트 발화 및 전사된 비합성 스피치 발화를 포함하는 트레이닝 데이터에 대해 ASR 모델의 오디오 인코더를 사전 트레이닝하는 것에 관한 것이다. 명백해질듯이, 오디오 인코더의 사전 트레이닝은 트레이닝 데이터에서 도출된 대조적 셀프 지도 손실, 지도 손실 및 일관성 손실의 조합에 기초하여 오디오 인코더의 파라미터를 업데이트하는 것을 포함한다. Implementations herein are intended to maintain the accuracy of the ASR model when large amounts of transcribed speech (e.g., non-synthesized speech) are not available or are less prevalent in the target domain and/or target language for training the ASR model. It is about using synthesized speech to train an ASR model to recognize speech. More specifically, implementations jointly learn speech and text representations and then use available transcribed non-synthetic speech utterances to fine-tune the pre-trained ASR model (e.g., warm-start training). It relates to pre-training the audio encoder of an ASR model on training data containing speech utterances, non-speech text utterances and transcribed non-synthetic speech utterances to generate corresponding synthetic speech representations. As will become clear, pre-training of the audio encoder involves updating the parameters of the audio encoder based on a combination of contrastive self-supervised loss, supervised loss and coherence loss derived from the training data.
대조적 셀프 지도 손실은 언어 학습을 촉진하기 위해 전사되지 않은 비합성 스피치 발화, 합성 스피치 표현 및 전사된 비합성 스피치 발화 중 대응하는 것으로부터 오디오 인코더에 의해 생성된 잠재 스피치 표현으로부터 도출될 수 있다. 반면에, 지도 손실은 합성 스피치 표현 및 전사된 비합성 스피치 발화 중 대응하는 것으로부터 오디오 인코더에 의해 생성된 잠재 스피치 표현에 기초하여 하나 이상의 보조 디코더에 의해 예측된 스피치 인식 라벨로부터 도출될 수 있다. 여기서, 전사된 비합성 스피치 발화와 페어링된 대응하는 전사 및 합성 스피치 표현을 생성하는데 사용되는 대응하는 비음성 텍스트 발화는 지도 손실을 도출하기 위한 실측 라벨 역할을 한다. 마지막으로, 일관성 손실은 비합성(예를 들어, 실제/인간) 및 동일한 발화의 합성 스피치 표현 둘 모두에 대해 오디오 인코더에 의해 일관성 예측(예: 잠재 스피치 표현)을 촉진하기 위해 동일한 발화의 대응하는 합성 스피치 표현 및 각각의 전사된 비합성 스피치 발화로부터 도출될 수 있다. 간단히 말해서, 동일한 발화에 대한 인간(비합성) 표현과 합성(합성된) 표현 간의 일관성 손실은 오디오 인코더가 인간 스피치 및 합성된 스피치의 트레이닝 발화에 대해 일관되게 동작하도록 장려함으로써 비지도 트레이닝 양태를 제공한다. 특히, TTS(텍스트-투-스피치) 모델은 전사된 각각의 비합성 스피치 발화와 페어링된 대응하는 전사를 동일한 발화의 대응하는 합성 스피치 표현으로 변환할 수 있다. Contrastive self-supervised losses can be derived from latent speech representations generated by an audio encoder from their counterparts among non-transcribed non-synthetic speech utterances, synthetic speech representations, and transcribed non-synthetic speech utterances to facilitate language learning. On the other hand, the supervised loss may be derived from a speech recognition label predicted by one or more auxiliary decoders based on a latent speech representation generated by the audio encoder from the synthetic speech representation and the corresponding one of the transcribed non-synthetic speech utterances. Here, the corresponding transcriptions paired with the transcribed non-synthetic speech utterances and the corresponding non-speech text utterances used to generate the synthetic speech representation serve as ground truth labels for deriving the supervised loss. Finally, coherence loss is used to facilitate consistency predictions (e.g., latent speech representations) by audio encoders for both non-synthetic (e.g., real/human) and synthetic speech representations of the same utterance. It can be derived from the synthetic speech representation and each transcribed non-synthetic speech utterance. Simply put, the loss of consistency between human (non-synthetic) and synthetic (synthesized) representations of the same utterance provides an unsupervised training aspect by encouraging the audio encoder to behave consistently for training utterances in human speech and synthesized speech. do. In particular, a text-to-speech (TTS) model can convert each transcribed non-synthetic speech utterance and the paired corresponding transcription into a corresponding synthetic speech representation of the same utterance.
추가 구현예는 화자 차이에 대한 견고성을 높이기 위해 합성된 화자 특성을 다양하게 하여 트레이닝 발화의 다양한 구현을 합성하는 것과 같은 데이터 증강 기법을 적용하는 것을 포함한다. 본 명세서에 기술된 기법은 타겟 도메인 및/또는 타겟 언어로 전사된 인간 스피치가 상대적으로 거의 없을 때 특히 유용하다.Additional implementation examples include applying data augmentation techniques, such as synthesizing various implementations of training utterances by varying the synthesized speaker characteristics to increase robustness to speaker differences. The techniques described herein are particularly useful when there is relatively little human speech transcribed in the target domain and/or target language.
도 1은 사용자(104)의 사용자 디바이스(102) 및/또는 사용자 디바이스(102)와 통신하는 원격 컴퓨팅 디바이스(201)(예를 들어, 클라우드 컴퓨팅 환경에서 실행되는 분산 시스템의 하나 이상의 서버)에 상주하는 ASR 모델(200)을 구현하는 자동 스피치 인식(ASR) 시스템(100)을 도시한다. 사용자 디바이스(102)가 모바일 컴퓨팅 디바이스(예: 스마트폰)로 도시되어 있지만, 사용자 디바이스(102)는 제한 없이 태블릿 디바이스, 랩톱/데스크톱 컴퓨터, 웨어러블 디바이스, 디지털 어시스턴트 디바이스, 스마트 스피커/디스플레이, 스마트 기기, 자동차 인포테인먼트 시스템 또는 사물 인터넷(IoT) 디바이스와 같은 임의의 유형의 컴퓨팅 디바이스에 대응할 수 있고, 데이터 프로세싱 하드웨어(111) 및 메모리 하드웨어(113)에 장착된다. 1 resides on user device 102 of user 104 and/or on a remote computing device 201 (e.g., one or more servers in a distributed system running in a cloud computing environment) in communication with user device 102. It shows an automatic speech recognition (ASR) system 100 that implements an ASR model 200 that: Although user device 102 is shown as a mobile computing device (e.g., a smartphone), user device 102 may include, without limitation, a tablet device, a laptop/desktop computer, a wearable device, a digital assistant device, a smart speaker/display, or a smart appliance. , may correspond to any type of computing device, such as an automobile infotainment system or an Internet of Things (IoT) device, and is equipped with data processing hardware 111 and memory hardware 113.
사용자 디바이스(102)는 사용자(104)가 말한 발화(106)을 수신하고(예를 들어, 사용자 디바이스(102)는 음성 발화(106)를 기록하기 위한 하나 이상의 마이크로폰을 포함할 수 있음), 상기 발화(106)를 ASR 시스템(100)에 의해 프로세싱될 수 있는 입력 음향 프레임(110)과 연관된 대응하는 디지털 형식으로 변환하도록 구성된 오디오 서브시스템(108)을 포함한다. 도시된 예에서, 사용자는 각각의 발화(106)를 "What is the weather in New York City?"라는 영어 자연어 문구로 말하고, 오디오 서브시스템(108)은 ASR 시스템(100)에 대한 입력을 위해 발화(106)를 대응하는 음향 프레임들(110)로 변환한다. 그 후, ASR 모델(200)은 발화(106)에 대응하는 음향 프레임(110)을 입력으로 수신하고, 발화(106)의 대응하는 전사(120)(예를 들어, 인식 결과/가설)를 출력으로서 생성/예측한다. 도시된 예에서, 사용자 디바이스(102) 및/또는 원격 컴퓨팅 디바이스(201)는 또한 사용자 디바이스(102)의 사용자(104)에게 발화(106)에 대한 전사(120)의 표현을 제시하도록 구성된 사용자 인터페이스 생성기(107)를 실행한다. 일부 구성에서, ASR 시스템(100)으로부터 출력된 전사(120)는 예를 들어 사용자 명령을 실행하기 위해 사용자 디바이스(102) 또는 원격 컴퓨팅 디바이스(201) 상에서 실행되는 자연어 이해(NLU) 모듈에 의해 프로세싱된다. 추가적으로 또는 대안적으로, 텍스트-투-스피치 시스템(예를 들어, 사용자 디바이스(102) 또는 원격 컴퓨팅 디바이스(201)의 임의의 조합에서 실행)은 상기 전사를 다른 사용자 디바이스에 의한 가청 출력을 위한 합성 스피치로 변환할 수 있다. 예를 들어, 원본 발화(106)는 전사(120)가 원본 발화(106)에서 전달된 메시지를 듣기 위해 친구에게 가청 출력을 위해 합성된 스피치로 변환되는 사용자(104)가 친구에게 보내는 메시지에 대응할 수 있다. User device 102 receives spoken utterances 106 from user 104 (e.g., user device 102 may include one or more microphones for recording vocal utterances 106), and an audio subsystem 108 configured to convert utterances 106 to corresponding digital formats associated with input acoustic frames 110 that can be processed by ASR system 100. In the example shown, the user utters each utterance 106 as the English natural language phrase “What is the weather in New York City?” and the audio subsystem 108 utters the utterance 106 for input to the ASR system 100. Convert 106 into corresponding acoustic frames 110. The ASR model 200 then receives as input the acoustic frame 110 corresponding to the utterance 106 and outputs the corresponding transcription 120 (e.g., recognition result/hypothesis) of the utterance 106. It is generated/predicted as. In the depicted example, user device 102 and/or remote computing device 201 also has a user interface configured to present a representation of the transcription 120 for the utterance 106 to the user 104 of the user device 102 Run generator 107. In some configurations, transcription 120 output from ASR system 100 may be processed by a natural language understanding (NLU) module executing on user device 102 or remote computing device 201, for example, to execute user commands. do. Additionally or alternatively, a text-to-speech system (e.g., running on any combination of user device 102 or remote computing device 201) may synthesize the transcription for audible output by another user device. It can be converted into speech. For example, original utterance 106 may correspond to a message sent by user 104 to a friend, in which transcription 120 is converted into synthesized speech for audible output to the friend to hear the message conveyed in original utterance 106. You can.
도 2를 참조하면, 예시적 프레임 정렬 기반 변환기 모델(200a)은 인터렉티브 애플리케이션과 연관된 지연 제약을 준수하는 RNN-T(Recurrent Neural Network-Transducer) 모델 아키텍처를 포함한다. RNN-T 모델 아키텍처의 사용은 예시적이며, 프레임 정렬 기반 트랜스듀서 모델(200)은 특히 트랜스포머-트랜스듀서 및 컨포머-트랜스듀서 모델 아키텍처와 같은 다른 아키텍처를 포함할 수 있다. RNN-T 모델(200)은 작은 계산 공간을 제공하고 기존의 ASR 아키텍처보다 적은 메모리 요구사항을 활용하여, RNN-T 모델 아키텍처를 사용자 디바이스(102)에서 완전히 스피치 인식을 수행하는데 적합하게 한다(예를 들어, 원격 서버와의 통신이 필요하지 않다). RNN-T 모델(200)은 인코더 네트워크(210), 예측 네트워크(220) 및 조인트 네트워크(230)를 포함한다. 종래의 ASR 시스템의 음향 모델(AM)과 대략 유사 인코더 네트워크(210)는 셀프 어텐션 레이어(예: 컨포머 또는 트랜스포머 레이어)의 스택 또는 적층된 LSTM(Long Short-Term Memory) 레이어(216)의 순환 네트워크를 포함한다. 예를 들어, 인코더는 d-차원 피처 벡터의 시퀀스(예를 들어, 음향 프레임(110)(도 1)) x = (x1, x2, · · · , xT)를 판독하고, 여기서 xt ∈ d이고 각 출력 단계에서 고차 피처 표현을 생성한다. 이 고차 피처 표현은 h_1^enc,...,h_T^enc로 표시될 수 있다.Referring to Figure 2, an example frame alignment based transducer model 200a includes a Recurrent Neural Network-Transducer (RNN-T) model architecture that adheres to delay constraints associated with interactive applications. The use of the RNN-T model architecture is exemplary, and the frame alignment based transducer model 200 may include other architectures, such as transformer-transducer and conformer-transducer model architectures, among others. The RNN-T model 200 provides a small computational footprint and utilizes less memory requirements than traditional ASR architectures, making the RNN-T model architecture well suited to performing speech recognition entirely on the user device 102 (e.g. For example, no communication with a remote server is required). The RNN-T model 200 includes an encoder network 210, a prediction network 220, and a joint network 230. Roughly similar to the acoustic model (AM) of a conventional ASR system, the encoder network 210 consists of a stack of self-attention layers (e.g., conformer or transformer layers) or a cycle of stacked Long Short-Term Memory (LSTM) layers 216. Includes network. For example, the encoder reads a sequence of d-dimensional feature vectors (e.g., acoustic frame 110 (Figure 1)) x = (x1, x2, · · · , xT), where xt ∈ d and At each output stage, a higher-order feature representation is generated. This higher-order feature representation can be denoted as h_1^enc,...,h_T^enc.
유사하게, 예측 네트워크(220)는 또한 언어 모델(LM)과 유사하고, 지금까지 최종 소프트맥스 레이어(240)에 의해 출력된 비-공백 심볼의 시퀀스, y0, .. . , yui - 1를 조밀한 표현 p_(u_i )로 프로세싱하는 LSTM 네트워크이다. 마지막으로, RNN-T 모델 아키텍처에서, 인코더 및 예측/디코더 네트워크(210, 220)에 의해 생성된 표현은 조인트 네트워크(230)에 의해 결합된다. 예측 네트워크(220)는 조밀한 표현을 프로세싱하는 대신 룩업 희소 임베딩을 출력함으로써 레이턴시를 개선하기 위해 임베딩 룩업 테이블로 대체될 수 있다. 그런 다음, 조인트 네트워크는 다음 출력 심볼에 대한 분포인 y_i│x_1,...,x_(t_i ),y_0,...,y_(u_(i-1) ) )를 예측한다. 달리 말하면, 조인트 네트워크(230)는 각각의 출력 단계(예를 들어, 시간 단계)에서 가능한 스피치 인식 가설에 대한 확률 분포를 생성한다. 여기서, "가능한 스피치 인식 가설"은 지정된 자연어에서 기호/문자를 각각 나타내는 출력 레이블의 세트에 대응한다. 예를 들어, 자연어가 영어인 경우, 출력 레이블의 세트는 27개의 기호, 예를 들어 영어 알파벳의 26자 각각에 대한 하나의 레이블과 공백을 지정하는 하나의 레이블을 포함할 수 있다. 따라서, 조인트 네트워크(230)는 미리 결정된 출력 레이블 세트 각각의 발생 가능성을 나타내는 값 세트를 출력할 수 있다. 이 값 세트는 벡터가 될 수 있으며, 출력 레이블 세트에 대한 확률 분포를 나타낼 수 있다. 일부 경우에, 출력 레이블이 자소(예: 개별 문자, 잠재적으로 구두점 및 기타 기호)이지만, 출력 레이블 세트는 그렇게 제한되지 않다. 예를 들어, 출력 레이블 세트는 자소에 추가로 또는 대신에 단어 조각 및/또는 전체 단어를 포함할 수 있다. 조인트 네트워크(230)의 출력 분포는 상이한 출력 레이블들 각각에 대한 사후 확률 값을 포함할 수 있다. 따라서, 상이한 자소 또는 다른 기호를 나타내는 100개의 상이한 출력 레이블이 있는 경우, 조인트 네트워크(230)의 출력 yi는 각 출력 레이블에 대해 하나씩 100개의 상이한 확률 값을 포함할 수 있다. 그 다음, 확률 분포는 전사(120)를 결정하기 위한 빔 검색 프로세스(예를 들어, 소프트맥스 레이어(240)에 의해)에서 후보 정법 엘리먼트(예를 들어, 자소, 단어 조각 및/또는 단어)에 점수를 선택하고 할당하는데 사용될 수 있다.Similarly, the prediction network 220 also resembles a language model (LM), with the sequence of non-blank symbols output by the final softmax layer 240 so far, y0, .. . , yui - 1 is an LSTM network that processes 1 into a dense representation p_(u_i). Finally, in the RNN-T model architecture, the representations generated by the encoder and prediction/decoder networks 210, 220 are combined by a joint network 230. Prediction network 220 can be replaced with an embedding lookup table to improve latency by outputting lookup sparse embeddings instead of processing a dense representation. Then, the joint network predicts the distribution y_i│x_1,...,x_(t_i ),y_0,...,y_(u_(i-1) ) ) for the next output symbol. In other words, joint network 230 generates a probability distribution for possible speech recognition hypotheses at each output step (e.g., time step). Here, a “possible speech recognition hypothesis” corresponds to a set of output labels, each representing a symbol/character in a given natural language. For example, if the natural language is English, the set of output labels may include 27 symbols, for example, one label for each of the 26 letters of the English alphabet and one label specifying a space. Accordingly, the joint network 230 may output a set of values indicating the probability of occurrence of each of the predetermined output label sets. This set of values can be a vector, representing a probability distribution over the set of output labels. In some cases, the output labels are graphemes (e.g. individual letters, and potentially punctuation marks and other symbols), but the set of output labels is not so limited. For example, the output label set may include word fragments and/or entire words in addition to or instead of graphemes. The output distribution of joint network 230 may include posterior probability values for each of the different output labels. Accordingly, if there are 100 different output labels representing different graphemes or other symbols, the output yi of joint network 230 may contain 100 different probability values, one for each output label. The probability distribution is then applied to candidate canonical elements (e.g., graphemes, word fragments, and/or words) in a beam search process (e.g., by softmax layer 240) to determine transcription 120. Can be used to select and assign scores.
소프트맥스 레이어(240)는 대응하는 출력 단계에서 RNN-T모델(200)에 의해 예측된 다음 출력 심볼로서 분포에서 가장 높은 확률을 갖는 출력 레이블/심볼을 선택하기 위해 임의의 기법을 사용할 수 있다. 이와 같이, RNN-T 모델(200)은 조건부 독립 가정을 하지 않고, 각 심볼의 예측은 음향뿐만 아니라 지금까지 출력된 레이블들의 시퀀스에 따라 조절된다. RNN-T 모델(200)은 출력 심볼이 미래의 음향 프레임(110)과 독립적이라고 가정하며, 이는 RNN-T 모델이 스트리밍 방식으로 사용될 수 있게 한다.The softmax layer 240 may use any technique to select the output label/symbol with the highest probability in the distribution as the next output symbol predicted by the RNN-T model 200 in the corresponding output step. In this way, the RNN-T model 200 does not assume conditional independence, and the prediction of each symbol is adjusted according to the sequence of labels output so far as well as the sound. The RNN-T model 200 assumes that the output symbols are independent of future acoustic frames 110, which allows the RNN-T model to be used in a streaming manner.
일부 예에서, RNN-T 모델(200)의 인코더 네트워크(즉, 오디오 인코더)(210)는 컨포머 블록과 같은 셀프-어텐션 레이어/블록의 스택을 포함하다. 여기서, 각 컨포머 블록은 일련의 멀티 헤드 셀프 어텐션, 깊이별 컨볼루션 및 피드포워드 레이어를 포함한다. 예측 네트워크(220)는 2개의 2,048-차원 LSTM 레이어들을 가질 수 있고, 이들 각각은 또한 640-차원 투영 레이어가 뒤따른다. 대안적으로, 예측 네트워크(220)는 트랜스포머 또는 컨포머 블록의 스택, 또는 LSTM 레이어 대신 임베딩 룩업 테이블을 포함할 수 있다. 마지막으로, 조인트 네트워크(230)는 또한 640개의 히든 유닛을 가질 수 있다. 소프트맥스 레이어(240)는 복수의 트레이닝 데이터 세트들에서 모든 고유한 단어 조각 또는 자소를 사용하여 생성되는 통합된 단어 조각 또는 자소 세트로 구성될 수 있다.In some examples, the encoder network (i.e., audio encoder) 210 of RNN-T model 200 includes a stack of self-attention layers/blocks, such as conformer blocks. Here, each conformer block includes a series of multi-head self-attention, depth-specific convolution, and feedforward layers. Prediction network 220 may have two 2,048-dimensional LSTM layers, each of which is also followed by a 640-dimensional projection layer. Alternatively, prediction network 220 may include a stack of transformer or conformer blocks, or an embedding lookup table instead of an LSTM layer. Finally, joint network 230 may also have 640 hidden units. The softmax layer 240 may be composed of an integrated set of word fragments or graphemes generated using all unique word fragments or graphemes from a plurality of training data sets.
도 3a 및 도 3b는 ASR 모델(200)(도 2)의 오디오 인코더(210)를 사전 트레이닝하기 위한 예시적 트레이닝 프로세스(300)를 도시한다. 트레이닝 프로세스(300)는 비음성 텍스트 발화(Xtext)(320)의 세트 및 전사되지 않은 비합성 스피치 발화(Xunsup)(306)의 세트를 포함하는 사용 가능한 트레이닝 데이터를 사용하여 오디오 인코더(210)를 사전 트레이닝할 수 있다. 각각의 비음성 트레이닝 텍스트 발화(320)는 텍스트 전용 데이터(즉, 페어링되지 않은 데이터)를 포함하므로, 각각의 비음성 트레이닝 텍스트 발화(320)는 발화의 임의의 대응하는 음성 오디오 표현(스피치)과 페어링되지 않는다. 각각의 전사되지 않은 비합성 스피치 발화(306)(단순히 "전사되지 않은 스피치 발화(306)"이라고도 함)은 오디오 전용 데이터(즉, 페어링되지 않은 데이터)를 포함하므로 전사되지 않은 스피치 발화(306)는 임의의 대응하는 전사와도 페어링되지 않는다. Figures 3A and 3B illustrate an example training process 300 for pre-training the audio encoder 210 of the ASR model 200 (Figure 2). The training process 300 trains the audio encoder 210 using available training data, including a set of non-speech text utterances (Xtext) 320 and a set of non-transcribed non-synthetic speech utterances (Xunsup) 306. You can train in advance. Because each non-speech training text utterance 320 includes text-only data (i.e., unpaired data), each non-speech training text utterance 320 includes any corresponding spoken audio representation (speech) of the utterance. No pairing. Each non-transcribed, non-synthetic speech utterance 306 (also referred to simply as a “non-transcribed speech utterance 306”) contains audio-only data (i.e., unpaired data) and thus contains untranscribed speech utterance 306. is not paired with any corresponding transcription.
단순화를 위해, 트레이닝 프로세스(300)는 대조적 셀프 지도 손실 부분(300a)을 포함한다(도 3a) 및 지도 손실 부분(300b)(도 3b)를 포함한다. 트레이닝 프로세스(300)는 비음성 텍스트 발화(Xtext)(320)로부터 대조적 셀프 지도 손실 부분(300a)을 사용하여 도출된 대조 손실(Lw2v)(316), 및 전사되지 않은 비합성 스피치 발화(Xunsup)(306); 및 비음성 텍스트 발화(Xtext)(320)로부터 지도 손실 부분(300b)을 사용하여 도출된 지도 손실(Laux)(342)에 기초하여 페어링되지 않은 데이터 손실 함수 unpaired 에 대해 오디오 인코더(210)를 사전 트레이닝한다.For simplicity, the training process 300 includes a contrasting self-supervised loss portion 300a (FIG. 3A) and a supervised loss portion 300b (FIG. 3B). The training process 300 includes a contrastive loss (Lw2v) 316 derived using a contrastive self-supervised loss portion 300a from a non-speech text utterance (Xtext) 320, and a non-transcribed non-synthetic speech utterance (Xunsup). (306); and an unpaired data loss function based on the supervised loss (Laux) 342 derived using the supervised loss portion 300b from the non-speech text utterance (Xtext) 320. Pre-train the audio encoder 210 for unpaired .
도 3a를 참조하면, 트레이닝 프로세스(300)의 대조적 셀프 지도 손실 부분(300a)은 복수의 출력 단계 각각에서 복수의 비음성 트레이닝 텍스트 발화(320) 각각에 대한 합성된 스피치 표현(예를 들어, 합성 스피치(332))을 생성하도록 구성된 TTS(text-to-speech) 시스템(330)을 사용할 수 있다. 비음성 트레이닝 텍스트 발화(320)(간단히 "비음성 텍스트 발화(320)"라고도 함)는 텍스트 전용 데이터인 비음성 텍스트, 즉 페어링되지 않은 데이터를 포함하므로, 각각의 비음성 텍스트 발화(예를 들어, Xtext)(320)는 임의의 합성된 또는 비-합성된 스피치와도 페어링되지 않는다. 따라서, TTS 시스템(330)은 각각의 비음성 텍스트 발화(320)에 대해 대응하는 합성 스피치 표현(332)을 생성한다. 특히, 합성된 스피치 표현(332)은 오디오 인코더(210)를 트레이닝하기 위한 멜-주파수 스펙트로그램 프레임들을 포함할 수 있고, 이에 의해 트레이닝 프로세스(300)가 멜-주파수 스펙트로그램 프레임들을 합성된 스피치로 합성하기 위해 보코더 및/또는 합성기를 포함할 필요성을 제거한다. Referring to FIG. 3A, the contrastive self-supervised loss portion 300a of the training process 300 includes a synthesized speech representation (e.g., synthesis) for each of a plurality of non-speech training text utterances 320 at each of the plurality of output stages. A text-to-speech (TTS) system 330 configured to generate speech 332 may be used. Non-speech training text utterances 320 (also simply referred to as “non-speech text utterances 320”) contain non-speech text, i.e. unpaired data, which is text-only data, so that each non-speech text utterance (e.g. , Xtext) 320 is not paired with any synthesized or non-synthesized speech. Accordingly, the TTS system 330 generates a corresponding synthetic speech representation 332 for each non-speech text utterance 320. In particular, the synthesized speech representation 332 may include mel-frequency spectrogram frames for training the audio encoder 210, whereby the training process 300 converts the mel-frequency spectrogram frames into synthesized speech. Eliminates the need to include a vocoder and/or synthesizer to synthesize.
TTS 시스템(330)은 비음성 텍스트 발화(320)를 변환할 때 화자 임베딩 z를 적용하여 화자 임베딩과 연관된 특정 화법 및 운율을 갖는 합성 스피치 표현(332)을 생성할 수 있다. TTS 시스템(330)은 합성되는 합성 스피치 표현(332)의 결과 발화의 서로 다른 화자 특성과 각각 연관된 다수의 서로 다른 화자 임베딩 z를 적용할 수 있다. 유사하게, TTS 시스템(330)은 합성되는 발화의 운율 및 기타 생성 품질을 변경할 수 있다. The TTS system 330 may apply the speaker embedding z when converting the non-speech text utterance 320 to generate a synthetic speech representation 332 with a specific speech style and prosody associated with the speaker embedding. The TTS system 330 may apply a number of different speaker embeddings z, each associated with a different speaker characteristic of the resulting utterance, in the resulting synthetic speech representation 332. Similarly, TTS system 330 may change the prosody and other production qualities of the utterances being synthesized.
일부 예에서, 트레이닝 프로세스(300)는 합성 스피치 표현(332)의 샘플 발화 중 적어도 하나에 데이터 증강을 적용한다. 데이터 증강은 잡음 추가, 타이밍 조작(예: 스트레칭), 또는 대응 스피치 표현에 잔향 추가를 포함하지만 이에 한정되지는 않는다. 데이터 증강은 합성 스피치 표현(332)에 다양한 합성 녹음 조건을 추가할 수 있다. In some examples, training process 300 applies data augmentation to at least one of the sample utterances of synthetic speech representation 332. Data enhancement includes, but is not limited to, adding noise, manipulating timing (e.g., stretching), or adding reverberation to the corresponding speech representation. Data augmentation may add various synthetic recording conditions to the synthetic speech representation 332.
합성 스피치 표현(332)의 샘플 발화를 생성하기 위한 이러한 사전 트레이닝 배치 생성 프로세스는 트레이닝 동안 비음성 텍스트 발화(320)가 관찰될 때마다 새로운 화자와 운율 조건 값을 이점적으로 샘플링하여 후속 관찰에서 다양한 합성 발화를 생성하게 한다. 따라서 각 배치는 합성 발화와 실제(비합성) 발화를 모두 포함한다. 손실 기여도는 손실 마스크 σ를 사용하여 마스킹될 수 있어서(아래 식 4), 적절한 배치 엘리먼트에 대해 손실이 계산된다.This pre-training batch generation process for generating sample utterances of synthetic speech representations 332 advantageously samples new speaker and prosodic condition values each time a non-speech text utterance 320 is observed during training, resulting in a variety of new speakers in subsequent observations. Produces synthetic speech. Therefore, each batch contains both synthetic and real (non-synthesized) utterances. The loss contribution can be masked using a loss mask σ (equation 4 below), so that the loss is calculated for the appropriate placement element.
일부 예시에서, 오디오 인코더(210)는 멀티 헤드 셀프 어텐션 메커니즘을 각각 포함하는 셀프 어텐션 레이어의 스택을 포함한다. 예를 들어, 셀프-어텐션 레이어의 스택은 컨포머 레이어 또는 트랜스포머 레이어의 스택을 포함할 수 있다. 도시된 예에서, 오디오 인코더(210)는 각각 일련의 멀티 헤드 셀프 어텐션, 깊이별 컨볼루션 및 피드포워드 레이어를 포함하는 컨포머 블록의 스택을 포함하는 컨포머 인코더를 포함한다. 컨포머 인코더(210)는 컨볼루션 서브샘플링 블록(212)을 포함하는 피처 인코더와 선형 레이어(214) 및 컨포머 블록 스택(216)을 포함하는 컨텍스트 네트워크로 자연스럽게 분할될 수 있다. 일부 구현예에서, 컨볼루션 서브샘플링 블록(212)은 스트라이드(2, 2)를 갖는 두 개의 2차원 컨볼루션 레이어를 가지며, 결과적으로 피처 시퀀스 길이가 4배 감소된다. 컨벌루션 서브샘플링 블록(212)은 각각의 합성 스피치 표현(332) 및 각각의 전사되지 않은 비합성 스피치 발화(306)와 연관된 입력 피처/벡터의 시퀀스(예를 들어, 도 1의 음향 프레임(110)과 같은 멜-주파수 스펙트로그램)을 입력으로 수신하고, 복수의 출력 단계 각각에 대해, 합성된 스피치 표현(332) 중 하나 또는 전사되지 않은 비합성 스피치 발화(306) 중 하나 중 각각의 것에 대응하는 인코딩된 피처("인코딩된 표현"이라고도 함)(211)을 출력으로 생성한다. In some examples, audio encoder 210 includes a stack of self-attention layers, each including a multi-head self-attention mechanism. For example, a stack of self-attention layers may include a stack of conformer layers or transformer layers. In the example shown, audio encoder 210 includes a conformer encoder comprising a stack of conformer blocks, each containing a series of multi-head self-attention, depth-specific convolution, and feedforward layers. The conformer encoder 210 can be naturally divided into a feature encoder including a convolutional subsampling block 212 and a context network including a linear layer 214 and a conformer block stack 216. In some implementations, convolutional subsampling block 212 has two two-dimensional convolutional layers with strides (2, 2), resulting in a 4-fold reduction in feature sequence length. The convolutional subsampling block 212 generates a sequence of input features/vectors associated with each synthetic speech representation 332 and each non-transcribed non-synthetic speech utterance 306 (e.g., acoustic frame 110 in FIG. 1 ). receives as input a mel-frequency spectrogram such as Produces encoded features (also referred to as “encoded representations”) 211 as output.
컨벌루션 서브샘플링 블록(212)으로부터 출력된 인코딩된 피처(211)는 인코딩된 피처(211) 중 일부가 무작위로 선택되고 대응하는 마스킹된 인코딩 피처(211m)를 제공하기 위해 모든 마스킹된 시간 단계 사이에 공유되는 트레이닝된 피처 벡터로 대체되는 마스킹 모듈(218)에 공급될 수 있다. 일부 예에서, 마스킹 모듈(218)은 시작 인덱스가 될 모든 시간 단계의 특정 비율 p를 교체 없이 무작위로 샘플링함으로써 무작위로 선택된 인코딩 피처(211)를 마스킹하고, 모든 샘플 인덱스로부터 후속 M개의 연속 시간 단계를 마스킹하여 일부 범위가 겹칠 수 있다. 마스킹이 적용된 후, 선형 레이어(214)와 컨텍스트 네트워크의 컨포머 블록(216)은 마스킹된 인코딩된 피처(211m)를 수신하고 마스킹된 인코딩된 피처(211m)로부터 대응하는 대조적 컨텍스트 벡터(215)를 출력한다. 더욱이, 양자화기(217)는 인코딩된 피처(211)를 입력으로 수신하고, 양자화된 벡터(즉, 목표 컨텍스트 벡터)(219)를 출력으로 생성한다. 이후, 대조 손실 모듈(315)은 마스킹된 포지션의 대조 컨텍스트 벡터(215)와 타겟 컨텍스트 벡터(219) 사이의 대조 손실 (Lw2v)(316)을 다음과 같이 도출한다.The encoded features 211 output from the convolutional subsampling block 212 are such that some of the encoded features 211 are randomly selected and interspaced between all masked time steps to provide the corresponding masked encoded features 211m. This can be fed to the masking module 218 where it is replaced by the shared trained feature vector. In some examples, the masking module 218 masks a randomly selected encoding feature 211 by randomly sampling, without replacement, a certain proportion p of all time steps to be the starting index, and the subsequent M consecutive time steps from all sample indices. By masking, some ranges may overlap. After masking is applied, the linear layer 214 and the conformer block 216 of the context network receive the masked encoded features 211m and generate the corresponding contrasting context vectors 215 from the masked encoded features 211m. Print out. Moreover, quantizer 217 receives encoded features 211 as input and produces a quantized vector (i.e., target context vector) 219 as output. Thereafter, the contrast loss module 315 derives the contrast loss (Lw2v) 316 between the contrast context vector 215 of the masked position and the target context vector 219 as follows.
(1) (One)
여기서 ct는 마스킹된 시간 단계 t에 중심이 있는 대조 컨텍스트 벡터(215)이고, qt는 qt 및 K 디스트랙터(distractor)를 포함하는 K + 1 후보 타겟 컨텍스트 벡터(219) 세트에서 시간 단계 t에서의 타겟 컨텍스트 벡터(219)를 나타낸다. 디스트랙터는 동일한 발화의 다른 마스킹된 시간 단계에서 균일하게 샘플링될 수 있다.where ct is the contrast context vector (215) centered at the masked time step t, and qt is the control context vector (215) at time step t in the set of K + 1 candidate target context vectors (219) containing qt and K distractors. Indicates the target context vector 219. Distractors can be uniformly sampled at different masked time steps of the same utterance.
대조 손실(316)은 마스킹된 포지션의 대조 컨텍스트 벡터(215)와 타겟 컨텍스트 벡터(219) 사이에서 최적화된다. 사전 트레이닝된 오디오 인코더(210)가 전사되지 않은 비합성 스피치 발화(306)에 수렴한 후, 합성된 스피치 표현(332)에 대해 사전 트레이닝 절차가 반복된다. 따라서, 대조 손실(316)은 실제/인간(비합성) 및 합성(TTS 오디오) 피처 모두에 대해 최적화되며, 도 3b를 참조하여 아래에서 더 자세히 설명되는 것처럼 합성 스피치 표현(332)에 대한 추가 보조 손실을 갖는다. 따라서, 트레이닝 프로세스(300)는 각각의 합성된 스피치 표현(332) 및 오디오 인코더(210)에 입력으로서 제공되는 각각의 전사되지 않은 비합성 스피치 발화(306)와 연관된 대응하는 인코딩된 피처(211)에 적용된 도출된 대조 손실(316)에 대해 오디오 인코더(210)를 사전 트레이닝한다. 오디오 인코더(210)를 사전 트레이닝하는 것은 대조 손실에 기초하여 오디오 인코더의 파라미터를 업데이트하는 것을 포함할 수 있다. The contrast loss 316 is optimized between the contrast context vector 215 of the masked position and the target context vector 219. After the pre-trained audio encoder 210 has converged on the non-transcribed non-synthetic speech utterance 306, the pre-training procedure is repeated for the synthesized speech representation 332. Accordingly, contrast loss 316 is optimized for both real/human (non-synthetic) and synthetic (TTS audio) features, with additional assistance for synthetic speech representation 332, as explained in more detail below with reference to Figure 3B. have a loss Accordingly, the training process 300 provides each synthesized speech representation 332 and the corresponding encoded features 211 associated with each non-transcribed non-synthesized speech utterance 306 provided as input to the audio encoder 210. The audio encoder 210 is pre-trained on the derived contrast loss 316 applied to . Pre-training the audio encoder 210 may include updating the parameters of the audio encoder based on the contrast loss.
도 3b를 참조하면, 트레이닝 프로세스(300)의 지도 손실 부분(300b)은 비음성 텍스트 발화(320)에 대해 TTS 시스템(330)에 의해 생성된 합성 스피치 표현(332)으로부터 도출된 지도 손실 항(342)에 기초하여 사전 트레이닝 동안 오디오 인코더(210)에 어휘 정보를 주입하도록 구성된다. 특히, 지도 손실 부분(300b)은 지도 손실 항(342)을 생성하기 위해 하나 이상의 보조 디코더(390)를 활용한다. 보조 디코더(390)는 CTC(Connectionist Temporal Classification) 디코더, LAS(Listen Attend Spell) 디코더 또는 RNN-T 디코더를 포함할 수 있다. 이러한 보조 디코더(390)는 음소들의 시퀀스를 디코딩하도록 구성되는 음소 디코더 또는 단어 조각들의 시퀀스를 디코딩하도록 구성되는 단어조각 디코더 중 적어도 하나를 포함할 수 있다. 보조 디코더(390)는 또한 자소의 시퀀스를 디코딩하도록 구성된 자소 디코더를 포함할 수 있다. 일부 예에서, 트레이닝 프로세스(300)는 주어진 비음성 트레이닝 텍스트 발화(320)에 대해 하나 이상의 어휘적으로 다양한 합성 스피치 표현(332)을 제공하기 위해 합성 스피치 표현(332)의 샘플 발화 중 적어도 하나에 데이터 증강을 적용한다. 데이터 증강은 잡음 추가, 타이밍 조작(예: 스트레칭), 또는 대응 스피치 표현에 잔향 추가를 포함하지만 이에 한정되지는 않는다. 데이터 증강은 합성 스피치 표현(332)에 다양한 합성 녹음 조건을 추가할 수 있다. 3B, the supervised loss portion 300b of the training process 300 includes a supervised loss term ( It is configured to inject vocabulary information into the audio encoder 210 during pre-training based on 342). In particular, the supervised loss portion 300b utilizes one or more auxiliary decoders 390 to generate supervised loss terms 342. The auxiliary decoder 390 may include a Connectionist Temporal Classification (CTC) decoder, a Listen Attend Spell (LAS) decoder, or an RNN-T decoder. This auxiliary decoder 390 may include at least one of a phoneme decoder configured to decode a sequence of phonemes or a word fragment decoder configured to decode a sequence of word fragments. Auxiliary decoder 390 may also include a grapheme decoder configured to decode a sequence of graphemes. In some examples, the training process 300 includes at least one of the sample utterances of the synthetic speech representation 332 to provide one or more lexically diverse synthetic speech representations 332 for a given non-speech training text utterance 320. Apply data augmentation. Data enhancement includes, but is not limited to, adding noise, manipulating timing (e.g., stretching), or adding reverberation to the corresponding speech representation. Data augmentation may add various synthetic recording conditions to the synthetic speech representation 332.
지도 손실 부분(300b) 동안, 오디오 인코더(210)는 피처/벡터의 시퀀스(예를 들어, 도 1의 음향 프레임(110)과 같은 멜-주파수 스펙트로그램)로서 비음성 텍스트 발화(320)로부터 생성된 각각의 합성 스피치 표현(332)을 입력으로서 수신하고, 복수의 시간 단계 각각에 대해, 대응하는 시간 단계에서 합성 스피치 표현(332)에 대응하는 제1 인코딩된 표현(etext)(312)을 출력으로서 생성한다. 음소 디코더 또는 단어조각 디코더를 포함하는 보조 디코더(390)는 오디오 인코더(310)로부터 출력된 각각의 제1 인코딩된 표현(312)을 입력으로 수신하고, 대응하는 시간 단계에서 대응하는 합성 스피치에 표현(332)에 대한 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포(392)를 출력으로서 생성한다. 일부 예시에서, 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포(392)는 가능한 음소 라벨 또는 가능한 단어 조각 라벨 중 하나를 포함한다. 그 후, 지도 손실 모듈(340)은 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포(392) 및 대응하는 비음성 텍스트 발화(320)에 기초하여 합성 스피치 손실 항(342)을 결정할 수 있다. 여기서, 합성 스피치 표현(332)이 생성되는 대응하는 비음성 텍스트 발화(320)는 또한 실측 전사의 역할도 한다. 지도 손실 부분(300b)은 오디오 인코더(210)의 파라미터를 업데이트함으로써 합성 스피치 손실 항(342)에 대해 오디오 인코더(210)를 사전 트레이닝할 수 있다.During the supervised loss portion 300b, the audio encoder 210 generates from the non-speech text utterance 320 as a sequence of features/vectors (e.g., a mel-frequency spectrogram, such as acoustic frame 110 in Figure 1). Receive as input each synthesized speech representation 332 and, for each of a plurality of time steps, output a first encoded representation (etext) 312 corresponding to the synthesized speech representation 332 at the corresponding time step. It is created as. An auxiliary decoder 390, comprising a phoneme decoder or a word fragment decoder, receives as input each first encoded representation 312 output from the audio encoder 310 and represents it in the corresponding synthesized speech at a corresponding time step. A first probability distribution 392 for possible synthetic speech recognition hypotheses for 332 is generated as output. In some examples, the first probability distribution 392 for possible synthetic speech recognition hypotheses includes either possible phoneme labels or possible word fragment labels. Supervised loss module 340 may then determine a synthetic speech loss term 342 based on the first probability distribution 392 for possible synthetic speech recognition hypotheses and the corresponding non-speech text utterance 320. Here, the corresponding non-speech text utterance 320 from which the synthetic speech representation 332 is generated also serves as a ground truth transcription. The supervised loss portion 300b may pre-train the audio encoder 210 on the synthetic speech loss term 342 by updating the parameters of the audio encoder 210.
일부 구현예에서, 트레이닝 프로세스(300)의 지도 손실 부분(300b)은 또 다른 보조 디코더(390)를 사용하여 대응하는 시간 단계에서 합성 스피치 표현(332)에 대한 제1 인코딩 표현(etext)(312)에 기초하여 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포(393)를 생성하며, 이에 따라 지도 손실 모듈(340)은 제2 확률 분포 및 합성 스피치 표현에 대응하는 비음성 텍스트 발화(320)에 기초하여 또 다른 합성 스피치 손실 항(342)을 결정한다. 여기서, 다른 보조 디코더(390)는 음소 디코더 또는 단어조각 디코더 중 다른 하나를 포함하고, 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포(393)는 가능한 음소 라벨 또는 가능한 단어 조각 라벨 중 다른 하나를 포함한다. In some implementations, the supervised loss portion 300b of the training process 300 uses another auxiliary decoder 390 to create a first encoded representation (etext) 312 for the synthetic speech representation 332 at the corresponding time step. ), whereby the supervised loss module 340 generates a second probability distribution 393 for possible synthetic speech recognition hypotheses based on Based on this, another synthetic speech loss term 342 is determined. Here, the other auxiliary decoder 390 includes another of the phoneme decoders or the word fragment decoders, and the second probability distribution 393 for the possible synthetic speech recognition hypotheses includes the other of the possible phoneme labels or the possible word fragment labels. do.
전사되지 않은 비합성 스피치 발화(306) 및 비음성 텍스트 발화(320)는 각각 "페어링되지 않은" 트레이닝 데이터에 대응하므로, 비음성 텍스트 발화(Xtext)(320)로부터 도출된 대조 손실(Lw2v)(316)(도 3a)는 합성 스피치 손실 항(342)과 연관된 지도 손실 Jaux와 결합되어 다음과 같이 비음성 텍스트 손실 함수 Jtext를 얻을 수 있다. Since the non-transcribed non-synthetic speech utterances 306 and non-speech text utterances 320 each correspond to “unpaired” training data, the contrast loss (Lw2v) derived from the non-speech text utterances (Xtext) 320 ( 316) (FIG. 3a) can be combined with the supervised loss Jaux associated with the synthetic speech loss term 342 to obtain the non-speech text loss function Jtext as follows:
마찬가지로, 전사되지 않은 비합성 스피치 발화(Xunsup)(306)로부터 도출된 대조 손실(Lw2v)(316)(FIG. 3a)은 비지도 스피치 손실 함수인 unsup_speech 를 다음과 같이 표현하는데 사용될 수 있다.Similarly, the contrast loss (Lw2v) (316) (FIG. 3a) derived from the non-transcribed unsynthesized speech utterance (Xunsup) (306) is the unsupervised speech loss function, It can be used to express unsup_speech as follows:
오디오 인코더(210)의 사전 트레이닝 동안, 합성 스피치 표현(332)과 전사되지 않은 비합성 스피치 발화(306)는 각 배치 내에서 혼합된다. 오디오 인코더(210)가 합성 및 비합성(인간/실제) 스피치 모두에 효과적인 표현을 학습하도록 강제하기 위해, 페어링되지 않은 데이터 손실 함수인 unpaired 을 획득하기 위해 식 2와 3의 손실 함수 Jtext를 결합할 때 손실 마스크 σ가 적용된다.During pre-training of the audio encoder 210, synthetic speech representations 332 and non-transcribed non-synthetic speech utterances 306 are mixed within each batch. To force the audio encoder 210 to learn an effective representation for both synthetic and non-synthetic (human/real) speech, an unpaired data loss function: A loss mask σ is applied when combining the loss functions Jtext of equations 2 and 3 to obtain unpaired .
마지막으로, 트레이닝 프로세스(300)는 오디오 인코더(210)가 스피치와 텍스트 사이의 공유 표현을 학습하도록 효과적으로 가르치기 위해 오디오 인코더(210)의 파라미터를 업데이트함으로써 페어링되지 않은 데이터 손실 함수인 unpaired 를 사용하여 오디오 인코더(210)를 사전 트레이닝할 수 있다. 오디오 인코더(210)를 사전 트레이닝한 후, 트레이닝 프로세스(300)는 합성(예를 들어, 합성 스피치) 및 비합성(예를 들어, 인간 스피치) 모두의 지도 트레이닝 샘플을 포함할 수 있는 전사된 스피치 발화에 대해 사전 트레이닝된 오디오 인코더를 파인 튜닝할 수 있다.Finally, the training process 300 updates the parameters of the audio encoder 210 to effectively teach the audio encoder 210 to learn the shared representation between speech and text, thereby creating an unpaired data loss function, You can pre-train the audio encoder 210 using unpaired . After pre-training the audio encoder 210, the training process 300 includes transcribed speech, which may include supervised training samples of both synthetic (e.g., synthetic speech) and non-synthetic (e.g., human speech). Audio encoders pre-trained on speech can be fine-tuned.
일부 구현예에서, 오디오 인코더(210)를 사전 트레이닝하기 위한 트레이닝 프로세스(300)는 인코더 일관성 정규화를 적용한다. 가정된 라벨(예를 들어, 비음성 텍스트 발화(320))을 요구하는 일관성 정규화 부분(300c) 동안 보조 디코더(들)에 적용되는 디코더 일관성 정규화와 달리, 인코더 일관성 정규화는 가정된 레이블을 요구하지 않으므로 모든 트레이닝 데이터(306, 320)에 적용될 수 있다는 장점이 있다. 인코더 일관성 정규화는 원래의/비증강 및 증강 스피치의 인코더 활성화 e, e*가 보조 네트워크를 통해 투영되어 z 및 z*를 생성하는 HCCR(계층적 대조 일관성 정규화) 기법을 통해 적용될 수 있다. 그 후, 양수 및 음수 쌍은 구성적이며 대조 손실 lt,z,z*는 다음과 같이 계산된다. In some implementations, the training process 300 for pre-training the audio encoder 210 applies encoder consistency normalization. Unlike the decoder consistency normalization applied to the auxiliary decoder(s) during consistency normalization portion 300c, which requires an assumed label (e.g., non-speech text utterance 320), encoder consistency normalization does not require an assumed label. Therefore, there is an advantage that it can be applied to all training data (306, 320). Encoder consistency normalization can be applied through the Hierarchical Contrast Consistency Normalization (HCCR) technique, where the encoder activations e, e* of the original/non-augmented and augmented speech are projected through an auxiliary network to produce z and z*. Afterwards, the positive and negative pairs are compositional and the contrast loss lt,z,z* is calculated as:
HCCR에 특정한 CNN(Convolutional Neural Network) 프로젝션 네트워크는 인코더 활성화 e(30, 50, 120ms)의 증가하는 길이 세그먼트에 대한 프로젝션을 계산하여 3개 뷰(V)를 생성하고 짧은 세그먼트에 대한 동일한 발화에서 그리고 120ms 세그먼트의 배치의 다른 발화에서 부정적인 예를 도출할 수 있다. 따라서, 전사되지 않은 비합성 스피치 발화(306)(페어링되지 않은 스피치) 및 비음성 텍스트 발화(320)로부터 생성된 합성 스피치 표현(합성 스피치)에 대해 HCCR 손실이 다음과 같이 계산될 수 있다.A convolutional neural network (CNN) projection network specific to HCCR generates three views (V) by computing projections for segments of increasing length of encoder activations e (30, 50, 120 ms) from the same utterance for short segments and Negative examples can be derived from other utterances in the batch of 120 ms segments. Accordingly, the HCCR loss can be calculated for a synthetic speech representation (synthetic speech) generated from a non-transcribed non-synthetic speech utterance 306 (unpaired speech) and a non-speech text utterance 320 as follows:
식 6에 의해 계산된 HCCR 손실은 오디오 인코더(210)를 사전 트레이닝하는데 사용하기 위한 페어링되지 않은 데이터 손실 함수의 일부로서 1e-3의 계수를 갖는 식 4에 추가될 수 있다. The HCCR loss calculated by Equation 6 can be added to Equation 4 with a coefficient of 1e-3 as part of the unpaired data loss function for use in pre-training the audio encoder 210.
도 4를 참조하면, 대조 비음성 텍스트 선택 프로세스(400)는 대규모 비음성 텍스트 코퍼스(402)로부터 오디오 인코더(210)를 사전 트레이닝하는데 사용되는 비음성 텍스트 발화(320)를 선택할 수 있으며, 이로써 선택된 비음성 텍스트 발화(320)는 오디오 인코더(210)가 학습하도록 사전 트레이닝되는 특정 도메인과 가장 유사하다. 즉, 텍스트 선택 프로세스(400)는 오디오 인코더(210)를 사전 트레이닝하는데 사용하기 위해 비음성 텍스트 발화(320)에 포함시키기 위해 비음성 텍스트 코퍼스(402)로부터 도메인 내 및 도메인 근접 비음성 텍스트를 식별할 수 있다. 특히, 텍스트 선택 프로세스(400)에 의해 선택된 비음성 텍스트 발화(320)는 배치 구성 동안 별개의 발화를 즉시 합성할 수 있게 하여 비음성 텍스트 발화(320)가 있을 때마다 샘플링될 수 있는 새로운 화자 임베딩 z 및 잠재 변수 Z가 배치 내에 있도록 한다.4 , collative non-speech text selection process 400 may select non-speech text utterances 320 from a large non-speech text corpus 402 to be used to pre-train an audio encoder 210, thereby selecting Non-speech text utterances 320 are most similar to the specific domain that the audio encoder 210 is pre-trained to learn. That is, the text selection process 400 identifies in-domain and domain-proximal non-speech text from the non-speech text corpus 402 for inclusion in non-speech text utterances 320 for use in pre-training the audio encoder 210. can do. In particular, the non-speech text utterances 320 selected by the text selection process 400 allow for the immediate synthesis of separate utterances during batch construction, creating a new speaker embedding that can be sampled whenever a non-speech text utterance 320 is present. Let z and the latent variable Z be within the batch.
비음성 텍스트(402)의 코퍼스는 넓은 범위의 도메인에 걸친 다수의 비음성 트레이닝 텍스트 발화들(320, 320a)을 포함하고, 오디오 인코더(210)가 학습하도록 트레이닝되는 특정 도메인보다 훨씬 더 큰 언어적 다양성을 포함한다. . 비음성 텍스트(402)의 코퍼스는 오디오 인코더(210)가 학습하도록 트레이닝되는 특정 도메인에 속하도록 음성 전사 비합성 스피치 발화(304)(즉, 트레이닝 발화)(304)와 동일하거나 다른 데이터 저장소(401)에 저장될 수 있다. 각각의 음성 전사 비합성 스피치 발화(304)는 대응하는 전사(302)와 페어링된다. 비음성 텍스트(402)의 코퍼스는 새로운 비음성 텍스트 발화들(302a)을 통합하도록 동적으로 변경될 수 있다. 단순히 비음성 텍스트 코퍼스(402)의 모든 비음성 텍스트 발화(320)를 사용하는 것은 다음과 같은 이유로 실현 가능하지 않다: i) 각 문장에 대해, 스피치 양식은 텍스트보다 인코딩되기 위해 훨씬 더 많은 메모리가 필요하므로 비음성 텍스트 코퍼스(402의 모든 텍스트를 변환하는 것은 실용적이지 않다. ii) 전사된 비합성 스피치 발화(304)와 페어링된 전사(302)와 비음성 텍스트 코퍼스(402)의 비음성 텍스트 발화(320) 사이의 엄청난 양의 차이는 기여도의 균형을 맞추는 지능형 전략을 필요로 한다. The corpus of non-speech text 402 includes a large number of non-speech training text utterances 320, 320a across a wide range of domains, much larger than the specific domain that audio encoder 210 is trained to learn. Includes diversity. . The corpus of non-speech text 402 may be the same as the speech transcription non-synthetic speech utterances 304 (i.e., training utterances) 304 or a different data store 401 to belong to the specific domain that the audio encoder 210 is trained to learn. ) can be stored in . Each voice transcribed non-synthesized speech utterance 304 is paired with a corresponding transcription 302. The corpus of non-speech text 402 may be dynamically changed to incorporate new non-speech text utterances 302a. Simply using every non-speech text utterance 320 in the non-speech text corpus 402 is not feasible for the following reasons: i) For each sentence, the speech form requires much more memory to be encoded than the text; It is not practical to convert all the text in the non-speech text corpus (402), as it would be necessary. ii) the transcribed non-synthetic speech utterances (304) and the paired transcriptions (302) and the non-speech text utterances in the non-speech text corpus (402). The enormous amount of difference between (320) requires intelligent strategies to balance contributions.
텍스트 선택 프로세스(400)는 대조 손실 동안 오디오 인코더(210)를 사전 트레이닝하기 위해 생성된 합성 스피치 표현(332)을 초래하는 TTS 합성을 위한 데이터로서 비음성 텍스트 코퍼스(402)로부터 사용 가능한 비음성 텍스트 발화(320)의 서브세트를 선택하는 것을 목표로 하고 도 3a 및 도 3b를 참조하여 전술한 트레이닝 프로세스(300)의 지도 손실 부분(300a, 300b)이 설명된다. 특히, 텍스트 선택 프로세스(400)는 사용가능한 비음성 텍스트 발화들(320)의 선택된 서브세트와 대상이 되는 특정 도메인 사이의 일치를 개선하는 것을 목표로 하고, 이는 결국 많은 양의 비-도메인-특정 데이터를 이용하는데 필요한 계산 리소스를 감소시킨다. 따라서, 텍스트 선택 프로세스(400)는 오디오 인코더(210)가 학습하도록 트레이닝되고 있는 특정 도메인과 가장 잘 일치하는 비음성 텍스트 발화(302a)를 선택함으로써 계산 및 메모리 비용을 감소시킨다. The text selection process 400 selects available non-speech text from the non-speech text corpus 402 as data for TTS synthesis, resulting in a synthetic speech representation 332 generated to pre-train the audio encoder 210 for contrast loss. The supervised loss portions 300a and 300b of the training process 300 described above are described with the goal of selecting a subset of utterances 320 and with reference to FIGS. 3A and 3B. In particular, the text selection process 400 aims to improve the match between a selected subset of the available non-speech text utterances 320 and the specific domain of interest, which in turn may result in a large amount of non-domain-specific Reduces the computational resources required to use data. Accordingly, the text selection process 400 reduces computational and memory costs by selecting non-speech text utterances 302a that best match the particular domain that the audio encoder 210 is being trained to learn.
일부 예에서, 텍스트 선택 프로세스(400)는 특정 도메인과 연관된 도메인 식별자(도시되지 않음)를 전체 비음성 텍스트 코퍼스(402)에 대해 이전에 트레이닝된 배경 LM(406)에 대한 입력으로 단순히 제공함으로써 특정 도메인에 가장 잘 일치하는 비음성 텍스트 코퍼스(402)로부터 사용 가능한 비음성 텍스트 발화들(302b)의 서브세트를 선택한다. 이전에 언급한 바와 같이, 비음성 텍스트 코퍼스(402)는 다수의 서로 다른 도메인에 걸쳐 있다. 이러한 예에서, 배경 LM(406)은 2014년 2월 12일에 출원된 미국 특허 번호 9,842,592에 설명된 바와 같이 입력으로서 도메인 식별자를 선택적으로 수용할 수 있는 최대 엔트로피(MaxEnt LM)를 포함할 수 있으며, 그 내용은 전체로서 본 명세서에 통합된다. 여기서, 특정 도메인과 연관된 도메인 식별자는 MaxEnt LM이 특정 도메인에 속하는 단어 및/또는 문구를 포함할 가능성이 있는 비음성 텍스트 코퍼스(402)로부터의 사용 가능한 비음성 텍스트 발화들(302b)의 서브세트를 출력하게 할 수 있다. 일부 구성에서, 단어의 가능성을 평가하는 대신, 통계적 언어 모델이 역 모드로 작동하여 특정 도메인에 속하는 단어의 통계적 분포와 일치하는 텍스트 구문을 무작위로 생성한다.In some examples, the text selection process 400 may select a specific domain by simply providing a domain identifier (not shown) associated with that particular domain as input to a background LM 406 previously trained on the entire non-speech text corpus 402. Select a subset of available non-speech text utterances 302b from the non-speech text corpus 402 that best matches the domain. As previously mentioned, the non-speech text corpus 402 spans a number of different domains. In this example, background LM 406 may include a maximum entropy (MaxEnt LM) that can optionally accept a domain identifier as input, as described in U.S. Patent No. 9,842,592, filed February 12, 2014; , the contents of which are incorporated into this specification in its entirety. Here, the domain identifier associated with a particular domain allows MaxEnt LM to identify a subset of available non-speech text utterances 302b from the non-speech text corpus 402 that are likely to contain words and/or phrases belonging to the particular domain. It can be printed. In some configurations, instead of evaluating the likelihood of words, statistical language models operate in reverse mode, randomly generating text phrases that match the statistical distribution of words belonging to a particular domain.
추가적인 예에서, 도 4에 도시된 바와 같이, 텍스트 선택 프로세스(400)는 인간 화자가 말한 전사된 비합성 스피치 발화(304)와 페어링된 전사(302)를 사용하여 특정 도메인과 가장 잘 일치하는 비음성 텍스트 코퍼스(402)로부터 사용 가능한 비음성 텍스트 발화(320)의 서브세트를 선택한다. 여기서, 전사된 비합성 스피치 발화들(304)은 단어, 문구 및/또는 특정 도메인에 속하는 다른 용어를 포함한다. 선택적으로, 전사된 비합성 스피치 발화들(304)과 페어링된 전사들(302)에 추가하여 또는 그 대신에, 특정 도메인에 속하는 상이한 전사된 발화들의 세트가 비음성 트레이닝 텍스트 발화들(302b)을 선택하는데 사용될 수 있다. 이것은 모든 전사된 비합성 스피치 발화들(304)이 특정 도메인에 속할 것을 요구하지 않는 이점을 제공할 것이다. In a further example, as shown in Figure 4, the text selection process 400 uses the transcribed non-synthetic speech utterance 304 spoken by a human speaker and the paired transcription 302 to select a non-synthetic speech utterance that best matches a particular domain. Select a subset of available non-speech text utterances (320) from the spoken text corpus (402). Here, the transcribed non-synthetic speech utterances 304 include words, phrases and/or other terms belonging to a particular domain. Optionally, in addition to or instead of the transcriptions 302 paired with the transcribed non-synthetic speech utterances 304, a different set of transcribed utterances belonging to a particular domain is used to transform the non-speech training text utterances 302b. Can be used to select. This would provide the advantage of not requiring all transcribed non-synthetic speech utterances 304 to belong to a specific domain.
제1 단계(단계 A) 동안, 비음성 텍스트 선택 프로세스(400)는 비음성 텍스트 발화(302a)의 대조적인 선택을 가능하게 하기 위해 2개의 언어 모델(404, 406)을 구축한다. 여기서, 도메인 특정 LM(410)은 전사된 비합성 스피치 발화들(304)의 세트의 각 전사(302)에 대해 트레이닝된다. 전사된 비합성 스피치 발화들(304)의 세트는 오디오 인코더(210)가 학습하도록 트레이닝되고 있는 특정 도메인에 속하는 것으로 가정된다. 한편, 배경 LM(406)은 전체 비음성 텍스트 코퍼스(402)의 각 비음성 트레이닝 텍스트 발화(320)에 대해 트레이닝된다. 이전에 언급한 바와 같이, 비음성 텍스트 코퍼스(402)는 다수의 서로 다른 도메인에 걸쳐 있다. 일부 예에서, 제1 단계는 n-gram 언어 모델 트레이닝을 사용하여 두 가지 언어 모델들(404, 406)을 구축한다. 다른 예에서, 제1 단계는 두 개의 언어 모델(404, 406)을 구축하기 위해 신경망 언어 모델 트레이닝을 사용한다. During the first step (Step A), the non-speech text selection process 400 builds two language models 404 and 406 to enable contrastive selection of non-speech text utterances 302a. Here, a domain-specific LM 410 is trained for each transcription 302 of the set of transcribed non-synthetic speech utterances 304. The set of transcribed non-synthetic speech utterances 304 is assumed to belong to the particular domain that the audio encoder 210 is being trained to learn. Meanwhile, the background LM 406 is trained for each non-speech training text utterance 320 of the entire non-speech text corpus 402. As previously mentioned, the non-speech text corpus 402 spans a number of different domains. In some examples, the first step builds two language models 404 and 406 using n-gram language model training. In another example, the first step uses neural network language model training to build two language models 404 and 406.
제2 상태(단계 B) 동안, 비음성 텍스트 선택 프로세스(400)는 2개의 대조적 LM(404, 406)을 사용하여 도메인 특정 LM(404)에 나타나는 비음성 텍스트 발화(320)의 각 단어와 연관된 제1 확률 P(w│I)을 결정하고, 배경 LM(406)에 나타나는 비음성 텍스트 발화(320)의 각 단어와 관련된 제2 확률 P(w│N)을 결정함으로써 비음성 텍스트 코퍼스(402)의 각 비음성 텍스트 발화(302a)를 평가한다. 그 후, 비음성 텍스트 코퍼스(402)의 각 비음성 텍스트 발화(302a)에 대해, 텍스트 선택 프로세스(400)는 점수화기(408)에서, 제1 확률, 제2 확률 및 대응하는 비음성 텍스트 발화(320)에서 나타나는 단어들의 수 #(w)에 기초하여 점수 S를 결정한다. 예를 들어, 각 비음성 텍스트 발화(302a)에 대한 점수 S는 다음과 같이 계산될 수 있다.During the second state (Phase B), the non-speech text selection process 400 uses the two contrasting LMs 404, 406 to select the Non-speech text corpus 402 by determining a first probability P(w│I) and a second probability P(w│N) associated with each word of the non-speech text utterance 320 appearing in the background LM 406. ) Each non-speech text utterance 302a is evaluated. Then, for each non-speech text utterance 302a in the non-speech text corpus 402, the text selection process 400 determines in scorer 408 a first probability, a second probability, and a corresponding non-speech text utterance. The score S is determined based on the number #(w) of words appearing in (320). For example, the score S for each non-speech text utterance 302a can be calculated as follows.
점수를 결정한 후, 비음성 텍스트 선택 프로세스(400)는 N-최상의 점수 S를 갖는 비음성 텍스트 발화(320)를 선택하는데, 이러한 비음성 텍스트 발화(320)가 특정 도메인과 가장 일치하기 때문이다. 비음성 텍스트 코퍼스(402)는 수십억 개의 비음성 텍스트 발화들(320)을 포함할 수 있다. 텍스트 선택 프로세스(400)에 의해 선택된 비음성 텍스트 발화(320)는 수백만 개의 발화를 포함할 수 있으며, 따라서 인간 화자가 말하는 전사되지 않은 비합성 스피치 발화(306)의 수를 훨씬 초과한다. 위에서 논의된 바와 같이, 비음성 텍스트 발화(320)의 콘텐츠는 오디오 인코더(210)가 학습하도록 트레이닝되는 특정 도메인에 대한 언어 다양성을 증가시키는 반면, 비음성 텍스트 발화(320)으로부터 생성된 대응하는 합성 스피치 표현(332)은 오디오 인코더(210)가 ASR 모델(200) 내에 통합될 때 오디오 인코더(210)가 스피치 인식 프로세스의 일부로서 인코딩하고 있는 스피치에 대한 음향/어휘 다양성을 증가시킨다. After determining the score, the non-speech text selection process 400 selects the non-speech text utterance 320 with the N-best score S because this non-speech text utterance 320 best matches the particular domain. Non-speech text corpus 402 may include billions of non-speech text utterances 320. The non-speech text utterances 320 selected by the text selection process 400 may include millions of utterances, thus far exceeding the number of non-transcribed non-synthetic speech utterances 306 uttered by human speakers. As discussed above, the content of non-speech text utterances 320 increases linguistic diversity for the specific domain that audio encoder 210 is trained to learn, while the corresponding composite generated from non-speech text utterances 320 Speech representation 332 increases acoustic/lexical diversity for the speech that audio encoder 210 is encoding as part of the speech recognition process when audio encoder 210 is integrated within ASR model 200.
도 5는 스피치 및 텍스트의 공유 표현을 공동으로 학습하기 위해 오디오 인코더(210)를 사전 트레이닝하는 방법(500)에 대한 동작의 예시적 구성의 흐름도이다. 방법(500)은 메모리 하드웨어(620)(도 6)에 저장된 명령어를 사용하여 데이터 프로세싱 하드웨어(610)(도 6)에서 실행될 수 있다. 데이터 프로세싱 하드웨어(610) 및 메모리 하드웨어(620)는 컴퓨팅 디바이스(600)(도 6)에 대응하는 도 1의 원격 컴퓨터/서버(201)에 상주할 수 있다. 5 is a flow diagram of an example configuration of operations for a method 500 of pre-training an audio encoder 210 to jointly learn a shared representation of speech and text. Method 500 may be executed in data processing hardware 610 (FIG. 6) using instructions stored in memory hardware 620 (FIG. 6). Data processing hardware 610 and memory hardware 620 may reside on remote computer/server 201 of Figure 1, corresponding to computing device 600 (Figure 6).
동작(502)에서, 방법(500)은 비음성 텍스트 발화(320) 및 전사되지 않은 비합성 스피치 발화(306)를 포함하는 트레이닝 데이터를 수신하는 것을 포함한다. 각각의 비음성 텍스트 발화(320)는 비합성 스피치의 임의의 대응하는 음성 발화와 페어링되지 않는다. 각각의 전사되지 않은 비합성 스피치 발화(306)는 대응하는 전사와 페어링되지 않는다. At operation 502, the method 500 includes receiving training data including a non-speech text utterance 320 and a non-transcribed non-synthetic speech utterance 306. Each non-spoken text utterance 320 is not paired with any corresponding spoken utterance in the non-synthesized speech. Each non-transcribed, non-synthetic speech utterance 306 is not paired with a corresponding transcription.
동작(504)에서, 방법(500)은 또한 텍스트-투-스피치(TTS) 시스템(330)을 사용하여, 수신된 트레이닝 데이터의 각각의 비음성 텍스트 발화(320)에 대해 대응하는 합성 스피치 표현(332)을 생성하는 것을 포함한다. 동작(506)에서, 방법은 오디오 인코더(210)가 공유된 스피치 및 텍스트 표현을 공동으로 학습하도록 가르치기 위해 오디오 인코더(210)를 비음성 텍스트 발화(320)에 대해 생성된 합성 스피치 표현(332) 및 전사되지 않은 비합성 스피치 발화(306)에 대해 사전 트레이닝하는 것을 포함한다. 사전 트레이닝은 각각의 합성 스피치 표현(332) 및 전사되지 않은 비합성 스피치 발화(306)로부터 도출된 대조 손실(315)에 기초하여 오디오 인코더(210)를 사전 트레이닝하는 것을 포함할 수 있다. 사전 트레이닝은 또한 합성 스피치 표현(332)으로부터 도출된 지도 손실(342)(예를 들어, 보조 디코더 손실)에 기초하여 오디오 인코더(210)를 사전 트레이닝하는 것을 포함할 수 있다. In operation 504, the method 500 also uses the text-to-speech (TTS) system 330 to provide a corresponding synthetic speech representation for each non-speech text utterance 320 of the received training data: 332). At operation 506, the method uses the audio encoder 210 to generate a synthetic speech representation 332 for a non-speech text utterance 320 to teach the audio encoder 210 to jointly learn the shared speech and text representation. and pre-training on non-transcribed, non-synthetic speech utterances (306). Pre-training may include pre-training the audio encoder 210 based on the contrast loss 315 derived from each synthetic speech representation 332 and the non-transcribed non-synthetic speech utterance 306. Pre-training may also include pre-training the audio encoder 210 based on a supervised loss 342 (e.g., an auxiliary decoder loss) derived from the synthetic speech representation 332.
소프트웨어 애플리케이션(즉, 소프트웨어 리소스)은 컴퓨팅 디바이스가 작업을 수행하게 하는 컴퓨터 소프트웨어를 지칭할 수 있다. 일부 예에서, 소프트웨어 애플리케이션은 "애플리케이션", "앱" 또는 "프로그램"으로 지칭될 수 있다. 예시적 애플리케이션은 시스템 진단 애플리케이션, 시스템 관리 애플리케이션, 시스템 유지보수 애플리케이션, 워드 프로세싱 애플리케이션, 스프레드시트 애플리케이션, 메시징 애플리케이션, 미디어 스트리밍 애플리케이션, 소셜 네트워킹 애플리케이션 및 게임 애플리케이션을 포함하지만 이에 한정되지는 않는다.A software application (i.e., software resource) may refer to computer software that enables a computing device to perform a task. In some examples, a software application may be referred to as an “application,” “app,” or “program.” Exemplary applications include, but are not limited to, system diagnostic applications, system management applications, system maintenance applications, word processing applications, spreadsheet applications, messaging applications, media streaming applications, social networking applications, and gaming applications.
비일시적 메모리는 컴퓨팅 디바이스에 의해 사용하기 위해 일시적 또는 영구적으로 프로그램(예를 들어, 명령어 시퀀스) 또는 데이터(예를 들어, 프로그램 상태 정보)를 저장하는데 사용되는 물리적 디바이스일 수 있다. 비일시적 메모리는 휘발성 및/또는 비휘발성 주소 지정가능 반도체 메모리일 수 있다. 비휘발성 메모리의 예는 플래시 메모리 및 읽기 전용 메모리(ROM)/프로그래밍 가능한 읽기 전용 메모리(PROM)/지울 수 있는 프로그램 가능한 읽기 전용 메모리(EPROM)/전자적으로 지울 수 있는 프로그래밍 가능한 읽기 전용 메모리(EEPROM)(예: 일반적으로 부팅 프로그램과 같은 펌웨어에 사용됨)를 포함하지만, 이에 한정되지 않는다. 휘발성 메모리의 예는 RAM(Random Access Memory), DRAM(Dynamic Random Access Memory), SRAM(Static Random Access Memory), PCM(Phase Change Memory), 디스크 또는 테이프 등을 포함하지만, 이에 한정되지 않는다.Non-transitory memory may be a physical device used to temporarily or permanently store programs (e.g., instruction sequences) or data (e.g., program state information) for use by a computing device. Non-transitory memory may be volatile and/or non-volatile addressable semiconductor memory. Examples of non-volatile memory are flash memory and read-only memory (ROM)/programmable read-only memory (PROM)/erasable programmable read-only memory (EPROM)/electronically erasable programmable read-only memory (EEPROM). (e.g. typically used in firmware such as boot programs) including, but not limited to: Examples of volatile memory include, but are not limited to, random access memory (RAM), dynamic random access memory (DRAM), static random access memory (SRAM), phase change memory (PCM), disk, or tape.
도 6는 본 문서에 기술된 시스템 및 방법을 구현하는데 사용될 수 있는 예시적 컴퓨팅 디바이스(600)의 개략도이다. 컴퓨팅 디바이스(600)는 랩톱, 데스크톱, 워크 스테이션, 개인 휴대 정보 단말기, 서버, 블레이드 서버, 메인 프레임 및 다른 적절한 컴퓨터와 같은 다양한 형태의 디지털 컴퓨터들을 나타내기 위한 것이다. 여기에 도시된 컴포넌트들, 그들의 연결 및 관계, 및 그들의 기능은 단지 예시적인 것을 의미하며, 본 명세서에 기술된 및/또는 청구된 발명의 구현을 제한하는 것을 의미하지는 않는다.Figure 6 is a schematic diagram of an example computing device 600 that can be used to implement the systems and methods described herein. Computing device 600 is intended to represent various types of digital computers, such as laptops, desktops, work stations, personal digital assistants, servers, blade servers, mainframes, and other suitable computers. The components shown herein, their connections and relationships, and their functions are meant to be illustrative only and are not meant to limit the implementation of the invention described and/or claimed herein.
컴퓨팅 디바이스(600)는 프로세서(610), 메모리(620), 저장 디바이스(630), 메모리(620) 및 고속 확장 포트(650)에 연결되는 고속 인터페이스/제어기(640) 및 저속 버스(670) 및 저장 디바이스(630)에 연결되는 저속 인터페이스/제어기(660)를 포함한다. 컴포넌트들(610, 620, 630, 640, 650 및 660) 각각은 다양한 버스들을 사용하여 상호 연결되고, 공통 마더 보드 상에 또는 적절한 다른 방식으로 장착될 수 있다. 프로세서(610)는 메모리(620) 또는 저장 디바이스(630)에 저장된 명령어들을 포함하는, 컴퓨팅 디바이스(600) 내에서 실행하기 위한 명령어들을 프로세싱하여, 고속 인터페이스(640)에 연결된 디스플레이(680)와 같은 외부 입/출력 디바이스상에 그래픽 사용자 인터페이스(GUI)에 대한 그래픽 정보를 디스플레이할 수 있다. 다른 구현예에서, 다수의 프로세서들 및/또는 다수의 버스들이 다수의 메모리들 및 다수의 유형의 메모리와 함께, 적절하게 사용될 수 있다. 또한, 다수의 컴퓨팅 디바이스들(600)은 필요한 동작의 부분들을 제공하는 각 디바이스와 연결될 수 있다(예를 들어, 서버 뱅크, 블레이드 서버 그룹 또는 멀티 프로세서 시스템).Computing device 600 includes a processor 610, a memory 620, a storage device 630, a high-speed interface/controller 640 and a low-speed bus 670 connected to memory 620 and a high-speed expansion port 650. It includes a low-speed interface/controller 660 coupled to a storage device 630. Components 610, 620, 630, 640, 650 and 660 are each interconnected using various buses and may be mounted on a common motherboard or in any other suitable manner. Processor 610 processes instructions for execution within computing device 600, including instructions stored in memory 620 or storage device 630, such as display 680 coupled to high-speed interface 640. Graphical information for a graphical user interface (GUI) can be displayed on an external input/output device. In other implementations, multiple processors and/or multiple buses may be used, as appropriate, along with multiple memories and multiple types of memory. Additionally, multiple computing devices 600 may be connected with each device providing portions of the required operation (eg, a server bank, a group of blade servers, or a multi-processor system).
메모리(620)는 컴퓨팅 디바이스(600) 내에 비일시적으로 정보를 저장한다. 메모리(620)는 컴퓨터 판독가능 매체, 휘발성 메모리 유닛(들), 비휘발성 메모리 유닛(들)일 수 있다. 비일시적 메모리(620)는 컴퓨팅 디바이스(600)에 의해 사용하기 위해 일시적 또는 영구적으로 프로그램(예를 들어, 명령어 시퀀스) 또는 데이터(예를 들어, 프로그램 상태 정보)를 저장하는데 사용되는 물리적 디바이스일 수 있다. 비휘발성 메모리의 예는 플래시 메모리 및 읽기 전용 메모리(ROM)/프로그래밍 가능한 읽기 전용 메모리(PROM)/지울 수 있는 프로그램 가능한 읽기 전용 메모리(EPROM)/전자적으로 지울 수 있는 프로그래밍 가능한 읽기 전용 메모리(EEPROM)(예: 일반적으로 부팅 프로그램과 같은 펌웨어에 사용됨)를 포함하지만, 이에 한정되지 않는다. 휘발성 메모리의 예는 RAM(Random Access Memory), DRAM(Dynamic Random Access Memory), SRAM(Static Random Access Memory), PCM(Phase Change Memory), 디스크 또는 테이프 등을 포함하지만, 이에 한정되지 않는다.Memory 620 stores information non-transitory within computing device 600. Memory 620 may be a computer-readable medium, volatile memory unit(s), or non-volatile memory unit(s). Non-transitory memory 620 may be a physical device used to temporarily or permanently store programs (e.g., instruction sequences) or data (e.g., program state information) for use by computing device 600. there is. Examples of non-volatile memory are flash memory and read-only memory (ROM)/programmable read-only memory (PROM)/erasable programmable read-only memory (EPROM)/electronically erasable programmable read-only memory (EEPROM). (e.g. typically used in firmware such as boot programs) including, but not limited to: Examples of volatile memory include, but are not limited to, random access memory (RAM), dynamic random access memory (DRAM), static random access memory (SRAM), phase change memory (PCM), disk, or tape.
저장 디바이스(630)는 컴퓨팅 디바이스(600)에 대한 대형 스토리지를 제공할 수 있다. 일부 구현예에서, 저장 디바이스(630)는 컴퓨터 판독가능 매체이다. 다양한 상이한 구현예에서, 저장 디바이스(630)는 플로피 디스크 디바이스, 하드 디스크 디바이스, 광 디스크 디바이스 또는 테이프 디바이스, 플래시 메모리 또는 다른 유사한 고체 상태 메모리 디바이스, 또는 저장 영역 네트워크 또는 다른 구성의 디바이스를 포함하는 디바이스의 어레이일 수 있다. 일 구현예에서, 컴퓨터 프로그램 제품은 정보 캐리어에 유형적으로 수록된다. 컴퓨터 프로그램 제품은 또한 실행될 때 상기 기술된 바와 같은 하나 이상의 방법을 수행하는 명령어들을 포함한다. 정보 캐리어는 메모리(620), 저장 디바이스(630) 또는 프로세서(610)상의 메모리와 같은 컴퓨터 또는 기계 판독가능 매체이다.Storage device 630 may provide large storage for computing device 600. In some implementations, storage device 630 is a computer-readable medium. In various different implementations, storage device 630 may be a device including a floppy disk device, a hard disk device, an optical disk device or tape device, flash memory or other similar solid state memory device, or a storage area network or other configured device. It may be an array of . In one implementation, the computer program product is tangibly embodied in an information carrier. The computer program product also includes instructions that, when executed, perform one or more methods as described above. The information carrier is a computer or machine-readable medium, such as memory 620, storage device 630, or memory on processor 610.
고속 제어기(640)는 컴퓨팅 디바이스(600)에 대한 대역폭 집중 동작들을 관리하는 반면, 저속 제어기(660)는 낮은 대역폭 집중 동작들을 관리한다. 이러한 기능들의 할당은 단지 예시적인 것이다. 일부 구현예에서, 고속 제어기(640)는 메모리(620), 디스플레이(680)(예를 들어, 그래픽 프로세서 또는 가속기를 통해) 및 다양한 확장 카드(도시되지 않음)를 수용할 수 있는 고속 확장 포트(650)에 연결된다. 일부 구현예에서, 저속 제어기(660)는 저장 디바이스(630) 및 저속 확장 포트(690)에 연결된다. 다양한 통신 포트(예를 들어, USB, 블루투스, 이더넷, 무선 이더넷)를 포함할 수 있는 저속 확장 포트(690)는 키보드, 포인팅 디바이스, 스캐너와 같은 하나 이상의 입력/출력 디바이스 또는 예를 들어 네트워크 어댑터를 통해 스위치 또는 라우터와 같은 네트워킹 디바이스에 결합될 수 있다.High-speed controller 640 manages bandwidth-intensive operations for computing device 600, while low-speed controller 660 manages low-bandwidth-intensive operations. The assignment of these functions is illustrative only. In some implementations, high-speed controller 640 includes memory 620, display 680 (e.g., via a graphics processor or accelerator), and a high-speed expansion port that can accommodate various expansion cards (not shown). 650). In some implementations, low-speed controller 660 is coupled to storage device 630 and low-speed expansion port 690. Low-speed expansion port 690, which may include various communication ports (e.g., USB, Bluetooth, Ethernet, wireless Ethernet), can connect one or more input/output devices, such as a keyboard, pointing device, scanner, or, for example, a network adapter. It can be coupled to networking devices such as switches or routers.
컴퓨팅 디바이스(600)는 도면에 도시된 바와 같이 다수의 상이한 형태로 구현될 수 있다. 예를 들어, 표준 서버(600a)로서 또는 그러한 서버(600a)의 그룹에서 여러 번, 랩톱 컴퓨터(600b)로서 또는 랙 서버 시스템(600c)의 일부로서 구현될 수 있다.Computing device 600 may be implemented in a number of different forms as shown in the figure. For example, it may be implemented as a standard server 600a or multiple times in a group of such servers 600a, as a laptop computer 600b, or as part of a rack server system 600c.
본 명세서에 기술된 시스템들 및 기법들의 다양한 구현예들은 디지털 전자 및/또는 광학 회로, 집적 회로, 특수하게 설계된 ASIC들(application specific integrated circuits), 컴퓨터 하드웨어, 펌웨어, 소프트웨어 및/또는 이들의 조합으로 구현될 수 있다. 이들 다양한 구현예들은 적어도 하나의 프로그래머블 프로세서를 포함하는 프로그래머블 시스템 상에서 실행가능하고 및/또는 인터프리트가능한 하나 이상의 컴퓨터 프로그램들에서의 구현예를 포함할 수 있고, 이는 전용 또는 범용일 수 있고, 저장 시스템, 적어도 하나의 입력 디바이스 및 적어도 하나의 출력 디바이스로부터 데이터 및 명령어들을 수신하고 그에 데이터 및 명령어들을 전송하기 위해 연결될 수 있다.Various implementations of the systems and techniques described herein may include digital electronic and/or optical circuits, integrated circuits, specially designed application specific integrated circuits (ASICs), computer hardware, firmware, software, and/or combinations thereof. It can be implemented. These various implementations may include implementations in one or more computer programs executable and/or interpretable on a programmable system that includes at least one programmable processor, which may be dedicated or general purpose, and a storage system. , can be coupled to receive data and instructions from and transmit data and instructions to at least one input device and at least one output device.
이들 컴퓨터 프로그램들(프로그램, 소프트웨어, 소프트웨어 애플리케이션 또는 코드로도 알려짐)은 프로그래머블 프로세서에 대한 기계 명령어들을 포함하며, 하이레벨 절차어 및/또는 객체 지향 프로그래밍 언어 및/또는 어셈블리/기계어에서 구현될 수 있다. 본 명세서에서 사용된 바와 같이, 용어 "기계 판독가능 매체", "컴퓨터 판독가능 매체"는 기계 판독가능 신호로서 기계 명령어들을 수신하는 기계 판독가능 매체를 포함하여, 기계 명령어들 및/또는 데이터를 프로그래머블 프로세서에 제공하는데 사용되는 임의의 컴퓨터 프로그램 물, 장치 및/또는 디바이스 예를 들어, 자기 디스크, 광학 디스크, 메모리, 비일시적 컴퓨터 판독가능 매체, 프로그래머블 로직 디바이스(PLD)를 지칭한다. 용어 "기계 판독가능 신호"는 기계 명령어들 및/또는 데이터를 프로그래머블 프로세서에 제공하는데 사용되는 임의의 신호를 지칭한다.These computer programs (also known as programs, software, software applications, or code) contain machine instructions for a programmable processor and may be implemented in a high-level procedural language and/or an object-oriented programming language and/or assembly/machine language. . As used herein, the terms “machine-readable medium” and “computer-readable medium” include a machine-readable medium that receives machine instructions as a machine-readable signal, producing machine instructions and/or data in a programmable manner. Refers to any computer program product, apparatus and/or device used to provide to a processor, such as a magnetic disk, optical disk, memory, non-transitory computer-readable medium, programmable logic device (PLD). The term “machine-readable signal” refers to any signal used to provide machine instructions and/or data to a programmable processor.
본 명세서에 기술된 프로세스들 및 논리 흐름들은 입력 데이터를 동작하고 출력을 생성함으로써 기능들을 수행하기 위해 하나 이상의 컴퓨터 프로그램들을 실행하는 데이터 프로세싱 하드웨어로도 지칭되는 하나 이상의 프로그래머블 프로세서들에 의해 수행될 수 있다. 프로세스들 및 논리 흐름들은 또한 FPGA 또는 ASIC와 같은 특수 목적 논리 회로에 의해 수행될 수 있다. 컴퓨터 프로그램의 실행에 적절한 프로세서들은, 예시로서, 범용 및 전용 마이크로프로세서들과 임의의 종류의 디지털 컴퓨터의 임의의 하나 이상의 프로세서들을 포함한다. 일반적으로, 프로세서는 읽기-전용 메모리 또는 랜덤 액세스 메모리 또는 둘 모두로부터 명령어들 및 데이터를 수신할 것이다. 컴퓨터의 필수 엘리먼트들은 명령어들을 수행하기 위한 프로세서 및 명령어들 및 데이터를 저장하기 위한 하나 이상의 메모리 디바이스들이다. 일반적으로, 컴퓨터는 데이터를 저장하기 위한 하나 이상의 대형 저장 디바이스들 예를 들면, 자기적, 자기-광학 디스크들 또는 광학적 디스크들 또한 포함하거나 또는 그로부터 데이터를 수신하거나 그에 데이터를 전송하기 위해 동작적으로 결합될 수 있다. 그러나, 컴퓨터는 상기 디바이스들을 반드시 가져야 하는 것은 아니다. 컴퓨터 프로그램 명령어들 및 데이터를 저장하기에 적합한 컴퓨터 판독가능 매체는 예를 들어, EPROM, EEPROM 및 플래시 메모리 디바이스들과 같은 반도체 메모리 디바이스들; 예를 들어, 내부 하드 디스크들 또는 이동식 디스크들과 같은 자기 디스크들; 및 CD-ROM 및 DVD-ROM 디스크들을 포함하는 모든 형태의 비휘발성 메모리, 매체 및 메모리 디바이스들을 포함한다. 프로세서 및 메모리는 특수 목적 논리 회로에 의해 보충되거나 그 안에 통합될 수 있다.The processes and logic flows described herein may be performed by one or more programmable processors, also referred to as data processing hardware, that execute one or more computer programs to perform functions by operating on input data and generating output. . Processes and logic flows may also be performed by special purpose logic circuitry, such as an FPGA or ASIC. Processors suitable for executing computer programs include, by way of example, general purpose and special purpose microprocessors and any one or more processors of any type of digital computer. Typically, a processor will receive instructions and data from read-only memory or random access memory, or both. The essential elements of a computer are a processor to perform instructions and one or more memory devices to store instructions and data. Typically, a computer also includes one or more large storage devices, such as magnetic, magneto-optical or optical disks, for storing data or is operatively configured to receive data from or transmit data to. can be combined However, a computer does not necessarily have to have the above devices. Computer-readable media suitable for storing computer program instructions and data include, for example, semiconductor memory devices such as EPROM, EEPROM, and flash memory devices; Magnetic disks, for example internal hard disks or removable disks; and all types of non-volatile memory, media and memory devices, including CD-ROM and DVD-ROM disks. The processor and memory may be supplemented by or integrated within special purpose logic circuitry.
사용자와의 인터렉션을 제공하기 위해, 본 개시의 하나 이상의 양태는 사용자에게 정보를 디스플레이하기 위해 예를 들어, CRT(cathode ray tube) 또는 LCD(liquid crystal display) 모니터 또는 터치 스크린과 같은 디스플레이 디바이스 및 선택적으로 사용자가 컴퓨터에 입력을 제공할 수 있는 키보드 및 포인팅 디바이스 예를 들어, 마우스 또는 트랙볼을 갖는 컴퓨터에서 구현될 수 있다. 다른 종류의 디바이스들도 사용자와의 인터렉션을 제공하는데 사용될 수 있다. 예를 들어, 사용자에게 제공되는 피드백은 시각 피드백, 청각 피드백 또는 촉각 피드백과 같은 임의의 형태의 감각적 피드백일 수 있고, 사용자로부터의 입력은 음향, 음성 또는 촉각 입력을 포함하는 임의의 형태로 수신될 수 있다. 추가로, 컴퓨터는 사용자에 의해 사용되는 디바이스에 문서를 송수신함으로써 예를 들어, 웹브라우저로부터 수신된 요청에 응답하여, 사용자의 사용자 디바이스상의 웹브라우저에 웹페이지를 전송함으로써 사용자와 인터렉션할 수 있다. To provide interaction with a user, one or more aspects of the present disclosure may include a display device, for example, a cathode ray tube (CRT) or liquid crystal display (LCD) monitor or a touch screen, and optionally, to display information to the user. It may be implemented on a computer with a keyboard and pointing devices, such as a mouse or trackball, that allow a user to provide input to the computer. Other types of devices can also be used to provide interaction with the user. For example, the feedback provided to the user may be any form of sensory feedback, such as visual feedback, auditory feedback, or tactile feedback, and input from the user may be received in any form including acoustic, vocal, or tactile input. You can. Additionally, the computer may interact with the user by sending and receiving documents to and from the device used by the user, for example, by sending a web page to a web browser on the user's user device, in response to a request received from the web browser.
다수의 구현예들이 기술되었다. 그럼에도 불구하고, 다양한 수정들이 본 발명의 정신과 범위로부터 벗어나지 않고 이루어질 수 있다는 것이 이해될 것이다. 따라서, 다른 구현예들도 다음의 청구항들의 범위 내에 있다.A number of implementations have been described. Nonetheless, it will be understood that various modifications may be made without departing from the spirit and scope of the invention. Accordingly, other implementations are within the scope of the following claims.
Claims (24)
트레이닝 데이터(306, 320)를 수신하는 동작, 상기 트레이닝 데이터는:
비음성 텍스트 발화들(320), 각각의 비음성 텍스트 발화(320)는 비합성 스피치의 임의의 대응하는 음성 발화와 페어링되지 않으며; 및
전사되지 않은 비합성 스피치 발화(306)를 포함하고, 각각의 전사되지 않은 비합성 스피치 발화(306)는 대응하는 전사와 페어링되지 않으며;
텍스트-투-스피치 모델(330)을 사용하여, 수신된 트레이닝 데이터(306, 320)의 각각의 비음성 텍스트 발화(320)에 대해 대응하는 합성 스피치 표현(332)을 생성하는 동작; 및
오디오 인코더(210)가 공유된 스피치 및 텍스트 표현을 공동으로 학습하도록 가르치기 위해 오디오 인코더(210)를 비음성 텍스트 발화(320)에 대해 생성된 합성 스피치 표현(332) 및 전사되지 않은 비합성 스피치 발화(306)에 대해 사전 트레이닝하는 동작을 포함하는, 컴퓨터로 구현되는 방법(500).1. A computer-implemented method (500) that, when executed on data processing hardware (610), causes data processing hardware (610) to perform operations, comprising:
An operation of receiving training data 306, 320, wherein the training data is:
Non-speech text utterances 320, where each non-speech text utterance 320 is not paired with any corresponding spoken utterance in non-synthesized speech; and
Includes untranscribed non-synthetic speech utterances 306, wherein each untranscribed non-synthetic speech utterance 306 is not paired with a corresponding transcription;
generating, using the text-to-speech model (330), a corresponding synthetic speech representation (332) for each non-speech text utterance (320) in the received training data (306, 320); and
To teach audio encoder 210 to jointly learn shared speech and text representations, audio encoder 210 can be used to generate synthetic speech representations 332 for non-speech text utterances 320 and for non-transcribed non-synthetic speech utterances. A computer-implemented method (500) comprising pre-training on (306).
각각의 전사되지 않은 비합성 스피치 발화에 대해(306):
전사되지 않은 비합성 스피치 발화(306)의 대응하는 인코딩된 표현(211)을 생성하는 동작; 및
전사되지 않은 비합성 스피치 발화(306)의 대응하는 인코딩된 표현(211)에 적용된 대비 손실(316)에 대해 오디오 인코더(210)를 사전 트레이닝하는 동작; 및
각각의 합성 스피치 표현에 대해(332):
상기 합성 스피치 표현(332)의 대응하는 인코딩된 표현(211)을 생성하는 동작; 및
상기 합성 스피치 표현(332)의 대응하는 인코딩된 표현(211)에 적용된 대조 손실(316)에 대해 오디오 인코더(210)를 사전 트레이닝하는 동작을 포함하는, 컴퓨터로 구현되는 방법(500).The method of claim 1 or 2, wherein pre-training the audio encoder (210) includes:
For each non-transcribed, non-synthetic speech utterance (306):
generating a corresponding encoded representation (211) of the non-transcribed, non-synthetic speech utterance (306); and
Pre-training the audio encoder (210) on the contrast loss (316) applied to the corresponding encoded representation (211) of the non-transcribed non-synthetic speech utterance (306); and
For each synthetic speech representation 332:
generating a corresponding encoded representation (211) of the synthesized speech representation (332); and
A computer-implemented method (500) comprising pre-training an audio encoder (210) on a contrast loss (316) applied to a corresponding encoded representation (211) of the synthesized speech representation (332).
보조 디코더(390)를 사용하여, 상기 대응하는 합성 스피치 표현(332)에 대한 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포(392)를 결정하는 동작;
상기 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포(392) 및 상기 대응하는 합성 스피치 표현(332)에 대응하는 비음성 텍스트 발화(320)에 기초하여 합성 스피치 손실 항(342)을 결정하는 동작; 및
상기 합성 스피치 손실 항(342)에 기초하여 상기 오디오 인코더(210)를 사전 트레이닝하는 동작을 포함하는, 컴퓨터로 구현되는 방법(500).12. The method of any one of claims 1-11, wherein pre-training the audio encoder (210) comprises at each of a plurality of time steps (332) for each synthesized speech representation (332):
determining, using an auxiliary decoder (390), a first probability distribution (392) for possible synthetic speech recognition hypotheses for the corresponding synthetic speech representation (332);
determining a synthetic speech loss term (342) based on a first probability distribution (392) for the possible synthetic speech recognition hypotheses and a non-speech text utterance (320) corresponding to the corresponding synthetic speech representation (332); and
A computer-implemented method (500) comprising pre-training the audio encoder (210) based on the synthesized speech loss term (342).
다른 보조 디코더(390)를 사용하여, 상기 대응하는 합성 스피치 표현(332)에 대한 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포(393)를 생성하는 동작, 상기 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포는 상기 가능한 음소 라벨 또는 상기 가능한 단어 조각 라벨 중 다른 하나를 포함하며;
상기 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포(393) 및 상기 대응하는 합성 스피치 표현(332)에 대응하는 비음성 텍스트 발화(320)에 기초하여 다른 합성 스피치 손실 항(342)을 결정하는 동작; 및
상기 다른 합성 스피치 손실 항(342)에 기초하여 상기 오디오 인코더(210)를 사전 트레이닝하는 동작을 포함하는, 컴퓨터로 구현되는 방법(500).The method of claim 5, wherein the act of pre-training the audio encoder (210) comprises at each of a plurality of time steps (332) for each synthesized speech representation (332):
generating, using another auxiliary decoder (390), a second probability distribution (393) over possible synthetic speech recognition hypotheses for the corresponding synthetic speech representation (332), a second probability distribution (393) over the possible synthetic speech recognition hypotheses; The probability distribution includes another of the possible phoneme labels or the possible word fragment labels;
Determining a different synthetic speech loss term (342) based on the second probability distribution (393) for the possible synthetic speech recognition hypothesis and the non-speech text utterance (320) corresponding to the corresponding synthetic speech representation (332). ; and
A computer-implemented method (500) comprising pre-training the audio encoder (210) based on the different synthetic speech loss terms (342).
데이터 프로세싱 하드웨어(610); 및
상기 데이터 프로세싱 하드웨어(610)와 통신하는 메모리 하드웨어(620)를 포함하며, 상기 메모리 하드웨어(620)는 상기 데이터 프로세싱 하드웨어(610)에 의해 실행될 때 상기 데이터 프로세싱 하드웨어(610)로 하여금 동작들을 수행하게 하는 명령어들을 저장하며, 상기 동작들은:
트레이닝 데이터(306, 320)를 수신하는 동작, 상기 트레이닝 데이터는:
비음성 텍스트 발화들(320), 각각의 비음성 텍스트 발화(320)는 비합성 스피치의 임의의 대응하는 음성 발화와 페어링되지 않으며; 및
전사되지 않은 비합성 스피치 발화(306)를 포함하고, 각각의 전사되지 않은 비합성 스피치 발화(306)는 대응하는 전사와 페어링되지 않으며;
텍스트-투-스피치 모델(330)을 사용하여, 수신된 트레이닝 데이터(306, 320)의 각각의 비음성 텍스트 발화(320)에 대해 대응하는 합성 스피치 표현(332)을 생성하는 동작; 및
오디오 인코더(210)가 공유된 스피치 및 텍스트 표현을 공동으로 학습하도록 가르치기 위해 오디오 인코더(210)를 비음성 텍스트 발화(320)에 대해 생성된 합성 스피치 표현(332) 및 전사되지 않은 비합성 스피치 발화(306)에 대해 사전 트레이닝하는 동작을 포함하는, 시스템(100).As system 100,
data processing hardware 610; and
and memory hardware 620 in communication with the data processing hardware 610, wherein the memory hardware 620, when executed by the data processing hardware 610, causes the data processing hardware 610 to perform operations. Stores instructions that do the following:
An operation of receiving training data 306, 320, wherein the training data is:
Non-speech text utterances 320, where each non-speech text utterance 320 is not paired with any corresponding spoken utterance in non-synthesized speech; and
Includes untranscribed non-synthetic speech utterances 306, wherein each untranscribed non-synthetic speech utterance 306 is not paired with a corresponding transcription;
generating, using the text-to-speech model (330), a corresponding synthetic speech representation (332) for each non-speech text utterance (320) in the received training data (306, 320); and
To teach audio encoder 210 to jointly learn shared speech and text representations, audio encoder 210 can be used to generate synthetic speech representations 332 for non-speech text utterances 320 and for non-transcribed non-synthetic speech utterances. System 100, including pre-training for 306.
각각의 전사되지 않은 비합성 스피치 발화에 대해(306):
전사되지 않은 비합성 스피치 발화(306)의 대응하는 인코딩된 표현(211)을 생성하는 동작; 및
전사되지 않은 비합성 스피치 발화의 대응하는 인코딩된 표현(211)에 적용된 대조 손실(316)에 대해 오디오 인코더(210)를 사전 트레이닝하는 동작; 및
각각의 합성 스피치 표현에 대해(332):
상기 합성 스피치 표현(332)의 대응하는 인코딩된 표현(211)을 생성하는 동작; 및
상기 합성 스피치 표현(332)의 대응하는 인코딩된 표현(211)에 적용된 대비 손실(316)에 대해 오디오 인코더(210)를 사전 트레이닝하는 동작을 포함하는, 시스템(100).The method of claim 13 or 14, wherein pre-training the audio encoder (210) includes:
For each non-transcribed, non-synthetic speech utterance (306):
generating a corresponding encoded representation (211) of the non-transcribed, non-synthetic speech utterance (306); and
Pre-training the audio encoder (210) on a contrast loss (316) applied to the corresponding encoded representation (211) of the non-transcribed non-synthetic speech utterance; and
For each synthetic speech representation 332:
generating a corresponding encoded representation (211) of the synthesized speech representation (332); and
System (100) comprising pre-training an audio encoder (210) on a contrast loss (316) applied to a corresponding encoded representation (211) of the synthesized speech representation (332).
보조 디코더(390)를 사용하여, 상기 대응하는 합성 스피치 표현(332)에 대한 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포(392)를 결정하는 동작;
상기 가능한 합성 스피치 인식 가설에 대한 제1 확률 분포(392) 및 상기 대응하는 합성 스피치 표현(332)에 대응하는 비음성 텍스트 발화(320)에 기초하여 합성 스피치 손실 항(342)을 결정하는 동작; 및
상기 합성 스피치 손실 항(342)에 기초하여 상기 오디오 인코더(210)를 사전 트레이닝하는 동작을 포함하는, 시스템(100).The method of any one of claims 13-15, wherein pre-training the audio encoder (210) comprises at each of a plurality of time steps (332) for each synthesized speech representation (332):
determining, using an auxiliary decoder (390), a first probability distribution (392) for possible synthetic speech recognition hypotheses for the corresponding synthetic speech representation (332);
determining a synthetic speech loss term (342) based on a first probability distribution (392) for the possible synthetic speech recognition hypotheses and a non-speech text utterance (320) corresponding to the corresponding synthetic speech representation (332); and
A system (100) comprising pre-training the audio encoder (210) based on the synthesized speech loss term (342).
다른 보조 디코더(390)를 사용하여, 상기 대응하는 합성 스피치 표현(332)에 대한 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포(393)를 생성하는 동작, 상기 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포는 상기 가능한 음소 라벨 또는 상기 가능한 단어 조각 라벨 중 다른 하나를 포함하며;
상기 가능한 합성 스피치 인식 가설에 대한 제2 확률 분포(393) 및 상기 대응하는 합성 스피치 표현(332)에 대응하는 비음성 텍스트 발화(320)에 기초하여 다른 합성 스피치 손실 항(342)을 결정하는 동작; 및
상기 다른 합성 스피치 손실 항(342)에 기초하여 상기 오디오 인코더(210)를 사전 트레이닝하는 동작을 포함하는, 시스템(100).18. The method of claim 17, wherein pre-training the audio encoder (210) comprises at each of a plurality of time steps (332) for each synthesized speech representation (332):
generating, using another auxiliary decoder (390), a second probability distribution (393) over possible synthetic speech recognition hypotheses for the corresponding synthetic speech representation (332), a second probability distribution (393) over the possible synthetic speech recognition hypotheses; The probability distribution includes another of the possible phoneme labels or the possible word fragment labels;
Determining a different synthetic speech loss term (342) based on the second probability distribution (393) for the possible synthetic speech recognition hypothesis and the non-speech text utterance (320) corresponding to the corresponding synthetic speech representation (332). ; and
System (100) comprising pre-training the audio encoder (210) based on the different synthetic speech loss terms (342).
Applications Claiming Priority (3)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US202163202950P | 2021-06-30 | 2021-06-30 | |
US63/202,950 | 2021-06-30 | ||
PCT/US2022/073067 WO2023278952A1 (en) | 2021-06-30 | 2022-06-21 | Injecting text in self-supervised speech pre-training |
Publications (1)
Publication Number | Publication Date |
---|---|
KR20240022598A true KR20240022598A (en) | 2024-02-20 |
Family
ID=82703136
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
KR1020247001572A KR20240022598A (en) | 2021-06-30 | 2022-06-21 | Inserting text in self-guided speech pretraining |
Country Status (5)
Country | Link |
---|---|
US (1) | US20230017892A1 (en) |
EP (1) | EP4338157A1 (en) |
KR (1) | KR20240022598A (en) |
CN (1) | CN117716422A (en) |
WO (1) | WO2023278952A1 (en) |
Family Cites Families (2)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US9842592B2 (en) | 2014-02-12 | 2017-12-12 | Google Inc. | Language models using non-linguistic context |
EP3948853A1 (en) * | 2019-05-03 | 2022-02-09 | Google LLC | End-to-end automated speech recognition on numeric sequences |
-
2022
- 2022-06-21 WO PCT/US2022/073067 patent/WO2023278952A1/en active Application Filing
- 2022-06-21 US US17/808,091 patent/US20230017892A1/en active Pending
- 2022-06-21 KR KR1020247001572A patent/KR20240022598A/en unknown
- 2022-06-21 EP EP22747909.4A patent/EP4338157A1/en active Pending
- 2022-06-21 CN CN202280046132.0A patent/CN117716422A/en active Pending
Also Published As
Publication number | Publication date |
---|---|
US20230017892A1 (en) | 2023-01-19 |
EP4338157A1 (en) | 2024-03-20 |
CN117716422A (en) | 2024-03-15 |
WO2023278952A1 (en) | 2023-01-05 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
JP7436709B2 (en) | Speech recognition using unspoken text and speech synthesis | |
JP2023545988A (en) | Transformer transducer: One model that combines streaming and non-streaming speech recognition | |
KR20220148245A (en) | Consistency Prediction for Streaming Sequence Models | |
JP7351018B2 (en) | Proper noun recognition in end-to-end speech recognition | |
KR20230084229A (en) | Parallel tacotron: non-autoregressive and controllable TTS | |
WO2023055410A1 (en) | Contrastive siamese network for semi-supervised speech recognition | |
JP2023175029A (en) | Attention-based joint acoustic and text on-device end-to-end model | |
US20230317059A1 (en) | Alignment Prediction to Inject Text into Automatic Speech Recognition Training | |
KR20240051176A (en) | Improving speech recognition through speech synthesis-based model adaptation | |
KR20240022598A (en) | Inserting text in self-guided speech pretraining | |
US20230013587A1 (en) | Advancing the Use of Text and Speech in ASR Pretraining With Consistency and Contrastive Losses | |
US20230103722A1 (en) | Guided Data Selection for Masked Speech Modeling | |
US20240153484A1 (en) | Massive multilingual speech-text joint semi-supervised learning for text-to-speech | |
KR102637025B1 (en) | Multilingual rescoring models for automatic speech recognition | |
US20240029715A1 (en) | Using Aligned Text and Speech Representations to Train Automatic Speech Recognition Models without Transcribed Speech Data | |
US20230298565A1 (en) | Using Non-Parallel Voice Conversion for Speech Conversion Models | |
CN117597729A (en) | Use of advanced text and speech in ASR pre-training with consistency and contrast loss | |
KR20240068699A (en) | Guided data selection for masked speech modeling | |
KR20240068704A (en) | Contrast Siamese networks for semi-supervised speech recognition. |