US8463615B2 - Low-delay audio coder - Google Patents
Low-delay audio coder Download PDFInfo
- Publication number
- US8463615B2 US8463615B2 US12/671,631 US67163108A US8463615B2 US 8463615 B2 US8463615 B2 US 8463615B2 US 67163108 A US67163108 A US 67163108A US 8463615 B2 US8463615 B2 US 8463615B2
- Authority
- US
- United States
- Prior art keywords
- model
- distribution model
- distribution
- signal
- combined
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Active, expires
Links
Images
Classifications
-
- G—PHYSICS
- G10—MUSICAL INSTRUMENTS; ACOUSTICS
- G10L—SPEECH ANALYSIS OR SYNTHESIS; SPEECH RECOGNITION; SPEECH OR VOICE PROCESSING; SPEECH OR AUDIO CODING OR DECODING
- G10L19/00—Speech or audio signals analysis-synthesis techniques for redundancy reduction, e.g. in vocoders; Coding or decoding of speech or audio signals, using source filter models or psychoacoustic analysis
- G10L19/04—Speech or audio signals analysis-synthesis techniques for redundancy reduction, e.g. in vocoders; Coding or decoding of speech or audio signals, using source filter models or psychoacoustic analysis using predictive techniques
- G10L19/08—Determination or coding of the excitation function; Determination or coding of the long-term prediction parameters
Definitions
- the present invention relates generally to methods and devices for encoding and decoding audio signals.
- the present invention relates to coders and decoders for reducing bit rate variations during the encoding and decoding procedures of speech signals.
- Coding of a digital audio signal is commonly based on the use of a signal model to reduce bit rate (also called “rate” in the following) and maintain high signal quality.
- a signal model enables the transformation of data to new data that are more amenable to coding or the definition of a distribution of the digital audio signal, which distribution can be used in coding.
- the signal model may be used for linear prediction, which removes dependencies among samples of the digital audio signal (a method called linear predictive encoding).
- the signal model may be used to provide a probability distribution of a signal segment of the digital audio signal to a quantizer, thereby facilitating the computation of the quantizer which operates either directly on the signal or on a unitary transform of the signal (method called adaptive encoding).
- Delay is an important factor in many applications of coding of audio signals.
- the delay is particularly critical.
- backward signal analysis backward adaptive encoding
- signal reconstruction in the following.
- Coding methods are commonly divided into two classes, namely variable-rate coding, which corresponds to constrained-entropy quantization, and fixed-rate coding, which corresponds to constrained-resolution quantization.
- the behaviour of these two coding methods can be analysed for the so-called high-rate case, which is often considered to be a good approximation of the low-rate case.
- a constrained-resolution quantizer minimizes the distortion under a fixed-rate constraint, which, at high rate, results generally in non-uniform cell sizes.
- a constrained-entropy quantizer minimizes the distortion under an average rate (the quantization index entropy) constraint.
- the instant rate varies over time, which, at high-rate, generally results in an uncountable set of quantization cells of uniform size and shape while redundancy removal is left to lossless coding.
- constrained-entropy quantization provides a (nearly) constant distortion, which is especially beneficial when the signal model or probabilistic signal model is not optimal.
- a non-optimal probabilistic signal model leads also to an increase in bit rate in the case of constrained-entropy coding.
- constrained-resolution quantization leads to an increased distortion while keeping a constant rate when the probabilistic signal model is not optimal.
- speech and audio signals display so-called transitions, at which the optimal probabilistic signal model would change abruptly. If the model is not updated immediately at a transition, the quality of the encoding degrades in the constrained-resolution case (increased distortion) while the bit rate increases in the constrained-entropy case.
- the problem at transitions is particularly significant when the probabilistic signal model is updated by a backward signal analysis.
- the problem at transitions leads to error propagation since the signal reconstruction is inaccurate because the signal model is inaccurate, and the signal model is inaccurate because the signal reconstruction is inaccurate. Thus, it takes a relatively long time for the coder to retrieve a good signal quality.
- constrained-entropy quantization there is little error propagation but the bit rate increases significantly at abrupt transitions (resulting in bit rate peaks).
- An object of the present invention is to wholly or partly overcome the above disadvantages and drawbacks of the prior art and to provide improved methods and devices for encoding and decoding audio signals.
- the present invention provides methods and apparatus enabling to reduce bit rate variation, such as bit rate peaks, when coding an input signal based on variable-rate quantization while maintaining a high average compression rate.
- the methods and apparatus provided by the present invention enable to reduce the propagation of errors caused by packet loss or channel errors, in particular in audio coding of input signal based on fixed-rate quantization, while maintaining high average compression rate.
- a method for encoding an input signal is provided in accordance with appended claim 1 .
- an apparatus for encoding an input signal is provided in accordance with appended claim 16 .
- a method for decoding a bit stream of coded data is provided in accordance with appended claim 36 .
- an apparatus for decoding a bit stream of coded data is provided in accordance with appended claim 46 .
- a computer readable medium is provided in accordance with appended claim 58 .
- a computer readable medium is provided in accordance with appended claim 59 .
- An advantage of the present invention is to remove bit rate peaks associated with transitions in audio coding for constrained-entropy encoding without increasing the average bit rate significantly.
- the present invention is based on an insight that the rate increases at transitions because of the non-optimality of the probabilistic signal model obtained with backward adaptation (or backward adaptive encoding).
- quantizers are designed based on a probabilistic signal model, their performance varies with the accuracy of the model.
- the optimal model for a given distortion is the model that provides the lowest bit rate.
- the probabilistic signal model used in backward adaptive encoding is generally not the probabilistic signal model leading to the lowest bit rate, which results in significant rate peaks at transitions.
- the present invention is advantageous since flexibility is introduced in the determination of the probabilistic signal model using a low rate of side information.
- This flexibility is introduced by encoding a current signal segment of the input signal using a combined distribution model obtained by adding at least one first distribution model and at least one fixed distribution model, to which distribution models weighting coefficients are affected.
- the first distribution model is associated with model parameters extracted from a reconstructed signal generated from past signal segments of the input signal.
- the probabilistic signal model or combined distribution model used to encode the current signal segment takes into account past signal segments of the input signal and is also based on other signal models.
- weighting coefficients affected to the first and the fixed distribution models may be selected for minimizing an estimated code length for the current signal segment.
- the probabilistic model or combined distribution model comprises a sum of probability distributions, which is also referred to as a sum of distribution models, each multiplied by a coefficient. At least one of the distribution models is obtained based on the past coded signal. Good or optimal values for the coefficients may be computed by a modeller.
- the probabilistic model is preferably based on at least one of the following: i) a distribution model generated based on a reconstructed signal (which can be available at both the encoder and the decoder), ii) information stored at both the encoder and the decoder (for example a fixed distribution model characteristic of the input signal), and iii) transmitted information.
- the combined distribution model or probabilistic model may be created by combining, in a manner specified in information transmitted from the encoder to the decoder, a distribution based on a reconstructed signal and one or more fixed distribution models known at both the encoder and the decoder.
- the combined distribution model may be a mixture model further including at least one adaptive distribution model selected in response to the model parameters extracted from the reconstructed signal, to which adaptive distribution model a weighting factor is affected. This is advantageous since one more component is included in the combined distribution model, thereby increasing the flexibility of the signal model.
- the combined distribution model is selected from a plurality of combined distribution models in response to a code length of a subsegment of the current signal segment and a code length used for describing the distribution model of the reconstructed signal.
- the plurality of combined distribution models may be obtained by varying the values of a set of weighting coefficients associated with a particular signal model.
- the proposed signal representation i.e. the combined distribution model, decreases the code length for the signal segments or blocks near transitions for backward adaptive encoding and may also decrease the average rate because the probabilistic signal model is closer to optimal.
- the information concerning the values of the weighting coefficients may be transmitted as side information in the form of one or more quantization indices.
- the information about the combined distribution model may be transmitted in the form of a model index, which will then be used at a decoder or apparatus for decoding the transmitted data or stored at the encoder.
- the weighting coefficients may be biased for minimizing the propagation of errors caused by packet loss and channel errors.
- the weighting coefficient affected to the first distribution model may be biased towards a value of zero or compared to a threshold value below which it is set to zero.
- An advantage of the present invention is to provide methods and devices for encoding and decoding audio signals that present low delay, low bit rate in average and low rate variations.
- the present invention is suitable for both constrained-resolution quantization and constrained-entropy quantization.
- the invention has broad applications for audio coding, in particular coding based on variable bit rate. It is applicable to low delay audio coding, where backward model adaptation is often selected to reduce the bit rate. Low delay coding is applicable in, for example, a scenario where the listener perceives an audio signal both through an acoustic path and through a communication network or for inter-ear communication for hearing aids, where delay affects spatial perception.
- FIG. 1 shows an apparatus for encoding an input signal according to an embodiment of the present invention
- FIG. 2 shows an apparatus for encoding an input signal according to another embodiment of the present invention
- FIG. 3 shows an apparatus for decoding a sequence of coded data according to an embodiment of the present invention
- FIG. 4 shows an apparatus for decoding a sequence of coded data according to another embodiment of the present invention
- FIG. 5 shows a modeller according to an embodiment of the present invention, which modeller is used in an apparatus for encoding in accordance with the present invention
- FIG. 6 shows a modeller according to another embodiment of the present invention, which modeller is used in an apparatus for decoding in accordance with the present invention.
- FIG. 1 With reference to FIG. 1 , a first aspect of the present invention will be described.
- FIG. 1 shows an apparatus or system 10 for encoding an input signal 120 , such as a digital audio signal or speech signal.
- the input signal 120 is processed on a segment-by-segment (block-by-block) basis.
- a signal model suitable for encoding a current signal segment of the input signal 120 in an encoder 119 is provided by a modeller 113 , also called probabilistic modeller 113 in the following.
- the signal model output from the modeller 113 is also called probabilistic model or combined distribution model in the following and corresponds to a probabilistic model of the joint distribution of the signal samples or segments.
- the modeller 113 obtains the combined distribution model by adding at least one first distribution model and at least one fixed distribution model, each of the distribution models being multiplied by a weighting coefficient.
- the first distribution model is associated with model parameters extracted by an extracting means 118 from a reconstructed signal 121 , which reconstructed signal 121 is the output of the signal quantizer 104 processed optionally by a reconstructing means or post-processing means 117 to approximate past segments of the input signal 120 .
- the modeller 113 obtains the combined distribution model by combining at least one first distribution model based on the reconstructed signal 121 and one or more fixed distribution models. Examples of a reconstructing means 117 and an extracting means 118 will be described in more detail with reference to FIG. 2 . The structure of the modeller 113 will be explained in more detail with reference to FIG. 5 .
- the encoding of the current segment of the input signal 120 is performed at the encoder 119 which uses the combined distribution model output from the modeller 113 .
- the encoded signal or sequence of coded data output by the encoder 119 is provided to a multiplexer 116 , which generates a bit stream 124 .
- information about the combined distribution model is also provided to the multiplexer 116 and included in the bit stream 124 .
- the input signal 120 may be pre-processed by a pre-processing means 125 , which addresses perceptual and blocking (segmentation) effects.
- the pre-processing means 125 will be explained in more detail with reference to FIG. 2 .
- the pre-processing means 125 and the post-processing means 117 form a matching pair. If no pre-processing means and post-processing means are used, the output of the quantizer 104 is the quantized speech signal itself.
- the encoder 119 includes a quantizer 104 and a first codeword generator 109 .
- the quantizer 104 generates indices and the first codeword generator 109 converts a sequence of these indices into codewords. Each codeword may correspond to one or more indices.
- the quantizer 104 can be either a constrained-resolution quantizer, a constrained-entropy quantizer or any other kind of quantizer. For the purpose of illustration, a constrained-resolution quantizer and a constrained-entropy quantizer are discussed. In the case of constrained-resolution quantization, the number of allowed reconstruction (dequantized) points is fixed and the quantizer 104 is dependent on the combined distribution model, i.e.
- the quantizer 104 operates using the combined distribution model.
- the first codeword generator 109 generates one codeword per index, and all codewords have the same length in bits.
- all quantization cells have a fixed size, thereby facilitating the quantization.
- the size of the quantization cells can be scaled with the variance of the combined distribution model created by the modeller 113 in order to scale the expected distortion with the input signal 120 or can be fixed in order to obtain a fixed distortion.
- the first codeword generator 109 operates using the combined distribution model and generates codewords of unequal length or codewords that describe many indices.
- the probability of the indices is estimated based on the combined distribution model provided by the modeller 113 in order to generate codewords having minimal average length per index.
- the first codeword generator 109 is set to achieve an encoding having an average rate that is close to the entropy of the indices (which corresponds to a method called entropy coding, also called lossless coding), for which the well-known Huffman or arithmetic coding techniques can be used.
- the weighting coefficients affected to each of the distribution models are selected by the modeller 113 for minimizing a code length or estimated code length corresponding to the current signal segment.
- the manner of combining the distribution model based on the reconstructed signal 121 of the input signal 120 with the fixed distribution model characteristic of the input signal 120 is specified by a model index 123 .
- information about the combined distribution model such as the weighting coefficients affected to each of the distribution models (the first and fixed distribution models), is specified in the model index 123 .
- the model index 123 may be encoded in a second codeword generator 100 and provided to the multiplexer 116 to be included in the bit stream 124 . If the lossless coding is used for the first codeword generator 109 , it is then preferable to use the same technique for the second codeword generator 100 .
- the bit stream 124 includes the encoded signal or sequence of coded data and the information about the combined distribution model used to encode the current signal segment, i.e. the model index 123 .
- the bit stream 124 may then be transmitted to a decoder 30 , which will be described with reference to FIG. 3 , or stored at the apparatus 10 for encoding.
- the model index may be transmitted as side information in the form of a coded model index specifying at least the weighting coefficients.
- FIG. 2 shows a system or apparatus 20 for encoding an input signal 120 , such as a digital audio signal or speech signal, which apparatus 20 is equivalent to the apparatus 10 described with reference to FIG. 1 except that examples of a pre-processing means 125 , a reconstructing means 117 and an extracting means 118 are illustrated in more detail.
- the apparatus 20 as well as the apparatus 10 , may be used as a backward adaptive, variable rate, low delay audio coder.
- the apparatus 20 for encoding operates also on a block-by-block basis.
- the input signal 120 or digital audio signal 120 may be sampled at 16000 Hz, and a typical block size would be 0.25 ms, or 4 samples.
- the processing steps of the encoder may be summarized as: (1) perceptual weighting, (2) two-stage decorrelation, (3) constrained-entropy quantization, and (4) entropy coding.
- the extracting means 118 includes a linear predictive (LP) analyzer 110 performing a linear predictive analysis (equivalent to a particular estimation method of autoregressive model parameters) of the most recent segment of a reconstructed signal 121 generated from past segments of the input signal 120 in the reconstructing means 117 .
- the prediction order may be set to 32, thereby capturing some of the spectral fine-structure of the input signal 120 . It is preferable for the LP analyzer 110 to operate on the reconstructed signal 121 because no delay is required for the analysis.
- a signal similar to the reconstructed signal 121 can also be available at a decoder, such as the decoders 30 or 40 that will be described with reference to FIGS. 3 and 4 , respectively, without transmission of side information.
- the reconstructed signal 121 which is input to the LP analyzer 110 may be first windowed using an asymmetric window as defined in ITU-T Recommendation G.728.
- the autocorrelation function for the windowed signal is computed and the predictor coefficients may be computed using e.g. the well-known split Levinson algorithm.
- A(z) the transfer function of the prediction-error filter corresponding to the set of prediction coefficients extracted by the LP analyzer 110 .
- the signal i.e. the current signal segment
- the signal first passes through a perceptual weighting filter 101 .
- the filtered signal segment may then be corrected by a first correcting means or adder 114 that subtracts a (closed-loop) zero-input response that is described in more detail below, transformed in a transformer 102 and normalized by a normalization means 103 .
- the normalized signal segment may be quantized in the quantizer 104 of the encoder 119 before it enters the reconstructing means 117 . It is to be noted that the first correcting means 114 and the normalization means 103 are optional elements of the pre-processing means 125 .
- the perceptual weighting filter 101 transforms the digital audio signal 120 from a signal domain to a “perceptual” domain, in which minimizing the squared error of quantization approximates minimizing the perceptual distortion.
- a conventional perceptual weighting filter depends on the autoregressive model of the signal, i.e. the model parameters extracted from the reconstructed signal 121 , and has the following transfer function:
- W ⁇ ( z ) A ⁇ ( z / ⁇ 1 ) A ⁇ ( z / ⁇ 2 ) , ( 1 )
- ⁇ 1 and ⁇ 2 are scalars having values comprised between 0 and 1.
- This filter is computed in perceptual weighting adaptation 111 .
- these scalars ⁇ 1 and ⁇ 2 may be set to 0.9 and 0.7, respectively.
- the next two processing steps of the pre-processing means 125 shown in FIG. 2 are a prediction of the segment and a transform of the segment, which both aim at decorrelation, thereby forming a two-stage decorrelation.
- a first stage is based on linear prediction and a second stage is based on a unitary transform.
- An advantage provided by linear prediction is the possibility to remove long-range correlations independently of the block length.
- a transform can not remove correlations over separations longer than the block length.
- long blocks imply long delay.
- An advantage of transform coding, when based on a unitary transform is that the shape of the quantization cells is not affected by the transform.
- transform coding it can benefit of the so-called reverse waterfilling, where the rate is zero in dimensions where the input signal 120 has a lower variance than the signal error.
- linear prediction is used to remove inter-block correlations by means of subtracting the zero-input response and unitary transform is used to remove within-block correlations.
- unitary transform is used to remove within-block correlations.
- the prediction step is carried out by a linear predictor or response computer 107 and the first correcting means or adder 114 .
- the linear prediction of the perceptually weighted signal from the past reconstructed perceptually weighted signal by the linear predictor 107 corresponds to the computation of the zero-input response 122 .
- the zero-input response is the zero input response of a cascade of the inverse of the prediction-error filter and the perceptual weighting filter (see equation (1)): W(z)/A(z).
- the first correcting means or adder 114 then performs a subtraction of zero-input response 122 for the current signal block or segment. The subtraction of the zero-input response is aimed at removing correlations between adjacent signal blocks (segments).
- the matrix U forms a model-based Karhunen-Loève transform (KLT) for the signal x.
- KLT Karhunen-Loève transform
- the KLT is enacted by multiplying the transpose of U on x.
- a normalization of the result would lead to a unit variance vector s, expressed as:
- variable-rate (constrained-entropy) coding it is preferable to use uniform quantization, which is optimal in the high-rate limit.
- uniform quantization For any particular average rate, a fixed scalar quantizer with uniform quantization step size may be used. The selection of scalar quantization is preferable since, asymptotically with increasing rate, the performance loss will not be more than 0.25 bit per sample over infinite-dimension vector quantization.
- either the average rate or the average distortion may be set as a constraint.
- the distortion may be set to a constant value equal to an average distortion.
- the average distortion is determined by the step size of the uniform scalar quantizer, which facilitates usage of the apparatus for encoding since one simply selects a step size.
- the average distortion is 1/12 of the square step size.
- the average-rate constraint requires that the combined distribution model is accurate.
- it is preferable to use a distortion constraint. Varying the value of the distortion constraint and measuring the resulting average rate over a range of distortions allows the selection of a desired bit rate with a certain numerical precision (distortion).
- the first codeword generator 109 may be an entropy coder based on an arithmetic coding method.
- the entropy coder receives the probability density of the symbols, i.e. the combined distribution model, from the probabilistic modeller 113 , the quantized signal values and the quantization step size from the quantizer 104 . It is preferable to use an arithmetic coding since it is possible to compute the codeword of a single quantized signal vector s using the combined distribution model without the need of computing other codewords. Thus, if the distribution changes, it is not necessary to update the entire set of all possible codewords in the method of the present invention.
- model probability function is selected to be of a simple form, as it generally is the case, then the summation can be replaced by an analytic integration, thereby reducing the computational effort.
- the arithmetic coding method can be generalized to the vector quantization case, which usually is associated with a truncation of the region of support.
- the arithmetic coder buffer depth can be bound using standard methods (e.g., a non-existing source symbol is introduced to enact a flushing of the buffer).
- the output of the first codeword generator 109 and the model index 123 output from the second codeword generator 100 are multiplexed in the multiplexer 116 into a bit stream 124 .
- This bit stream 124 may be transmitted to a receiver, such as a decoder, or stored at the apparatus 10 or 20 for encoding.
- the multiplexing should be done in such a way that the decoder is able to distinguish between the bits describing the model and the bits describing the data. For the constrained-resolution case, where the signal samples and the model index each have fixed codeword length, this is a simple alternation of sets of codewords for a set of signal samples with codewords for a model index.
- arithmetic coding this is most conveniently done by combining the first codeword generator 109 and the second codeword generator 100 into a single codeword generator and interlacing the parameters to be encoded as input to the combined codeword generator.
- signal segments are coded by the arithmetic code as a single codeword (i.e, with an end-of-sequence termination) by the first codeword generator 109 , alternated by the corresponding independent encoding of a set of model indices (also with an end-of-sequence termination) by the second codeword generator 100 .
- a third method fixed-rate coding is used for the model index and arithmetic coding is used for the signal samples, and each fixed-length codeword for the model index is inserted as soon as the encoding of a corresponding signal segment of samples is completed in the sense that the signal segment of samples can be decoded from the bitstream.
- the third method results in an arithmetic code for the signal samples that is interlaced with model index samples, without requiring additional bits for separating the bitstreams containing information for the dequantizer 204 and the modeller 213 .
- the reconstructed signal 121 is formed by processing the quantized segments produced by the quantizer 104 in the reconstructing means 117 , which reconstructing means 117 includes components performing the inverse operations of the components of the pre-processing means 125 .
- the reconstructing means 117 may include a denormalization means 105 for performing a denormalization of the signal segment, an inverse transformer 106 for applying an inverse transform to the denormalized signal segment, a second correcting means or adder 115 that adds back the zero-input response to the inversely transformed signal segment, and an inverse weighting filter 108 for applying an inverse filter to the corrected signal segment.
- the reconstruction operators may also be updated from the reconstructed signal 121 . It is to be noted that the normalization means and the correcting means are optional components of the reconstructed means 117 .
- FIG. 3 shows a decoder or apparatus 30 for decoding a bit stream 124 of coded data which may be received from the coder or apparatus 10 or 20 for encoding described with reference to FIG. 1 or 2 , respectively.
- the bit stream is received by a demultiplexer 214 that splits the bit stream in information about a combined distribution model and a bit stream corresponding to a current sequence of coded data, i.e. quantization indices for a current signal segment of the input signal 120 , pre-processed by the pre-processing means 125 such as described with reference to FIGS. 1 and 2 .
- the current sequence of coded data is provided to a decoder 219 , which uses a combined distribution model provided by a modeller 213 in order to output a sequence of decoded data.
- the quantization indices input in the decoder 219 specify quantized subsegments.
- the modeller 213 obtains the combined distribution model by adding at least one first distribution model with which model parameters are associated and at least one fixed distribution model.
- the model parameters are extracted by an extracting means 218 from an existing part of a reconstructed signal 221 which corresponds to past sequences of the bit stream 124 .
- the reconstructed signal 221 is generated by a reconstructing means 217 which will be described in more detail with reference to FIG. 4 in the following.
- the information about the combined distribution model which may be received in the form of a model index, includes at least weighting coefficients and is provided to the modeller 213 .
- the modeller 213 can then affect the weighting coefficients to the corresponding distribution models (the first and fixed distribution models) in accordance with the model index 223 for obtaining the combined distribution model.
- the extracting means 218 allows the probabilistic modeller 213 to create a combined distribution model in a similar manner as the extracting means 118 described with reference to FIG. 1 or 2 .
- the decoder 219 includes a first codeword interpreter 209 , which outputs quantization indices, and a dequantizer 204 , which outputs the sequence of decoded data, i.e. the quantized current signal segment.
- the dequantizer computes the quantized data from the quantization indices.
- the reconstructing means 217 performs the inverse process of the pre-processing means 125 described with reference to FIG. 1 or 2 on a segment-by-segment basis, thereby rendering a reconstructed signal 221 in response to the sequence of decoded data provided by the dequantizer 204 .
- the reconstructed signal 221 can then output a part of the reconstructed signal 221 from the current sequence of decoded data, thereby the reconstructed signal 221 is continuously updated.
- a second codeword interpreter 200 may be arranged between the demultiplexer 214 and the modeller 213 in order to decode the coded model index or coded information about the combined distribution model and provide this information or model index to the modeller 213 .
- the model index specifies information about the combined distribution model and in particular a set of weighting coefficients.
- the modeller provides a combined distribution model 424 to the first codeword interpreter 209 and/or to the dequantizer 204 .
- the combined distribution model specifies the set of reconstruction points used in the dequantizer 204 .
- the first codeword interpreter 209 provides the index for a particular point and this point is then determined in the dequantizer 204 .
- the set of reconstruction points of the constrained-resolution quantizer is spaced with a spacing that is the inverse of the local density of reconstruction points as computed by standard high-rate quantization theory based on the combined distribution model 424 provided by the modeller 213 .
- the index information is used to determine the correct quantization index in the first codeword interpreter 209 using the combined distribution model provided by the modeller 213 .
- This quantization index is then used in the dequantizer 204 to select one of the reconstruction points of the uniform constrained-entropy quantizer.
- the reconstruction points of the dequantizer 204 are identical to the reconstruction points of the quantizer 104 , and it could be considered that the dequantizer 204 is identical to a component of the quantizer 104 .
- FIG. 4 shows a system or apparatus 40 for decoding a bit stream 124 of coded data, which apparatus 40 is equivalent to the apparatus 30 described with reference to FIG. 3 except that examples of a reconstructed means 217 and an extracting means 218 are illustrated in more detail.
- the reconstructed means 217 is equivalent to the reconstructed means 117 described with reference to FIG. 2 and may include a denormalization means 205 , an inverse transformer 206 such as an inverse KLT transformer 206 , a correcting means or adder 215 , a response computer 207 and an inverse weighting filter 218 .
- the extracting means 218 is equivalent to the extracting means 118 described with reference to FIG. 2 and may include a LP analyser 210 , a perceptual weighting adaptation means 211 and an SVD 212 .
- FIG. 5 An example of a modeller 113 of the apparatus 10 or 20 for encoding, such as described with reference to FIG. 1 or 2 , will now be described with reference to FIG. 5 .
- the probabilistic modeller 113 determines a probabilistic model or combined distribution model for the quantization indices.
- the probabilistic model is based on the autoregressive signal model corresponding to the linear prediction coefficients estimated by the LP analyzer 110 and the perceptual weighting computed in adaptation 115 .
- the entropy coder 109 can define the code words that are to be transmitted or stored.
- the optimal description length used to describe the current signal segment with a particular probabilistic model can be estimated via a summation of the code length of the quantized signal and the length used for describing the model.
- the resulting length called description length in the following, can be used as a means for selecting the model.
- the description length may be evaluated based on high-rate quantization theory assumptions (which correspond to an approximation of most normal cases) and be expressed as:
- l i max ⁇ ⁇ - ⁇ j ⁇ ⁇ log ⁇ ( p S j ⁇ M ⁇ ( s j ⁇ M i ) ⁇ ⁇ ) , 0 ⁇ + L ⁇ ( M i ) , ( 8 )
- M i ) denotes the probability density of the scalar signal component s j given a particular model M i
- ⁇ is the quantization step size
- L(M i ) is the description length needed for the parameters of the particular model.
- the sum in equation (8) is over all scalar signal components comprising the signal segment of signal 120 after preprocessing (including transformation) and quantization.
- Equation (8) clearly illustrates the effect of reverse waterfilling, i.e. a component p s i
- the probability density model used in the present invention is a mixture (weighted sum) of a backward adapted probability density and one or more other component probability densities.
- Each joint probability density model is a mixture model resulting in a combined distribution model.
- the distribution models may share the same mixture components, wherein only the weights or weighting coefficients of the components vary, as illustrated in the following equation:
- M i ) represents a probability distribution, the sum of the weights or weighting coefficients is equal to unity.
- the set of weights or weighting coefficients forms a probability distribution for the component probability densities.
- two or three component probability densities may be used.
- the combined distribution model is obtained by adding at least one first distribution model with which the model parameters extracted from the reconstructed signal 121 are associated and at least one fixed distribution model. Weighting coefficients are affected to and multiplied by each of these distribution models. The sum of these weighted distribution models results in the combined distribution model.
- the combined distribution model is obtained by adding at least one first Gaussian distribution model generated in the first distribution generator 303 based on the autoregressive model parameters extracted from the reconstructed signal 121 , at least one fixed uniform distribution model generated in the second distribution generator 301 and at least one adaptive uniform distribution model generated in the adaptive distribution generator 302 , selected in response to the extracted autoregressive model parameters.
- weighting coefficients are affected to and multiplied by each of the corresponding distribution models for a summation.
- any arbitrary number of component probability densities may be used.
- a quantized version of the weighting coefficients or a weight vector representing the weighting coefficients is transmitted or is stored together with the sequence of coded data.
- a constrained-entropy quantization procedure may be used to quantize the weight vectors in order to optimize performance.
- the quantizer weight vectors have a low bit rate, it is reasonable to use a constrained-resolution quantizer for the weight vectors even when constrained-entropy coding is used for the signal segments.
- the number L(M i ) in equation (8) is fixed. In the example shown in FIG.
- three component distribution densities generated in a first 303 , a second 301 and a third 302 generator, are weighted and summed before the resulting mixture density function, i.e. the combined distribution model, is used to estimate the description length in a description length estimator 305 .
- the estimator 305 receives a segment of the preprocessed quantized signal 321 from the codeword generator 109 , comprising the set of scalars s j for equation (8).
- the first generator 303 may generate a Gaussian distribution model obtained from the model parameters through the SVD operator 112 .
- the model parameters are associated with the Gaussian model and may represent the variance of the Gaussian distribution.
- the second generator 301 may generate a fixed distribution model, which may be a uniform distribution with a range that equals the range of the digital representation of the input signal 120 .
- the third generator 302 may generate an adaptive distribution model selected in response to the model parameters extracted from the reconstructed signal 121 .
- the distribution model generated by the third generator 302 may be a uniform distribution which is adaptive with a range corresponding to 12 times the range of the standard deviation of the corresponding Gaussian distribution generated by the first generator 301 .
- the uniform distribution components remove precision problems associated with the Gaussian density.
- one of the distribution models is adapted for large deviation and one of the other models is adapted for small deviation.
- the weight vectors and codewords are affected to the distribution models by a weight codebook 304 .
- the probabilistic modeller 113 searches through every entry or set of values of weighting coefficients of the weight codebook 304 and selects the set of weighting coefficients leading to the shortest description length. Then, the combined distribution model 324 which corresponds to the sum of the different distribution models generated by the generators 301 - 303 , each of the model being multiplied by its respective weighting coefficient, is sent to the entropy coder 109 .
- modeller 213 of the apparatus 30 or 40 for decoding is described in more detail.
- the probabilistic modeller 213 receives the model index 223 and generates the combined distribution model 424 used by the first codeword interpreter 209 and the dequantizer 204 .
- the modeller 213 is equivalent to the modeller 113 described with reference to FIG. 5 except that the modeller 213 of the apparatus for decoding does not include a description length estimator.
- the modeller 213 includes a first generator 403 for generating a first Gaussian distribution model based on the autoregressive model parameters, a second generator 401 for generating a fixed distribution model and may further include a third generator 402 for generating an adaptive uniform distribution model selected in response to the autoregressive model parameters. These model parameters are extracted by the extracting means 218 from the reconstructed signal 221 generated by the reconstructing means 217 .
- the first distribution model 403 may be a Gaussian distribution model and the extracted model parameters provided by the extracting means 218 are parameters of the Gaussian distribution model.
- the fixed distribution model may be a uniform signal model, which is characteristic of the input signal 120 .
- the weighting coefficients are affected to each of these distribution models in accordance with the model index 223 decoded by the second codeword interpreter 200 .
- backward adaptive encoding enables to reduce bit rate
- this type of encoding may present poor robustness against channel errors in the form of bit errors and/or packet loss.
- One of the reasons may be that the reconstructed signal segment is used for analysis. This type of error will be referred to as error propagation through analysis in the following.
- Another reason may be that the subtraction of the zero-input response propagates past signal errors. This type of errors decays if the filters are stable and will be referred to as error propagation through filtering in the following.
- weighting coefficient for a probabilistic density is zero for a time segment longer than the window length of the backward adaptive analysis, then the error propagation through analysis is stopped. This can be implemented by biasing the set of weights if channel errors are anticipated.
- the threshold values can be adapted, either in real-time or off-line, such that a desired level of robustness is achieved. It is noted that as the quality of the reconstructed signal 121 does not vary with the combined distribution model used (the rate does), the bias can be enacted both during background or foreground signals.
- a plurality of fixed probabilistic signal models that are commonly seen in the input signal 120 may be introduced as components of the combined distribution model in addition to the fixed distribution model generated in by the third generators 302 and 402 .
- Error propagation through filtering is generally a lesser problem.
- Most common methods used to estimate autoregressive model parameters through linear-predictive analysis lead to stable filters, which implies that errors in the contributions of the zero-input response decay without additional effort.
- a channel is particularly poor, it can be ensured that the zero-input response decays more rapidly by e.g. considering the zero-input response as a summation of responses to previous individual blocks. For each block the response can then be windowed, so that it has a finite support and, therefore, does not ring beyond a small number of samples. When this is done consistently at the encoder and the decoder, then error propagation through filtering is significantly diminished.
- a computer readable medium having computer executable instructions for carrying out, when run on a processing unit, each of the steps of the method for encoding described above is provided, and a computer readable medium having computer executable instructions for carrying out, when run on a processing unit, each of the steps of the method for decoding described above is provided.
Abstract
Description
where γ1 and γ2 are scalars having values comprised between 0 and 1. This filter is computed in
x=σHe, (2)
where e is regarded as a white Gaussian process with unit power, σ is the standard deviation of e, and H denotes an impulse response matrix, which matrix has the following form:
where {hi}i=0 p−1 are the first p quantities in a normalized unit impulse response sequence of a cascade of the synthesis (inverse prediction-error) filter and the perceptual weighting filter W(z)/A(z) where h0 is set to 1 because of normalization. These p quantities are based on the output of the
H=UΛV, (4)
where U and V are unitary matrices, and Λ is a diagonal matrix. This operation is performed in the
wherein the covariance of the vector s is expressed as:
R=E{ssT}=Λ2. (6)
Thus, assuming accuracy of the probabilistic signal model, the components of the vector s are decorrelated, and the variance of each resulting component is defined by the corresponding diagonal element in Λ. The normalization of and equation (6) results in:
det(R)=1. (7)
where ps
Each joint probability density model is a mixture model resulting in a combined distribution model. The distribution models may share the same mixture components, wherein only the weights or weighting coefficients of the components vary, as illustrated in the following equation:
where the coefficient set {wi1, . . . , wik} correspond to the weighting coefficients affected to the various components of the combined distribution model. As pS|M(s|Mi) represents a probability distribution, the sum of the weights or weighting coefficients is equal to unity. Thus, the set of weights or weighting coefficients forms a probability distribution for the component probability densities. As an example, two or three component probability densities may be used. In a first example, the combined distribution model is obtained by adding at least one first distribution model with which the model parameters extracted from the reconstructed
Claims (59)
Priority Applications (1)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US12/671,631 US8463615B2 (en) | 2007-07-30 | 2008-06-23 | Low-delay audio coder |
Applications Claiming Priority (5)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US93518307P | 2007-07-30 | 2007-07-30 | |
EP07113397 | 2007-07-30 | ||
EP07113397A EP2023339B1 (en) | 2007-07-30 | 2007-07-30 | A low-delay audio coder |
PCT/EP2008/057970 WO2009015944A1 (en) | 2007-07-30 | 2008-06-23 | A low-delay audio coder |
US12/671,631 US8463615B2 (en) | 2007-07-30 | 2008-06-23 | Low-delay audio coder |
Publications (2)
Publication Number | Publication Date |
---|---|
US20110224975A1 US20110224975A1 (en) | 2011-09-15 |
US8463615B2 true US8463615B2 (en) | 2013-06-11 |
Family
ID=44560788
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
US12/671,631 Active 2030-08-22 US8463615B2 (en) | 2007-07-30 | 2008-06-23 | Low-delay audio coder |
Country Status (1)
Country | Link |
---|---|
US (1) | US8463615B2 (en) |
Families Citing this family (11)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
EP2313986A1 (en) * | 2008-08-13 | 2011-04-27 | Nokia Siemens Networks Oy | Method of generating a codebook |
US9854377B2 (en) | 2013-05-29 | 2017-12-26 | Qualcomm Incorporated | Interpolation for decomposed representations of a sound field |
US9922656B2 (en) | 2014-01-30 | 2018-03-20 | Qualcomm Incorporated | Transitioning of ambient higher-order ambisonic coefficients |
US10770087B2 (en) | 2014-05-16 | 2020-09-08 | Qualcomm Incorporated | Selecting codebooks for coding vectors decomposed from higher-order ambisonic audio signals |
US10762417B2 (en) * | 2017-02-10 | 2020-09-01 | Synaptics Incorporated | Efficient connectionist temporal classification for binary classification |
US10762891B2 (en) * | 2017-02-10 | 2020-09-01 | Synaptics Incorporated | Binary and multi-class classification systems and methods using connectionist temporal classification |
US11087213B2 (en) * | 2017-02-10 | 2021-08-10 | Synaptics Incorporated | Binary and multi-class classification systems and methods using one spike connectionist temporal classification |
US11100932B2 (en) * | 2017-02-10 | 2021-08-24 | Synaptics Incorporated | Robust start-end point detection algorithm using neural network |
US11853884B2 (en) * | 2017-02-10 | 2023-12-26 | Synaptics Incorporated | Many or one detection classification systems and methods |
US11080600B2 (en) * | 2017-02-10 | 2021-08-03 | Synaptics Incorporated | Recurrent neural network based acoustic event classification using complement rule |
US10762427B2 (en) * | 2017-03-01 | 2020-09-01 | Synaptics Incorporated | Connectionist temporal classification using segmented labeled sequence data |
Citations (7)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US6115689A (en) * | 1998-05-27 | 2000-09-05 | Microsoft Corporation | Scalable audio coder and decoder |
EP1355298A2 (en) | 1993-06-10 | 2003-10-22 | Oki Electric Industry Company, Limited | Code Excitation linear prediction encoder and decoder |
US20040068401A1 (en) * | 2001-05-14 | 2004-04-08 | Jurgen Herre | Device and method for analysing an audio signal in view of obtaining rhythm information |
US20050012648A1 (en) | 2003-07-17 | 2005-01-20 | Detlev Marpe | Apparatus and methods for entropy-encoding or entropy-decoding using an initialization of context variables |
US20050031219A1 (en) * | 2002-09-06 | 2005-02-10 | The Regents Of The University Of California | Encoding and decoding of digital data using cues derivable at a decoder |
US20070016418A1 (en) | 2005-07-15 | 2007-01-18 | Microsoft Corporation | Selectively using multiple entropy models in adaptive coding and decoding |
US7583730B2 (en) * | 2000-12-15 | 2009-09-01 | Microsoft Corporation | Drifting reduction and macroblock-based control in progressive fine granularity scalable video coding |
-
2008
- 2008-06-23 US US12/671,631 patent/US8463615B2/en active Active
Patent Citations (8)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
EP1355298A2 (en) | 1993-06-10 | 2003-10-22 | Oki Electric Industry Company, Limited | Code Excitation linear prediction encoder and decoder |
US6115689A (en) * | 1998-05-27 | 2000-09-05 | Microsoft Corporation | Scalable audio coder and decoder |
US6256608B1 (en) * | 1998-05-27 | 2001-07-03 | Microsoa Corporation | System and method for entropy encoding quantized transform coefficients of a signal |
US7583730B2 (en) * | 2000-12-15 | 2009-09-01 | Microsoft Corporation | Drifting reduction and macroblock-based control in progressive fine granularity scalable video coding |
US20040068401A1 (en) * | 2001-05-14 | 2004-04-08 | Jurgen Herre | Device and method for analysing an audio signal in view of obtaining rhythm information |
US20050031219A1 (en) * | 2002-09-06 | 2005-02-10 | The Regents Of The University Of California | Encoding and decoding of digital data using cues derivable at a decoder |
US20050012648A1 (en) | 2003-07-17 | 2005-01-20 | Detlev Marpe | Apparatus and methods for entropy-encoding or entropy-decoding using an initialization of context variables |
US20070016418A1 (en) | 2005-07-15 | 2007-01-18 | Microsoft Corporation | Selectively using multiple entropy models in adaptive coding and decoding |
Non-Patent Citations (3)
Title |
---|
Jean-Luc Garcia et al., "Backward Linear Prediction for Lossless Coding of Stereo Audio", Audio Engineering Society E-Library, May 8, 2004, XP0102463607, pp. 1-7. |
Matthew V. Mahoney, "Adaptive Weighing of Context Models for Lossless Data Compression" Technical Report CS-2005-16, [Online] 2005, XP002463606, Retrieved from the Internet: URL:http://www.cs.fit/edu/{mmahoney/compression/cs200516.pdf>[retrieved on Dec. 22, 2007]. |
Minyue Li et al., "A Low-Delay Audio Coder with Constrained-Entropy Quantization" 2007 IEEE Workshop on Applications of Signal Processing to Audio and Acoustics, Oct. 21-24, 2007, pp. 191-194, XP008087029. |
Also Published As
Publication number | Publication date |
---|---|
US20110224975A1 (en) | 2011-09-15 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
US8463615B2 (en) | Low-delay audio coder | |
US6721700B1 (en) | Audio coding method and apparatus | |
US11978460B2 (en) | Truncateable predictive coding | |
KR101430118B1 (en) | Audio or video encoder, audio or video decoder and related methods for processing multi-channel audio or video signals using a variable prediction direction | |
US7392195B2 (en) | Lossless multi-channel audio codec | |
US7756350B2 (en) | Lossless encoding and decoding of digital data | |
EP2301022B1 (en) | Multi-reference lpc filter quantization device and method | |
US8396706B2 (en) | Speech coding | |
KR20080049116A (en) | Audio coding | |
EP1806737A1 (en) | Sound encoder and sound encoding method | |
EP2270774B1 (en) | Lossless multi-channel audio codec | |
KR20090007396A (en) | Method and apparatus for lossless encoding of a source signal, using a lossy encoded data stream and a lossless extension data stream | |
KR20040028750A (en) | Method and system for line spectral frequency vector quantization in speech codec | |
US8239210B2 (en) | Lossless multi-channel audio codec | |
EP2023339B1 (en) | A low-delay audio coder | |
US20120072207A1 (en) | Down-mixing device, encoder, and method therefor | |
US9548057B2 (en) | Adaptive gain-shape rate sharing | |
US20110137661A1 (en) | Quantizing device, encoding device, quantizing method, and encoding method | |
EP2309493B1 (en) | Coding and decoding of source signals using constrained relative entropy quantization | |
EP3610481B1 (en) | Audio coding | |
CN102436822B (en) | Signal control device and method | |
WO2014198724A1 (en) | Apparatus and method for audio signal envelope encoding, processing and decoding by splitting the audio signal envelope employing distribution quantization and coding | |
Kırbız et al. | Perceptual coding-based informed source separation | |
JP3099876B2 (en) | Multi-channel audio signal encoding method and decoding method thereof, and encoding apparatus and decoding apparatus using the same | |
Hernandez-Gomez et al. | High-quality vector adaptive transform coding at 4.8 kb/s |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
AS | Assignment |
Owner name: GLOBAL IP SOLUTIONS (GIPS) AB, SWEDENFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:LI, MINYUE;KLEIJN, WILLEM BASTIAAN;REEL/FRAME:024104/0170Effective date: 20100302Owner name: GLOBAL IP SOLUTIONS, INC., CALIFORNIAFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:LI, MINYUE;KLEIJN, WILLEM BASTIAAN;REEL/FRAME:024104/0170Effective date: 20100302 |
|
AS | Assignment |
Owner name: GLOBAL IP SOLUTIONS, INC., CALIFORNIAFree format text: CHANGE OF NAME;ASSIGNOR:GLOBAL IP SOUND, INC.;REEL/FRAME:026844/0188Effective date: 20070221 |
|
AS | Assignment |
Owner name: GLOBAL IP SOLUTIONS (GIPS) AB, SWEDENFree format text: CHANGE OF NAME;ASSIGNOR:GLOBAL IP SOUND EUROPE AB;REEL/FRAME:026883/0928Effective date: 20040317 |
|
AS | Assignment |
Owner name: GOOGLE INC., CALIFORNIAFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:GLOBAL IP SOLUTIONS (GIPS) AB;GLOBAL IP SOLUTIONS, INC.;REEL/FRAME:026944/0481Effective date: 20110819 |
|
FEPP | Fee payment procedure |
Free format text: PAYOR NUMBER ASSIGNED (ORIGINAL EVENT CODE: ASPN); ENTITY STATUS OF PATENT OWNER: LARGE ENTITY |
|
STCF | Information on status: patent grant |
Free format text: PATENTED CASE |
|
FPAY | Fee payment |
Year of fee payment: 4 |
|
AS | Assignment |
Owner name: GOOGLE LLC, CALIFORNIAFree format text: CHANGE OF NAME;ASSIGNOR:GOOGLE INC.;REEL/FRAME:044101/0299Effective date: 20170929 |
|
MAFP | Maintenance fee payment |
Free format text: PAYMENT OF MAINTENANCE FEE, 8TH YEAR, LARGE ENTITY (ORIGINAL EVENT CODE: M1552); ENTITY STATUS OF PATENT OWNER: LARGE ENTITYYear of fee payment: 8 |