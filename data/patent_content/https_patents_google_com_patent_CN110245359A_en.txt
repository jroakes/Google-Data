CN110245359A - Parallel decoding is carried out using autoregression machine learning model - Google Patents
Parallel decoding is carried out using autoregression machine learning model Download PDFInfo
- Publication number
- CN110245359A CN110245359A CN201910418720.2A CN201910418720A CN110245359A CN 110245359 A CN110245359 A CN 110245359A CN 201910418720 A CN201910418720 A CN 201910418720A CN 110245359 A CN110245359 A CN 110245359A
- Authority
- CN
- China
- Prior art keywords
- prediction
- model
- output
- token
- independent
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Granted
Links
- 238000010801 machine learning Methods 0.000 title abstract description 4
- 238000000034 method Methods 0.000 claims abstract description 45
- 230000001537 neural effect Effects 0.000 claims description 6
- 210000005036 nerve Anatomy 0.000 claims description 3
- 238000004590 computer program Methods 0.000 abstract description 11
- 230000008569 process Effects 0.000 description 17
- 238000005516 engineering process Methods 0.000 description 15
- 238000012545 processing Methods 0.000 description 15
- 230000001133 acceleration Effects 0.000 description 6
- 238000013519 translation Methods 0.000 description 6
- 238000012549 training Methods 0.000 description 5
- 230000015572 biosynthetic process Effects 0.000 description 3
- 238000004821 distillation Methods 0.000 description 3
- 230000005611 electricity Effects 0.000 description 3
- 230000003993 interaction Effects 0.000 description 3
- 238000010586 diagram Methods 0.000 description 2
- 238000002474 experimental method Methods 0.000 description 2
- 230000006872 improvement Effects 0.000 description 2
- 230000009467 reduction Effects 0.000 description 2
- 230000004044 response Effects 0.000 description 2
- 238000013515 script Methods 0.000 description 2
- 238000000926 separation method Methods 0.000 description 2
- 238000003786 synthesis reaction Methods 0.000 description 2
- 238000004458 analytical method Methods 0.000 description 1
- 230000003796 beauty Effects 0.000 description 1
- 230000008901 benefit Effects 0.000 description 1
- 230000005540 biological transmission Effects 0.000 description 1
- 238000004364 calculation method Methods 0.000 description 1
- 230000008859 change Effects 0.000 description 1
- 238000012512 characterization method Methods 0.000 description 1
- 238000006243 chemical reaction Methods 0.000 description 1
- 238000004891 communication Methods 0.000 description 1
- 150000001875 compounds Chemical class 0.000 description 1
- 238000000354 decomposition reaction Methods 0.000 description 1
- 230000007423 decrease Effects 0.000 description 1
- 230000002542 deteriorative effect Effects 0.000 description 1
- 230000035558 fertility Effects 0.000 description 1
- 230000010365 information processing Effects 0.000 description 1
- 239000004973 liquid crystal related substance Substances 0.000 description 1
- 238000004519 manufacturing process Methods 0.000 description 1
- 238000005259 measurement Methods 0.000 description 1
- 230000004048 modification Effects 0.000 description 1
- 238000012986 modification Methods 0.000 description 1
- 230000002040 relaxant effect Effects 0.000 description 1
- 238000004335 scaling law Methods 0.000 description 1
- 238000009958 sewing Methods 0.000 description 1
- 239000007787 solid Substances 0.000 description 1
- 239000000758 substrate Substances 0.000 description 1
- 230000001052 transient effect Effects 0.000 description 1
- 238000012795 verification Methods 0.000 description 1
- 230000000007 visual effect Effects 0.000 description 1
Classifications
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F40/00—Handling natural language data
- G06F40/40—Processing or translation of natural language
- G06F40/42—Data-driven translation
- G06F40/47—Machine-assisted translation, e.g. using translation memory
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N20/00—Machine learning
- G06N20/20—Ensemble learning
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F18/00—Pattern recognition
- G06F18/20—Analysing
- G06F18/21—Design or setup of recognition systems or techniques; Extraction of features in feature space; Blind source separation
- G06F18/217—Validation; Performance evaluation; Active pattern learning techniques
- G06F18/2178—Validation; Performance evaluation; Active pattern learning techniques based on feedback of a supervisor
- G06F18/2185—Validation; Performance evaluation; Active pattern learning techniques based on feedback of a supervisor the supervisor being an automated module, e.g. intelligent oracle
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F18/00—Pattern recognition
- G06F18/20—Analysing
- G06F18/22—Matching criteria, e.g. proximity measures
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F18/00—Pattern recognition
- G06F18/20—Analysing
- G06F18/24—Classification techniques
- G06F18/241—Classification techniques relating to the classification model, e.g. parametric or non-parametric approaches
- G06F18/2413—Classification techniques relating to the classification model, e.g. parametric or non-parametric approaches based on distances to training or reference patterns
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N20/00—Machine learning
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/04—Architecture, e.g. interconnection topology
- G06N3/045—Combinations of networks
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/08—Learning methods
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N7/00—Computing arrangements based on specific mathematical models
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V10/00—Arrangements for image or video recognition or understanding
- G06V10/70—Arrangements for image or video recognition or understanding using pattern recognition or machine learning
- G06V10/764—Arrangements for image or video recognition or understanding using pattern recognition or machine learning using classification, e.g. of video objects
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V10/00—Arrangements for image or video recognition or understanding
- G06V10/70—Arrangements for image or video recognition or understanding using pattern recognition or machine learning
- G06V10/82—Arrangements for image or video recognition or understanding using pattern recognition or machine learning using neural networks
Abstract
Parallel decoding is carried out using autoregression machine learning model this application involves a kind of.It provides for executing the mthods, systems and devices for generating the output from autoregressive sequence to series model in a parallel fashion, including the computer program encoded in computer storage medium.In an aspect, the fact that some frameworks can score to sequence within the sublinear time is utilized in block parallel coding/decoding method.By once generating the prediction for multiple time steps, the longest-prefix verified by Rating Model is then returned to, this method can substantially improve greedy decoded speed in the case where not influencing performance.
Description
Cross reference to related applications
The application requires the U.S. Provisional Application No.62/ submitted on May 18th, 2018 at 35 U.S.C. § 119 (e)
673,796, entitled Parallel Decoding Using Autoregressive Machine Learning Models
The applying date priority equity, and be incorporated by reference into herein.
Background technique
Decoding and generate output from autoregression model is substantially sequence, because being necessary for model is provided with their own
Previous prediction.This makes large-scale autoregression model be likely difficult to apply in production environment, especially in low latency environment.
It may refer to three kinds of currently associated methods for overcoming the difficulty.Each of which has a problem, that is, it
Speed it is faster when, it is also more significant in quality to deteriorate.
First method is prediction procreation (fertility) and noise parallel decoding.This method is returned certainly in the non-of Gu et al.
Return in neural machine translation (Non-Autoregressive Neural Machine Translation) and is described, the opinion
Text is delivered in the 6th international study characterization meeting in 2018 as meeting paper, can be in https: //arxiv.org/pdf/
1711.02281.pdf obtaining.
Second method is the iterative refinement of independent prediction.This method on April 17th, 2018, Lee et al. by iteration
Refine determination nonautoregression nerve sequence (the Deterministic Non-Autoregressive Neural of modeling
Sequence Modeling by Iterative Refinement) in be described, can be in https: //arxiv.org/
Pdf/1802.06901.pdf is obtained.
The third method is that sequentially prediction series of discrete is hidden (latent), then parallel anticipation ultimate sequence.It should
For method on April 29th, 2018, Kaiser's et al. quickly decoded (Fast to series model using discrete latent variable
Decoding in Sequence Models Using Discrete Latent Variables) in be described, can be
Https: //arxiv.org/pdf/1803.03382.pdf obtains.
Although paying close attention to the amount and instruction of several frequently seen framework class calculating needed for every layer of network certainly including circulation, convolution sum
Practice and carry out different compromises (trade-offs) between the critical path depth at the time, but is still to the deduction newly inputted
Intrinsic sequential process.
Neural autoregressive sequence has become to include the various of machine translation, abstract and speech synthesis to series model
Task actual standard.The different new network architectures allow to increase parallelization during the training period now.This framework is more
It is suitble to current large-scale parallel hardware accelerator, the training time that this framework needs wants much less.However, for many realities
When these models are disposed in border application, significant challenge is still had in the performance generated at the time.
Therefore, more and more work are related to for accelerating the distinct methods generated from autoregression model.These method packets
Include the probability density way of distillation (probability density distillation), sub- scaling law and by PROBLEM DECOMPOSITION at
After autoregression generates short series of discrete latent variable, hidden with discrete for the parallel generation step of condition.In these technologies
Some applied specifically, such as the nonautoregression Transformer of machine translation to a certain extent.Although one
A little technologies realize the acceleration of multiple number grades of speech synthesis, but as far as we know, and non-batch decoding is most in machine translation
It is about 4 times that the wallclock timestamp announced greatly, which improves, but is significantly deteriorated in quality.
Summary of the invention
Increase present specification describes the ability using some frameworks (for example, conversion (Transformer) framework) to utilize
The technology of the parallelization scoring and training that add.Transformer is in Vaswani et al., Attention Is All You
Need, the 31st neural information processing systems meeting (NIPS 2017) are described in Long Beach, CA, USA, can be
Https: //papers.nips.cc/paper/7181-attention-is-all-you-need.pdf obtains.The paper exists
This is incorporated herein by reference.
Present specification describes before the longest for determining these predicted parallel anticipations of autoregression " detector " model
Before sewing, the extension of basic autoregression model is trained to carry out the technology of multiple predictions parallel.
In general, a novel aspects of theme described in this specification can be embodied in for generating from autoregression
In the method for the output of model p1, this method includes movement: obtaining k-1 submodel pi, wherein i=2 ..., k, described auxiliary
Model pi is helped respectively to be configured as single i-th of the output for given prefix input prediction from model p1；And to current
Input executes following operation, until meeting termination condition: the current input (a) is directed to, according to model p1To pkIn it is every
One generates corresponding independent prediction, and each independent prediction is the prediction of single token；(b) maximum n is found out, so that (i) coming
From for by model p1To p(n-1)First token of independent prediction is cascade described currently entered to (n-1) a token
The model p of next token of input1Prediction and matching (ii) by model pnThe independent prediction of n-th of the token used；And
(c) by the way that model p will be come from1To pnIndependent prediction be attached to the output of generation to extend output generated.This aspect its
His embodiment includes corresponding computer system, device and the computer recorded on one or more computer memory devices
Program, they are respectively configured as executing the movement of these methods.
Realize that the system of these technologies, methods and procedures can realize that approximate iteration twice is reduced from autoregression model,
Without deteriorating in quality in greediness decoding.Together with the knowledge way of distillation, the appropriateness in performance can be utilized to sacrifice real
Speed is now increased to five times.Another advantage of these technologies is, previously mentioned for improving formation speed with other
Technology is compared, they can be realized the existing model on the basis of with the smallest modification.
These technologies can realize that up to 2 times of iteration is reduced on baseline greediness decoder, without dropping in speed
It is low.Relax acceptance criteria and fine-tune model parameter can be to provide reduction in the case where being declined slightly in performance exchanging for
Up to 7 times.The most fast mode of inventor realizes 4 times of acceleration in wallclock timestamp.
Detailed description of the invention
Fig. 1 is the block diagram for showing three sub-steps of example block parallel decoding process.
Fig. 2A illustrates the operation for executing the example system of the decoded prediction sub-step of block parallel.
Fig. 2 B illustrates the operation for executing the example system of the decoded verifying sub-step of block parallel.
Fig. 3 is the flow chart of example block parallel decoding process.
Fig. 4 shows the exemplary block parallel decoding process of the Fig. 3 executed in example prefix.
Identical appended drawing reference and title indicate identical element in each attached drawing.
Specific embodiment
In sequence into sequence problem, list entries (x is provided1,...,xn), and target is corresponding in order to predict
Output sequence (y1,...,ym).In the case where machine translation, these sequences may be source statement and object statement, or scheme
In the case where as super-resolution, these sequences can be low-resolution image and high-definition picture.
Assuming that system has learnt according to the autoregression Rating Model p (y | x) for from left to right decomposing and decomposing
Given input x, system are able to use the model come by hating to leave decoding prediction outputAs described below.It is opened from j=0
Begin, system is with top score tokenIt repeatedly extends the prediction and j ← j is set
+ 1 until meeting termination condition.For language generation problem, once generate the ending of special sequence token, system
Usually stop.Problem, the step of system simply decodes fixed number, are generated for image.
The decoding of standard greediness use m step generation length for the output of m, even for can be with speed more faster than linear session
Degree and be also effectively such to the model that sequence scores.Although output extension strength enumerate vocabulary size very
It is intractable for being longer than a token when big, but inventor has been found to propose to wait by one group of submodel of training
Choosing extension is to evade this problem.
As representation, basic model is designated as p1=p.In addition to learning basic model p1, system has also learnt k-1
Submodel p2,...,pkSet, wherein pi(yj+i| y≤j, x) be (j+i) a token be yj+iProbability.Suitable k
Value can be found out in the range of 2-20, or in the range of preferred 2-10, and in the range of preferred 4-6.
Fig. 1 is the block diagram for showing three sub-steps of example block parallel decoding process.System executes block parallel decoding
Process, this guarantee produce the identical prediction found out under greedy decodingBut use as few as m/k step.System with
Sky predictionStart, and j=0 is set.Three sub-steps of example block parallel decoding process are: prediction sub-step 110 is tested
It demonstrate,proves sub-step 120 and receives sub-step 130.System repeats sub-step 110,120 and 130, until meeting termination condition:
(1) (110) are predicted:
For i=1 ..., k obtains block prediction
(2) (120) are verified:
It finds out maximumSo that:
For all
It is noted that passing through definition
(3) receive (130):
Pass throughExtensionAnd it is arranged
In prediction sub-step 110, system finds out basic model p1 and submodel p2,...,pkLocal greedy prediction.
System finds out prediction according to equation 112.Since these are disjoint models, system can each prediction of parallel computation, therefore
Compared with single greedy prediction, the time is rarely lost.
In verifying sub-step 120, system finds out the extension by the length suggested produced in other ways by p1, raw for k
Maximum-prefix.If Rating Model can handle the sequence of this k token, the son in the case where being less than k step
Step helps to save the more than one token of offer to be correct overall time.In other words, in verifying sub-step 120
In, system finds out maximum k, so that equation 122 is set up.
Finally, in receiving sub-step 130, the Prefix Expansion of the system verifying hypothesis.That is, system utilizesExtensionAnd it is arrangedBy the way that token is used only until wherein basic model p1 and submodel
p2,...,pkUntil dissenting point, system will restore that the identical output for running greedy decoding with p1 and generating will be provided.
Ability for improving these technologies of decoding performance is critically depend on some network architectures to be performed in parallel
The ability of all predictions carried out in verifying sub-step 210.For example, in the converter, although the operation executed during decoding
Sum be prediction number quadratic power, but regardless of the number for predicting output position, the number of inevitable sequence operation
It is all constant.This permission system is performed in parallel for several positions in the case where not needing to spend additional wallclock timestamp
Verifying sub-step 110.
When being scored using Transformer, the above-mentioned every step of technology needs two models to call: one is to predict
Parallel calling p in sub-step1,...,pk, and the other is verify the calling p1 in sub-step.Even if this intention has used
The submodel of beauty, substitutes required m/k, and the number that model calls also only can be reduced to 2m/k from m by these technologies.
Another technology can be scored by using combination and propose scheme, and the number for further calling model is from 2m/k
It is reduced to m/ (k+1), in this case, n-th of verifying sub-step can merge with (n+1) a prediction sub-step.
More specifically, consider the system for realizing single inverter model, the model is during verifying sub-step, constant
In the operation of number, to all i=1 ..., k and i '=1 ..., k, generateThis can
Such as by the way that the dimension of the final projection layer of Transformer is increased k times and calculates k individual softmax come real
It is existing.Calling model gives required output after being inserted into k prediction output.Then, it is being verified
Period calculatesLater, system calculates all iThis is exactly decoded
Required for prediction sub-step in next iteration.Therefore, these sub-steps can be merged together, in addition to changing for the first time
Instead of outer, the number that all models call is with the reduction of the factor 2.
Up to the present, the described technology for block parallel decoding, which is generated, decodes identical output with standard greediness.
The system for relaxing the standard used during verifying can be that cost realizes additional acceleration may deviate greedy output.
It in some implementations, only in prediction is the predetermined number of output to p1 closest to one in prediction
When, which just matches the output of p1.In other implementations, in addition to requirement forecast accurately match Rating Model prediction it
Outside, system only can alternatively require it to be located in preceding k project.It is verified in order to achieve this, can be replaced with following items
Standard:
In some other implementations, only when prediction and the output of p1 are in preset distance apart, prediction
Just match the output of p1.For example, system implementations can be with closely in exporting the problem of space allows nature distance metric d
The exact matching of the element to score with highest is replaced like matching:
In the case where image generates, for example, suitable distance metric d (u, v)=| u-v | it is in given Color Channel
Intensity u1Absolute difference between v.
The first non-greedy prediction in given step may be it is incorrect, in this case, only single token is added
It is added in the hypothesis.In order to ensure minimum accelerates, it can be able to achieve system, it is required that at least adding most during each decoding step
A small number of purpose tokens.It is that k will be corresponding with the parallel decoding of the block with fixed size k by the setting minimal amount.
Fig. 2A illustrates the operation for executing the example system of the decoded prediction sub-step of block parallel.In this step, base
This model p1 receives input x and predicts single output tokenOutputIt can be local greedy prediction.Inputting x can be
One or more characters, one or more words, one or more sentences including one or more characters, or it is one or more
Image.Equally, each submodel p2,...,pkReceive input x and to i=2 ..., k, the single output token of prediction
Each Model Independent is in other each models and is parallel with prediction output.
Fig. 2 B illustrates the operation for executing the example system of the decoded verifying sub-step of block parallel.In this step, base
This model p1 is used as Rating Model to determine for i=2 ..., k, should receive which tokenN-th of the calculating of p1 is real
Example will receiveAs input, wherein " | | " cascade, and n=2 ..., k are indicated, and export scoring
Predict tokenThese calculating can be completed parallel.In the verification step, maximum n, which is found, to be less than or waits for being directed to
Make in all i of nMatching
Fig. 3 is the flow chart of example block parallel decoding process 300.Instantiation procedure will be described as by according to this specification
Properly programmed system executes.
For i=2 ..., k, system obtains (k-1) a submodel pi(305).Each submodel piIt is configured as root
According to single i-th of the output of common prefix input (also referred to as current input) prediction.
System is for current input, from model p1To pkEach of generate corresponding independent prediction (310).It is each only
Vertical prediction is the prediction of single token.
System finds out maximum n so that (i) from for it is described it is currently entered with by model p1To pn-1Independent prediction
First next token to the cascade input of (n-1) a token model p1Prediction and matching (ii) by model pnIt adopts
The independent prediction (315) of n-th of token.For example, using the representation of Fig. 2, system finds out maximum n, so that for straight
All predictions predicted to n-th makeMatching
In some implementations, corresponding prediction is only just to match under the same conditions in the two.In other realization sides
In formula, prediction is only just matched under conditions of the two is in preset distance apart；And in other other implementations, in advance
Survey only its be to p1Output predetermined number immediate prediction in one when just match p1Output, such as above
It is described in more detail.
By the way that model p will be come from1To pnIndependent prediction (be directed to the maximum n of above description) be attached to be previously generated it is defeated
Out, system extends the output (320) being previously generated of model p1 (being referred to as x above).Maximum n is found out using when system
(315) the verified prediction found out whenSystem extends the output being previously generated.
System determines whether to have met termination condition (325).If meeting termination condition, which terminates.If not
Meet termination condition, then the process iteration and the additional prediction (310) of system generation, is found out based on additional prediction maximum
N (315), and be based on maximum n, extend the output generated (320) of model p1, until termination condition be satisfied for
Only.
Fig. 4 shows example piecemeal executing to exemplary prefix 412 corresponding with x used above, Fig. 3
Parallel decoding processes.Example prefix 412 is word " I saw a dog ride ".The process is with sky predictionStart.
In prediction sub-step 410, basic model p1With submodel (for example, model p2、p3Deng) respectively one is exported
Token is individually predicted.Model p1、p2And p3Word " in ", " the " and " bus " are predicted respectively.These three words account for respectively
According to first position, the second position and the third place.Each prediction is predicted independently of each other and is parallel with progress.
In verifying sub-step 420, basic model p1Score each of independent prediction, thus be applicable in
In the case of previous independent prediction is adjusted.In the example of fig. 4, the maximum probability prediction of the third place or score in predicting
It is " car ".Using 414 (that is, words " I saw a dog ride in the ") of input, score in predicting " car " is predicted by p1.
Input 414 is the word with independent prediction " in " and " the " cascade prefix 412, by mould during prediction sub-step 410
Type p1 and p2 prediction.Score in predicting " car " is different from by the prediction of p3 of " bus " for the third place.
In receiving sub-step 430, system extends prefixTo include for first position and the second position, i.e., " in "
The prediction of " the ", but do not include the third place, i.e. the prediction of " bus ".It is preceding before model carries out next k independent prediction
SewIt is extended.
Fig. 4 shows the parallel anticipation from verifying sub-step 420 with dotted arrow will be in decoded next iteration
Prediction sub-step in reuse.It is noted that be necessary for verifying sub-step in each position calculate these prediction (although
In a parallel fashion).
Parallel processing described in this specification has many technological merits.It can guarantee that these processes will not in quality
Deteriorate.Nevertheless, the acceleration actually obtained in the experiment of inventor is obtained with by the existing method deteriorated in quality
The acceleration obtained.In addition, it is very simple that these processes, which will implement,.It is compared with above-mentioned other technologies, and
It is inappreciable that row processing technique, which will implement, and is unusual robust in training.
Another interested measurement is accelerated relative to greedy decoded practical wall clock, is considered for piecemeal simultaneously
The additional overhead that row prediction needs.In one group of experiment, inventors have found that wall clock acceleration reaches peak for the setting with k=6
At value 4.0, with 5.3 average acceptable block size.In terms of the number of iterations, biggish acceptable block size continues to change
It is kind, but due to its higher calculating cost, begun to decline in terms of wall clock improvement.
Parallel processing technique can be used in the improvement autoregressive sequence in the case where being generated output using this model and arrive
The performance of series model.The example of the application of autoregression model includes the machine by a kind of natural language to another natural language
It translates, the abstract of natural language text, wherein output is the sequence of the word in sentence, speech-to-text and Text To Speech,
Relate to the sequence of word and phoneme.Other exemplary applications include image generation, Language Modeling and parsing, for example, structure solution
Analysis.Other examples include the application of the sequence based on image, the application controlled including autonomous driving vehicle and robot.For example,
From or belong to a series of inputs (for example, image) of the physical system (true or virtual) including this model can be defeated
Out for controlling a series of actions of the machine operated in physical system or together with physical system.
These technologies can realize advantageously in the computer system with GPU because the process be related to it is many parallel
It calculates, is especially quickly calculated so as to cause in wallclock timestamp.
Theme described in this specification and movement and operation embodiment can in Fundamental Digital Circuit, tangible
It is realized in the computer software or firmware of implementation, in computer hardware, including structure disclosed in this specification and its structure
The combination of equivalent or one or more of which.The embodiment of theme described in this specification can be implemented as
One or more computer programs, i.e., one or more of the computer program instructions encoded on tangible non-transient storage medium
A module, for being executed by data processing equipment or being controlled the operation of data processing equipment.Alternatively or additionally, program refers to
Enabling can be believed through generating with the manually generated propagation encoded to the information for being used for transmission acceptor device appropriate
It is encoded on number (for example, machine generate electricity, light or electromagnetic signal), for data processing equipment execution.Computer storage medium
Can be machine readable storage device, machine readable storage substrate, random or serial access memory equipment or in them one
A or multiple combination.Computer storage medium is not transmitting signal.
Term " data processing equipment " enumerates all types of devices, equipment and the machine for handling data, including
Such as programmable processor, computer or multiple processors or computer.The data processing equipment can include special logic electricity
Road, such as FPGA (field programmable gate array), ASIC (specific integrated circuit) or GPU (graphics processing unit).In addition to hardware
Except, which can also include the code that performing environment is created for computer program, for example, constituting processor firmware, agreement
Stack, data base management system, operating system or their one or more combined codes.
Computer program (can also be referred to as or be described as program, software, software application, application, module, software mould
Block, engine, script or code) it can be write with any type of programming language, including compiling or interpreted language or sound
Bright property or procedural, and it can be disposed in any form, including as stand-alone program or as module, component, draw
It holds up, subroutine or be suitble to other units for executing in a computing environment, which may include by one or more positions
One or more computers of data communication network interconnection.
Computer program can with but need not be corresponding with the file in file system.Computer program can be stored in guarantor
It holds in the part of the file of other programs or data (for example, the one or more scripts stored in marking language document), deposit
Storage is in the single file for being exclusively used in described program or is stored in multiple coordination files (for example, storing one or more moulds
Block, subprogram or code section) file in.
Process and logic flow described in this specification can by execute one of one or more computer programs or
Multiple computers execute, to execute operation by being operated to input data and generating output.These processes and logic
Process can also be by dedicated logic circuit (such as FPGA, ASIC or GPU) or dedicated logic circuit and one or more programming meters
The combination of calculation machine executes.
The computer for being adapted for carrying out computer program can be based on general or specialized microprocessor or both or any
Other kinds of central processing unit.In general, central processing unit will be from read-only memory or random access memory or both
Receive instruction and data.The primary element of computer is central processing unit for executing instruction and sum number for storing instruction
According to one or more memory devices.Central processing unit and memory by supplemented or can be incorporated in it
In.
In general, computer will also include or be operatively coupled with from one or more mass-memory units receive number
According to or transmit data to one or more mass-memory units.Mass-memory unit can be such as magnetic, magneto-optic or
CD or solid state drive.However, computer does not need have such equipment.In addition, computer can be embedded in it is another
In a equipment, such as mobile phone, personal digital assistant (PDA), Mobile audio frequency or video player, game console, the whole world
Positioning system (GPS) receiver or portable memory apparatus, for example, universal serial bus (USB) flash drive, here only
Lift several.
In order to provide the interaction with user, the embodiment of theme described in this specification can have for user
Display equipment that show information, such as LCD (liquid crystal display) monitor and user pass through it and provide input to computer
Input equipment, such as realized on keyboard and the computer of indicating equipment (such as mouse, trace ball or Trackpad), or be configured
At communicating.Other kinds of equipment can also be used to provide the interaction with user；For example, the feedback for being supplied to user can
It is any type of sense feedback, such as visual feedback, audio feedback or touch feedback；And it can receive in any form
Input from the user, including acoustics, voice or tactile input.In addition, computer can pass through the equipment to being used by user
It sends document and receives document from the equipment used by user to interact with user；For example, by response to being connect from web browser
Webpage is sent the web browser on user equipment by the request of receipts, or by with user equipment (such as smart phone or
Electronic tablet) on run app interaction.In addition, computer can by personal device (for example, operation information receiving and transmitting
The smart phone of application) message of sending information message or other forms to interact with user, and returns and to receive from user
Response message.
This specification use term " being configured to " related with system, device and computer program component.For to be matched
Be set to the one or more system for computer for executing specific operation or movement, it is intended that the system had mounted thereto software,
Firmware, hardware or their combination make system execute these operations or these movements in operation.For to be configured to hold
Row specific operation or one or more computer programs of movement, it is intended that one or more programs include when by data processing equipment
Device is set to execute the instruction of operation or movement when execution.Special logic electricity for be configured to execute specific operation or movement
Road, it is intended that the circuit has the electronic logic for executing operation or movement.
Although this specification includes many specific implementation details, these are not construed as the model to any invention
It encloses or the limitation of claim scope of the claimed, but as can be specific to the feature of the specific embodiment of specific invention
Description.The certain features described in the present specification in the context of separate embodiments can also in a single embodiment with
Combined mode is realized.On the contrary, the various features described in the context of single embodiment can also be in various embodiments
Individually or with any suitable sub-portfolio realize.In addition, although feature can be described above as with certain compound actions
And even initially just so it is claimed, but one or more features in claimed combination in some cases
It can be removed from the combination, and claim can be directed to sub-portfolio or the variation for sub-portfolio.
Similarly, although operation is depicted with particular order in the accompanying drawings and is cited in the claims, this is not
It should be understood as requiring operation particular order shown in or sequentially be performed, or execute all operations shown,
To realize desired result.In some cases, multitasking and parallel processing may be advantageous.In addition, above-mentioned implementation
The separation of various system modules and component in example is understood not to require this separation in all embodiments, and
It should be understood that the program assembly and system usually can be integrated or be packaged into single software product
Multiple software product.
The specific embodiment of theme has been described.Other embodiments are within the scope of the claims.For example, claim
The movement of middle record can be executed in different order and still realize desired result.As an example, the mistake
Journey particular order or sequentially realizes desired result shown in being not necessarily required to.
Claims (21)
1. one kind comes from autoregression model p for generating1Output method, comprising:
Obtain k-1 submodel pi, wherein i=2 ..., k, the submodel piIt is respectively configured as defeated for given prefix
Enter to predict from model p1It is single i-th output；And
Following operation is executed to current input, until meeting termination condition:
For the current input, generates and come from model p1To pkEach of corresponding independent prediction, each independent prediction
It is the prediction of single token；
Find out maximum n so that (i) from for by model p1To p(n-1)First token of independent prediction is to (n-1)
The model p of next token of a cascade input currently entered of token1Prediction and matching (ii) by model pnIt uses
The independent prediction of n-th of token；And
By the way that model p will be come from1To pnIndependent prediction be attached to it is generated output to extend output generated.
2. the method for claim 1, wherein only in corresponding prediction and p1Output phase simultaneously, corresponding prediction
Just match the p1Output.
3. the method for claim 1, wherein only predicting to be to p corresponding1Output predetermined number it is closest
When one in prediction, corresponding prediction just matches the p1Output.
4. the method for claim 1, wherein only in corresponding prediction and p1Output it is apart in preset distance
When, corresponding prediction just matches the p1Output.
5. the method for claim 1, wherein k is the integer in the range of 2-20 or 2-10 or 4-6.
6. the method for claim 1, wherein the autoregression model is depth nerve autoregression model.
7. the method for claim 1, wherein parallel generation comes from the model p1To pkEach of single order
Board prediction.
8. it is a kind of by one or more computer implemented systems, the system comprises:
Autoregression model p1；And
K-1 submodel pi, wherein i=2 ..., k, the submodel piRespectively be configured as given prefix input come
Prediction comes from model p1It is single i-th output；
Wherein, the system is configured as executing following operation for current input, until meeting termination condition:
For the current input, generates and come from model p1To pkEach of independent prediction, each independent prediction is single
The prediction of token；
Find out maximum n so that (i) from for by model p1To p(n-1)First token of independent prediction is to (n-1)
The model p of next token of a cascade input currently entered of token1Prediction and matching (ii) by model pnIt uses
The independent prediction of n-th of token；And
By the way that model p will be come from1To pnIndependent prediction be attached to it is generated output to extend output generated.
9. system as claimed in claim 8, wherein only in corresponding prediction and p1Output phase simultaneously, corresponding prediction
Just match the p1Output.
10. system as claimed in claim 8, wherein be only to p in corresponding prediction1Output predetermined number it is closest
When one in prediction, corresponding prediction just matches the p1Output.
11. system as claimed in claim 8, wherein only in corresponding prediction and p1Output it is apart in preset distance
When, corresponding prediction just matches the p1Output.
12. system as claimed in claim 8, wherein k is the integer in the range of 2-20 or 2-10 or 4-6.
13. system as claimed in claim 8, wherein the autoregression model is depth nerve autoregression model.
14. system as claimed in claim 8, wherein parallel generation comes from the model p1To pkEach of single order
Board prediction.
15. one or more coding has the computer readable storage medium of instruction, described instruction is by one or more computers
One or more of computers are made to execute operation when execution, comprising:
Obtain autoregression model p1With k-1 submodel pi, wherein i=2 ..., k, the submodel piRespectively it is configured as
It is inputted for given prefix to predict from model p1It is single i-th output；And
Following operation is executed to current input, until meeting termination condition:
For the current input, generates and come from model p1To pkEach of corresponding independent prediction, each independent prediction
It is the prediction of single token；
Find out maximum n so that (i) from for by model p1To p(n-1)First token of independent prediction is to (n-1)
The model p of next token of a cascade input currently entered of token1Prediction and matching (ii) by model pnIt uses
The independent prediction of n-th of token；And
By the way that model p will be come from1To pnIndependent prediction be attached to it is generated output to extend output generated.
16. one or more computer readable storage medium as claimed in claim 15, wherein only in corresponding prediction and p1
Output phase simultaneously, corresponding prediction just matches the p1Output.
17. one or more computer readable storage medium as claimed in claim 15, wherein be only pair in corresponding prediction
p1Output predetermined number closest to one in prediction when, corresponding prediction just matches the p1Output.
18. one or more computer readable storage medium as claimed in claim 15, wherein only in corresponding prediction and p1
Output it is apart in preset distance when, corresponding prediction just matches the p1Output.
19. one or more computer readable storage mediums as claimed in claim 15, wherein k be 2-20 or 2-10 or
Integer in the range of 4-6.
20. one or more computer readable storage medium as claimed in claim 15, wherein the autoregression model is deep
Spend neural autoregression model.
21. one or more computer readable storage medium as claimed in claim 15, wherein parallel generation comes from model p1
To pkEach of single token prediction.
Applications Claiming Priority (2)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US201862673796P | 2018-05-18 | 2018-05-18 | |
US62/673,796 | 2018-05-18 |
Publications (2)
Publication Number | Publication Date |
---|---|
CN110245359A true CN110245359A (en) | 2019-09-17 |
CN110245359B CN110245359B (en) | 2024-01-26 |
Family
ID=67884364
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
CN201910418720.2A Active CN110245359B (en) | 2018-05-18 | 2019-05-20 | Parallel decoding using autoregressive machine learning model |
Country Status (2)
Country | Link |
---|---|
US (2) | US10521701B2 (en) |
CN (1) | CN110245359B (en) |
Cited By (2)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN111274764A (en) * | 2020-01-23 | 2020-06-12 | 北京百度网讯科技有限公司 | Language generation method and device, computer equipment and storage medium |
CN111489803A (en) * | 2020-03-31 | 2020-08-04 | 重庆金域医学检验所有限公司 | Report coding model generation method, system and equipment based on autoregressive model |
Families Citing this family (4)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US11475590B2 (en) * | 2019-09-12 | 2022-10-18 | Nec Corporation | Keypoint based pose-tracking using entailment |
US11455555B1 (en) | 2019-12-31 | 2022-09-27 | Meta Platforms, Inc. | Methods, mediums, and systems for training a model |
CN112686058B (en) * | 2020-12-24 | 2021-10-29 | 中国人民解放军战略支援部队信息工程大学 | BERT embedded speech translation model training method and system, and speech translation method and equipment |
CN112951203B (en) * | 2021-04-25 | 2023-12-29 | 平安创科科技(北京)有限公司 | Speech synthesis method, device, electronic equipment and storage medium |
Citations (4)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US6453206B1 (en) * | 1996-11-22 | 2002-09-17 | University Of Strathclyde | Neural network for predicting values in non-linear functional mappings |
CN103942457A (en) * | 2014-05-09 | 2014-07-23 | 浙江师范大学 | Water quality parameter time series prediction method based on relevance vector machine regression |
CN105759983A (en) * | 2009-03-30 | 2016-07-13 | 触摸式有限公司 | System and method for inputting text into electronic devices |
CN107836000A (en) * | 2015-07-07 | 2018-03-23 | 触摸式有限公司 | For Language Modeling and the improved artificial neural network of prediction |
Family Cites Families (2)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
KR20200003407A (en) * | 2017-07-28 | 2020-01-09 | 구글 엘엘씨 | Systems and methods for predicting and summarizing medical events from electronic health records |
US11604956B2 (en) * | 2017-10-27 | 2023-03-14 | Salesforce.Com, Inc. | Sequence-to-sequence prediction using a neural network model |
-
2019
- 2019-05-20 US US16/417,190 patent/US10521701B2/en active Active
- 2019-05-20 CN CN201910418720.2A patent/CN110245359B/en active Active
- 2019-11-13 US US16/682,611 patent/US11681954B2/en active Active
Patent Citations (4)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US6453206B1 (en) * | 1996-11-22 | 2002-09-17 | University Of Strathclyde | Neural network for predicting values in non-linear functional mappings |
CN105759983A (en) * | 2009-03-30 | 2016-07-13 | 触摸式有限公司 | System and method for inputting text into electronic devices |
CN103942457A (en) * | 2014-05-09 | 2014-07-23 | 浙江师范大学 | Water quality parameter time series prediction method based on relevance vector machine regression |
CN107836000A (en) * | 2015-07-07 | 2018-03-23 | 触摸式有限公司 | For Language Modeling and the improved artificial neural network of prediction |
Non-Patent Citations (1)
Title |
---|
YANG XIANGLIN ET AL: "Improved IAMB with Expanded Markov Blanket for High-Dimensional Time Series Prediction", 《CHINESE JOURNAL OF ELECTRONICS》, pages 264 - 269 * |
Cited By (2)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN111274764A (en) * | 2020-01-23 | 2020-06-12 | 北京百度网讯科技有限公司 | Language generation method and device, computer equipment and storage medium |
CN111489803A (en) * | 2020-03-31 | 2020-08-04 | 重庆金域医学检验所有限公司 | Report coding model generation method, system and equipment based on autoregressive model |
Also Published As
Publication number | Publication date |
---|---|
US20190354812A1 (en) | 2019-11-21 |
US10521701B2 (en) | 2019-12-31 |
CN110245359B (en) | 2024-01-26 |
US11681954B2 (en) | 2023-06-20 |
US20200082226A1 (en) | 2020-03-12 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
CN110245359A (en) | Parallel decoding is carried out using autoregression machine learning model | |
JP7009564B2 (en) | End-to-end text-to-speech conversion | |
EP3971786B1 (en) | Feedforward generative neural networks | |
KR102565275B1 (en) | Translating method and apparatus based on parallel processing | |
US9037464B1 (en) | Computing numeric representations of words in a high-dimensional space | |
KR20190113928A (en) | Device placement optimization through reinforcement learning | |
CN110246488B (en) | Voice conversion method and device of semi-optimized cycleGAN model | |
CN111699497A (en) | Fast decoding of sequence models using discrete latent variables | |
US11238332B2 (en) | Attention neural networks with sparse attention mechanisms | |
CN110326002A (en) | Use the series processing paid attention to online | |
JP6983271B2 (en) | Methods, devices, equipment and computer readable storage media for synthesizing speech in parallel | |
CN111581988B (en) | Training method and training system of non-autoregressive machine translation model based on task level course learning | |
CN110663049A (en) | Neural network optimizer search | |
US20230104159A1 (en) | Generating output examples using bit blocks | |
CN111587441A (en) | Generating output examples using a regression neural network conditioned on bit values | |
US20230325658A1 (en) | Conditional output generation through data density gradient estimation | |
CN116484935A (en) | Model training method, dance generation method, device and medium | |
WO2023147144A1 (en) | Attention neural networks with gated attention units | |
WO2023028372A1 (en) | Sequence error correction using neural networks | |
Shipton et al. | Implementing WaveNet Using Intel® Stratix® 10 NX FPGA for Real-Time Speech Synthesis | |
JP2024506597A (en) | Generating neural network output by enriching latent embeddings using self- and mutual-attention behaviors | |
EP4298555A1 (en) | Neural networks with feedforward spatial transformation units | |
CN116830120A (en) | Neural network with switching layer |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
PB01 | Publication | ||
PB01 | Publication | ||
SE01 | Entry into force of request for substantive examination | ||
SE01 | Entry into force of request for substantive examination | ||
GR01 | Patent grant | ||
GR01 | Patent grant |