The application requires to enjoy the U.S. Provisional Application No.60/574 that submitted on May 25th, 2004,290 rights and interests, and its full content is incorporated into as a reference at this and is used for all purposes.The application also requires to enjoy the U.S. Provisional Application No.60/593 that submitted on February 2nd, 2005,651 rights and interests, and its full content is incorporated into as a reference at this and is used for all purposes.
Embodiment
Fig. 1 has shown the block diagram of diagram filtering system 100 instances, and said system filters Internet traffic based on the prestige of source IP address.In accordance with the embodiments illustrated, system 100 comprises one or more data source 102a, 102b (being 102 jointly), source credit system 104 and one or more client 106a, 106b (being 106 jointly).Said source credit system 104 comprises real-time threat identification (RTIN) engine 108 and optional client's configuration database 110.
RTIN engine 108 is responsible for from many data sources 102, finding the IP address information; The information that processing is found is with development in RTIN database 114 and be kept for the source prestige profile of IP address or IP address block, and managed source prestige profile information is to the distribution of client 106.Should notice that client 106a and 106b comprise customer rs router 107a and 107b (being 107 jointly) respectively.In certain embodiments, RTIN engine 108 can be managed profile information directly to the distribution of customer rs router 107.In certain embodiments, RTIN engine 108 distribution that can come the management ip address profile information according to the customer information that is stored in the database 110.What for example, information distributing method and the information type that offers client 106a can be with client 106b is different.RTIN engine 108 can be guaranteed according to exclusive attribute and/or the configuration of client 106a and 106b they to be carried out suitable processing with reference to the data that are stored in the database 110.
RTIN engine 108 can be assessed the IP address based on the information that receives from one or more data sources 102.Any risk measurement can be used to reach reliability standard or whether source/territory is confirmed reliably.The example of risk measurement comprises that relating to spam, virus, e-mail bomb and catalogue collects the tolerance of attacking.Can make based on predetermined ratio the measurement of each in these tolerance, for example, from 1 to 100 ratio, expression theme source IP address is absorbed in the degree of these behaviors.The IP address can be labeled based on these measurements then, and for example, scope means that at 50 to 100 the mark for the measurement of spam theme IP address is considered to sizable source of spam email.Otherwise if the spam measurement is lower than 50, so said IP address is that wherein the rank of reliability depends on measurement numerical value reliably to a certain extent.For example, having the spam range for measuring, to be considered to than to have the spam range for measuring in the IP address of 1-10 more reliable in the IP address of 40-50.
In certain embodiments; The owner of IP address (for example can be identified; Through carrying out DNS or " whois " research operations) so that an industry factor is included in the assessment to the IP address; Said industry factor has been represented under the situation of given industry that has a said IP address or entity, and the IP address to what extent can be the source of spam or other rogue activitys.The territory or the IP address that reach the reliability intended level also can be like this by identifications correctly.In certain embodiments, being identified as is the database that reliable territory or IP address can be added to reliable IP address.
For producing RTIN database 114, the keeper of source credit system 104 can inquire about and be evaluated at the combination in the various fields of various data source 102 information available, such as the ratio of message number with the spam messages quantity of sending from particular ip address.Other measurements include, but are not limited to:
● message transmitted quantity
● be considered to the message number of spam
● addressee's quantity
● connect the quantity of attempting
● the quantity of successful connection
● the quantity of connection failure
● the quantity of the 400th type of mistake
● the quantity of the 500th type of mistake
● with the average message size of byte representation
● on average connect the duration
● viral load
But some in the RTIN engine 108 scan-data sources 102 or whole; Inquire about which source IP address and disturbed spam attack strategies, catalogue to collect attack strategies, viral strategy or service-denial attack strategies, or RTIN engine 108 comes classification or classification source IP address according to the analysis to the inner data of data source 102.
RTIN database 114 will allow specific source IP address to remove its record, but there is no need to receive healthy clean inventory with the identical classification of its bad record of development.For example, possibly take ten times " cleaning " operation to reduce the DHA mark of source IP address.These classifications are observation or design object and be conditioned rule of thumb, and they under varying environment-seriousness/rank of attacking before for example or other Given informations-even can be different about said IP address.
On the program, based on the request from client 106, RTIN engine 108 can provide IP address ratio in the right tabulation of the name/value of CSV.This is to increasing additional values and with the Previous System compatibility very big dirigibility being provided.
As previously mentioned, it is possible developing positive reputation rather than developing negative prestige, such as the knowledge through industry assigned ip address realm.Therefore, the server that has by IBM or 3M or GM of reliable source IP address-for example-be assumed to be probably and send valid email rather than spam or DHA etc.Said then classification can comprise the positive reputation mark, and it can together return with the mark prestige request from client 106.It also might provide more graininess industry customizing messages, and is for example medical science, law or accounting, and the IP address that therefore belongs to one of those industries more unlikely is prevented from respect to the client who belongs to one of those industries.
To differentiation,, be the measurement that RTIN database 114 is made based on system's 104 performances Network Based objectively such as caller ID type system and blacklist with respect to the element of the source credit system 104 of the method for detailed earlier herein.Do not need people to write down or report spammer.Say that compactly source credit system 104 does not mind that you say that who are you or you register for Whom.If you just serve the devil, you will be identified as the WKG working bad thing and cut this Email that will have influence on your transmission by the performance of RTIN database 114 instruction clients 106 with its filtration.Caller ID can not stop people and send spam from well known server; It can stop the Email that comes from except the server that is associated with the SMTP information of discerning for specific e-mail, so caller ID is not the complete solution to spam.In addition, caller ID method is not collected to attack to catalogue and is protected, because caller ID assessment needs the service load of access message.Yet said based on didactic method under many circumstances only through the related Email that stop from spammer of Email with source IP address; Said source IP address has been confirmed to be by spammer and has pro used; Or pro used by legal sender, such as some industry or business type.Expansion discussion for the industry heuristic of this filtration; Consult the U.S. Patent application No.10/832 of " using the system and method for commercial heuristic filtering electronic messages " by name; 407, itself and present disclosure co-dispensed and in these whole incorporated all purposes that are used for as a reference.
Therefore the information type that keeps in the RTIN database can comprise information, possibly be the data of possibility in the source of spam, virus, DHA or other rogue activitys such as the said theme of the indication address that is used for IP address or IP address block.For example; In certain embodiments; For each IP address; Said RTIN database can comprise the mark that is used for such as one or more classification of spam, virus or DHA, and said mark provides a kind of indication, and promptly said theme IP address has how likely to be absorbed in the activity relevant with each classification.
Fig. 2 has shown the block diagram of first embodiment of RTIN engine 108.According to said first embodiment, RTIN engine 108 comprises one or more RTIN servers.RTIN engine 108 comprises the first and second RTIN server 112a and 112b (common is " 112 ") in embodiment illustrated.Identical information can both handled and store to each server 112.Therefore, if in the server 112 one when shutting down owing to maintenance or other reasons, the service that offers client 106 can be continuous.Therefore, use a plurality of RTIN servers 112 can build firmer system 104.Optional embodiment can comprise the RTIN server 112 of any amount.
Each RTIN server 112 all comprises RTIN database 114a, 114b (common is " 114 "), and the source IP address reputation information is maintained at wherein.RTIN server 112 can be set to periodically data source 102 inquired about the IP address informations, handles said IP address information and is used for the data of the source prestige profile of IP address with development, and correspondingly upgrade the profile data in the RTIN database 114.What in like Fig. 2, show comprises that each of server 112a and 112b all can comprise the RTIN database 114a, the 114b that comprise identical information separately among the embodiment more than one RTIN server 112.
RTIN server 112 is also managed the distribution of source IP address reputation information to client 106.Server 112 can be by client's 106 visits, although this in certain embodiments visit can be limited and manage where necessary.For example, RTIN server 112 can be configured to only to allow the safety of data in 106 pairs of RTIN databases 114 of signed client of source credit system and the visit of authentication.But said client's 106 querying servers 112 and based on the message pick-up response that is stored in the RTIN database 114.
The data that are stored in the RTIN database 114 can offer the client by client access or with multitude of different ways.A kind of mode that the RTIN data can be visited is the algorithm of searching through the DNS type, and client 106 sends the inquiry of the DNS type of the authentication of being handled by RTIN controller (being associated with RTIN server 112 (referring to Fig. 3)).These DNS types are searched and can be sent to find out whether said send server has bad or good prestige for specific send server IP address (for the server of the send Email of asking SMTP to connect) by client 106.
The RTIN controller can be with reference to the customer data that is stored in client's configuration database 110.Therefore, for example, client 106a can send the system that inquires 104 of the DNS type that is used for send server IP address.Said inquiry is handled by one of RTIN server 112.RTIN server 112 can come according to the configuration information in client's configuration database 110 from its RTIN database 114, information to be provided.Can comprise for the response of client inquiry and mark to be provided RTIN client 106; Said mark has indicated specific send server IP address whether possibly collect attack with spam or catalogue or the service-denial attack is associated; Or in the one side in front; Positive mark can be associated with specific send server, has indicated said send server to be associated with legitimate email.When subscriber's e-mail system receives the Email connection request, search and to carry out in real time.
Fig. 3 has shown the block diagram of second embodiment of RTIN engine 108.The difference of said second embodiment and first embodiment is that the function of in first embodiment, being carried out by RTIN server 112 is cut apart in a second embodiment between RTIN controller 116a, 116b (common is " 116 ") and RTIN server 118a, 118b (common is " 118 ").Therefore, according to second embodiment, RTIN engine 108 comprises one or more RTIN controllers 116 and one or more RTIN servers 118.Keep RTIN database 114a, 114b, 114c, 114d (being " 114 " jointly) separately in each controller 116 and the server 118.As in first embodiment, many uses to controller 116 and server 118 can be built firmer system 104.
Division of tasks between RTIN controller 116 and the RTIN server 118 can change; For example; RTIN controller 116 can be responsible for periodically data query source 102 to collect the IP address information; Handle said IP address information with development source IP address reputation, and the RTIN database 114 of update controller 116 and server 118.RTIN server 118 can be in charge of being stored in source IP address reputation information in its RTIN database 114 to client 106 distribution, comprises the inquiry of processing from client 106.
Get back to Fig. 1, the data source 102 of source credit system 104 addressable any amount.Though block diagram has shown two data source 102a and 102b, should be noted that the data source 102 that under the situation of spirit that does not break away from present disclosure and scope, to use any amount.
The specification of data source 102 can change.In certain embodiments, for example, the system of monitoring email traffic can be used as data source 102.Fig. 4 has shown the block diagram of an embodiment of E-mail communication amount supervisory system 120.Said traffic supervisory system 120 produces real-time electronic mail communication amount statistic.Said traffic supervisory system 120 can be included in the assembly and the process of the movable electronics message management system of describing in the movable EMS patented claim (with reference to above-described).Said communications monitor system 120 comprises message processing procedure 122.Said message processing procedure 122 is responsible for setting up and monitoring is attempted from connecting to the Incoming SMTP such as the receipt mail server of server 126 such as the send Email server of server 124.
Said process 122 is connected to traffic supervisor 128.Said traffic supervisor 128 is collected the SMTP that arrives in real time and is connected data, message meta-data and message transmission information, comprises the source and destination data from process 122.Said source and destination data can comprise source data that is associated with sender mail server 124 and the destination data that is associated with receipt mail server 126.The specific examples of the data point that is kept by traffic supervisor 128 can comprise, for each combination of source IP address and destination data/information:
● in last one minute, be established to the number of connection of traffic supervisory system 120 by the source
● from the number of connection in the source of working as front opening
● in last one minute, be established to the client's in representative source number of connection by traffic supervisory system 120
● be established to the number of connection of representative by traffic supervisory system 120 as the client in the source of front opening
● be established to the quantity that the client's in representative source the connection of failure is attempted by traffic supervisory system 120
● from the source to mean value and the standard deviation of duration of the connection of traffic supervisory system 120
● be established to the client's in representative source the mean value and the standard deviation of duration of connection by traffic supervisory system 120
● the mean value of the size of all message and standard deviation from the source to client
● the mean value and the standard deviation of the quantity of accepting message from the source to client
● send to the quantity (summation) of client's message by the source
● send to the quantity of message that is identified as the client of spammer by traffic supervisory system 120 by the source
● send to the quantity that is identified as the client's who comprises virus message by traffic supervisory system 120 by the source
● send to the quantity that is write down the client's who rebounds message by traffic supervisory system 120 according to connection management by the source
● send to the quantity that is write down the client's who puts it into the black hole message by us according to connection management by the source
● send to the quantity that is write down the client's who isolates message by us according to connection management by the source
● send to by the quantity of the client's of traffic supervisory system 120 automatic spools (spool) message by the source
● in the quantity that comprises the 400th type of mistake of seeing being connected of source and client
● in the quantity that comprises the 500th type of mistake of seeing being connected of source and client
Therefore, said traffic supervisory system 120 can be come the storage of real time statistic according to the source IP address of the send server that is used for being routed through system 120.
Although Fig. 4 shows traffic supervisor that actual enforcement can have still less or more traffic supervisor as independent traffic supervisor 128.For example, it can cut apart traffic supervisor according to subscriber's geographical or main language.
In certain embodiments, traffic supervisory system 120 can be responsible for going up the information that keeps relative short-term, for example 60 seconds at all send servers or message transport agents (" MTAs ").All those transmissions IP addresses all are stored in the storer grid of traffic supervisor 128 inside; It keeps the multiple information about those source IP addresss; Sent how much message such as them; They have produced the mistake of what " the 500th type of mistakes " or other type, and content-based scanning, and how many spam messages they have sent.In certain embodiments; Said traffic supervisory system 120 can be configured at any time only know in 60 seconds in the past what has taken place; And if one separately connect to open and be longer than 60 seconds, the data that said traffic supervisory system 120 can continue to accumulate said connection need only said connection and exist.
Another example of data source 102 is a system, said system monitoring Email and during preset time the capacity check based on Email be the IP address of source of spam email.Fig. 5 has shown the block diagram of an embodiment of such system.The system that shows among Fig. 5 is twice attacking system 130.Said twice attacking system 130 provides a kind of method that reduces mistake-correct spam identification.Transmission is identified as the IP address of the Email of spam by error can not send the high capacity Email that is identified as spam usually.Therefore, when said twice attacking system 130 suspects that the Email from the IP address is spam, it will check institute's elapsed time total amount since the spam of suspecting receives from that IP address.If passed through regulation or more time, so said twice attacking system 130 will think that the Email of said suspection is that the possibility of spam is very little.Otherwise if passed through the time that is less than ormal weight, so said system 130 will think that the Email of said suspection is that the possibility of spam is very big and will to send the IP Address Recognition be possible source of spam email.
Said dual systems 130 comprises message processing procedure 122, examines the process 122 that Fig. 4 describes such as behaviour.Said message processing procedure 122 still is responsible for setting up and monitoring is attempted from connecting to the arrival SMTP such as the receipt mail server of server 136 such as the send Email server of server 134, and confirms the source and destination data that are associated with transmission message.Said process 122 is connected to twice and attacks engine 132.The data that said twice attack engine 132 is configured to obtain with message processing procedure 122 and said process 122 work together.Said engine 132 can extraly be configured to detect Email whether to be rendered as spam.In some optional embodiment, this is confirmed and can be made and said detection is provided for engine 132 by process 122.In some this embodiment, said twice attack engine 132 can receive the indication that is suspect to be spam with together some of Email.In other this optional embodiment, said system 130 can be configured to receive only the Email that is suspect to be spam, does not need the indicator of the sort of influence in this case.Spam detection can be based on any known spam detection method, for example, and based on Email content.
Engine 132 is connected to attack database 138 twice.It is the information of the instance of spam that said engine 132 active banks 138 are used to store about Email under a cloud.Database 138 is the storing IP address information also, and for example, being confirmed as by engine 132 possibly be the IP address of source of spam email.Said information can be used for RTIN engine 108.
Fig. 6 has shown the process flow diagram of diagram by twice attack process of twice attacking system 130 execution.At piece 140, the Incoming Email that comes from theme IP address is identified as and is likely spam, for example through message processing procedure 122.At piece 142, the IP address of said twice attack engine 132 Query Databases 138 said theme.If received from said theme IP address before the Email of suspecting, database 138 will comprise the last received time of suspecting of Email so.Attack the time that engine 132 extracts the last Email of suspecting said twice.It should be noted that process can jump to piece 148 so if there are not the data of theme IP address.At piece 144, engine 132 how long confirm to have passed through at the Email of current suspection and between the Email of suspecting before and the time total amount whether less than predetermined threshold value, said threshold value can be the time of any amount and can be set according to historical information.An example of threshold value can be two hours.If also not through (being " being " at piece 144), so said Email is considered to spam and said process proceeds to piece 146 for the threshold time total amount.At piece 146, said Email is isolated or is handled as spam.Equally, to be updated with the source IP address of discerning said SPAM be known source of spam email to database 138.Then, at piece 148, database 138 is updated, thus the time of the Email of current suspection replaced last suspection Email time with after being used for to said process repeatedly.It should be noted that at piece 144 if the threshold time total amount has been passed through (being " denying " at piece 144), so said process is skipped piece 146 and entered into piece 148.
Another example of data source 102 can be a kind of system, is used for detecting spam based on the Email that sends to known non-existent e-mail address that receives.Fig. 7 has shown the block diagram of an embodiment of this system.The said system that shows among Fig. 7 is a die by visitation of God system 150.Said system 150 provides a kind of instance based on the email message that sends to non-existent e-mail address to discern the source of spam.The high capacity Email that sends to non-existent e-mail address possibly be the indication of DHA, so source IP address can be identified as the source of DHA and possibly be the source of spam.In some cases, not belonging to " seed " e-mail address of real user can be on Internet, " global USE-NET system " or other local propagation.System 150 can detect the Email that sends to one of these " seed " addresses and said source IP address is labeled as possible source of spam email then.
Die by visitation of God system 150 also comprises message processing procedure 122, just as the process of describing with reference to Figure 4 and 5 122.Said message processing procedure 122 still is responsible for setting up and monitoring is attempted from connecting to the Incoming SMTP such as the receipt mail server of server 156 such as the send Email server of server 154, and confirms the source and destination data that are associated with transmission message.Said process 122 is connected to die by visitation of God engine 152.The data that said die by visitation of God engine 152 is configured to obtain with message processing procedure 122 and said process 122 work together.Said engine 152 can extraly be configured to detect Email whether to be rendered as non-existent address or " seed " address.In some optional embodiment, this is confirmed and can be made by process 122, and said detection is provided for engine 152.In some this embodiment, said die by visitation of God engine 152 can receive with together some of Email and be sent to indication non-existent or " seed ".In other this optional embodiment, said system 150 can be configured to receive only send to and not exist or the Email of " seed " address, does not need the indicator of the sort of influence in this case.
Engine 152 is connected to die by visitation of God database 158.Said engine 152 active banks 158 are used for the information of storage about the instance of the Email that sends to non-existent or " seed " address.Database 158 is the storing IP address information also, for example, is confirmed as the IP address in the source that possibly be spam and/or DHA by engine 152.Said information can be used for RTIN engine 108.
Fig. 8 has shown the process flow diagram of diagram by the die by visitation of God process of die by visitation of God system 150 execution.At piece 160, be identified as from the arrival Email of theme IP address and be sent to non-existent e-mail address, for example, through message processing procedure 122.In some cases, this possibly mean that said object Email causes that receipt mail server 156 produces the 500th type of mistake, promptly means the address of receipt mail server 156 nonrecognition email messages.Said Email possibly be marked as the address with coupling " seed " address or die by visitation of God address pattern (" SD pattern ").The SD pattern be impossible be true mailbox mailbox (for example, ptexql).Die by visitation of God engine 152 can keep the tabulation of this SD pattern.At piece 162, whether die by visitation of God engine 152 is confirmed to transmit the address and is mated with one of SD pattern.If so said process proceeds to piece 164.Otherwise piece 164 is skipped.At piece 164, whether die by visitation of God engine 152 check SD patterns are used in e-mail address existence, legal.For example, if said Email is sent to " ptexqlxyz.com ", mailbox " ptexql " will be matched with SD pattern " ptexql " so.Yet, might have the electronic mail account that is matched with said SD pattern equally.So, at piece 164, said die by visitation of God engine 152 can querying server " xyz.com " to confirm whether necessary being of mailbox " ptexqlxyz.com ".If die by visitation of God process so can finish and said Email can be by normal delivery.Otherwise said process proceeds to piece 166.It should be noted that the addressee does not match the SD pattern if at piece 162, so said process proceeds to piece 166 equally.
At piece 166, make and transmit the decision whether very blur the address.For example; If said Email is for sending to " ptexqlxyz.com " and legal electronic mail account " prexqlxyz.com " existence; So because these two addresses are very similar, so mistake appears in the time marquis that very possible transmitter transmits the address in input.Therefore, whether piece 166 can comprise transmitting the address and existing the address to compare to exist different quantity between the address greater than the quantity of different (the for example characters) be scheduled to confirm to transmit address and any, for example, and greater than one or two difference.If not (is " denying " at piece 166), die by visitation of God engine 152 thinks that said Email maybe be by the legal Email of mistake input so.Otherwise (being " being ") at piece 166, so said Email is considered to spam, and die by visitation of God engine 152 to upgrade die by visitation of God database 158 be possible source of spam email to discern said source IP address.
Refer back to Fig. 1 once more, another example of data source 102 can comprise IP address information database (or a plurality of database).Said information can provide by providing about the spam of reception and the client 106 of the information of the IP address of sending said spam.Said information also can be provided by the system manager about the IP address.IP address information database can comprise and stop tabulation, such as the tabulation of the IP address in the source that is known as spam or other rogue activity.IP address information database can comprise reliable to a certain extent " gray scale tabulation " IP address, and for example wherein kept the score according to their degree of reliability in the IP address.IP address information data can comprise that also known can not be the tabulation of reliable IP address in the source of spam or other rogue activity.
As if reliable IP address can be discerned the identifying that can not send the territory of spam through comprising.This can comprise based on anticipatory behavior specifies reliable rank for the IP address, and wherein reliable rank is crossed over the spam meeting or a lot of degree of the possibility that can not be sent out.Reliable rank can be based among other fact, commerce, industry or other exploration.It is relevant with some industry that the IP address can be identified as, and for example the IP address block can be identified as and belong to finance or science of law mechanism or even cover the classification of " reliable usually " of many common responsible entity.In certain embodiments, classification can be associated with certain reliable rank, can automatically specify the reliable rank that is associated to said so be appointed as the IP address or the territory of a classification.
If from history, particular ip address is that known source of spam email or other malice or the Internet do not expected are movable, this information can be maintained in the IP address information database so.If from history, an IP address is the known email source accepted or other Internet traffic, this information also can be stored in the IP address information database so.In certain embodiments, the IP address can be by according to historical information mark or graduation.Mark or grade can be represented the activity in acceptable or past of not expecting.In certain embodiments, can implement progressively to increase activity detection system, it can reduce other grade of reduction level of for example indicating reliability of said IP address based on the detection to the increase of the rogue activity that is derived from said IP address or address block.If in a period of time, detect the obvious minimizing of spam or other rogue activitys, the IP address also can regain the grade of raising so, for example becomes and thinks more reliable.This information can be updated with the predetermined time interval based on the real-time Communication for Power amount information of Internet traffic supervisor.
Forward Fig. 9 now to, the flowchart illustrations of demonstration increase the embodiment of the process of RTIN database 114.In this embodiment, traffic supervisory system 120 can be used as one of data source 102.
Start from piece 170, traffic supervisor 128 receives real-time Communication for Power amount statistic and upgrades.Then, at the state of piece 172, traffic supervisor 128 is collected real-time arrival SMTP and is connected data, message meta-data and message transmission information, comprises the source and destination data.The source and destination data can comprise source data that is associated with sender mail server 124 and the destination data that is associated with receipt mail server 126.Therefore traffic supervisor 128 is come the storage of real time statistic according to the IP address that system 120 is routed of passing through that is used for send server.In particular implementation, traffic supervisor 128 can be responsible on all send servers or MTA, keeping the information of relative short-term, for example 60 seconds.All those transmissions IP addresses all are stored in the storer grid of traffic supervisor 128 inside; It keeps the multiple information about those source IP addresss; Sent how much message such as them; They have produced the mistake of what " the 500th type of mistakes " or other type, and content-based scanning, and how many spam messages they have sent.In certain embodiments; Said traffic supervisor 128 can be configured at any time only know in 60 seconds in the past what has taken place; And if one separately connect to open and be longer than 60 seconds, the data that said traffic supervisor 128 can continue to accumulate said connection need only said connection and exist.
Below, like that in the piece 174 of Fig. 9, indicates, RTIN engine 108 data query sources 102.In current embodiment, this comprises query communication amount supervisory system 120, and scanning is stored in the data in the traffic supervisor 128.The scanning of traffic supervisor 128 can make periodically, and is for example more frequent than 60 seconds, took place once such as per 15 seconds.Ideally, the time cycle between the scanning should be retained in the time total amount in the traffic supervisor 128 less than data.
RTIN engine 108 can be inquired about additional data source 102, such as above-described those.For example, in certain embodiments, RTIN engine 108 can be inquired about attack database 138, die by visitation of God database 158 and/or above-described other databases twice.
In case collected data from each data source 102, RTIN engine 108 just can image pattern 9 in that kind of piece 176 indications handle the result of inquiry.Collecting under the data conditions from traffic supervisory system 120, RTIN engine 108 can be collected data in traffic supervisor 128, and uses the pattern of the said data of interpreter process analysis procedure analysis with the inner message of the traffic of discerning the message that can abide by.Said interpreter process can be the interpreter process of describing as in the movable EMS patented claim above-mentioned.The pattern that said interpreter process is confirmed to be associated with email message through the metadata of analyzing the source and destination data and being written to traffic supervisor or or even the user send the behavior of said message.In certain embodiments, said interpreter process can be considered from the data of additional data source 102 receptions.
As exemplary process, although said interpreter process can discern that attack-DHA, spam attack, virus outbreak and mail bomb/service-denial attack-RTIN database 114 of four types can be defined as the information of the many other types of identification flexibly or about the attack of particular ip address.As specific examples, if being detected, source IP address is absorbed in one or more in these four kinds of attacks, the counter that is associated with the particular type of the attack of that source IP address and identification so can be added 1.As specific embodiment; Just be absorbed in DHA if RTIN engine 108 scans traffic supervisory system 120 also definite source IP addresss " XYZ " at midnight, counting can be added in the classification of " XYZ " source IP address clauses and subclauses relevant in the RTIN database 114 so separately.If this is the new clauses and subclauses of source IP address hereto, its relevant source is DHA=1 so.If " XYZ " source that in the scanning process of next minute, recognizes is still being attacked, its source will be increased 1 so, and the associated score that produces a renewal is DHA=2.Said process can continue to rise to for example 99 maximal value.If for 99 directly scanning, source IP address " XYZ " is also being attacked the someone based on traffic monitoring analysis, counter will be added to 99 so, and it can be defined as maximal value.
Indicated like the piece in Fig. 9 178, be used to upgrade RTIN database 114 from the data of interpreter process result.According to the characteristic of the data that receive from additional data source, what possibility was suitable is directly to use from the data of some data sources 102 receptions to upgrade the RTIN database and do not need indicative processing.For example, if a data source 102 provides the information that the IP address should be prevented from.
At optional 179 that shows, RTIN controller 116 pushes away the RTIN Data Update to RTIN server 118.The said optional embodiment that can be used to like second embodiment that shows among Fig. 3.Needn't be used for other embodiment for optional 179, such as first embodiment that shows among Fig. 2.In fact piece 179 is provided so that the RTIN database 114 at RTIN server 118 places can be synchronized to the RTIN database 114 at RTIN controller 116 places.
Only keep data in short time though it should be noted that traffic supervisor 128, RTIN database 114 that can keep accumulating with the information longer time about the IP address that upgrade.
Client 106 can utilize the source reputation information in the RTIN database through many modes.A kind of mode is that client is made the DNS type inquiry about the IP address of asking the TCP connection.Below with reference to being presented at process flow diagram among Figure 10 how this DNS type inquiry is implemented system 104 by client 106 example is described.
Start from piece 180, the TCP connection request that client 106 receives from source IP address.For example, source IP address possibly just attempted setting up with client 106 SMTP and be connected to transmit email message.Said client 106 will be inquired about said source credit system 104 before confirming said connection request.In certain embodiments, shown in piece 182, said client 106 comprises the RTIN client computer that is used for producing through effective key the inquiry of authentication.
For the source credit system 104 that is provided for commercial signature, desired is that said RTIN database 114 visits for the user of said signature by paying only.Therefore, what system 104 can provide authentication has access to RTIN database 114, and safety key (in a kind of exemplary process) is bonded to from the DNS type look-up command that RTIN client 106 sends thus.The form of RTIN look-up command can be the form for the pre-prepd mixed and disorderly safety key in IP address that will search.Therefore, for example a mixed and disorderly safety key can be " 45492147 ", and the particular ip address that will search can be 127.000.000.001.The complete order form just can be " RTIN.45492147.127.000.000.001.RTIN.postinicorp.com " in that instance so.Therefore, usual way is that client 106 uses and wants the IP or " machine " address of searching, and before the IP address, prepares the mixed and disorderly safety key of MD5 in advance, and makes the DNS type inquiry of RTIN engine 108.Said RTIN access security key can be periodically expired, and this will improve the safety of system.In a kind of exemplary process, each key can be effectively in 60 day cycle, and new key provided once in per 30 days, and continuous thus key will have 30 days overlapping.Key can be provided through any one of many methods, comprises through computer-readable medium distributing or through safe online access and checking.Multi-keys can be provided in advance, be equivalent to the key in 2 years so that certain subscriber can have, and can be updated periodically by the subscriber.
At piece 186, in case client 106 has obtained the visit to source credit system 104, so said client 106 inquiry RTIN engines 108 are about the information of said source IP address then.Then at piece 188, if implemented the request of authentication, RTIN engine 108 authentication described requests, and at piece 190, RTIN engine 108 inquiry RTIN databases 114 are about the information of source IP address.At piece 192, RTIN database 114 returns Query Result to the RTIN engine.Then, at piece 194, RTIN engine 108 provides Query Result to client 106.
In certain embodiments, piece 194 can comprise according to the client properties that is stored in client's configuration database 110 and handles said Query Result.For example, be stored in the tabulation that clients configuring file in the database 110 can comprise reliable or known malice IP address.Said tabulation can be used to revise the information that receives from RTIN database 114.For example; If RTIN database 114 comprises said source IP address and possibly be the information of source of spam email and should be prevented from; But client's configuration comprises the information to the IP address block that should be prevented from never that comprises said source IP address, and client's attribute can be preferentially so that RTIN engine 108 report source IP addresss be one that should not be prevented from so.
At last, at piece 196, client 106 receives Query Result.At the moment, client 106 can respond the connection request that comes from said source IP address based on said Query Result with to client 106 local policy.
Although above-described access method is described to the DNS type method, inquiry is not standard DNS inquiry.For example, the DNS inquiry generally includes submits to domain name to give dns server, and it will return the IP address then.On the contrary, the said inquiry that is used to visit the RTIN database is IP address itself, and the information of returning also be the RTIN database known about characteristic as the particular ip address of send Email server.
Client 106 utilizes the another kind of method of the source reputation information in the RTIN database 114 to comprise that system 104 directly provides the process of information to customer rs router.Referring now to Figure 11～13 process how the RTIN data are provided for customer rs router is described.Be identified as before said process is based upon and use it on other technology of Email grouping/router level.On the Internet with company intranet in the common grouping routed path that passes millions of routers that generates of message router; So that the message that sends to the Internet from lowermost level IP address can find the route that arrives its expectation destination; These message routers adapt to message communicating amount processing speed and the propagation times on some router, and constantly adapt to " shutdown " or disabled router.The adaptability of grouping routing architecture is as one of extensively universal factor of the Internet that the reliable means of transmitting electronic information is provided for company, education and client user in this Internet.
Be used for the standard agreement of the shared message routed path of Internet router (RFC) is developed by " Internet draft standard ", international internet association sets up its standard through said draft.In these years the agreement of exploitation comprises Exterior Gateway Protocol (EGP), and it is widely used Internet in early days, and Border Gateway Protocol (BGP), and it just day by day replaces EGP as preferred Internet host-host protocol.BGP more than current the doing is Border Gateway Protocol 4 (BGP-4), and it is described in RFC 1771.
In order to understand BGP, Internet can be imagined as the set of autonomous system.For example, the part of Internet one group of autonomous system 200～204 that can be described to show among Figure 11.Each autonomous system 200～204 can use border router 206～210 directly to communicate by letter with some other autonomous system 200～204.In addition, each autonomous system 200～204 is not that direct-connected autonomous system 200～204 is communicated by letter with other.For example, autonomous system (AS-A) 200 can use autonomous system (AS-C) 202 as communicating with autonomous system (AS-E) 204 through service.Also possibly be autonomous system (AS-A) 200 use autonomous systems (AS-B) 201 with (AS-D) 203 as through service and communicate with autonomous system (AS-E) 204.Therefore, router RA 206 optional majority paths allow autonomous system (AS-A) 200 and (AS-E) communication between 204.It should be noted that Figure 11 only provides very simple view, for example, communication is often through providing through the internal router of the autonomous system of service and by relaying.
In order to make communicating by letter of router RA 206 request and router RE 210, it must at first know one or more path of arrival router RE 210.Router RA 206 can use BGP from router RB 207 and the possible path of router RC 208 study.BGP is made by the for example router of router two 06～210 to be used for the agreement of exchange network getatability information.So in example shown in Figure 11, router RC 208 can use BGP to notify router RA 206 to arrive the available path of AS-E 204; Equally, router RB 207 can use BGP to notify router RA 206 to arrive the available path of AS-E 204 through the router RD 209 (supposing that router RD209 has notified router RB 207 to arrive the path of AS-E 204) of AS-D 203.The exchange of this routing iinformation usually occurs in when initially setting up the straight-forward network connection, for example, and when router RA 206 is initially connected to router RB 207.Router RA 206 will use from the routing iinformation of router RB 207 receptions and set up bgp routing table.Bgp routing table can be updated after after a while, because received routing update from router RB 207 (and from other routers, such as router RC 208).
Get back to Fig. 1, RTIN engine 108 can be configured to communicate by letter with 107b with the router one 07a of client 106a and 106b respectively.Have independent router one 07 though each client 106 is shown as, each client 106 can comprise the router one 07 of any amount.
Figure 12 has shown the block diagram of the instance of client 107.Router one 07 comprises routing table 212 and with bit table 214.RTIN engine 108 can be configured to use bgp protocol to communicate.So; In case be configured to suitably comprise that with bit table 214 RTIN engine 108 is as peer; RTIN engine 108 can instruct router one 07 to upgrade routing table 212 so, and provides route data to be stored in the routing table 212 according to the information that is stored in the RTIN database 114.
Therefore, another characteristics of RTIN engine 108 are that it can provide the connection data to customer rs router 107, and said customer rs router 107 can effectively stop particular ip address and 106 foundation of respective client system to be got in touch.RTIN engine 108 data query sources 102 also form the concentrated image of the Internet traffic.In certain embodiments; RTIN engine 108 can be compared the information of collecting from the Internet traffic data with the client properties being stored in configuration database 110, and tackles the infringement property IP address that each client 106 stops based on said relatively the generation.In other embodiments, predetermined threshold or decision-point can be used to produce the IP address list of prevention.The router for having the router specific knowledge " is pretended " in 108 pairs of many independences of RTIN engine (or group) property invaded IP address then.RTIN engine 108 issue update command are to router one 07 and use black hole routing iinformation relaying that BGP will be used to the property invaded IP address to router one 07.Router one 07 is according to their routing table 212 separately of the new black hole updating route information that receives from RTIN engine 108 then.
By the black hole routing iinformation of RTIN engine 108 issue use the black hole route be stored in before having replaced in the routing table 212 be used to the property invaded IP address have routing iinformation.The black hole route be routed to except with the position of the system of said infringement property IP address.In certain embodiments, the black hole route can be to the route that is provided and be stored in the selectable location in the configuration database 110 by client 106.
The influence of using the black hole route to replace legal route can make an explanation through Figure 13.In Figure 13, router two 20 is the legal routes from origin system 222 to purpose client 106.Router two 20 can comprise the route of carrying out through service system 226 through many.
Connect in order between origin system 222 and purpose client 106, to set up TCP, the exchange of message or grouping must take place between two systems 222 and 106.Origin system 222 can through send first be grouped into purpose system 106 the IP address initiate to set up the trial that TCP is connected with purpose system 106.Be sent out in case said first divides into groups, origin system 222 is just waited for the affirmation from purpose system 106.Said initial packet receives along route 220 transmission and by purpose system 224.When receiving said initial packet, purpose system 224 prepares and sends one and confirm to divide into groups.Suppose that the router of purpose system 106 knows legal route; Said route maybe be identical or different with route 220; Get back to origin system 222, said affirmation is sent out back origin system 222 and is received by it, so the further communication between source and destination system 222 and 106 can take place.
On the other hand, suppose that RTIN engine 108 is identified as the property invaded system with origin system 222.In certain embodiments, this specific behavior pattern that possibly mean that origin system 222 is showed conforms to the standard that purpose system 106 sets.After RTIN engine 108 has been discerned origin system 222; For example through IP address or IP address block, RTIN engine 108 will instruct one or more router ones 07 their routing table 212 of renewal of purpose system 106 so that obtain the legal route of origin system 222 and replaced by black hole route 228.Attempt subsequently and purpose system 106 when connecting when origin system 222 then, it will be unsuccessful that said connection is attempted.Origin system 222 sends to the IP address of purpose system 106 with initial packet, and said initial packet will be sent to purpose system 106 via legal route 150 from origin system 152.As response, acknowledge message will prepared and issue in purpose system 106.Yet, because unique route of the IP address of the arrival origin system 222 that the router one 07 of purpose system 106 is known is black hole routes, so acknowledge message is not sent to origin system 222.On the contrary, said acknowledge message is pointed to address, black hole 230.Through special time after the cycle, the TCP that origin system 222 is made connect attempt will " overtime " and origin system 222 will think that purpose system 106 is unavailable or can not arrive.Therefore stoped further communication from origin system 222.
As stated; Through black hole technology is used in combination with the source credit system, thereby the source credit system threatens Email and provides objectively, prevents the appearance of this threat with direct identification and through on the router rank, stoping with communicating by letter of system of infringement property accurately.The property invaded IP address is by real-time monitored and tabulation, is not that said process comes from traditional RBL (RBLs), and is often scolded through part and inefficient artificial reporting process.The source credit system also is objectively, in case because the assaulter has removed their message behavior, the source credit system just is removed from tabulation automatically.Many RBLs of today after the suspection incident with IP address Liu the tabulation on for a long time.Use the source credit system to assess threat based on probability score, rather than simply be/deny process, make the copartner use the chromatographic analysis technology to make the decision of whether accepting Email.As a result, the source credit system will produce false positive still less, and just legitimate ip address is regarded as malice by error.
Consider defence catalogue collection attack according to the source credit system of notion described here; Be that spam is being made through the conjecture home address and through registering the complete e-mail directory of " results " enterprise, do not receive " mailbox does not find " message of returning in this example.The source credit system through seem whole goal systems unavailable or " not finding " so that this attack efficient is very low.Be absorbed in the spam transmission or play the part of the relaying of spam transmission or the IP address of passage though RBL just lists out usually, the source credit system provides to be attacked and sees clearly based on what the service-denial of Email was attacked those execution catalogue collections.The source credit system follows the tracks of through the IP address and related catalogue is collected attack and spam is attacked, and the results were quite startling.DHA can take the exemplary electronic mail server the arrival SMTP traffic and capacity 40%, and the guiding indicator of spam activities normally.
Though above according to principles illustrated described here various embodiment, be to be understood that they only are rendered as example at this, itself and be not restrictive.Therefore, width of the present invention and scope should not limited by above-described any one illustrative examples, and only should be defined according to claim of delivering from said disclosure and their equivalents.In addition, above-mentioned advantage and characteristics are provided among the described embodiment, do not accomplish in one of above-mentioned advantage or the whole process and structure but should not limit this claim that obtains is applied to.
In addition, the division header here is provided the prompting that the suggestion that is used for 37CFR 1.77 is consistent or tissue is provided.These titles should not limit or qualitative listed the present invention of any claim that can deliver from said disclosure.Particularly also through example, although title relates to " technical field ", this claim should not limited by the language of selecting down from this title of describing so-called technical field.And the technology of in " background technology ", describing can not be by literal translation for to admit that said technology all is a prior art to all inventions in the said disclosure." summary of the invention " can not be considered to be in the characteristic of delivering of the present invention that claim proposed.In addition, " invention " with independent form reference all can not be used to argue the novelty that single point is only arranged in said disclosure in said disclosure.A plurality of inventions can propose according to the restriction of a plurality of claims of delivering from said disclosure, thereby and this claim also defined the present invention and equivalents thereof, so they are protected.In all examples, the scope of this claim should be considered according to said disclosure, and should not retrained by the title that proposes here.