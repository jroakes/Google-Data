US7873114B2 - Method and apparatus for quickly detecting a presence of abrupt noise and updating a noise estimate - Google Patents
Method and apparatus for quickly detecting a presence of abrupt noise and updating a noise estimate Download PDFInfo
- Publication number
- US7873114B2 US7873114B2 US11/693,028 US69302807A US7873114B2 US 7873114 B2 US7873114 B2 US 7873114B2 US 69302807 A US69302807 A US 69302807A US 7873114 B2 US7873114 B2 US 7873114B2
- Authority
- US
- United States
- Prior art keywords
- noise
- energy
- channel
- peak
- estimator
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Active, expires
Links
Images
Classifications
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L25/00—Baseband systems
- H04L25/02—Details ; arrangements for supplying electrical power along data transmission lines
- H04L25/0202—Channel estimation
- H04L25/022—Channel estimation of frequency response
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L25/00—Baseband systems
- H04L25/02—Details ; arrangements for supplying electrical power along data transmission lines
- H04L25/0202—Channel estimation
Definitions
- the present invention relates to mobile communication devices, and more particularly, to noise suppression systems in mobile communication devices.
- Mobile communication devices such as a cell phone or radio, are used primarily for voice communication.
- speech may be contaminated with unwanted noise.
- the noise may be background noise, such as car noise, street noise, or babble noise, that is audibly present in the environment and that degrades the intelligibility of the speech.
- Mobile communication devices generally include a noise suppressor for suppressing unwanted noise in the speech.
- the noise suppressor may be a stand-alone module, or a module integrated within a vocoder. As shown in FIG.
- a mobile communication device generally includes a microphone 20 for capturing speech, an analog to digital converter 30 for generating a digital signal from the speech, an equalizer 40 for adjusting an equalization of the digital signal, a vocoder 50 for compressing the equalized signal, and a modem 60 for transmitting the compressed signal.
- the input to the microphone 20 may consist of speech and unwanted noise.
- the vocoder 50 can include an internal noise suppressor 100 that suppresses unwanted noise, such as background noise, in the input signal.
- a vocoder 50 such as the Enhanced Variable Rate Coder (EVRC) is a voice compression system used with the International Standard (IS-95) Rate 1 CDMA interface.
- the EVRC employs an adaptive noise suppressor (NS) 100 for suppressing unwanted noise in an input signal.
- the adaptive NS 100 is based on a spectral subtraction technique that effectively subtracts a noise estimate from the input signal.
- the adaptive NS 100 requires a good estimate of the noise to achieve acceptable noise suppression.
- the noise can be estimated during times of silence, or non-speech activity.
- the adaptive NS 100 relies on an assumption that the noise (generally background noise) is stationary or slowly varying non-stationary. This allows the adaptive NS 100 to generate a reliable estimate of the noise during non-speech activity.
- the adaptive NS 100 misinterprets the noise as speech. Consequently, the adaptive NS 100 does not update the noise estimate nor immediately suppress the noise. As a result, the adaptive NS 100 can only suppresses noise in accordance with a previous noise estimate. This delay in immediately recognizing the noise leaves much noise that is unsuppressed for a significant period afterwards. Over time the adaptive NS 100 will recognize the noise, update an estimate of the noise, and begin the noise suppression process. However, during this time, the unwanted noise is audible and present in the compressed speech signal. A need therefore exists for improving the detection and suppression of abrupt noise in a signal.
- One embodiment is a method for detecting noise in a signal.
- the method can include estimating a subband energy of the signal to produce an estimated channel energy over a pre-specified time window, calculating a peak-to-peak energy difference between a maximum subband energy and a minimum subband energy of the estimated channel energy, and calculating a spectrum deviation of the signal as a difference between the estimated channel energy and a long-term channel energy.
- a presence of noise and a request to update a noise channel estimate can be declared if a) a total estimated channel energy is greater than a predetermined noise floor, b) the spectrum deviation is less than a predetermined variance threshold, and c) the peak-to-peak energy difference is less than a predetermined peak-to-peak threshold.
- the apparatus can include a frequency domain converter that represents the signal as a plurality of energy channels in a frequency domain of the signal, a channel energy estimator that produces an estimated channel energy, and a spectral deviation estimator that calculates a peak-to-peak energy difference between a maximum subband energy and a minimum subband energy of the estimated channel energy and calculates a spectrum deviation of the signal as a difference between a long-term channel energy and the estimated channel energy.
- the apparatus can include a background noise estimator that estimates a noise channel energy, an a noise update detector that declares the presence of noise based on the peak-to-peak energy difference and the spectral deviation.
- Yet another embodiment is a method for detecting noise in a signal, suitable for use in a spectral subtraction based noise suppressor.
- the method can include estimating a subband energy of a frame of the signal to produce an estimated channel energy, calculating a spectrum deviation of the signal as a difference between the estimated channel energy and a long-term channel energy, evaluating a ratio between a maximum subband energy and a minimum subband energy of the estimated channel energy, incrementing a noise update count if the ratio is less than a predetermined threshold, and updating a noise channel energy if the noise update count is greater than an update count threshold.
- the method can further include estimating a channel SNR from the estimated channel energy and the noise channel energy, and applying a spectral gain scaling to the estimated channel energy in accordance with the SNR to suppress the noise.
- the spectral subtraction based noise suppressor can be integrated in an enhanced variable rate coder (EVRC) to comply with an IS-95x CDMA interface.
- EVRC enhanced variable rate coder
- FIG. 1 is a block diagram of an exemplary mobile communication device having an adaptive noise suppressor
- FIG. 2 is a block diagram of an adaptive noise suppressor that suppresses abrupt noise in accordance with the embodiments of the invention
- FIG. 3 is a method for detecting the presence of noise in accordance with the embodiments of the invention.
- FIG. 4 illustrates a frequency representation of an input signal in accordance with the embodiments of the invention
- FIG. 5 illustrates channels of the frequency representation of FIG. 4 a in accordance with the embodiments of the invention
- FIG. 6 illustrates a peak-to-peak energy difference for a noise spectrum in accordance with the embodiments of the invention
- FIG. 7 illustrates a peak-to-peak energy difference for a speech spectrum in accordance with the embodiments of the invention
- FIG. 8 illustrates a spectrum deviation for a noise spectrum in accordance with the embodiments of the invention.
- FIG. 9 illustrates a spectrum deviation for a speech spectrum in accordance with the embodiments of the invention.
- FIG. 10 identifies noise update criteria for updating a channel noise estimate in accordance with the embodiments of the invention.
- FIG. 11 is a simulation result of the adaptive noise suppressor that does not use the criteria of FIG. 10 in a noise update logic in accordance with the embodiments of the invention.
- FIG. 12 is a simulation result of the adaptive noise suppressor that uses the criteria of FIG. 10 in a noise update logic for suppressing abrupt noise in accordance with the embodiments of the invention.
- the terms “a” or “an,” as used herein, are defined as one or more than one.
- the term “plurality,” as used herein, is defined as two or more than two.
- the term “another,” as used herein, is defined as at least a second or more.
- the terms “including” and/or “having,” as used herein, are defined as comprising (i.e., open language).
- the term “coupled,” as used herein, is defined as connected, although not necessarily directly, and not necessarily mechanically.
- the term “suppress”, as used herein, is defined as partially or wholly attenuating noise within a signal.
- the term “abrupt noise”, as used herein, is defined as high energy noise with a relatively flat or approximately uniform noise spectrum.
- embodiments of the invention are directed to a method and apparatus for detecting a presence of abrupt noise in a signal.
- Abrupt noise is generally characterized as a rapidly varying high energy signal with a relatively flat noise spectrum.
- the method and apparatus can update a noise estimate in response to the detecting for quickly suppressing the abrupt noise.
- two metrics are introduced within a noise decision logic for declaring a presence of abrupt noise.
- a ratio between a maximum subband energy value and a minimum subband energy value within a specified time window is determined to characterize the signal as speech or noise.
- the ratio is a first metric employed in the noise update logic. This ratio is compared with a certain threshold, where a smaller ratio indicates the absence of speech.
- a spectral deviation is calculated that identifies spectral characteristics of the input signal.
- the spectral deviation is a second metric employed in the noise update logic. Noise is declared present when the spectral deviation is less than a predetermined amount and if the overall signal energy is above an energy threshold.
- the novel method of speech detection herein presented introduces a peak-to-peak energy difference metric (e.g. ratio) and a spectral deviation metric within a noise update decision logic for improving detection of abrupt noise.
- the two metrics are used to increase an update count of noise frames in the noise update decision logic.
- the method when combined with the noise update decision in a noise suppression system, such as the EVRC NS, allows for quick detection, quick updating of the noise estimate, and tracking of abrupt noise.
- the noise suppressor can quickly respond to changes in noise and update a noise estimate.
- the updated noise estimate can be subtracted from the original signal to quickly suppress the abrupt noise thereby enhancing the user listening experience.
- the adaptive NS 100 includes a frequency domain converter 110 that represents the input signal s(n) as a plurality of gain channels G(k) in a frequency domain of the input signal.
- the input signal s(n) may be high-pass filtered s HP (n) to remove low energy noise or to adjust a spectral tilt of the input signal in accordance with a vocoder input requirement.
- the channel energy estimator 115 is operatively coupled to the frequency domain converter 110 and produces an estimated channel energy E ch (m) from the input signal s HP (n).
- the spectral deviation estimator 120 is operatively coupled to the channel energy estimator 115 and calculates a spectrum deviation ⁇ E (m) of the estimated channel energy E ch (m).
- the peak-to-peak detector 123 is operatively coupled to the channel energy estimator and estimates a peak-to-peak energy difference ⁇ P-P (m) in the estimated channel energy E ch (m).
- the background noise estimator 125 is cooperatively coupled to the channel energy estimator 115 and estimates a noise channel energy, E N (m), during periods of silence, or non-speech activity, in the input signal.
- a noise update detector 130 is operatively coupled to the spectral deviation estimator 120 , the peak-to-peak detector 123 , and the channel energy estimator 115 .
- the noise update detector 130 declares a presence of noise in the input signal s HP (n), based on the peak-to-peak energy difference ⁇ P-P (m) and the spectral deviation ⁇ E (m) calculated by the peak-to-peak detector 123 and the spectral deviation estimator 120 , respectively. Briefly, these two metrics identify the presence of abrupt noise and are used in conjunction with a noise update decision logic of the noise update detector 130 to update a count of noise frames.
- the adaptive noise suppressor (NS) 100 also includes a channel signal-to-noise (SNR) ratio estimator 135 operatively coupled to the channel energy estimator 115 , the background noise estimator 125 , and the noise update detector 130 .
- the channel SNR ratio estimator 135 estimates a SNR from the estimated channel energy E ch (m) and the noise channel energy E N (m).
- a channel gain module 140 is cooperatively coupled to the channel (SNR) ratio estimator 135 and the background noise estimator 125 .
- the channel gain module 140 applies a spectral gain scaling ⁇ ch (m) to the plurality of energy channels (m) in accordance with the SNR to suppress the abrupt noise.
- a voice metric module 137 is operatively coupled to the channel SNR estimator 135 and determines a voicing level of the input signal.
- the voicing level identifies a periodicity of the input signal which is generally absent in abrupt noise.
- a channel SNR modifier 139 is operatively coupled to the voice metric module 137 and the channel gain module 140 .
- the channel SNR modifier 139 determines the spectral gain scaling ⁇ ch (m) in view of the voicing level.
- a time domain converter 150 is operatively coupled to the channel (SNR) ratio estimator 135 and the frequency domain converter 110 .
- the time domain converter 150 converts the plurality of energy channels that have been gain-scaled to a time domain signal s(n).
- a method 200 for detecting the presence of noise in a signal is provided.
- the method 200 can be practiced with more or less than the number of steps shown.
- FIGS. 2 , and 4 - 9 reference will be made to FIGS. 2 , and 4 - 9 , although it is understood that the method 200 can be implemented in any other manner using other suitable components.
- the method 200 can contain a greater or a fewer number of steps than those shown in FIG. 3 .
- a subband energy can be estimated to produce an estimated channel energy over a pre-specified time window.
- a subband energy is an energy of the input signal within a frequency band.
- the pre-specified time window corresponds to a frame size of the input signal.
- the input signal can be represented as a series of 10 ms frames but can be any other frame size.
- the frequency domain converter 110 can to produce a magnitude signal spectrum, and the channel energy estimator 115 can perform a filter-bank operation on the signal spectrum to calculate an estimated channel energy.
- the input signal is represented as a sequence of frequency bins 260 .
- the frequency bins 260 can be categorized into non-overlapping (or overlapping) channels (m) 270 to produce the estimated channel energy 257 .
- the non-overlapping channels can approximate critical bands having bandwidths that increase with frequency.
- the sum of the frequency bins 260 within each channel 270 represents the subband energy of the estimated channel energy 257 .
- FFT Fast-Fourier transform
- a peak-to-peak energy difference between a maximum subband energy and a minimum subband energy of the estimated channel energy can be calculated.
- the peak-to-peak detector 123 identifies the maximum subband energy channel and the minimum subband energy channel of the estimated channel energy 257 for a frame of speech, and calculates the absolute difference.
- the channel energy estimator 115 can identify a maximum subband channel energy (dB), identify a minimum subband channel energy, and subtract the minimum subband channel energy from the maximum subband channel energy to produce the peak-to-peak energy difference ⁇ P-P (m).
- the channel energy estimator 115 can also apply an exponential windowing factor to the average long-term channel energy over time to smooth the spectrum deviation.
- FIG. 6 a plot illustrating the peak-to-peak energy difference ⁇ P-P (m) of the estimated channel energy 257 for a noise spectrum 300 is shown.
- the noise spectrum 300 is relatively flat with minimal variation which is characteristic of most background noise. Accordingly, a peak-to-peak energy difference ⁇ P-P (m) 315 between a maximum energy channel 305 and a minimum energy channel 310 is relatively small.
- FIG. 7 a plot illustrating the peak-to-peak energy difference ⁇ P-P (m) of the estimated channel energy 257 for a speech spectrum 330 is shown.
- the speech spectrum 330 has areas of high energy corresponding to the formants speech.
- a speech spectrum 330 tends to have greater peak-to-peak energy differences than a noise spectrum 300 .
- a peak-to-peak energy difference 345 ⁇ P-P (m) between a maximum energy channel 335 and a minimum energy channel 340 for a speech spectrum is large compared to the peak-to-peak energy difference 315 ⁇ P-P (m) of the noise spectrum.
- a spectrum deviation of the signal can be calculated as a difference between the estimated channel energy and a long-term channel energy.
- the long-term channel energy can be a running average of the estimated channel energy for each frame.
- the spectral deviation estimator 120 identifies a variance for each subband energy channel 270 ( m ) over time, and calculates the absolute changes in the variance.
- the spectral deviation estimator 120 calculates an absolute difference between an average long-term channel energy (dB) and a current channel energy (dB) for each channel 270 , and sums the absolute differences for the plurality of channels to produce the spectrum deviation.
- the spectral deviation estimator 120 can also smooth the frequency bin estimates over time to reduce variation in assessing the subband channel energy. For example, spectral deviation estimator 120 can apply an exponentially weighted low-pass filter to the plurality of channels over time to smooth the estimated channel energy.
- FIG. 8 a plot illustrating a noise spectrum deviation ⁇ E (m) 416 of the estimated channel energy 257 for a noise spectrum 300 is shown.
- a spectrum deviation can be calculated for each channel and averaged for the frame.
- a background noise spectrum exhibits lower spectral deviation than a speech spectrum. For example, referring to FIG.
- a plot illustrating a speech spectrum deviation ⁇ E (m) 426 of the estimated channel energy 257 for a speech spectrum 330 is shown.
- the speech spectrum deviation ⁇ E (m) 426 is between an upper bound 420 and a lower bound 425 .
- the speech spectrum deviation ⁇ E (m) 426 is considerably larger than the noise spectrum deviation ⁇ E (m).
- a presence of noise can be declared and a request for a noise channel estimate update can be made in view of the spectrum deviation and the peak-to-peak energy.
- the peak-to-peak detector 123 calculates and determines if the peak-to-peak energy difference ⁇ P-P (m) is less than an energy threshold.
- the spectral deviation estimator 120 calculates and determines if the spectrum deviation ⁇ E (m) is less than a deviation threshold.
- the noise update detector 130 requests an update to an channel noise estimate if these two conditions are met.
- the ⁇ P-P (m) criteria and the ⁇ E (m) criteria are supplemental criteria to a noise update logic section within the noise update detector 130 .
- the method 200 can end.
- the noise update decision module 130 determines when the noise estimate should be updated. During operation, the noise update decision module 130 counts the number of frames that are considered non-speech, and updates the noise channel estimate if the number of frames exceeds an update count threshold. In normal operation, the noise update decision module 130 updates the noise channel estimate based on criteria including determining if a voicing level metric level is below a threshold, or determining if a total subband channel energy is greater than a noise floor.
- the novel aspects of the invention herein extend the noise update logic criteria to include measures of spectrum deviation ⁇ E (m) and peak-to-peak energy differences ⁇ P-P (m).
- the method 200 is implemented in the noise update decision module 130 to update the existing decision logic.
- the noise estimate update logic is extended to include two criteria determining whether 1) the spectrum deviation ⁇ E (m) is greater than an adaptive deviation threshold, and 2) the peak-to-peak energy difference ⁇ P-P (m) is less than a predetermined threshold.
- both criteria must be met to request an update to the noise estimate.
- the spectral deviation estimator 120 and peak-to-peak detector 123 introduce these two criteria for detecting abrupt noise having large spectral variance and large peak-to-peak energy difference as will be explained in the foregoing and in more detail.
- the input signals first pass through a six-order Butterworth high pass filter whose cut-off frequency is 120 Hz.
- This adaptive NS 100 reduces a large amount of energy for noises having primarily low frequency while keeping the speech quality at the same level.
- the adaptive NS 100 uses overlap-added method with 24 samples of the adjacent frames, 24 zeros padded and a trapezoidal window which forms a 128 samples vector.
- the frequency domain conversion module 110 sends the samples through a 128 point Fast Fourier Transform (FFT).
- FFT Fast Fourier Transform
- the channel energy estimator 115 calculates the mean magnitude for all frequency bins within a channel in accordance with EQ 1.
- the channel energy estimator 115 can also apply an exponential average with the former calculated results to estimate the energy presented in each channel, E ch (m,i).
- m current frame
- i is the channel index
- E min is the minimum allowable channel energy
- ⁇ ch (m) is the channel energy smoothing factor
- N c 16 is the number of combined channels
- f L (i) and f H (i) are the i-th elements of the respectively low and high channel.
- the channel SNR estimator 135 then combines the channel energy E ch (m,i) with an estimated channel noise energy E N (m,i) to calculate the channel SNR, ⁇ q (i), estimated in dB units using EQ 2.
- ⁇ q ⁇ ( i ) min ⁇ ⁇ 0 , min ⁇ ⁇ 89 , round ⁇ ⁇ 10 ⁇ ⁇ log 10 ⁇ ( E ch ⁇ ( m , i ) E n ⁇ ( m , i ) ) / 0.375 ⁇ ⁇ ⁇ , ⁇ 0 ⁇ i ⁇ N c ( 2 )
- the voice metric module 137 calculates the voice metrics from the channel SMR, ⁇ q (i), using a look-up table in accordance with EQ 3.
- the look-up table is predetermined and charts channel SNR versus voicing level. In general, the larger the SNR, the larger the voicing level.
- the channel energy estimator 115 estimates a channel noise energy
- the channel SNR estimator 135 estimates a channel SNR from the estimated channel energy and a noise channel energy provided by the background noise estimator 125 .
- the voice metric module 137 calculates a voice metric from the channel SNR which determines a voicing level of the signal.
- the voice metric is one criterion used for detecting the presence of noise.
- the noise update decision module 130 declares the presence of noise if the voice metric is less than a voice level threshold.
- the noise update decision module 130 informs the background noise estimator 125 to update the noise channel energy. More specifically, the noise update decision module 130 keeps track of a number of noise update requests through an update-flag 131 .
- the noise update decision module 130 may also declare the presence of noise if the peak-to-peak energy difference ⁇ P-P (m) (See method step 220 of FIG. 3 ) and the spectrum deviation ⁇ E (m)(See method step 230 of FIG. 3 ) are both less than a respective threshold.
- the peak-to-peak energy difference ⁇ P-P (m) is only calculated when the signal energy is higher than a threshold: min (E ch (m,i)) ⁇ ENG_THLD Under an assumption that the input signal has gone through a high pass filter, C low and C High are selectively chosen as user input parameters when searching for the minimum value,
- the peak-to-peak detector 123 also low pass filters (e.g. smooths) the peak-to-peak energy difference ⁇ P-P (m) with a previous result to reduce channel variation in accordance with EQ 12.
- ⁇ P-P ( m ) ⁇ P-P ( m ⁇ 1)* ⁇ + ⁇ P-P ( m )*(1 ⁇ ) (12)
- the spectrum deviation ⁇ E (m) (See FIGS. 8 and 9 ) is defined as the sum of the absolute value of the difference between average long-term channel energy ⁇ dB (m) and current channel energy 10 log 10 (E ch (m,i)) as shown in EQ 4.
- the exponential windowing factor ⁇ (m) used in EQ 5 is a function of the total channel energy as shown in EQ 6.
- a noise update can be determined.
- the noise update decision unit 130 receives the voice metric, peak-to-peak energy difference, and spectrum deviation to update a noise frame count.
- the noise update decision unit 130 employs decision logic that evaluates these criterion to determine if noise is present and if the noise estimate should be updated.
- the following pseudo code used in the noise update logic illustrates how the noise update decision unit 130 evaluates the voice metrics v(m), peak-to-peak energy difference ⁇ P-P (m), and spectrum deviation ⁇ E (m), and a hysteresis logic to increment a noise update update_cnt.
- the update_flag identifies when a noise update will be performed and the frames of the signal used for updating the noise channel energy.
- the background noise estimator 125 will only set the update_flag true to update the noise estimate when the update_cnt exceeds a predetermined threshold. More specifically, the noise decision update unit 130 counts a number of noise update requests thereby producing an update count, and updates a noise channel energy if the update count is greater than an update count threshold.
- the noise update logic below as modified with the peak-to-peak energy difference criteria and the spectrum deviation ⁇ E (m) can further update update_cnt in response to abrupt noise.
- the noise update decision unit 130 will also check the ⁇ P-P (m). If ⁇ P-P (m) is less than the threshold, the frame is identified as noise.
- the underlined section identifies the first criteria ⁇ E (m) ⁇ p*DEV_THLD and the second criteria ( ⁇ P-P (m) ⁇ PP_THLD implemented by the noise update decision logic to increment update_count.
- the update_flag can be set true only when the total signal energy is greater than a noise floor. The following values were assigned to the free parameters
- the adaptive NS 100 functions well when the noise spectrum can be accurately estimated. Accordingly, the update_flag decision logic is critical for the noise estimation. As illustrated above in the pseudo code, the modified update logic is based on voice metrics v(m), peak-to-peak energy difference ⁇ P-P (m), and the spectrum deviation ⁇ E (m). When v(m) is less than a certain threshold, ⁇ E (m) is less than an predetermined threshold, and the spectrum deviation is less than a predetermined threshold the signal is considered noise. As a result of the additional criteria in the noise update logic, the adaptive NS 100 will work well for stationary noise, slow varying non-stationary noise, and also fast-changing abrupt noise.
- the noise update decision unit 130 declares a presence of noise and requests a noise channel estimate update if a) a total estimated channel energy is greater than a predetermined noise floor ( 442 ), and b) the spectrum deviation is less than a predetermined variance threshold ( 444 ), and c) the peak-to-peak energy difference is less than a predetermined peak-to-peak threshold ( 446 ).
- the noise update decision unit 130 may also declare the presence of noise if only the voice metric is less than a voice level threshold ( 448 ); that is, criteria 448 can stand alone for updating the noise channel estimate.
- the background noise estimator updates the noise channel estimate.
- the channel SNR estimator 135 uses the update noise estimate to calculate the channel SNRs.
- the Channel SNR modifier 139 uses the channel SNRs to determine gain adjustments to the frequency representation G(k) of the signal.
- the channel gain module 140 then applies the gain factors in accordance with the gain adjustments. More specifically, the channel SNR modifier 139 computes the overall gain factor ⁇ n for each of the energy channels in the current frame as:
- E floor is the noise floor energy
- E n (m) is the estimated noise spectrum.
- the channel gain module 140 then applies the channel gains to the transformed input signal G(k):
- H ⁇ ( k ) ⁇ ⁇ ch ⁇ ( i ) ⁇ G ⁇ ( k ) , f L ⁇ ( i ) ⁇ k ⁇ f H ⁇ ( i ) , 0 ⁇ i ⁇ N c G ⁇ ( k ) , 0 ⁇ k ⁇ f L ⁇ ( 0 ) , f H ⁇ ( N c - 1 ) ⁇ k ⁇ M / 2 ⁇ ( 10 )
- the time domain converter 150 then performs an inverse FFT on the noise-suppressed energy channels of the signal.
- simulation results of the adaptive filter 100 without the modified noise update logic is shown (e.g. peak-to-peak energy difference ⁇ P-P (m), and the spectrum deviation ⁇ E (m)).
- simulation results of the adaptive filter 100 with the modified noise update logic are shown in FIG. 12 .
- subplot 510 a noisy input signal is shown.
- the noisy input signal consists of an abrupt onset of noise 555 followed by speech 556 .
- subplot 520 the output signal of the adaptive NS 100 representing the noise suppressed input signal 510 is shown.
- the adaptive NS 100 is unable to suppress the initial onset of noise 555 . Consequently, the noise will be momentarily heard at the beginning.
- the adaptive NS 100 will be able to suppress the noise shortly after the abrupt onset.
- the spectral deviation of the input signal 510 is shown.
- the spectral deviation 531 at the onset of noise is significantly less than the spectral deviation 557 at the onset of speech.
- the calculated voice metrics for the input signal are shown.
- the voice metric for the onset of abrupt noise 532 is significantly higher than the onset of speech 558 .
- the adaptive NS 110 is unable to sufficiently suppress the abrupt noise 555 without use of the peak-to-peak energy differences to identify the abrupt onset of noise 555 .
- simulation results of the adaptive NS 100 using the modified decision noise update decision logic (e.g. peak-to-peak energy difference ⁇ P-P (m), and the spectrum deviation ⁇ E (m)) are shown.
- the results indicate that the adaptive NS 100 can sufficiently suppress the onset abrupt noise.
- Subplot 610 shows the input noisy signal having a noise component 555 and a speech component 557 .
- Subplot 620 shows the noise suppressed output signal.
- the onset abrupt noise 555 in FIG. 11 is absent in FIG. 12 due to the more aggressive noise suppression, due to the modified decision logic.
- the adaptive NS 100 can suppress the onset abrupt noise 555 without affecting the integrity of the speech signal 555 .
- the adaptive filter 100 in accordance with the method 200 described in FIG. 3 , advantageously employs the voice metrics, the spectrum deviations, and the peak-to-peak energy differences to identify the abrupt onset of noise 555 , update the noise channel estimate, and suppress the abrupt noise with the updated noise channel estimate to produce noise suppressed speech.
- the present embodiments of the invention can be realized in hardware, software or a combination of hardware and software. Any kind of computer system or other apparatus adapted for carrying out the methods described herein are suitable.
- a typical combination of hardware and software can be a mobile communications device with a computer program that, when being loaded and executed, can control the mobile communications device such that it carries out the methods described herein.
- Portions of the present method and system may also be embedded in a computer program product, which comprises all the features enabling the implementation of the methods described herein and which when loaded in a computer system, is able to carry out these methods.
Abstract
Description
where m is current frame, i is the channel index, Emin is the minimum allowable channel energy, αch(m) is the channel energy smoothing factor, Nc=16 is the number of combined channels, and fL(i) and fH(i) are the i-th elements of the respectively low and high channel.
ΔP-P(m)=max(10 log10(E ch(m,i)))−min(10 log10(E ch(m,i)))C low ≦i≦C high (11)
ΔP-P(m)=ΔP-P(m−1)*β+ΔP-P(m)*(1−β) (12)
The average long-term channel energy ĒdB(m) used in
Ē dB(m+1,i)=α(m)Ē dB(m,i)+(1−α(m))E dB(m,i), 0≦i≦Nc (5)
Upon the voice
if ( (v(m) ≦ UPDATE_THLD ){ | ||
update_flag = TRUE | ||
update_cnt = 0 | ||
} | ||
else if ((( Etot > NOISE_FLOOR ) and ( ΔE(m) < DEV_THLD ) or | ||
(( Etot > NOISE_FLOOR )and( ΔE(m) < p * DEV_THLD )and | ||
(Δp—p(m) < PP_THLD)) | ||
update_cnt = update_cnt + 1 | ||
if ( update_cnt ≧ UPDATE_CNT_THLD ) | ||
update_flag = TRUE | ||
} | ||
if ( update_cnt == last_update_cnt ) | ||
hyster_cnt = hyster_cnt + 1 | ||
else | ||
hyster_cnt = 0 | ||
last_update_cnt = update_cnt | ||
if ( hyster_cnt > HYSTER_CNT_THLD ) | ||
update_cnt = 0 | ||
γdB(i)=μg(m)(σq″(i)−σth)+γn, 0≦i<N c (9)
Claims (20)
Priority Applications (2)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US11/693,028 US7873114B2 (en) | 2007-03-29 | 2007-03-29 | Method and apparatus for quickly detecting a presence of abrupt noise and updating a noise estimate |
PCT/US2008/052980 WO2008121436A1 (en) | 2007-03-29 | 2008-02-05 | Method and apparatus for quickly detecting a presence of abrupt noise and updating a noise estimate |
Applications Claiming Priority (1)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US11/693,028 US7873114B2 (en) | 2007-03-29 | 2007-03-29 | Method and apparatus for quickly detecting a presence of abrupt noise and updating a noise estimate |
Publications (2)
Publication Number | Publication Date |
---|---|
US20080240282A1 US20080240282A1 (en) | 2008-10-02 |
US7873114B2 true US7873114B2 (en) | 2011-01-18 |
Family
ID=39794304
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
US11/693,028 Active 2029-10-20 US7873114B2 (en) | 2007-03-29 | 2007-03-29 | Method and apparatus for quickly detecting a presence of abrupt noise and updating a noise estimate |
Country Status (2)
Country | Link |
---|---|
US (1) | US7873114B2 (en) |
WO (1) | WO2008121436A1 (en) |
Cited By (13)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US20080159560A1 (en) * | 2006-12-30 | 2008-07-03 | Motorola, Inc. | Method and Noise Suppression Circuit Incorporating a Plurality of Noise Suppression Techniques |
US20090196434A1 (en) * | 2005-09-02 | 2009-08-06 | Nec Corporation | Method, apparatus, and computer program for suppressing noise |
US20090254340A1 (en) * | 2008-04-07 | 2009-10-08 | Cambridge Silicon Radio Limited | Noise Reduction |
US20110169721A1 (en) * | 2008-09-19 | 2011-07-14 | Claus Bauer | Upstream signal processing for client devices in a small-cell wireless network |
US20120095755A1 (en) * | 2009-06-19 | 2012-04-19 | Fujitsu Limited | Audio signal processing system and audio signal processing method |
US20120215536A1 (en) * | 2009-10-19 | 2012-08-23 | Martin Sehlstedt | Methods and Voice Activity Detectors for Speech Encoders |
US8606571B1 (en) * | 2010-04-19 | 2013-12-10 | Audience, Inc. | Spatial selectivity noise reduction tradeoff for multi-microphone systems |
US9343056B1 (en) | 2010-04-27 | 2016-05-17 | Knowles Electronics, Llc | Wind noise detection and suppression |
US9431023B2 (en) | 2010-07-12 | 2016-08-30 | Knowles Electronics, Llc | Monaural noise suppression based on computational auditory scene analysis |
US9438992B2 (en) | 2010-04-29 | 2016-09-06 | Knowles Electronics, Llc | Multi-microphone robust noise suppression |
US9502048B2 (en) | 2010-04-19 | 2016-11-22 | Knowles Electronics, Llc | Adaptively reducing noise to limit speech distortion |
US10045140B2 (en) | 2015-01-07 | 2018-08-07 | Knowles Electronics, Llc | Utilizing digital microphones for low power keyword detection and noise suppression |
US11172312B2 (en) | 2013-05-23 | 2021-11-09 | Knowles Electronics, Llc | Acoustic activity detecting microphone |
Families Citing this family (13)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US9571652B1 (en) | 2005-04-21 | 2017-02-14 | Verint Americas Inc. | Enhanced diarization systems, media and methods of use |
US7720644B2 (en) * | 2005-09-16 | 2010-05-18 | Agilent Technologies, Inc. | Method and apparatus of spectral estimation |
TW200849891A (en) * | 2007-06-04 | 2008-12-16 | Alcor Micro Corp | Method and system for assessing the statuses of channels |
CN101983402B (en) * | 2008-09-16 | 2012-06-27 | 松下电器产业株式会社 | Speech analyzing apparatus, speech analyzing/synthesizing apparatus, correction rule information generating apparatus, speech analyzing system, speech analyzing method, correction rule information and generating method |
WO2010121657A1 (en) * | 2009-04-22 | 2010-10-28 | Nokia Siemens Networks Oy | Selective interference rejection combining |
CN102457452B (en) * | 2010-10-19 | 2015-06-03 | 中兴通讯股份有限公司 | Method for calculating frequency offset estimated value and channel estimated value and LTE base station |
US9368116B2 (en) | 2012-09-07 | 2016-06-14 | Verint Systems Ltd. | Speaker separation in diarization |
US9460722B2 (en) | 2013-07-17 | 2016-10-04 | Verint Systems Ltd. | Blind diarization of recorded calls with arbitrary number of speakers |
US9984706B2 (en) * | 2013-08-01 | 2018-05-29 | Verint Systems Ltd. | Voice activity detection using a soft decision mechanism |
US9570093B2 (en) * | 2013-09-09 | 2017-02-14 | Huawei Technologies Co., Ltd. | Unvoiced/voiced decision for speech processing |
US9953661B2 (en) | 2014-09-26 | 2018-04-24 | Cirrus Logic Inc. | Neural network voice activity detection employing running range normalization |
US9875742B2 (en) | 2015-01-26 | 2018-01-23 | Verint Systems Ltd. | Word-level blind diarization of recorded calls with arbitrary number of speakers |
US11380345B2 (en) * | 2020-10-15 | 2022-07-05 | Agora Lab, Inc. | Real-time voice timbre style transform |
Citations (6)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5659622A (en) * | 1995-11-13 | 1997-08-19 | Motorola, Inc. | Method and apparatus for suppressing noise in a communication system |
US5809455A (en) * | 1992-04-15 | 1998-09-15 | Sony Corporation | Method and device for discriminating voiced and unvoiced sounds |
US6366880B1 (en) * | 1999-11-30 | 2002-04-02 | Motorola, Inc. | Method and apparatus for suppressing acoustic background noise in a communication system by equaliztion of pre-and post-comb-filtered subband spectral energies |
US20040102967A1 (en) * | 2001-03-28 | 2004-05-27 | Satoru Furuta | Noise suppressor |
US6868378B1 (en) * | 1998-11-20 | 2005-03-15 | Thomson-Csf Sextant | Process for voice recognition in a noisy acoustic signal and system implementing this process |
US20080281589A1 (en) * | 2004-06-18 | 2008-11-13 | Matsushita Electric Industrail Co., Ltd. | Noise Suppression Device and Noise Suppression Method |
Family Cites Families (2)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US4811404A (en) * | 1987-10-01 | 1989-03-07 | Motorola, Inc. | Noise suppression system |
KR100388454B1 (en) * | 2001-06-09 | 2003-06-25 | 주식회사 하이닉스반도체 | Method for controling voice output gain by predicting background noise |
-
2007
- 2007-03-29 US US11/693,028 patent/US7873114B2/en active Active
-
2008
- 2008-02-05 WO PCT/US2008/052980 patent/WO2008121436A1/en active Application Filing
Patent Citations (6)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5809455A (en) * | 1992-04-15 | 1998-09-15 | Sony Corporation | Method and device for discriminating voiced and unvoiced sounds |
US5659622A (en) * | 1995-11-13 | 1997-08-19 | Motorola, Inc. | Method and apparatus for suppressing noise in a communication system |
US6868378B1 (en) * | 1998-11-20 | 2005-03-15 | Thomson-Csf Sextant | Process for voice recognition in a noisy acoustic signal and system implementing this process |
US6366880B1 (en) * | 1999-11-30 | 2002-04-02 | Motorola, Inc. | Method and apparatus for suppressing acoustic background noise in a communication system by equaliztion of pre-and post-comb-filtered subband spectral energies |
US20040102967A1 (en) * | 2001-03-28 | 2004-05-27 | Satoru Furuta | Noise suppressor |
US20080281589A1 (en) * | 2004-06-18 | 2008-11-13 | Matsushita Electric Industrail Co., Ltd. | Noise Suppression Device and Noise Suppression Method |
Non-Patent Citations (1)
Title |
---|
Cohen, "Speech Enhancement For Non-Stationary Noise Environments," Signal Processing 81, 2001, pp. 2403-2418. |
Cited By (23)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US20090196434A1 (en) * | 2005-09-02 | 2009-08-06 | Nec Corporation | Method, apparatus, and computer program for suppressing noise |
US8233636B2 (en) * | 2005-09-02 | 2012-07-31 | Nec Corporation | Method, apparatus, and computer program for suppressing noise |
US8477963B2 (en) | 2005-09-02 | 2013-07-02 | Nec Corporation | Method, apparatus, and computer program for suppressing noise |
US8489394B2 (en) | 2005-09-02 | 2013-07-16 | Nec Corporation | Method, apparatus, and computer program for suppressing noise |
US20080159560A1 (en) * | 2006-12-30 | 2008-07-03 | Motorola, Inc. | Method and Noise Suppression Circuit Incorporating a Plurality of Noise Suppression Techniques |
US9966085B2 (en) * | 2006-12-30 | 2018-05-08 | Google Technology Holdings LLC | Method and noise suppression circuit incorporating a plurality of noise suppression techniques |
US20090254340A1 (en) * | 2008-04-07 | 2009-10-08 | Cambridge Silicon Radio Limited | Noise Reduction |
US9142221B2 (en) * | 2008-04-07 | 2015-09-22 | Cambridge Silicon Radio Limited | Noise reduction |
US20110169721A1 (en) * | 2008-09-19 | 2011-07-14 | Claus Bauer | Upstream signal processing for client devices in a small-cell wireless network |
US9300714B2 (en) * | 2008-09-19 | 2016-03-29 | Dolby Laboratories Licensing Corporation | Upstream signal processing for client devices in a small-cell wireless network |
US8676571B2 (en) * | 2009-06-19 | 2014-03-18 | Fujitsu Limited | Audio signal processing system and audio signal processing method |
US20120095755A1 (en) * | 2009-06-19 | 2012-04-19 | Fujitsu Limited | Audio signal processing system and audio signal processing method |
US20120215536A1 (en) * | 2009-10-19 | 2012-08-23 | Martin Sehlstedt | Methods and Voice Activity Detectors for Speech Encoders |
US9401160B2 (en) * | 2009-10-19 | 2016-07-26 | Telefonaktiebolaget Lm Ericsson (Publ) | Methods and voice activity detectors for speech encoders |
US20160322067A1 (en) * | 2009-10-19 | 2016-11-03 | Telefonaktiebolaget Lm Ericsson (Publ) | Methods and Voice Activity Detectors for a Speech Encoders |
US8606571B1 (en) * | 2010-04-19 | 2013-12-10 | Audience, Inc. | Spatial selectivity noise reduction tradeoff for multi-microphone systems |
US9502048B2 (en) | 2010-04-19 | 2016-11-22 | Knowles Electronics, Llc | Adaptively reducing noise to limit speech distortion |
US9343056B1 (en) | 2010-04-27 | 2016-05-17 | Knowles Electronics, Llc | Wind noise detection and suppression |
US9438992B2 (en) | 2010-04-29 | 2016-09-06 | Knowles Electronics, Llc | Multi-microphone robust noise suppression |
US9431023B2 (en) | 2010-07-12 | 2016-08-30 | Knowles Electronics, Llc | Monaural noise suppression based on computational auditory scene analysis |
US11172312B2 (en) | 2013-05-23 | 2021-11-09 | Knowles Electronics, Llc | Acoustic activity detecting microphone |
US10045140B2 (en) | 2015-01-07 | 2018-08-07 | Knowles Electronics, Llc | Utilizing digital microphones for low power keyword detection and noise suppression |
US10469967B2 (en) | 2015-01-07 | 2019-11-05 | Knowler Electronics, LLC | Utilizing digital microphones for low power keyword detection and noise suppression |
Also Published As
Publication number | Publication date |
---|---|
WO2008121436A1 (en) | 2008-10-09 |
US20080240282A1 (en) | 2008-10-02 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
US7873114B2 (en) | Method and apparatus for quickly detecting a presence of abrupt noise and updating a noise estimate | |
US6415253B1 (en) | Method and apparatus for enhancing noise-corrupted speech | |
US6766292B1 (en) | Relative noise ratio weighting techniques for adaptive noise cancellation | |
US6529868B1 (en) | Communication system noise cancellation power signal calculation techniques | |
US6523003B1 (en) | Spectrally interdependent gain adjustment techniques | |
US7492889B2 (en) | Noise suppression based on bark band wiener filtering and modified doblinger noise estimate | |
US8571231B2 (en) | Suppressing noise in an audio signal | |
EP2008379B1 (en) | Adjustable noise suppression system | |
US6487257B1 (en) | Signal noise reduction by time-domain spectral subtraction using fixed filters | |
EP2244254B1 (en) | Ambient noise compensation system robust to high excitation noise | |
US7912567B2 (en) | Noise suppressor | |
US20070260454A1 (en) | Noise reduction for automatic speech recognition | |
US20140316775A1 (en) | Noise suppression device | |
US8712768B2 (en) | System and method for enhanced artificial bandwidth expansion | |
US6671667B1 (en) | Speech presence measurement detection techniques | |
US20110123045A1 (en) | Noise suppressor | |
US8694311B2 (en) | Method for processing noisy speech signal, apparatus for same and computer-readable recording medium | |
US8744846B2 (en) | Procedure for processing noisy speech signals, and apparatus and computer program therefor | |
JP2004341339A (en) | Noise restriction device | |
US6507623B1 (en) | Signal noise reduction by time-domain spectral subtraction | |
US11227622B2 (en) | Speech communication system and method for improving speech intelligibility | |
Krini et al. | Model-based speech enhancement for automotive applications | |
JP2003517761A (en) | Method and apparatus for suppressing acoustic background noise in a communication system |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
AS | Assignment |
Owner name: MOTOROLA, INC., ILLINOISFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNOR:LIN, HAITAO;REEL/FRAME:019083/0062Effective date: 20070322 |
|
AS | Assignment |
Owner name: MOTOROLA MOBILITY, INC, ILLINOISFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNOR:MOTOROLA, INC;REEL/FRAME:025673/0558Effective date: 20100731 |
|
STCF | Information on status: patent grant |
Free format text: PATENTED CASE |
|
AS | Assignment |
Owner name: MOTOROLA MOBILITY LLC, ILLINOISFree format text: CHANGE OF NAME;ASSIGNOR:MOTOROLA MOBILITY, INC.;REEL/FRAME:029216/0282Effective date: 20120622 |
|
FPAY | Fee payment |
Year of fee payment: 4 |
|
AS | Assignment |
Owner name: GOOGLE TECHNOLOGY HOLDINGS LLC, CALIFORNIAFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNOR:MOTOROLA MOBILITY LLC;REEL/FRAME:034419/0001Effective date: 20141028 |
|
MAFP | Maintenance fee payment |
Free format text: PAYMENT OF MAINTENANCE FEE, 8TH YEAR, LARGE ENTITY (ORIGINAL EVENT CODE: M1552)Year of fee payment: 8 |
|
MAFP | Maintenance fee payment |
Free format text: PAYMENT OF MAINTENANCE FEE, 12TH YEAR, LARGE ENTITY (ORIGINAL EVENT CODE: M1553); ENTITY STATUS OF PATENT OWNER: LARGE ENTITYYear of fee payment: 12 |