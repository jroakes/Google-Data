CN117337574A - Hybrid white balance mode in a camera system of an electronic device - Google Patents
Hybrid white balance mode in a camera system of an electronic device Download PDFInfo
- Publication number
- CN117337574A CN117337574A CN202180098314.8A CN202180098314A CN117337574A CN 117337574 A CN117337574 A CN 117337574A CN 202180098314 A CN202180098314 A CN 202180098314A CN 117337574 A CN117337574 A CN 117337574A
- Authority
- CN
- China
- Prior art keywords
- white balance
- gain
- mode
- camera
- manual
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Pending
Links
- 238000000034 method Methods 0.000 claims abstract description 52
- 230000000875 corresponding effect Effects 0.000 claims description 27
- 238000012937 correction Methods 0.000 claims description 23
- 230000004044 response Effects 0.000 claims description 11
- 230000006870 function Effects 0.000 claims description 8
- 230000002596 correlated effect Effects 0.000 claims description 6
- 238000004364 calculation method Methods 0.000 description 14
- 230000008859 change Effects 0.000 description 7
- 238000004891 communication Methods 0.000 description 6
- 230000007935 neutral effect Effects 0.000 description 6
- 239000003086 colorant Substances 0.000 description 5
- 229920001621 AMOLED Polymers 0.000 description 3
- 230000000977 initiatory effect Effects 0.000 description 3
- 230000035945 sensitivity Effects 0.000 description 3
- 238000003860 storage Methods 0.000 description 3
- 230000001960 triggered effect Effects 0.000 description 3
- 230000003213 activating effect Effects 0.000 description 2
- 238000007796 conventional method Methods 0.000 description 2
- 239000011159 matrix material Substances 0.000 description 2
- 238000007781 pre-processing Methods 0.000 description 2
- 238000012545 processing Methods 0.000 description 2
- 230000007704 transition Effects 0.000 description 2
- 230000009471 action Effects 0.000 description 1
- 238000013459 approach Methods 0.000 description 1
- 238000003491 array Methods 0.000 description 1
- 230000001276 controlling effect Effects 0.000 description 1
- 230000000694 effects Effects 0.000 description 1
- 239000011521 glass Substances 0.000 description 1
- 238000005286 illumination Methods 0.000 description 1
- 238000011065 in-situ storage Methods 0.000 description 1
- 239000004973 liquid crystal related substance Substances 0.000 description 1
- 230000003287 optical effect Effects 0.000 description 1
- 230000002085 persistent effect Effects 0.000 description 1
- 238000012805 post-processing Methods 0.000 description 1
- 230000008569 process Effects 0.000 description 1
- 238000009877 rendering Methods 0.000 description 1
- 239000010409 thin film Substances 0.000 description 1
- 230000000007 visual effect Effects 0.000 description 1
Classifications
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N23/00—Cameras or camera modules comprising electronic image sensors; Control thereof
- H04N23/60—Control of cameras or camera modules
- H04N23/667—Camera operation mode switching, e.g. between still and video, sport and normal or high- and low-resolution modes
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N23/00—Cameras or camera modules comprising electronic image sensors; Control thereof
- H04N23/60—Control of cameras or camera modules
- H04N23/63—Control of cameras or camera modules by using electronic viewfinders
- H04N23/631—Graphical user interfaces [GUI] specially adapted for controlling image capture or setting capture parameters
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N23/00—Cameras or camera modules comprising electronic image sensors; Control thereof
- H04N23/60—Control of cameras or camera modules
- H04N23/63—Control of cameras or camera modules by using electronic viewfinders
- H04N23/631—Graphical user interfaces [GUI] specially adapted for controlling image capture or setting capture parameters
- H04N23/632—Graphical user interfaces [GUI] specially adapted for controlling image capture or setting capture parameters for displaying or modifying preview images prior to image capturing, e.g. variety of image resolutions or capturing parameters
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N23/00—Cameras or camera modules comprising electronic image sensors; Control thereof
- H04N23/80—Camera processing pipelines; Components thereof
- H04N23/84—Camera processing pipelines; Components thereof for processing colour signals
- H04N23/88—Camera processing pipelines; Components thereof for processing colour signals for colour balance, e.g. white-balance circuits or colour temperature control
Abstract
This document describes methods and systems for a hybrid white balance, HWB, mode (114), which is a hybrid of automatic and manual, WB, modes in a camera system (104) of an electronic device (102). The HWB mode may provide the user with an option to select WB settings along a continuous WB adjustment range via a camera user interface (118) in a live preview mode (110). In this way, a desired color of the user may be applied with respect to an image or video captured by the camera system. The camera UI includes a manual WB control (112) to manually adjust white balance. The WB module (108) determines a target WB gain corresponding to the manual WB control relative to an initial automatic WB decision for a current frame displayed in a live preview mode of the camera application. In aspects, a lookup table associated with the manual WB control is used to calculate the target WB gain.
Description
Background
Digital cameras typically have many features that can be used to adjust the characteristics (e.g., color, sharpness, magnification) of an image or video. Some features are applied at preprocessing (e.g., during live preview mode prior to image capture) and other features are applied at post-processing (e.g., after image capture). One such feature includes White Balance (WB), which is a camera setting that adjusts how colors are rendered in an image. White balance is generally used to render an object that appears white in reality as white in an image. To assist the user, many cameras include an automatic WB feature that automatically adjusts WB according to a color correction algorithm. However, conventional camera systems may not achieve 100% accuracy for all light source (illuminant) conditions. Additional challenges arise when attempting to meet personal preferences for the color appearance of images and video. Many manual WB controls rely on a set of preset gains or color temperatures to adjust the image color. However, such manual WB controls may not achieve accurate color correction because the real scene light source may deviate significantly from a limited number of preset gains.
Disclosure of Invention
This document describes methods and systems for a White Balance (WB) mode in a camera system of an electronic device, the WB mode being a hybrid of automatic and manual WB modes. The Hybrid WB (HWB) mode has a manual mode that can provide the user with an option to select WB settings along a continuous WB adjustment range via a camera User Interface (UI) in live preview mode. In this way, the desired color of the user may be applied with respect to the image or video captured by the camera system. The camera UI includes a manual WB control to manually adjust white balance. In addition, the WB module determines a target WB gain corresponding to the manual WB control relative to an initial Automatic WB (AWB) decision of a current frame displayed in a live preview mode (e.g., preprocessing) of the camera application. In an example, a look-up table (LUT) associated with the manual WB control is used to calculate the target WB gain.
In aspects, a method for HWB mode in a camera application of an electronic device is disclosed. The method comprises the following steps: during a live preview mode of the camera application, a Manual White Balance (MWB) control is presented on a camera user interface displayed on a display device of the electronic device, the MWB control configured to enable a user to select WB settings to perform manual adjustments to white balance relative to a current frame presented in the live preview mode of the camera application. The method further comprises the steps of: determining an AWB decision on a red-green-blue (RGB) scale for a current frame based on one or more characteristics of the current frame using an AWB mode; and receiving a user input to adjust the MWB control displayed in the camera user interface. In addition, the method comprises: a target WB gain for WB adjustment of the current frame is determined based on the user input to the MWB control relative to the AWB decision using MWB mode, the AWB decision serving as an initial WB gain to determine the target WB gain corresponding to the user input to the MWB control. Furthermore, the method includes applying the target WB gain to a current frame presented in a live preview mode of the camera application for color correction.
In aspects, a mobile electronic device includes a display device, a camera system, one or more processors, and memory. The memory stores instructions that, when executed by the one or more processors, cause the one or more processors to implement a HWB mode for the camera system by performing any of the methods described above.
In aspects, a computer-readable medium comprising instructions that, when executed by one or more processors, cause the one or more processors to perform the above-described method.
This summary is provided to introduce simplified concepts related to a hybrid white balance mode in a camera system of an electronic device, which is further described below in the detailed description and drawings. This summary is not intended to identify essential features of the claimed subject matter, nor is it intended to be used to determine the scope of the claimed subject matter.
Drawings
With reference to the following figures, details of one or more aspects of a hybrid white balance mode in a camera system of an electronic device are described in this document. The same numbers are used throughout the drawings to reference like features and components:
FIG. 1 illustrates an example embodiment of an electronic device capable of implementing a hybrid white balance mode in a camera system of the electronic device in accordance with the techniques described herein;
FIG. 2 illustrates an example embodiment of the electronic device of FIG. 1 in more detail;
FIG. 3 illustrates an example embodiment of a MWB control in a camera system of an electronic device;
fig. 4 shows an example of interpolation ratio and color correction temperature;
FIG. 5 depicts an example flowchart of a feedback loop between a camera application and a WB module for presetting the MWB selection between WB points;
FIG. 6 illustrates an example implementation of HWB mode in a camera system of an electronic device;
FIG. 7 depicts an example flow chart of a feedback loop between a camera application for HWB mode and a WB module based on a preferred color adjustment;
FIG. 8 illustrates an example of a camera UI with a MWB control for adjusting WB of a frame shown in a live preview mode of a camera application on an electronic device;
FIG. 9 illustrates an example implementation of WB locking in a camera application of an electronic device;
FIG. 10 depicts an example flow chart of communications between a camera application and a WB module regarding WB locking;
FIG. 11 depicts a flowchart of communication between a camera application and a WB module to achieve touch WB;
FIG. 12 illustrates an example embodiment of a touch WB variant initiating the MWB mode via a camera UI of a camera application;
FIG. 13 illustrates an example embodiment of a preferred color mode variant for selecting MWB mode via a camera UI of a camera application;
FIG. 14 illustrates an example embodiment of a preset light source variant for selecting MWB mode via a camera UI of a camera application;
FIG. 15 illustrates an example embodiment of MWB tuning by preference gain;
FIG. 16 shows an example graph of a color correction temperature range for preference gain adjustment;
FIG. 17 depicts a flowchart of HWB mode by preference color adjustment; and
FIG. 18 illustrates an example method of implementing the MWB control from FIG. 1 in a preview mode of the camera system of the electronic device.
Detailed Description
SUMMARY
This document describes methods and systems for hybrid white balance modes in a camera system of an electronic device. This mode provides an MWB control that uses the decisions made by the AWB mode as a starting point for MWB adjustments. Unlike a predefined number of preset WB light source points, MWB adjustment is based on AWB decisions for the current frame and then enables the user to manually adjust the white balance to achieve the desired color correction. The MWB control provides adjustable different color directions.
For example, the MWB control may be used to adjust the white balance between red (higher color temperature) and blue (lower color temperature) and/or between violet and green. By moving the MWB control to red, the hue warms. Moving the MWB control towards blue results in a cooler hue. Similarly, adjusting the MWB control towards violet results in a warmer hue, while the direction towards green results in a cooler hue.
The MWB control also includes different user selectable mode variants that enable user input to manually adjust the white balance in different ways. For example, the user may select a touch WB variant and then touch a location on the display device to designate a region of interest corresponding to the user touch for AWB decision. In this way, the AWB decision for the current frame is calculated based on the user-selected region of interest in the current frame.
In another example, a user may select a continuous control or "preference" color variation, which may provide one or more slider bars that the user may use to manually adjust white balance. A user selected position on the slider is determined using a look-up table defining WB gains for at least the end points of the slider. In another example, the target WB gain may be calculated in real time based on the reference line of the calibrated light source.
In yet another example, the user may select a preset light source variant that provides a slider bar that the user may use to manually adjust white balance. The user selected position on the slider bar may be determined by interpolation between the closest preset light source points on both sides (selection sides) of the user selected position.
While the features and concepts of the described methods and systems for hybrid white balance mode in a camera system of an electronic device may be implemented in any number of different environments, aspects are described in the context of the following examples.
Example apparatus
Fig. 1 illustrates an example embodiment 100 of an electronic device (e.g., electronic device 102) capable of implementing a hybrid white balance mode in a camera system of the electronic device in accordance with the techniques described herein. The electronic device 102 is shown to include a camera system 104, a camera application 106, and a white balance module 108 ("WB module 108"). In aspects, the camera application 106 includes a live preview mode 110 and a manual white balance control 112 ("MWB control 112"). In addition, the WB module 108 includes a hybrid white balance mode 114 ("HWB mode 114") and a white balance mode control 116 ("WB mode control 116"). The HWB mode 114 includes both a manual mode (e.g., MWB mode) and an automatic mode (e.g., AWB mode) and enables the WB module 108 to use the WB mode control 116 to switch between and/or combine the functionality of the manual and automatic WB modes.
The camera application 106 provides a camera UI 118 that may be rendered via a display device 120 of the electronic device 102. Live preview mode 110 of camera application 106 is rendered via camera UI 118 to provide real-time video of the current scene within the field of view (FOV) of the lens of camera system 104, thereby causing display device 120 to act as a viewfinder for camera system 104.
WB module 108 is configured to automatically estimate WB settings of camera system 104 to adjust colors rendered in live preview mode 110 of camera application 106. In aspects, WB module 108 may automatically select and apply WB gains based on one or more predefined light source conditions that most closely correspond to current light source conditions surrounding electronic device 102.
MWB control 112 is configured to enable a user to adjust one or more color directions, for example, between red and blue or between violet and green. In aspects further described herein, a user can use MWB control 112 to manually adjust WB gain along a continuous range that is not limited to a particular gain setting defined by predefined light source conditions.
The HWB mode 114 combines the features and functionality of WB module 108 and MWB control 112 to enhance the accuracy of accurate color correction, thereby providing the user with fine control over color correction. In an example, the HWB mode 114 enables the WB module 108 to switch between an automatic mode and a manual mode for correcting white balance of one or more frames in the live preview mode 110 of the camera application 106. Additionally, when switching to manual mode, WB module 108 may first estimate the WB gain of the current frame using automatic mode, and then adjust the WB gain according to user input to MWB control 112 with respect to the initial WB gain estimate.
In more detail, considering fig. 2, fig. 2 shows an example implementation 200 of the electronic device 102 of fig. 1. The electronic device 102 of FIG. 2 is illustrated with various example devices including a smart phone 102-1, a tablet computer 102-2, a laptop computer 102-3, a desktop computer 102-4, a computing watch 102-5, computing glasses 102-6, a gaming system 102-7, a home automation and control system 102-8, and a microwave oven 102-9. Electronic device 102 may also include other devices such as televisions, entertainment systems, audio systems, automobiles, drones, touch pads, drawing tablets, netbooks, electronic readers, home security systems, and other home appliances. Note that the electronic device 102 may be mobile, wearable, non-wearable but mobile, or relatively non-mobile (e.g., desktop devices and appliances).
The electronic device 102 also includes one or more computer processors 202 and one or more computer-readable media 204. One or more computer-readable media 204 include a memory medium 206 and a storage medium 208. An application 210 and/or an operating system 212 implemented as computer readable instructions on a computer readable medium 204 may be executed by the computer processor 202 to provide some or all of the functionality described herein. For example, the computer-readable medium 204 may include the camera application 106, the WB module 108, and the MWB control 112.
The electronic device 102 also includes a camera system 104 configured to capture images, video, and audio. Any suitable camera system 104 may be implemented in the electronic device 102. The camera system 104 may be a digital camera that converts light captured by a lens into digital data representing a scene within a field of view of the lens.
The electronic device 102 may also include a network interface 214. The electronic device 102 may communicate data over a wired, wireless, or optical network using the network interface 214. By way of example, and not limitation, network interface 214 may communicate data over a Local Area Network (LAN), a Wireless Local Area Network (WLAN), a Personal Area Network (PAN), a Wide Area Network (WAN), an intranet, the Internet, a peer-to-peer network, or a mesh network.
Various embodiments of camera system 104 may include a system on a chip (SoC), one or more Integrated Circuits (ICs), a processor with embedded processor instructions or configured to access processor instructions stored in memory, hardware with embedded firmware, a printed circuit board with various hardware components, or any combination thereof.
The electronic device 102 also includes one or more sensors 216, which may include any of a variety of sensors, including an audio sensor (e.g., a microphone), a touch input sensor (e.g., a touch screen), an image capture device (e.g., a camera or video camera), a proximity sensor (e.g., a capacitive sensor), or an ambient light sensor (e.g., a photodetector).
The electronic device 102 may also include a display device (e.g., display device 120). Display device 120 may include any suitable touch sensitive display device, such as a touch screen, liquid Crystal Display (LCD), thin Film Transistor (TFT) LCD, in-situ switched (IPS) LCD, capacitive touch screen display, organic Light Emitting Diode (OLED) display, active Matrix Organic Light Emitting Diode (AMOLED) display, super AMOLED display, or the like. The display device 120 may be referred to as a display or screen such that content may be displayed on the screen.
These and other capabilities and configurations, as well as the manner in which the entities of fig. 1 and 2 function and interact, are set forth in more detail below. These entities may be further divided, combined, etc. The detailed illustrations of the embodiment 100 and fig. 2-18 show some of many possible environments, devices, and methods that can employ the described techniques, whether alone or in combination with one another.
Fig. 3 illustrates an example embodiment 300 of a MWB control in a camera system of an electronic device. In fig. 3, a set of preset WB light source gains (e.g., presets 302) are shown along the range. Each preset WB light source gain may be calibrated by a laboratory standard light source. Some example preset WB light source gains may correspond to shadows (clips) 302-1, clouds (clouds) 302-2, outdoor (outdoor) 302-3, fluorescent (fluorescent) 302-4, warm fluorescent (warm fluorescent) 302-5, incandescent) 302-6, and horizon (horizontal) 302-7. In operation, however, there are a wide variety of illuminations that may deviate from laboratory standard light sources. Thus, the techniques described herein provide manually adjustable functionality between preset WB light source gains. For example, fig. 3 includes a slider bar 304 based on a preset WB light source gain. Slider bar 304 may be an example of MWB control 112 in FIG. 1. The user may slide the indicator 306 along the slider bar 304 between the cloudy day 302-1 and the horizon 302-7 (including the cloudy day 302-1 and the horizon 302-7) to determine WB gains for scene light sources that correct the scene in the field of view of the camera.
The HWB mode 114 may be selected by passing metadata information from the camera application 106 to the WB module 108. The metadata may include an indication (e.g., a flag) of the manual mode "ON". In response to receiving such an indication, WB module 108 disables the AWB mode and switches to the MWB mode. The MWB pattern includes a plurality of preset gains corresponding to preset WB points (e.g., preset 302).
To provide continuous WB gain calculations between presets 302, an interpolation function may be implemented. The interpolation function may use an interpolation ratio based on the correlated color temperature of the preset WB points (e.g., preset 302). Table 1 shows an example color temperature (in kelvin (K)) of the presets 302.
Table 1: example Manual white balance Point and correlated color temperature
Index | Manual WB point | Correlated color temperature |
0 | Shadow | 7500K |
1 | Clouds of people | 6500K |
2 | Sunlight | 5000K |
3 | FluorescenceLamp with light-emitting device | 4100K |
4 | Warm fluorescent lamp | 3800K |
5 | Filament lamp | 3200K |
6 | Horizon line | 2800K |
Consider fig. 4, which illustrates an example 400 of interpolation ratios and color correction temperatures. In the illustrated example, the user-selected WB point is located between two preset WB points (e.g., MWB (i) 402 and MWB (i+1) 404), which may correspond to two adjacent presets 302 from fig. 3. The term i refers to the index of the preset WB points, including those shown in table 1 (e.g., i e 0, 6). The distance 406 between MWB (i) 402 and MWB (i+1) 404 may be normalized to 0,1, zero at MWB (i) 402 and 1 at MWB (i+1) 404. When the user selects the position of the indicator 306 on the slider bar 304, the corresponding WB point (e.g., user-selected WB point 408) on the slider bar 304 is determined, and a ratio r (e.g., ratio 410) is obtained. MWB (i) 402, MWB (i+1) 404, and ratio 410 are sent to the AWB algorithm to calculate the target WB gain for the user selected WB point 408.
It is assumed that the Color Correction Temperature (CCT) of the light source MWB (i+1) is CCT (i+1), and that the CCT of the light source MWB (i) is CCT (i). The CCT of the target manual WB point (CCT (T)) can then be calculated using the following equation:
CCT (T) =cct (i) -r [ CCT (i) -CCT (i+1) ] equation 1
In equation 1, the light source CCT varies from high to low (e.g., from MWB (i) to MWB (i+1)). The target WB gain may then be calculated by interpolating the preset gain of the preset WB points using the CCT as an interpolation weight. In aspects, the CCT is normalized by Mired CCT (MCCT) before being used as a weighting for the calculation of the target WB gain. MCCT (i), MCCT (i+1) and MCCT (T) were calculated using the following:
the target WB gain (TMWB) may include a gain on the red-green-blue (RGB) scale. In aspects, rgain (R gain) and Bgain (B gain) may be calculated, and Ggain (G gain) may be kept constant. For example, TMWB (Rgain, ggain, bgain) may be calculated using the following:
fig. 5 depicts an example flowchart 500 of a feedback loop between a camera application and WB module for MWB selection between preset WB points. To implement WB mode, a feedback loop may be applied between camera application 106 and WB module 108 of fig. 1. At 502, WB is selected via camera application 106. For example, WB mode may have been selected or triggered by a user or a setting in the camera application 106. In an example, the user adjusts the position of the pointer 306 on the slider bar 304 presented via the camera UI 118.
The camera application 106 provides metadata (e.g., metadata 504) associated with the user-selected WB point 408 on the slider bar 304 to the WB module 108. If the position of the user-selected WB point 408 is between the two presets 302, the metadata 504 may include two preset WB points (MWB (i) and MWB (i+1)) on both sides of the user-selected WB point 408. In aspects, the two preset WB points may be the two closest presets on both sides of the user-selected WB point 408. The camera application 106 also provides a ratio r (e.g., ratio 410) based on the position of the user-selected WB point 408 on the slider bar 304 relative to the two closest preset WB points. However, if the user selects one of the presets 302 (e.g., the position of the user-selected WB point 408 corresponds to the position of the preset 302), then the ratio 410 is zero (e.g., r=0), and the two closest preset WB points are considered to be a single point (e.g., MWB (i) =mwb (i+1)). In aspects, metadata 504 also includes an indication (e.g., a manual mode flag) of whether the manual WB mode is on or off.
Upon receiving metadata 504, WB mode control 116 of WB module 108 determines whether to use a manual mode (e.g., MWB mode 506) or an automatic mode (e.g., AWB mode 508) to calculate WB gains. If the manual mode flag is on ("yes"), WB module 108 performs manual WB gain calculation 510 using MWB mode 506 to calculate a target manual WB gain 512 based on user-selected WB points 408 (e.g., via interpolation between two preset WB points). However, if the manual mode flag is off ("no"), the WB module 108 calculates WB gains using the AWB mode 508, the AWB mode 508 relying on conventional techniques for automatic WB gain calculation.
The WB module 108 may output information to the camera application 106 including a target WB gain (TMWB (Rgain, ggain, bgain)) for the user selected WB point 408. Feedback communication between WB module 108 and camera application 106 may occur in real-time to reduce latency and provide a user experience with a smooth WB transition as indicator 306 is slid along slider bar 304.
Fig. 6 illustrates example embodiments 600 and 650 of HWB mode in a camera system of an electronic device. In fig. 6, HWB mode 114 involves using an automatic WB gain calculation ("AWB decision") of AWB mode 508 as a starting point for a manual WB gain calculation 510 ("MWB gain calculation 510"). For example, rather than predefining several preset WB light source points (e.g., preset 302), the manual adjustment of the white balance may be based on an AWB decision for a current frame (e.g., the current frame shown in live preview mode 110 of camera application 106). WB module 108 may then apply fine or "preferential" color adjustments to achieve the user's preferential color.
The direction of color adjustment generally includes a direction between red and blue (e.g., embodiment 600) and/or a direction between violet and green (e.g., embodiment 650). By sliding the indicator 306 in the red direction (e.g., toward the red endpoint 602) or the violet direction (e.g., toward the violet endpoint 652), the hue warms (e.g., a higher color temperature). By sliding the indicator 306 in the blue direction (e.g., toward the blue endpoint 604) or the green direction (e.g., toward the green endpoint 654), the hue is chilled (e.g., colder color temperature).
The WB algorithm for controlling the manual mode is based on predefined preferred color tuning ranges in the red, blue, green and/or violet directions. The AWB decision for the current frame is defined by [ Rgain, ggain, bgain ]. Example gain adjustment tuning parameters are defined in table 2, where only Rgain and Bgain are adjusted. Based on the position of the user selected WB point 408 on the slider bar 304 presented in the camera UI 118 of the camera application 106, different red and blue gain adjustments may be applied in the WB algorithm.
Table 2: preference gain adjustment range
Preference gain | Gain adjustment range |
Red gain (Rgain) adjustment range | [RminAdjust,RmaxAdjust] |
Blue gain (Bgain) adjustment range | [BminAdjust,BmaxAdjust] |
In an example, if the user slides the indicator 306 to the red endpoint 602, the WB module 108 applies a preference gain adjustment (e.g., [ RgainAdjust, bgainAdjust ] = [1.02,0.98 ]) to achieve a warmer color cast (color cast). The intensity of the warmer color shift depends on the WB point along the slider 304 selected by the user. If the user is sliding the indicator 306 all the way to the red endpoint 602, the preference gain reaches a maximum red adjustment and a minimum blue adjustment (e.g., [ RmaxAdjust, bminAdjust ]).
The camera UI 118 provides location information of the user-selected WB point 408 on the slider bar 304 to enable the WB module 108 to provide gains that prefer color adjustment. The distance from the center of slider 304 to the two color endpoints is defined by a position parameter [ R, B ] (e.g., MWB point position 606). The position information at the slider center point 608 is defined as [ r=0, b=0 ]. The red endpoint 602 position information is defined as [ r=1, b= -1], and the blue endpoint 604 position information is defined as [ r= -1, b=1 ]. Purple and green slider bars may be similarly defined using [ r=1, b=1 ] for purple endpoint 652 positional information and [ r= -1, b= -1] for green endpoint 654 positional information. The position information on the slider is summarized in table 3:
Table 3: position information on slider
Slider option | Left (or top) dot | Center point | Right (or bottom) point |
Red/blue sliding bar | [R＝1,B＝-1] | [R＝0,B＝0] | [R＝-1,B＝1] |
Purple/green slider | [R＝1,B＝1] | [R＝0,B＝0] | [R＝-1,B＝-1] |
Camera UI 118 sends MWB point locations 606 r, b to WB module 108 to calculate WB gains for the user's preferences. A reference gain adjustment range is defined in the WB tuning header. Assume that the AWB decision for the current frame is [ Rgain, ggain, bgain ]. With this preferred color adjustment information (e.g., MWB point location 606) sent from camera UI 118, WB module 108 can update the new gain by using R e [ -1,1] and B e [ -1,1]:
rgain (MWB) =rgain (1+r x rmaxadjust) equation 5
Bgain (MWB) =rgain (1+b×rmaxadjust) equation 6
Fig. 7 depicts an example flowchart 700 of a feedback loop between a camera application and WB module for HWB mode based on preference color adjustment. To implement the MWB mode 506 described above, a feedback loop may be applied between the camera application 106 and WB module 108 of fig. 1, similar to the feedback loop of fig. 5. At 702, a hybrid WB is selected via the camera application 106. For example, the HWB mode 114 may have been selected or triggered by a user or a setting in the camera application 106. In an example, the user adjusts the position of the pointer 306 on the slider bar 304 presented via the camera UI 118.
The camera application 106 provides the position of the user-selected WB point 408 on the slider bar 304 (e.g., [ R, B ]). The camera application 106 provides metadata (e.g., metadata 704) to the WB module 108. The metadata 704 may include a red gain adjustment ratio R having a valid range of [ -1,1 ]. The metadata 704 may also include a blue gain adjustment ratio B having a valid range of [ -1,1 ]. In addition, metadata 704 may include a manual mode flag, as described above.
WB mode control 116 triggers WB module 108 to calculate AWB gain calculation 706 ("AWB decision") for the current frame of live preview mode 110 of camera application 106 using AWB mode 508 of HWB mode 114. Then, the AWB gain calculation 706 of the current frame may be used as a starting point (e.g., [ r=0, b=0 ]) to perform the MWB gain calculation 510 via the MWB mode 506 of the HWB mode 114 using the red gain adjustment ratio R and the blue gain adjustment ratio B in the metadata. The MWB gain calculation 510 returns an output provided to the camera application 106, where the output includes a target manual WB gain 708 (e.g., TMWB (Rgain, ggain, bgain)) for the user selected WB point 408. Feedback communication between camera application 106 and WB module 108 occurs in real-time to reduce latency between movement of MWB control 112 and rendering results of corresponding color corrections in content displayed via camera UI 118. Such real-time results provide a smooth WB transition process as the user moves MWB control 112 in camera application 106.
Fig. 8 shows examples 800 and 850 of a camera UI with MWB controls for adjusting the white balance of frames shown in a live preview mode of a camera application on an electronic device. In example 800, the camera UI 118 includes slider controls for adjusting different parameters of the camera system 104 or the camera application 106. The slider controls may include MWB control 112, which may correspond to slider 304 in fig. 3, 4, and 6. The additional slider controls may include an exposure control 802 for adjusting the exposure of the image sensor of the camera system 104, a brightness control 804 for adjusting the brightness of the image or video, and a contrast control 806 for adjusting the contrast of the image or video. Additional slider controls may also be implemented to enable manual adjustment of additional parameters of the camera system 104 or the camera application 106, including focus (focus), zoom, saturation, hue (hue), and the like.
MWB control 112 may be presented in any suitable form via camera UI 118. In example 800, MWB control 112 includes slider 304 and a plurality of indicators on slider 304. These indicators may include an upper bound 808, a lower bound 810, and an indicator 306 representing a user-selectable target WB point (e.g., user-selected WB point 408). Slide bar 304 extends between an upper boundary 808 and a lower boundary 810. Each of the indicators 306, 808, and 810 may be UI elements including objects, icons, symbols, thumbnails, and the like. In one example, the upper bound 808 indicator includes a daylight (day) icon to indicate to the user that moving the indicator 306 toward the upper bound 808 causes the hue of the image to become warmer. In an example, the lower bound 810 indicator includes an incandescent icon to indicate to the user that moving the indicator 306 toward the lower bound causes the hue of the image to become cooler. As depicted in fig. 3, the preset 302 may exist between an upper bound 808 and a lower bound 810. The one or more presets 302 may also be represented by corresponding UI elements positioned on a slider 304 of MWB control 112. In aspects, MWB control 112 may be displayed in camera UI 118 in response to a user input requesting that MWB control 112 be displayed. MWB control 112 may be otherwise hidden from camera UI 118 to reduce screen clutter.
In example 850, MWB control 112 includes two separate slider bars: a first slider bar 852 and a second slider bar 854. Example 850 may be related to example embodiments 600 and 650 described in fig. 6. For example, a first slider bar 852 may be associated with the example embodiment 600, which enables manual WB adjustment between red and blue hues. The second slider 854 may be associated with the example embodiment 650, which enables manual WB adjustment between purple and green hues. Alternatively, the first slider bar 852 may adjust the white balance between the purple hue and the green hue, while the second slider bar 854 adjusts the white balance between the red hue and the blue hue.
By relying on the preferred color range defined in the WB tuning header instead of the preset WB light source gain (e.g., preset 302), the MWB control (e.g., MWB control 112, first slider bar 852, or second slider bar 854) may be displayed as a stripe with an initial AWB decision located at the center of the stripe (bar). To provide an indication of the color direction associated with each MWB control, a colored slider bar or object (e.g., icon) may be implemented.
Fig. 9 illustrates an example implementation 900 of white balance lock ("WB lock") in a camera application of an electronic device. For example, WB module 108 from fig. 1 may include a lock feature (e.g., WB lock) that may be used to lock the AWB gain and apply the locked AWB gain to subsequent frames in live preview mode 110.
Some target scenarios may be challenging for WB module 108 to provide accurate AWB decisions. These challenges may be due to various factors, including the lighting conditions of the scene or the colors of objects in the scene. To improve accuracy, the user may point the camera of the electronic device 102 at a gray or white object under a similar light source to allow the WB module 108 to determine the AWB decision on the current frame, and then the user may select WB lock to prevent further changes to white balance. When WB lock is enabled, WB gain is not adjustable, either automatically or manually. Thus, the user can point the camera at the target scene of interest and the white balance remains unchanged from the AWB decision made for gray or white objects. In this way, WB module 108 is not misled by one or more colors in the field of view of the target scene of the camera.
If a gray or white object is available, it may be useful to use the gray or white object because accurate results may be obtained without requiring further manual adjustment of the white balance by the user. In general, WB module 108 may automatically correct scene illuminant by using neutral colors in the field of view of the camera.
In the example shown in fig. 9, the field of view of the camera captures a scene with a neutral color bike 902 and the scene is displayed in a live preview mode of the camera UI 118 (e.g., camera UI 118-1). WB module 108 automatically determines WB gains from the neutral color bike 902 (or from the neutral color wall behind the bike). To maintain the determined WB gain, the user may provide an input to lock the WB gain. For example, a UI element (e.g., icon 904) may be selected by user input to initiate WB locking. In the illustrated example, icon 904 may be an unlocked lock indicating that the current WB gain has not been locked.
After the user input locks WB gain, the user moves the camera field of view to aim at another object of interest (e.g., chair 906 shown in camera UI 118-2), which may be under the same light source. Thus, the same WB gain determined for bicycle 902 is now applied to the capture of chair 906, regardless of how challenging the scene content is for WB module 108. Additionally, icon 904 may change (e.g., change to icon 908) to indicate that WB gain is locked in place. In this example, icon 908 is a locked lock. Because this example relies on WB module 108 operating in AWB mode, MWB control 112 is not displayed. However, the lockout features described herein may be implemented in conjunction with MWB control 112 to prevent undesired WB gain adjustments by unintended user input to MWB control 112.
Fig. 10 depicts an example flowchart 1000 of communication between the camera application 106 and the WB module 108 regarding WB locking. After WB module 108 calculates the AWB decision for the current frame (e.g., the first frame), then at 1002, the user input selects WB lock via camera UI 118. In response to the user's selection of WB lock for the current frame, the camera application 106 passes a WB lock flag 1004 to the WB module 108, and at 1006 WB lock is enabled. At 1008, the AWB auto mode locks to the current frame WB gain. In this way, the WB module 108 does not perform AWB computation on frames following the current frame, and maintains WB gains [ Rgain, ggain, bgain ] for the current frame until WB lock is disabled. WB module 108 returns WB gain 1010 for the current frame to camera application 106.
Fig. 11 depicts a flowchart 1100 of communication between the camera application 106 and WB module 108 to implement a touch WB variant of MWB mode 506. According to the touch WB, when a user touches the display device 120, a touch region of interest (ROI) is defined. Then, in some examples, ROI information (e.g., sensor coordinates (x, y, dx, dy) on which the touch ROI is defined) is sent to WB module 108, and WB module 108 calculates AWB decisions for the entire frame using only RGB information corresponding to the touch ROI.
In many camera applications on touch screen devices, a default touch action (e.g., a tap) in the camera UI 118 may trigger touch autofocus and touch auto-exposure. Thus, it may be useful for a user to have prior knowledge of selecting neutral objects for white balancing a scene light source. To avoid confusion of the user with conventional touch gestures in many camera applications, touch WB may be triggered separately from touch autofocus and touch auto-exposure. Thus, touch WB may be enabled in response to enabling touch input to adjust white balance explicit user input, and disabled by default at other times.
At 1102, a manual WB mode (specifically, touch WB) is selected via the camera UI 118. The camera application 106 passes the touch ROI information 1104 of the user touch to the WB module 108. Touch ROI information 1104 may include touch WB flag and touch WB ROI. Specifically, the touch-WB ROI includes ROI information. In response to receiving touch ROI information with touch WB flag, WB module 108 switches MWB mode 506 to touch WB at 1106. Touch WB enables a touch pipeline (pipeline) to be separated from touch focus and touch exposure. For example, by activating touch WB of MWB mode 506, the user may touch a location on camera UI 118 for AWB decision making without activating or causing a change in auto focus and/or auto exposure.
At 1108, WB module 108 calculates a final AWB decision for the frame based on the RGB information within the touch ROI. In this way, WB module 108 uses the AWB mode to calculate AWB decisions based on information obtained from the MWB mode (e.g., touch WB variants). WB module 108 then passes the final AWB decision (e.g., WB gain 1110[ rgain, ggain, bgain ] based on RGB information located within the touch ROI) to camera application 106 for color correction.
Fig. 12 shows an example implementation 1200 of a touch WB variant of initiating an MWB mode 506 via the camera UI 118 of the camera application 106. In aspects, MWB control 112 may provide selectable options via camera UI 118 to enable a user to select a particular MWB mode from a plurality of MWB mode variants. Some example MWB pattern variants include touch WB variants, preset light source variants, and preference color variants. The selectable object may initiate a corresponding MWB pattern variant when selected by a user input. For example, in example 1202-1, camera UI 118 provides UI element 1204 with selectable options including first icon 1206 (e.g., a touch icon), second icon 1208 (e.g., a preference color icon), and third icon 1210 (e.g., a preset color icon). The first icon 1206 may correspond to a touch WB variant of the MWB mode 506. The second icon 1208 may correspond to a preferred color variant of the MWB pattern 506. The third icon 1210 may correspond to a preset light source variation of the MWB pattern 506. MWB control 112 may be provided in any suitable manner, including via a drop down menu, a pop-up window, or an overlay. Further, MWB control 112 may be accessible via settings of camera application 106.
In example 1202-1, the user directs the camera to his dog 1212 sitting on the floor 1214 in front of wall 1216. The camera UI 118 currently shows a live preview of the scene of the dog 1212. The HWB mode 114 described herein enables a user to control color correction of frames shown in the live preview mode 110 of the camera application 106 via WB adjustment.
In example 1202-1, the user touches (e.g., touches 1218) first icon 1206, which triggers initiation of a touch WB variant of MWB mode 506. In response, the camera application 106 switches to the touch WB variant. In some cases, MWB control 112 is removed from camera UI 118 in response to touch 1218 to reduce screen clutter. In another example, the display of MWB control 112 is preserved. Because the user has selected the touch WB variant, the electronic device 102 does not perform AWB decision until after receiving explicit user input selecting the ROI on the display device 120. In the example 1202-2 of the illustrated example, a user input (e.g., touch 1220) selects the wall 1216 behind the dog 1212 because the wall has a neutral color. WB module 108 then performs AWB decisions using only RGB information within the area of display device 120 touched by the user's finger (e.g., touching the ROI). Using the AWB decision, the camera application 106 can adjust the white balance of the subsequent frames shown in the live preview mode 110 and thus adjust the captured image or video captured by the camera system 104 for persistent storage. Additionally, the camera UI 118 may provide a lock option (e.g., WB lock described in fig. 9) by displaying an icon 904 that may be selected by the user to lock WB gain. The user may then move the field of view of the camera to capture images or video of a different object (not shown), and the camera system 104 uses WB gains with WB gains calculated based on the selection of the wall 1216.
Fig. 13 shows an example implementation 1300 of a preferred color variant for selecting MWB mode 506 via camera UI 118 of camera application 106. In instance 1302-1, a user input (e.g., touch 1304) selects a second icon 1208 corresponding to the preferred color variant of MWB mode 506 via UI element 1204. In response to selection of the second icon 1208, in example 1302-2, the camera application 106 provides one or more WB slide bars (e.g., first slide bar 852 and/or second slide bar 854) via the camera UI 118 to enable a user to manually adjust white balance of frames shown in live preview mode by moving indicators (e.g., indicators 306-1 and 306-2) over the WB slide bars (e.g., slide bars 852 and 854). Then, as described above, the camera application determines the position of the indicators 306-1 and 306-2 on the WB slide bars 852 and 854 and communicates this position information to the WB module 108.WB module 108 calculates AWB decisions based on the location information and returns the AWB decisions (e.g., WB gains) to camera application 106 for color correction.
Fig. 14 shows an example embodiment 1400 of a preset light source variant for selecting MWB mode via a camera UI of a camera application. In example 1402-1, a user input (e.g., touch 1404) selects a third icon 1210 corresponding to a preset light source variant of MWB pattern 506 via UI element 1204. In response to selection of the third icon 1210, in instance 1402-2, the camera application 106 provides one or more WB controls (e.g., MWB control 112) via the camera UI 118 to enable a user to manually adjust white balance of frames shown in live preview mode by moving the indicator 306 over the MWB control 112. Then, as described above, camera application 106 determines the position of indicator 306 on MWB control 112, such as by interpolation between the closest preset light source points (e.g., presets 302) on both sides of indicator 306. WB module 108 calculates AWB decisions based on interpolation of preset manual WB gains corresponding to presets 302 and returns the AWB decisions to camera application 106 for color correction.
Fig. 15 shows an example implementation 1500 of MWB adjustment by preference gain. Similar to embodiment 600 in fig. 6, embodiment 1500 includes a MWB slider (e.g., slider 304) having two endpoints (e.g., red endpoint 1502, blue endpoint 1504). In fig. 15, endpoints 1502 and 1504 correspond to tunable red and blue color segments, respectively. A preferred color adjustment look-up table (LUT) may be implemented in the tuning header and enables the maximum red and blue gains (e.g., red end 1502 and blue end 1504, respectively) to be tunable. In aspects, the red and blue endpoints 1502 and 1504 of the slider bar 304 are tunable to provide full coverage of the light source range or to provide only a portion of the light source range. MWB control 112 is based on the AWB gain, which enables the user to return the manually adjusted WB gain to the original AWB decision. For example, the AWB decision is used to define the center of WB slider 304 (e.g., slider center 1506) (e.g., slider center 1506 is defined as R, B initial gain adjustment= [1.0,1.0 ]). Gain adjustment LUT-which may be defined as in table 4-is used to define the boundary settings for MWB control 112:
table 4: manual WB preference gain adjustment range
Different red and blue gain adjustments are applied by WB module 108 based on the user-selected position of indicator 306 on WB slider bar 304 in camera UI 118. To calculate the real-time MWB gain and provide output to an image or video displayed in a camera preview (e.g., live preview mode 110 of camera application 106), information indicating the position of user-selected pointer 306 on WB slider bar 304 is passed from camera UI 118 to WB module 108. If the position of the pointer 306 is defined as a floating point value d slider ∈[-1，1]Then it can be shown on the slider bar 304 in fig. 15. The corresponding value for the position of the indicator 306 is shown in the third column of table 4 (e.g., the "slider distance value").
Use position d slider WB module 108 may look up a preference gain adjustment table defined in the tuning header and locate the corresponding gain adjustment value to calculate the current MWB gain. Note that the maximum and minimum preferred gain adjustment values are tunable based on the needs of each camera sensor. Maximum and minimum preference gain values (e.g., red endpoint 1502, blue endpoint 1504 Respectively defined as [ R ] max ，B min ]、[R min ，B max ]. When WB module 108 receives position d slider When the corresponding adjustment gains can be calculated for the target red and blue gains accordingly using the following
If d slider ＞0，
If d slider ＜0，
If d slider ＝0，
Note that: r is R max ≥1.0，0＜B min ≤1；B max ≥1.0，0＜R min Less than or equal to 1 equation 7
When WB gain changes, the corresponding CCT and Color Correction Matrix (CCM) may also change. For the manual mode, the new CCT and CCM may be calculated together, depending on the maximum gain adjustment range.
In some embodiments, a smaller range between the red and blue endpoints of slider bar 304 may enable finer adjustment of the white balance, while a larger range enables coarser adjustment of the white balance. Thus, the sensitivity of WB slider 304 may be adjusted by defining the respective end points of WB slider 304. For example, the sensitivity of WB slider 304 may be increased by increasing the range between the red and blue endpoints on slider 304. Alternatively, the sensitivity of WB slider 304 may be reduced by reducing the range between the red and blue endpoints on slider 304.
Fig. 16 illustrates an example graph 1600 of a color correction temperature range for preference gain adjustment. In various aspects, the CCT range includes complete coverage of the light source range. However, the CCT range may be defined to include only a portion of the entire light source range. The light source range includes sub-ranges 1602 corresponding to at least some of the preset WB points (e.g., preset 302) and correlated color temperatures described above in table 1. Any suitable number and size of sub-ranges 1602 may be used to represent portions of the light source range. In the example shown, the graph 1600 includes a first range 1602-1, a second range 1602-2, a third range 1602-3, and a fourth range 1602-4. The first range 1602-1 may be defined as a range around a calibration reference point (e.g., calibrated by a laboratory standard light source) and a reference line, including a preset shadow 302-1, a cloudiness 302-2, and an outdoors 302-3. The second range 1602-2 may be defined as a range around the calibration reference point and reference line, including the preset fluorescent lamp 302-4 and the warm fluorescent lamp 302-5. The third range 1602-3 may be defined as a range around the calibration reference point and reference line, including the preset incandescent lamp 302-6. The fourth range 1602-4 may be defined as a range around the calibration reference point and reference line that includes the preset horizon 302-7.
Conventional camera systems may use only a preset gain (e.g., preset 302). However, the preset gain may not match the real world light source, which may result in some color cast (color cast) even when manual WB adjustment is used. Such problems can reduce the effectiveness of manual WB adjustment. To address this problem, the color correction algorithm used by WB module 108 is based on the current AWB decision and may still cover the entire light source range. In this way, WB slider bar 304 is centered on the current AWB decision, and the user can slide indicator 306 on WB slider bar 304 to achieve a different color appearance. This approach enhances the accuracy of color correction compared to conventional techniques that rely solely on preset 302.
The centerline 1604 represents a pre-calibration line between presets 302. The reference CCT line 1606 (represented by a dashed line) is a calibration line parallel to the centerline 1604, but is illustrated offset from the centerline 1604 for visual clarity. Based on the current light source characteristics, WB module 108 calculates AWB decisions (e.g., AWB decisions 1608) and how they relate to the calibrated center light source in real time. The central light source is based on a highest color temperature and a lowest color temperature. For example, sliding the indicator 306 toward the red endpoint 602 on the WB slider bar 304 in fig. 15 moves the WB gain along the reference CCT line 1606 in the first direction 1610 and adjusts to a warmer hue. Sliding the indicator 306 on the WB slider bar 304 toward the blue end point 604 causes WB gain to be shifted on the WB slider bar 304 along the reference CCT line 1606 in a second direction 1612 opposite the first direction 1610 and adjusted to a cooler hue.
Fig. 17 depicts a flowchart 1700 of HWB mode by preference color adjustment. At 1702, camera application 106 determines metadata 1704 associated with indicator 306 on MWB control 112 (e.g., WB slider bar 304) in camera application 106. The camera application 106 sends the metadata 1704 to the WB module 108. Metadata 1704 includes location information (e.g., floating point value d) of indicator 306 on WB slider 304 relative to the center of WB slider 304 (e.g., slider center 1506) slider ). Metadata 1704 may also include a manual mode flag, as described above.
At 1706, the WB mode control 116 of the WB module 108 receives metadata 1704 from the camera application 106 and uses the metadata 1704 to determine whether to enter the AWB mode 508 or the MWB mode 506 for calculation of WB gain adjustment.
At 1708, WB module 108 determines whether MWB mode 506 is enabled based on the manual mode flag included in metadata 1704. If MWB mode 506 is enabled ("yes" at 1708), WB module 108 performs manual WB calculation using the location information in metadata 1704 at 1710. However, if MWB mode 506 is disabled ("no" at 1708), WB module 108 uses AWB mode 508 to perform automatic WB calculation based on characteristics of the current frame at 1712. The WB module then provides an output (e.g., WB gain [ Rgain, ggain, bgain ], CCT, CCM) to the camera application 106 at 1714 to enable the camera application 106 to adjust WB gain for frames in the live preview mode 110.
FIG. 18 illustrates an example method 1800 of implementing the MWB control 112 from FIG. 1 in a preview mode of a camera system of an electronic device. In the illustrated example, the electronic device 102 provides a colored slider bar 1802 in a camera preview of a camera application that is rendered on the display device 120. The colored slider 1802 is dedicated to manual WB adjustment and is an example of slider 304. In aspects, the colored slider 1802 is provided in a vertical orientation. However, the colored slider 1802 may be presented in a horizontal orientation or a diagonal orientation. The color toward the top (e.g., top end 1804) of the colored slider 1802 may be rendered with a warm color (e.g., orange, red) to indicate a warmer hue adjustment direction 1806. The color toward the bottom (e.g., bottom end 1808) of the colored slider 1802 may be rendered with a cool color (e.g., blue) to indicate a cooler hue adjustment direction 1810. In aspects, the color of the colored slider 1802 between the top end 1804 and the bottom end 1808 may gradually change from substantially blue to substantially red (or substantially orange) to visually indicate a correlation between the color shade adjustment and the position of the indicator 306 on the colored slider 1802. In another example, the color of the colored slider 1802 may change in a stepwise manner. In this way, the user can intuitively understand the functionality of the WB slider (e.g., the correlation between the position of the pointer and the resulting hue effect on the preview image) without having a priori knowledge of the CCT or how to use the CCT for WB adjustment. Conversely, the warmer and cooler color directions for MWB adjustment provide the user with an immediate impression of how to change the color appearance.
In aspects, CCT also changes based on gain adjustment changes. For example, sliding the indicator 306 toward a warmer direction moves the white balance to a higher CCT direction, and sliding the indicator 306 toward a cooler direction moves the white balance to a lower CCT direction.
In general, any of the components, modules, methods, and operations described herein may be implemented using software, firmware, hardware (e.g., fixed logic circuitry), manual processing, or any combination thereof. Some operations of the example methods may be described in the general context of executable instructions stored on computer-readable storage memory local and/or remote to a computer processing system, and embodiments may include software applications, programs, functions, and the like. Alternatively, or in addition, any of the functionality described herein may be performed, at least in part, by one or more hardware logic components, including, but not limited to, field Programmable Gate Arrays (FPGAs), application Specific Integrated Circuits (ASICs), application Specific Standard Products (ASSPs), systems-on-a-chip (socs), complex Programmable Logic Devices (CPLDs), and the like.
Some examples are described below:
a method for hybrid white balance mode in a camera application of an electronic device, the method comprising: presenting, during a live preview mode of the camera application, an MWB control on a camera user interface displayed on a display device of the electronic device, the MWB control configured to enable user selection of a white balance setting for performing manual adjustment of white balance relative to a current frame presented in the live preview mode of the camera application; determining an automatic white balance decision on a red, green, and blue RGB scale for the current frame based on one or more characteristics of the current frame using an automatic white balance automatic mode; receiving user input to adjust the manual white balance control displayed in the camera user interface; determining, using an automatic white balance manual mode, a target white balance gain for white balance adjustment of the current frame based on the user input to the white balance control relative to the automatic white balance decision, the automatic white balance decision serving as an initial white balance gain to determine the target white balance gain corresponding to the user input to the manual white balance control; and applying the target white balance gain to the current frame presented in the live preview mode of the camera application for color correction.
Determining the white balance adjustment may include using a lookup table defined to perform the white balance gain adjustment.
The lookup table may define values for the upper bound, lower bound, and center point corresponding to the manual white balance control.
The white balance gain adjustment may include a red gain adjustment and a blue gain adjustment.
The upper and lower bounds may be tunable based on one or more parameters of the camera system.
The manual white balance control may include a slider bar extending between an upper bound and a lower bound.
The method may further comprise: determining positional information associated with a user-selected pointer on the slider relative to a center of the slider; transmitting the position information from the camera user interface to the white balance module to calculate a target white balance gain in real time; and calculating, by the white balance module, a target white balance gain for the manual white balance adjustment by referring to the corresponding gain adjustment value using the position information with the lookup table.
The method may further comprise: when the white balance gain is changed, a new color correction temperature and a new color correction matrix for the automatic white balance manual mode are calculated depending on the maximum range of gain adjustment.
The slider bar may be configured to provide a continuous range between a plurality of preset white balance gains, and the method may further include: determining location information associated with a user-selected pointer on the slider; and applying an interpolation function with respect to two preset white balance points on both sides of the user-selected pointer to determine a target white balance gain corresponding to the position information of the user-selected pointer.
The interpolation function may use an interpolation ratio based on correlated color temperatures of two preset white balance points.
The slider bar may be centered on the automatic white balance decision for the current frame and include a range covering at least a portion of the entire light source range.
The manual white balance control may include: a first slider configured to enable manual white balance adjustment substantially between red and blue; and a second slider configured to enable manual white balance adjustment substantially between purple and green.
The method may further comprise: receiving an additional user input selecting a white balance lock; and in response to receiving the additional user input, locking the target white balance gain to prevent additional gain adjustment in the automatic white balance mode and the manual white balance mode; and applying the target white balance gain to subsequent frames displayed in a live preview mode of the camera application.
The user input may initiate a touch white balance variant of the manual white balance control, and the method may further comprise: receiving additional user input comprising a touch by a user finger on the display device; determining a region of interest corresponding to the touch prior to determining the automatic white balance decision; performing a determination of the automatic white balance decision using RGB information within the region of interest; and applying the target white balance gain to subsequent frames displayed in the live preview mode.
A mobile electronic device, comprising: a display device; a camera system; one or more processors; and a memory that stores: instructions that, when executed by the one or more processors, cause the one or more processors to implement a hybrid white balance mode of the camera system by performing the method disclosed above.
A computer-readable medium comprising instructions that, when executed by one or more processors, cause the one or more processors to perform the above-described method.
Conclusion(s)
Although aspects of a hybrid white balance mode in a camera system of an electronic device have been described in language specific to features and/or methods, the subject of the appended claims is not necessarily limited to the specific features or methods described. Rather, the specific features and methods are disclosed as example implementations of the claimed hybrid white balance mode in a camera application of an electronic device, and other equivalent features and methods are intended to be within the scope of the appended claims. Furthermore, various aspects are described, and it is to be understood that each described aspect may be implemented independently or in combination with one or more other described aspects.
Claims (15)
1. A method for hybrid white balance mode in a camera system of an electronic device, the method comprising:
during a live preview mode of a camera application of the camera system, presenting a manual white balance control via a camera user interface displayed on a display device of the electronic device, the manual white balance control configured to enable user selection of white balance settings for performing manual adjustment of white balance relative to a current frame presented in the live preview mode of the camera application;
determining an automatic white balance decision on a red, green, and blue RGB scale for the current frame based on one or more characteristics of the current frame using an automatic white balance mode;
receiving user input to adjust the manual white balance control displayed in the camera user interface;
determining, using a manual white balance mode, a target white balance gain for white balance adjustment of the current frame based on the user input to the manual white balance control relative to the automatic white balance decision, the automatic white balance decision serving as an initial white balance gain to determine the target white balance gain corresponding to the user input to the manual white balance control; and
The target white balance gain is applied to the current frame presented in the live preview mode of the camera application for color correction.
2. The method of claim 1, wherein determining the white balance adjustment comprises performing white balance gain adjustment using a look-up table.
3. The method of claim 2, wherein the lookup table defines values of an upper bound, a lower bound, and a center point corresponding to the manual white balance control.
4. A method according to claim 3, wherein the white balance adjustment comprises a red gain adjustment and a blue gain adjustment.
5. The method of claim 3 or claim 4, wherein the upper bound and the lower bound are tunable based on one or more parameters of the camera system.
6. The method of any of claims 3-5, wherein the manual white balance control comprises a slider bar extending between the upper and lower bounds.
7. The method of claim 6, further comprising:
determining positional information associated with a user-selected pointer on the slider relative to a center of the slider;
Transmitting the position information from the camera user interface to a white balance module to calculate the target white balance gain in real time; and
the target white balance gain for the white balance adjustment is calculated by the white balance module by referring to a corresponding gain adjustment value using the position information together with the look-up table.
8. The method of claim 1, wherein the manual white balance control comprises a slider bar configured to provide a continuous range between a plurality of preset white balance gains, the method further comprising:
determining location information associated with a user-selected pointer on the slider; and
an interpolation function is applied with respect to two preset white balance points on both sides of the user-selected pointer to determine the target white balance gain corresponding to the position information of the user-selected pointer.
9. The method of claim 8, wherein the interpolation function uses an interpolation ratio that is based on a correlated color temperature of each of the two preset white balance points.
10. The method according to any of claims 6 to 9, wherein the slider bar is centered on the automatic white balance decision for the current frame and comprises a range covering at least a part of the entire light source range.
11. The method of any of claims 6 to 10, wherein the manual white balance control comprises:
a first slider configured to enable manual white balance adjustment substantially between red and blue hues; and
a second slider configured to enable manual white balance adjustment substantially between the purple and green hues.
12. The method of any of the preceding claims, further comprising:
receiving an additional user input selecting a white balance lock; and
in response to receiving the additional user input, locking the target white balance gain to prevent additional gain adjustment in the automatic white balance mode and the manual white balance mode; and
the target white balance gain is applied to subsequent frames displayed in the live preview mode of the camera application.
13. The method of claim 1, wherein adjusting the user input of the manual white balance control initiates a touch white balance variant of the manual white balance mode, and the method further comprises:
receiving additional user input comprising a touch of a user's finger on the display device;
Determining a region of interest corresponding to the touch prior to determining the automatic white balance decision;
performing a determination of the automatic white balance decision for the current frame using RGB information within the region of interest; and
the target white balance gain is applied to subsequent frames displayed in the live preview mode.
14. A mobile electronic device, comprising:
a display device;
a camera system;
one or more processors; and
a memory that stores:
instructions that, when executed by the one or more processors, cause the one or more processors to implement a hybrid white balance mode of the camera system by performing the method of any of the preceding claims.
15. A computer-readable medium comprising instructions that, when executed by one or more processors, cause the one or more processors to perform the method of any of claims 1-13.
Applications Claiming Priority (1)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
PCT/US2021/033487 WO2022245364A1 (en) | 2021-05-20 | 2021-05-20 | Hybrid white-balance mode in a camera system of an electronic device |
Publications (1)
Publication Number | Publication Date |
---|---|
CN117337574A true CN117337574A (en) | 2024-01-02 |
Family
ID=76270120
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
CN202180098314.8A Pending CN117337574A (en) | 2021-05-20 | 2021-05-20 | Hybrid white balance mode in a camera system of an electronic device |
Country Status (5)
Country | Link |
---|---|
EP (1) | EP4342172A1 (en) |
CN (1) | CN117337574A (en) |
DE (1) | DE112021007688T5 (en) |
TW (1) | TW202310611A (en) |
WO (1) | WO2022245364A1 (en) |
Family Cites Families (4)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
JP2005175975A (en) * | 2003-12-12 | 2005-06-30 | Canon Inc | Image processor |
JP2011055170A (en) * | 2009-08-31 | 2011-03-17 | Canon Inc | Information processing apparatus and control method therefor |
JP5817131B2 (en) * | 2011-02-01 | 2015-11-18 | 株式会社リコー | Imaging apparatus, imaging method, and imaging program |
JP6786850B2 (en) * | 2016-04-07 | 2020-11-18 | 富士ゼロックス株式会社 | Image processing equipment, image processing methods, image processing systems and programs |
-
2021
- 2021-05-20 DE DE112021007688.4T patent/DE112021007688T5/en active Pending
- 2021-05-20 EP EP21730078.9A patent/EP4342172A1/en active Pending
- 2021-05-20 WO PCT/US2021/033487 patent/WO2022245364A1/en active Application Filing
- 2021-05-20 CN CN202180098314.8A patent/CN117337574A/en active Pending
-
2022
- 2022-03-17 TW TW111109762A patent/TW202310611A/en unknown
Also Published As
Publication number | Publication date |
---|---|
DE112021007688T5 (en) | 2024-04-04 |
WO2022245364A1 (en) | 2022-11-24 |
TW202310611A (en) | 2023-03-01 |
EP4342172A1 (en) | 2024-03-27 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
US11729518B2 (en) | Systems and methods for digital photography | |
US7839436B2 (en) | Photographing apparatus with setting for white balance adjustment | |
US8538147B2 (en) | Methods and appartuses for restoring color and enhancing electronic images | |
US9483849B2 (en) | Method and apparatus for controlling camera for color calibration of multi-displays | |
US9148638B2 (en) | Digital photographing apparatus | |
JP2016533663A (en) | White balance adjustment method and apparatus | |
WO2008153620A1 (en) | Color correcting for ambient light | |
CN105744174A (en) | Selfie method and device and mobile terminal | |
US9025224B2 (en) | Image-color-correcting method using a multitouch screen | |
JPWO2006059573A1 (en) | Color adjustment apparatus and method | |
US20110285745A1 (en) | Method and apparatus for touch screen assisted white balance | |
TW201444365A (en) | Automatic white balance based on dynamic mapping | |
JP2009183010A (en) | Imaging apparatus, white balance processing method of imaging apparatus, program, and recording medium | |
US7764318B2 (en) | Photographing apparatus having a white balance adjustment function | |
TWI654873B (en) | Screen calibration method and screen calibration system | |
CN117337574A (en) | Hybrid white balance mode in a camera system of an electronic device | |
EP2556655B1 (en) | Electronic camera viewfinder with continuous variable adjustable colour temperature |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
PB01 | Publication | ||
PB01 | Publication |