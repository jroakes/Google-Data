EP3788591B1 - Focus-weighted, machine learning classifier error prediction for microscope slide images - Google Patents
Focus-weighted, machine learning classifier error prediction for microscope slide images Download PDFInfo
- Publication number
- EP3788591B1 EP3788591B1 EP18834117.6A EP18834117A EP3788591B1 EP 3788591 B1 EP3788591 B1 EP 3788591B1 EP 18834117 A EP18834117 A EP 18834117A EP 3788591 B1 EP3788591 B1 EP 3788591B1
- Authority
- EP
- European Patent Office
- Prior art keywords
- focus
- image
- classifier
- error
- images
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Active
Links
- 238000010801 machine learning Methods 0.000 title description 8
- 238000000034 method Methods 0.000 claims description 59
- 210000001519 tissue Anatomy 0.000 claims description 42
- 210000002307 prostate Anatomy 0.000 claims description 7
- 210000001165 lymph node Anatomy 0.000 claims description 6
- 201000010099 disease Diseases 0.000 description 59
- 208000037265 diseases, disorders, signs and symptoms Diseases 0.000 description 59
- 230000007170 pathology Effects 0.000 description 17
- 206010028980 Neoplasm Diseases 0.000 description 14
- 201000011510 cancer Diseases 0.000 description 12
- 238000013527 convolutional neural network Methods 0.000 description 12
- 238000012549 training Methods 0.000 description 12
- 238000003745 diagnosis Methods 0.000 description 8
- 238000001000 micrograph Methods 0.000 description 7
- 238000013459 approach Methods 0.000 description 6
- 210000004027 cell Anatomy 0.000 description 6
- 206010027476 Metastases Diseases 0.000 description 5
- 238000007906 compression Methods 0.000 description 5
- 230000006835 compression Effects 0.000 description 5
- 238000013507 mapping Methods 0.000 description 5
- 238000004220 aggregation Methods 0.000 description 4
- 230000002776 aggregation Effects 0.000 description 4
- 238000013528 artificial neural network Methods 0.000 description 4
- 238000001514 detection method Methods 0.000 description 4
- 238000011156 evaluation Methods 0.000 description 4
- 238000010191 image analysis Methods 0.000 description 4
- 238000003384 imaging method Methods 0.000 description 4
- 206010006187 Breast cancer Diseases 0.000 description 3
- 208000026310 Breast neoplasm Diseases 0.000 description 3
- 208000007433 Lymphatic Metastasis Diseases 0.000 description 3
- 238000004458 analytical method Methods 0.000 description 3
- 238000013434 data augmentation Methods 0.000 description 3
- 238000001914 filtration Methods 0.000 description 3
- 238000003908 quality control method Methods 0.000 description 3
- 238000009877 rendering Methods 0.000 description 3
- 238000012360 testing method Methods 0.000 description 3
- 238000013144 data compression Methods 0.000 description 2
- 238000013135 deep learning Methods 0.000 description 2
- 230000001419 dependent effect Effects 0.000 description 2
- 238000002474 experimental method Methods 0.000 description 2
- 239000011521 glass Substances 0.000 description 2
- 230000009401 metastasis Effects 0.000 description 2
- 238000012545 processing Methods 0.000 description 2
- 238000013441 quality evaluation Methods 0.000 description 2
- 238000011160 research Methods 0.000 description 2
- 210000004881 tumor cell Anatomy 0.000 description 2
- 230000000007 visual effect Effects 0.000 description 2
- 208000020358 Learning disease Diseases 0.000 description 1
- 206010060862 Prostate cancer Diseases 0.000 description 1
- 208000000236 Prostatic Neoplasms Diseases 0.000 description 1
- 101150071882 US17 gene Proteins 0.000 description 1
- 230000004931 aggregating effect Effects 0.000 description 1
- 238000013103 analytical ultracentrifugation Methods 0.000 description 1
- 230000005540 biological transmission Effects 0.000 description 1
- 210000000481 breast Anatomy 0.000 description 1
- 230000001413 cellular effect Effects 0.000 description 1
- 238000003759 clinical diagnosis Methods 0.000 description 1
- 230000001276 controlling effect Effects 0.000 description 1
- 230000001934 delay Effects 0.000 description 1
- 238000011161 development Methods 0.000 description 1
- 238000002059 diagnostic imaging Methods 0.000 description 1
- 230000003292 diminished effect Effects 0.000 description 1
- 239000000428 dust Substances 0.000 description 1
- 230000000694 effects Effects 0.000 description 1
- 210000001280 germinal center Anatomy 0.000 description 1
- 238000009499 grossing Methods 0.000 description 1
- 238000005259 measurement Methods 0.000 description 1
- 230000003287 optical effect Effects 0.000 description 1
- 239000002245 particle Substances 0.000 description 1
- 238000010827 pathological analysis Methods 0.000 description 1
- 238000003909 pattern recognition Methods 0.000 description 1
- 230000003094 perturbing effect Effects 0.000 description 1
- 201000005825 prostate adenocarcinoma Diseases 0.000 description 1
- 238000001303 quality assessment method Methods 0.000 description 1
- 238000013442 quality metrics Methods 0.000 description 1
- 238000011002 quantification Methods 0.000 description 1
- 230000001105 regulatory effect Effects 0.000 description 1
- 238000012552 review Methods 0.000 description 1
- 238000005070 sampling Methods 0.000 description 1
- 238000012216 screening Methods 0.000 description 1
- 230000035945 sensitivity Effects 0.000 description 1
- 238000004088 simulation Methods 0.000 description 1
- 230000009897 systematic effect Effects 0.000 description 1
- 238000010200 validation analysis Methods 0.000 description 1
Images
Classifications
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T7/00—Image analysis
- G06T7/0002—Inspection of images, e.g. flaw detection
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F18/00—Pattern recognition
- G06F18/20—Analysing
- G06F18/21—Design or setup of recognition systems or techniques; Extraction of features in feature space; Blind source separation
- G06F18/217—Validation; Performance evaluation; Active pattern learning techniques
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N20/00—Machine learning
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/08—Learning methods
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V20/00—Scenes; Scene-specific elements
- G06V20/60—Type of objects
- G06V20/69—Microscopic objects, e.g. biological cells or cellular parts
- G06V20/693—Acquisition
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V20/00—Scenes; Scene-specific elements
- G06V20/60—Type of objects
- G06V20/69—Microscopic objects, e.g. biological cells or cellular parts
- G06V20/698—Matching; Classification
-
- G—PHYSICS
- G16—INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR SPECIFIC APPLICATION FIELDS
- G16H—HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA
- G16H30/00—ICT specially adapted for the handling or processing of medical images
- G16H30/40—ICT specially adapted for the handling or processing of medical images for processing medical images, e.g. editing
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/10—Image acquisition modality
- G06T2207/10056—Microscopic image
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20021—Dividing image into blocks, subimages or windows
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20081—Training; Learning
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20084—Artificial neural networks [ANN]
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/30—Subject of image; Context of image processing
- G06T2207/30168—Image quality inspection
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V2201/00—Indexing scheme relating to image or video recognition or understanding
- G06V2201/03—Recognition of patterns in medical or anatomical images
Definitions
- This disclosure relates to a method for generating a prediction of a classification error generated by a machine learning classifier for a microscope slide image.
- the predicted error is weighted by the degree to which portions of the image are out-of-focus (“OOF").
- Tissue images from whole-slide scanners are typically of gigapixel size (e.g. 100,000 ⁇ 100,000 pixels at 40X magnification).
- regions of the digitized images can often be blurry and out-of-focus, rendering the respective image regions unusable for accurate diagnoses both by human pathologists as well as machine learning algorithms.
- Achieving accurate focus is particularly challenging for whole-slide scanners because (1) the depth of field is extremely thin due to the high objective power used to digitize the image, and (2) the tissue is often uneven and not in the same focus plane.
- the depth of field is reciprocal to the magnification, accordingly the depth of field is only extremely thin at high magnifications.
- the depth of field also denoted as "focus range,” especially at high magnifications, is often close to or even smaller than the thickness of the tissue to be captured.
- the tissue sample is usually not perfectly planar, but uneven, and its thickness varies often too. Therefore, slide scanners usually employ a local auto-focus method while capturing images in smaller stripes or tiles, which are then digitally stitched together to form a whole-slide image. None of the auto-focus solutions employed by the different scanner manufacturers are perfect, but rather can fail in some image regions to keep the majority of the tissue within the focus range, and thus cause out-of-focus blur of varying degrees.
- the main challenge for the auto-focus algorithm thereby is to distinguish between (a) blurriness in in-focus image regions caused by tissue with smooth appearance and (b) blurriness of any tissue pattern caused by varying degrees of out-of-focus.
- a secondary challenge is to prevent focusing on foreign particles on top of the "cover slip” (plastic or glass slide covering the tissue sample), such as dust or debris, which usually results in the tissue to be far outside the focus range.
- Literature relating to the problems of quantifying the degree of out-of-focus for tissue images and related topics includes the following: G. Campanella et al., Towards machine learned quality control: A benchmark for sharpness quantification in digital pathology. Computerized Medical Imaging and Graphics (2017) https://doi.org/10.1016/ j.compmedimag.2017.09.001 ; K. Kayser et al., How to measure image quality in tissue-based diagnosis (diagnostic surgical pathology), from 9th European Congress on Telepathology and 3rd International Congress on Virtual Microscopy, Toledo Spain Diagnostic Pathology 2008 3 (suppl. 1 ); J.
- WO 2016/030897 A1 relates to a digital microscope that captures images by performing a depth scan of a mapping field spanning a certain area of the surface of a cell sample carrier.
- a confidence score is computed for each of a plurality of focus analysis regions that are generated by dividing the mapping field into identical rectangular regions. The confidence score is indicative of the quality or sharpness of a portion; in the diagnostic field.
- the present inventors have appreciated that the degree to which a slide is out-of-focus can impact the accuracy of machine learning diagnosis or cancer cell identification, and that there is a need to quantifying the error in a machine learning disease classifier that is focus-weighted, i.e., the error is specifically attributable to the degree to which portions of the microscope slide image are out-of-focus. This disclosure addresses this need.
- a method for characterizing a classifier configured to generate a classification label for digital microscope slide image as defined in claim 1.
- the method may further include the step of repeating steps b), c) and d) at different magnifications for the slide images in the set. This results in generation of classifier error statistics for slide images at different magnifications.
- the method can further comprise the step of repeating steps a), b), c) and d) at least once for each of a plurality of different slide scanners of different manufacturers. Different slide scanners of different manufacturers may produce images of different qualities and accordingly the classifier error statistics may vary from machine to machine. In this embodiment, the classifier error statistics are obtained for each of set of different slide scanners so that the methodology of this disclosure may be generally used for a multitude of different machines from different manufacturers.
- the synthetic out-of-focus degrees which are applied to the images are obtained using a computational Bokeh filter.
- Other methods for artificially blurring the master images could be used.
- Our experimentation indicates that computational or digital Bokeh filtering is a preferred method.
- diagnoses that are based on cellular features such as detection of breast cancer metastases, usually require even higher focus quality than diagnoses that are based primarily on the larger tissue morphology, such as prostate adenocarcinoma Gleason grading.
- This document introduces a focus quality evaluation that address all of these shortcomings - it provides a generally applicable metric that is highly concordant with manually evaluated focus quality, can be applied to any WSI regardless of the scanning device, and provides spatial information of focus quality across the WSI. Moreover, we investigate the focus sensitivity of two diagnostic models for tumor detection and introduce a quality metric that takes the impact on focus quality for the particular clinical diagnosis task at hand into account to provide a relevance-weighted quality score for a slide image.
- the methodology is shown in Figure 1 at a high level.
- the method makes use a deep convolutional neural network which is trained to identify disease or tumor cells in digital microscope images ("classifier” or “disease classifier” herein).
- This deep convolutional neural network, or machine learning model is not shown in Figure 1 , but can be configured as described in PCT application entitled “Method and System for Assisting Pathologist Identification of Tumor Cells in Magnified Tissue Images", serial no. PCT/US17/019051, filed February 23, 2017 , published as WO 2018/156133 , the content of which is incorporated by reference herein.
- Deep convolutional neural network pattern recognizers are widely known in the art of pattern recognition and machine vision, and therefore a detailed description thereof is omitted for the sake of brevity.
- the Google Inception-v3 deep convolutional neural network architecture which is a suitable architecture, is described in the scientific literature. See the following references, the content of which is incorporated by reference herein: C. Szegedy et al., Going Deeper with Convolutions, arXiv:1409.4842 [cs.CV] (September 2014 ); C. Szegedy et al., Rethinking the Inception Architecture for Computer Vision, arXiv:1512.00567 [cs.CV] (December 2015 ); see also U.S. patent application of C.
- step 100 the expected disease classifier error statistics for the disease classifier neural network described in the previous paragraph are obtained for varying degrees of out-of-focus.
- An alternative method is to use partially out-of-focus scans as master images, by running the OOF classifier (described below) to determine patches that are in-focus and run the remainder of the "calibration algorithm" of Figure 2 on those image patches.
- step 100 could be considered a quasi-calibration step. Essentially we take measurements of the patch-based errors (via the AUC for binary disease classifiers, and via Cohen's Kappa for multiclass classifiers), and assume those to be similar when applying the disease model to other digitized pathology images of the same tissue and stain type, and of similar focus quality. So, one could say that in step 100 we calibrate the patch-level error metrics (AUC, Cohen's kappa, respectively), to the OOF-degree levels.
- Step 104 we use the stored error statistics (step 102) to predict a focus-weighted disease classifier error on a previously unseen, i.e., a "new" tissue image.
- Step 104 is performed at the time of use, that is, when a new tissue image is captured by a whole-slide scanner and the user wishes to understand the disease classifier error before assigning a diagnosis or label to the image or portion thereof.
- Step 104 makes use of a second convolutional neural network (“OOF Classifier”) which is trained to identify the degree to which patches in the new image are out-of-focus.
- OAF Classifier second convolutional neural network
- This convolutional neural network can be either deep (e.g., 18 convolutional layers) or shallow (e.g., 3 convolutional layers), our research has indicated that a shallow neural network with three convolutional layers performs well.
- the architecture for the OOF Classifier may also be as described previously. In one possible configuration it may be configured and trained as described in Samuel Yang et al.: "Assessing microscope image focus quality with deep learning", BMC Bioinformatics (2016) 19:77 . Step 104 is shown in greater detail in Figure 6 .
- Hyper-parameters of all models were manually tuned by qualitative assessment of predicted OOF heatmaps on a validation test set during development of the OOF classifier.
- CNNs trained on Bokeh-style or Gaussian-blurred synthetic examples yields poor prediction accuracy on real OOF images; erroneously predicting almost all OOF test patches as in-focus.
- this was caused by the artificial smoothing removing real artifacts.
- grid-like artifacts at the edges of scan lanes and JPEG blocks may be smoothed out in artificially blurred images, but would be present in real OOF images.
- several categories of other artifact types were re-added after synthetic blurring to explore their importance.
- Figure 2 is a flow chart showing the step 100 of Figure 1 in greater detail.
- the procedure shown in Figure 2 is to compute the expected classification error statistics for the classifier.
- we obtain a multitude e.g., 100 or so, possibly more, such as 1,000 or tens of thousands, and optionally at different magnification levels
- a given tissue type e.g., lymph nodes from breast cancer patients or prostate tissue.
- These images 200 are referred to as the "master images" in this document. These images could be obtained from scanners of different manufacturers.
- the ground truth labels exist for each image patch, i.e., (i) cancer/non-cancer for lymph node breast metastasis, or (ii) Gleason score for a prostate tissue.
- These gigapixel images consists of a multitude of rectangular pixel patches or tiles, the patches are shown at 210 in block 208.
- the patch annotations can be performed manually by a trained pathologist or a team of pathologists. The size of the patches can vary depending on the tissue type and the particular disease classifier that is used. In a situation where a team of pathologists are used to assign ground truth (patch annotations), ground truth is determined from multiple annotations of the same patch.
- step 202 we add a synthetic (artificial) out-of-focus blur to the images 200 with the pixel noise level fixed, both at varying degrees.
- the blur is added at different degrees or amounts of blur, indicated by parameter Y, where Y can take integer values from 0 (no blur) to N, where N can be 4, 10, or some other number such as 29.
- the synthetic noise (multiplicative Poisson noise to be precise) degree does not depend on Y, but is randomly chosen from a range, which was determined prior from measuring noise levels of (non-blurred) original images.
- loop 204 we repeat the process of creating synthetic OOF blur, and perform steps 206 and 212 for all values of Y.
- the OOF blur is preferably performed using a computational Bokeh filter, the details of which are explained in the paper of Tim McGraw, Fast Bokeh Effects Using Low-Rank Linear Filters, The Visual Computer vol. 31 no. 5 (May 2014 ), the content of which is incorporated by reference herein.
- the Summed Area Tables approach described at page 3 of the McGraw paper is a suitable approach for the instant application.
- Bokeh-blurring filtering
- steps 206 and 212 are performed.
- a label e.g., cancer/no cancer, or Gleason score
- the result of step 206 can be represented as a "heat map" showing the predicted disease probabilities for each patch in the entire slide 200. This heat map is shown at 208 with the patches 210 not shown to scale. The small circles in the tissue blob for example could be red to indicate high probability of containing cancer cells.
- step 214 we repeat the loop 204 for each of the in-focus images with ground truth 200.
- step 216 we the average the errors for each OOF degree over all cases/master images.
- step 216 we repeat this process for different scan magnifications, thereby obtaining expected disease error statistics for all of the images at different magnifications.
- the different magnifications can be obtained from upsampling or downsampling the images 200 or by obtaining physical tissue slides instead of the images 200 and scanning them at different magnifications.
- the results are then stored in a table 220 shown in Figure 4.
- Figure 4 shows the expected disease classifier error statistics for different out-of-focus degrees at different magnification levels.
- the procedure of Figure 2 can be performed many times for different types of master images 200 and disease classifiers, such as once for the lymph node master set of in-focus images and a lymph node metastasis classifier and once for a prostate tissue master set of in-focus images and a prostate Gleason scoring classifier. Additionally, the procedure of Figure 2 can be performed repeatedly to generate disease classifier error statistics for different makes and models of whole-slide scanners. For example, the procedure for Figure 2 could be performed once to generate disease classifier error statistics for a Hamamatsu whole-slide scanner and then a second time for an Aperio line scan whole-slide scanner, or other makes and models that are currently in use commercially. This is because the disease classifier error statistics may vary from scanner to scanner, as the scanners perform differently in terms of image and focus quality.
- Figure 5 shows an example of the result of Figure 2 , in terms of a plot of the disease classifier performance (AUC metric) for a particular disease classifier (in this example lymph node metastasis classification on a patch of pixels) at a given magnification power.
- the X axis indicates the degree of out-of-focus (0 being completely in focus) and examples of the images 500, 502, 504 and 506 at each degree of out-of-focus.
- AUC performance could be plotted for further OOF degrees (not shown in Figure 5 ).
- the disease classifier error statistics are obtained and stored as per the procedure of Figure 2 , they can be used at the time of use on a new (previously unseen) digital magnified tissue image in order to generate a disease classifier error prediction for all or part of the image.
- This procedure is shown at 104 in Figure 1 and in more detail in Figure 6 .
- the "new" tissue image is shown at 600.
- At step 602 we perform inference on the image 600 using the OOF classifier (deep or shallow CNN) described previously.
- the results of the inference step 206 can be represented as a heat map of the image 600 such as shown at 604, where the more out-of-focus patches in the image are colored light and the more in focus areas are given a darker color in accordance with the scale to the right of the heat map 604.
- step 606 for each patch we map the focus degree to the expected classifier error using the error statistics computed from Figure 2 (see Figure 4 ).
- This mapping can be conceptualized as a second heat map shown in Figure 7 , where the OOF degrees from heat map 604 ( Figure 6 ) are translated or mapped to classifier error as indicated at 606 in Figure 6 .
- step 608 we aggregate the predictions of the patch errors (illustrated in Figure 7 ) to the whole-slide image.
- this aggregation can take the form of a computation of a classifier error score for the whole-slide.
- This aggregation can be computed. One method is as follows:
- Another simple way of aggregating the predictions of patch errors to the whole slide would be to just count pixels above/below an error threshold without any connected component analysis and report the result as a percent of the tissue portion of the image.
- step 608 we then report a focus-weighted disease classifier error prediction for the whole-slide.
- the error prediction could be reported in a pop-up window on the display of the workstation alongside the image.
- the disease classifier error prediction could be reported in a screen used by the pathologist to enter a finding or diagnosis associated with the tissue image.
- lymph node metastasis detector which predicts probability of breast cancer metastasis in a lymph node tissue image
- classifier would normally operate at 40 ⁇ or 20 ⁇ magnification, generate a class label of cancer/non-cancer for each of the patches in the image, and use as an error metric 1.0 - AUC, where AUC is the receiver operating characteristic plot for the classifier's performance.
- AUC is the receiver operating characteristic plot for the classifier's performance.
- Such an error metric is shown in Figures 3 and 4 .
- this classifier predicts a Gleason score on each patch of pixels in a prostate tissue image and typically operates at 10 ⁇ magnification.
- the class labels assigned by the classifier on each patch is in the set ⁇ none, 1, 2, 3, 4, 5 and 6 ⁇ where 1 ... 6 are Gleason scores known in the art.
- the error metrics for such as classifier may take a different format, such as weighted Cohen's Kappa ( ⁇ ), a known statistical metric, or an average over one versus other classes AUCs.
- the expected error in the disease classifier can be represented as 1.0 minus the area under a receiver operating characteristic curve (AUC) for a binary classifier or 1.0 - Cohen's Kappa where the classifier is multiclass classifier.
- the computations shown in Figure 6 could be implemented locally in computing resources of a whole-slide scanner such that the scanner both scans the slide and then generates the disease classifier error statistics and reports them both to a connected pathology workstation.
- the scanner includes a processing unit and the deep CNN focus classifier as well as a data store storing the statistics of Figure 4 , as well as software for implementing the procedure explained in Figure 6 .
- the whole-slide scanner 802 is connected to a local area network 806 to which a pathology workstation 804 is also connected.
- This network 806 could for example take the form of a network in a hospital or medical clinic equipped with both the scanner and the pathology workstation.
- the network also has a computing resource 808, which could also take the form of a general purpose computer, which is connected to a data store or memory storing the parameters for the deep CNN focus classifier and disease classifier error statistics of Figure 4 , as well as code for implementing the procedure of Figure 6 .
- the scanner 802 scans the slide (not shown) and generates the image 600 of Figure 6
- the image is passed to the computing resource 808 which then implements the procedure of Figure 6 and forwards the disease classifier error metrics to the workstation 804.
- the reporting of the disease classifier error prediction could take the form of a heat map such as shown in Figure 7 along with the aggregated prediction of patch errors computed at step 608.
- Figure 9 is another example of a system implementing the methods of this disclosure.
- the whole-slide scanner 802 and workstation 804 are on a network 806 which is connected to the cloud 820 (internet).
- a service provider in the cloud 820 operates a computing resource 808 with connected data store 810.
- the service provider receives images (600, Figure 6 ) from the scanner 802 and by virtue of storing the OOF classifier and the disease classifier error statistics in the data store 810 and generates the disease classifier error predictions for the image and reports them back to the pathology workstation 804.
- the transmission of the image 600 ( Figure 6 ) to the service provider is accompanied by metadata for the image indicating the magnification level and make/model of the whole-slide scanner so that the proper disease classifier error statistics can be retrieved and used as appropriate for the particular image.
- the service provider performs this service for a multitude of distributed pathology laboratories, hospitals, clinics, universities, etc., one of which is indicated by the separate whole-slide scanner and pathology workstation 904 also connected to the cloud 820.
- the number of OOF degrees in the scale used in Figure 2 loop 204 can vary and it is also possible to use a floating point scale.
- step 608 could take other forms such as a) the absolute tissue area and percentage of total tissue area where predicted error above a classifier-dependent threshold, or b) total area of distinct tissue regions that are individually larger than a disease-specific size and for which the predicted errors are larger (or smaller) than a disease-specific predicted threshold, or c) min/max error statistics, or still some other format.
- the aggregation of prediction of patch errors is a mean expected error (i.e., the average across all tissue patches).
- the main use of the aggregated error metrics are to report them alongside slide-level predictions, such as the slide-level Gleason score.
- an automated system could report to clinician/pathologist a Gleason score 4+3, but with a focus-dependent predicted error of 3%.
- the predicted error then could trigger (a) an additional microscope-based manual examination by a pathologist, or (b) or it could trigger a re-scan of the slide, if the error is particularly high.
- the pathologist could use the heatmap to prioritize regions with high error predictions when doing the additional manual microscope examination.
- the method includes a step of acquiring a set of slide images ( Figure 2 , 200) (e.g., via an application programming interface (API) call to a data store storing such images, or from physically scanning a set of tissue slides with a whole slide scanner), each composed of patches of pixel image data, which are in focus and which are associated with ground truth labels for each image patch;
- API application programming interface
- steps a), b), c) and d) can be repeated at least once for each of a plurality of different slide scanners of different manufacturers.
- the error metric computed in step b) 2) takes the form of a mean error. It is also computed as a receiver operating characteristic (ROC) area under the curve (AUC) metric. This latter approach requires to first compute the ROC curve over across all patches first, followed by the computation of the area below it ("area under the curve”). As such it is a metric that is not computed per individual patch and then aggregated.
- ROC receiver operating characteristic
- AUC area under the curve
- step b) defining a set of out-of-focus degrees, and for each degree, the method consists of performing steps 1)-4):
- the tissue sample is in the form of a prostate tissue sample.
- the tissue sample can be a lymph node sample.
- the synthetic out-of-focus applied at step b) 1) is applied using a computational Bokeh filter in a preferred embodiment.
- the expected error in one embodiment can be represented by 1.0 minus the area under a receiver operating characteristic curve (AUC) for the disease classifier.
- AUC receiver operating characteristic curve
- mean error stored in step c) can be stored in a table format of degrees of out-of-focus and associated expected disease classifier errors.
Description
- This disclosure relates to a method for generating a prediction of a classification error generated by a machine learning classifier for a microscope slide image. The predicted error is weighted by the degree to which portions of the image are out-of-focus ("OOF").
- In the medical field of histopathology, microscopic images of human tissue samples (which a prepared onto glass slides) are used for rendering cancer diagnosis. In classic histopathology, a tissue sample is diagnosed visually by an expert using a microscope. By contrast, in the newer sub-field of digital pathology, a high-resolution digital image of a sample is acquired by a whole-slide scanner first, and diagnosis is done in a subsequent step at a computer screen. Alternatively, the identification of cancerous cells in a tissue image can be aided by machine learning algorithms, typically embodied as deep convolutional neural networks, which are trained to find cancer cells in magnified tissue images. Such algorithms can generate so-called "heat map" images in which areas of the slide are shown in contrasting color, e.g., red, to indicate areas which are predicted to contain cancer cells.
- Tissue images from whole-slide scanners are typically of gigapixel size (e.g. 100,000 × 100,000 pixels at 40X magnification). One of the main technical problems, however, is that regions of the digitized images can often be blurry and out-of-focus, rendering the respective image regions unusable for accurate diagnoses both by human pathologists as well as machine learning algorithms. Achieving accurate focus is particularly challenging for whole-slide scanners because (1) the depth of field is extremely thin due to the high objective power used to digitize the image, and (2) the tissue is often uneven and not in the same focus plane.
- The depth of field is reciprocal to the magnification, accordingly the depth of field is only extremely thin at high magnifications. The depth of field, also denoted as "focus range," especially at high magnifications, is often close to or even smaller than the thickness of the tissue to be captured. Moreover, the tissue sample is usually not perfectly planar, but uneven, and its thickness varies often too. Therefore, slide scanners usually employ a local auto-focus method while capturing images in smaller stripes or tiles, which are then digitally stitched together to form a whole-slide image. None of the auto-focus solutions employed by the different scanner manufacturers are perfect, but rather can fail in some image regions to keep the majority of the tissue within the focus range, and thus cause out-of-focus blur of varying degrees.
- The main challenge for the auto-focus algorithm thereby is to distinguish between (a) blurriness in in-focus image regions caused by tissue with smooth appearance and (b) blurriness of any tissue pattern caused by varying degrees of out-of-focus. A secondary challenge is to prevent focusing on foreign particles on top of the "cover slip" (plastic or glass slide covering the tissue sample), such as dust or debris, which usually results in the tissue to be far outside the focus range.
- Literature relating to the problems of quantifying the degree of out-of-focus for tissue images and related topics includes the following: G. Campanella et al., Towards machine learned quality control: A benchmark for sharpness quantification in digital pathology. Computerized Medical Imaging and Graphics (2017) https://doi.org/10.1016/ j.compmedimag.2017.09.001; K. Kayser et al., How to measure image quality in tissue-based diagnosis (diagnostic surgical pathology), from 9th European Congress on Telepathology and 3rd International Congress on Virtual Microscopy, Toledo Spain Diagnostic Pathology 2008 3 (suppl. 1); J. Liao et al., Rapid focus map surveying for whole-slide imaging with continues [sic] sample motion, arXiv:1707.03039 [cs.CV] June 2017; S. Shakeri et al., Optical quality assessment of whole-slide imaging systems for digital pathology Optics Express Vol. 23, ); X. Lopex et al., An Automated Blur Detection Method for Histological Whole-slide Imaging, PLOS one (December 13, 2013) https://doi.org/10.1371/ journal.pone.0082710; Samuel Yang et al., "Assessing microscope image focus quality with deep learning", BMC Bioinformatics (2018) 19:77, and M. Gurcan et al. Histopathological Image Analysis: A Review IEEE Rev Biomed Eng. 2009; 2: 147-171.
-
WO 2016/030897 A1 relates to a digital microscope that captures images by performing a depth scan of a mapping field spanning a certain area of the surface of a cell sample carrier. A confidence score is computed for each of a plurality of focus analysis regions that are generated by dividing the mapping field into identical rectangular regions. The confidence score is indicative of the quality or sharpness of a portion; in the diagnostic field. - The work in "A Unified Approach of Multi-scale Deep and Hand-crafted Features for Defocus Estimation" by J. Park et al. presents deep features which assess various aspects of an image for defocus estimation and also presents a method for obtaining a full defocus map of a scene.
- The present inventors have appreciated that the degree to which a slide is out-of-focus can impact the accuracy of machine learning diagnosis or cancer cell identification, and that there is a need to quantifying the error in a machine learning disease classifier that is focus-weighted, i.e., the error is specifically attributable to the degree to which portions of the microscope slide image are out-of-focus. This disclosure addresses this need.
- In one aspect of the invention, there is disclosed a method for characterizing a classifier configured to generate a classification label for digital microscope slide image as defined in
claim 1. - In another aspect of the invention, there is disclosed a method for characterizing a classifier configured to generate a classification label for digital microscope slide image as defined in claim 9.
- In one embodiment, the method may further include the step of repeating steps b), c) and d) at different magnifications for the slide images in the set. This results in generation of classifier error statistics for slide images at different magnifications. In one embodiment, the method can further comprise the step of repeating steps a), b), c) and d) at least once for each of a plurality of different slide scanners of different manufacturers. Different slide scanners of different manufacturers may produce images of different qualities and accordingly the classifier error statistics may vary from machine to machine. In this embodiment, the classifier error statistics are obtained for each of set of different slide scanners so that the methodology of this disclosure may be generally used for a multitude of different machines from different manufacturers.
- In one embodiment, the synthetic out-of-focus degrees which are applied to the images are obtained using a computational Bokeh filter. Other methods for artificially blurring the master images could be used. Our experimentation indicates that computational or digital Bokeh filtering is a preferred method.
-
-
Figure 1 is a flow chart showing a process of predicting a focus-weighted disease classifier error on a digital microscope image. -
Figure 2 is a flow chart showing a process for generating and computing expected disease classifier error statistics for use in the method ofFigure 1 . The flow chart is executed on a set of in-focus, ground truth annotated images ("master images" herein) obtained from a particular whole-slide scanner of a particular manufacturer. The images consist of a multitude of patches of pixel image data. The process may be repeated several times in order to generate expected disease classifier error statistics for different whole-slide scanners of different manufacturers or different makes and models, as the expected disease classifier error statistics may vary between different makes and models of slide scanners. -
Figure 3 is an illustration of a computed mean disease classifier error, per patch, for different degrees of out-of-focus, for two of the master images. -
Figure 4 is an illustration of data representing the expected disease classifier error statistics for different out-of-focus degrees averaged over all of the reference images. The data shown inFigure 4 is stored in memory and used to calculate the focus-weighted disease classifier error for a new slide as per the procedure ofFigures 1 and6 . -
Figure 5 is an illustration of the disease classifier error for degrees of out-of-focus for all the master images. -
Figure 6 is a more detailed illustration of a procedure for predicting a focus-weighted disease classifier error for a new slide as perFigure 1 , using the stored error statistics ofFigure 4 and generated in accordance withFigure 2 . -
Figure 7 is an illustration of the expected disease classifier error per image patch calculated in accordance withFigure 6 . -
Figure 8 is an illustration of one application of the method ofFigure 1 to a computing environment featuring a whole-slide scanner and a networked pathology workstation. -
Figure 9 is an illustration of a second application of the method ofFigure 1 to a computing environment featuring a whole-slide scanner and a networked pathology workstation, in which the generation of the focus-weighted disease classifier error occurs in computing systems in a remote network, and the results are transmitted to the pathology workstation. - Digital pathology is advancing into clinical workflows, largely motivated by the potential of powerful image analysis tools using new machine learning techniques and enabled by the recent regulatory approval of the first Whole-Slide Image (WSI) scanner for primary diagnosis in the U.S., as well as wider availability of cloud storage and large IT infrastructure to handle gigapixel image files. However, the process of digitization adds sources for artifacts to the imaging process, including color or contrast problems and out-of-focus areas. These artifacts, and in particular out-of-focus areas, can negatively impact the suitability of the digital slide image for rendering an accurate diagnosis by a pathologist, or the accuracy of automated image analysis. A human pathologist will usually flag such an image as low quality and order a rescan, which causes potentially long delays with the case. Even worse, in automated image analysis, such image artifacts can directly translate into detection and classification errors. For instance, some studies found that systematic false positives can be traced back to bad focus quality, such as out-of-focus germinal centers being mistaken as tumor metastases by algorithms.
- One option to mitigate these problems is to have a technician prescreen all digital slides that are produced by the scanner. This type of manual quality control, however, is impractical from a time and cost perspective, and even infeasible for exhaustive screening of small artifacts. The other option is to do automated quality control and evaluation of focus quality, which does not have any of the above limitations. While every WSI scanner has built-in focus evaluation that can be used for automatic rescans of the affected regions or for quality reporting, there are several shortcomings in the existing methods: (1) despite this built-in focus evaluation, many slides scanned by a WSI scanner still have out-of-focus regions, (2) the focus evaluation methods across scanners are different, prohibiting comparison across devices, (3) the focus metrics can usually not be exported to the user in sufficient detail, such as a spatial distribution of focus quality, and (4) the evaluation does not take the clinical relevance of the focus quality into account. For instance, diagnoses that are based on cellular features, such as detection of breast cancer metastases, usually require even higher focus quality than diagnoses that are based primarily on the larger tissue morphology, such as prostate adenocarcinoma Gleason grading.
- This document introduces a focus quality evaluation that address all of these shortcomings - it provides a generally applicable metric that is highly concordant with manually evaluated focus quality, can be applied to any WSI regardless of the scanning device, and provides spatial information of focus quality across the WSI. Moreover, we investigate the focus sensitivity of two diagnostic models for tumor detection and introduce a quality metric that takes the impact on focus quality for the particular clinical diagnosis task at hand into account to provide a relevance-weighted quality score for a slide image.
- The methodology is shown in
Figure 1 at a high level. The method makes use a deep convolutional neural network which is trained to identify disease or tumor cells in digital microscope images ("classifier" or "disease classifier" herein). This deep convolutional neural network, or machine learning model, is not shown inFigure 1 , but can be configured as described in PCT application entitled "Method and System for Assisting Pathologist Identification of Tumor Cells in Magnified Tissue Images", serial no.PCT/US17/019051, filed February 23, 2017 WO 2018/156133 , the content of which is incorporated by reference herein. Deep convolutional neural network pattern recognizers are widely known in the art of pattern recognition and machine vision, and therefore a detailed description thereof is omitted for the sake of brevity. The Google Inception-v3 deep convolutional neural network architecture, which is a suitable architecture, is described in the scientific literature. See the following references, the content of which is incorporated by reference herein: C. Szegedy et al., Going Deeper with Convolutions, arXiv:1409.4842 [cs.CV] (September 2014); C. Szegedy et al., Rethinking the Inception Architecture for Computer Vision, arXiv:1512.00567 [cs.CV] (December 2015); see alsoU.S. patent application of C. Szegedy et al., "Processing Images Using Deep Neural Networks", serial no. 14/839,452 filed August 28, 2015 U.S. patent application of C. Vanhoucke, "Image Classification Neural Networks", serial no. 15/395,530 filed December 30, 2016 - Essentially, in the method of
Figure 1 , instep 100 the expected disease classifier error statistics for the disease classifier neural network described in the previous paragraph are obtained for varying degrees of out-of-focus. The manner of obtaining these statistics from a large set of master images in the form of in-focus, ground truth annotated images, and artificially blurred to the different degrees of out-of-focus, is shown inFigure 2 and will be described in detail below. An alternative method is to use partially out-of-focus scans as master images, by running the OOF classifier (described below) to determine patches that are in-focus and run the remainder of the "calibration algorithm" ofFigure 2 on those image patches. Once these statistics are obtained, by either method, they are stored, as indicated at 102, and then used later as indicated atstep 104. In some sense,step 100 could be considered a quasi-calibration step. Essentially we take measurements of the patch-based errors (via the AUC for binary disease classifiers, and via Cohen's Kappa for multiclass classifiers), and assume those to be similar when applying the disease model to other digitized pathology images of the same tissue and stain type, and of similar focus quality. So, one could say that instep 100 we calibrate the patch-level error metrics (AUC, Cohen's kappa, respectively), to the OOF-degree levels. - At
step 104 we use the stored error statistics (step 102) to predict a focus-weighted disease classifier error on a previously unseen, i.e., a "new" tissue image. Step 104 is performed at the time of use, that is, when a new tissue image is captured by a whole-slide scanner and the user wishes to understand the disease classifier error before assigning a diagnosis or label to the image or portion thereof. Step 104 makes use of a second convolutional neural network ("OOF Classifier") which is trained to identify the degree to which patches in the new image are out-of-focus. This convolutional neural network can be either deep (e.g., 18 convolutional layers) or shallow (e.g., 3 convolutional layers), our research has indicated that a shallow neural network with three convolutional layers performs well. The architecture for the OOF Classifier may also be as described previously. In one possible configuration it may be configured and trained as described in Samuel Yang et al.: "Assessing microscope image focus quality with deep learning", BMC Bioinformatics (2018) 19:77. Step 104 is shown in greater detail inFigure 6 . One significant difference between our approach (similar to Yang et al.) and those of Campanella et al. cited previously in the Background is that the latter do not apply synthetic noise after the synthetic blurring (in order to simulate the original image sensor pixel noise which is removed almost completely by the synthetic blurring.). In our experiments we found the synthetic noise to be important to train a proper OOF classifier from synthetic training data. Without it, we found our classifier to fail to detect especially strong real OOF, where the noise is quite visible. - Our research has shown that additional data augmentation steps are preferably performed in training the OOF Classifier mentioned in the previous paragraph. These steps include simulating (a) data compression and noise artifacts, (b) translational jitter, and (c) brightness perturbations. It is possible and advantageous to combine all of these in training in addition to or as an alternative to computational Bokeh filtering (described below). These will now be described in further detail.
- Hyper-parameters of all models were manually tuned by qualitative assessment of predicted OOF heatmaps on a validation test set during development of the OOF classifier. In those experiments, CNNs trained on Bokeh-style or Gaussian-blurred synthetic examples yields poor prediction accuracy on real OOF images; erroneously predicting almost all OOF test patches as in-focus. We hypothesized that this was caused by the artificial smoothing removing real artifacts. For example, grid-like artifacts at the edges of scan lanes and JPEG blocks may be smoothed out in artificially blurred images, but would be present in real OOF images. Thus, several categories of other artifact types were re-added after synthetic blurring to explore their importance.
- Visual comparison at high magnification of synthetically blurred real in-focus images to real OOF revealed other artifacts beyond OOF: pixel noise, which most likely originates from the image sensor; and JPEG compression artifacts, which are likely to stem from the lossy JPEG compression applied by the scanners post digitization. We found the latter to have been applied all our training and test images with compression levels ranging from 40 to 90%. Most scanner models employ post digitization. In synthetically blurred images, however, both of these other artifacts are either faint or mostly absent, depending on synthetic blurring magnitude, even if they were present in the real in-focus input images. This is because both pixel noise and JPEG artifacts typically consist of high spatial frequencies, which are diminished by blurring.
- Consequently, simulated JPEG compression artifacts were added back into the synthetically blurred images, implemented via JPEG encoding and decoding and an image quality parameter chosen between 40 and 90%, which are the typical compression settings used by scanners from which our images were obtained.
- As for simulating pixel noise, it is well known that image sensors produce Poisson-distributed noise at digitization. Therefore, pixel-wise Poisson noise was simulated by mapping each color channel value xc ∈ [0, 1], c ∈ {R,G, B} to a noisy version xc' via x c = P xc * s with P referring to the Poisson distribution and s inversely controlling the signal-to-noise ratio. As the latter was observed to vary significantly between different scanners and objective magnifications, the noise portion during training was varied by randomly sampling s from the interval [0.01, 64.0] for each training patch, which additionally showed better experimental results compared to using a fixed signal-to-noise ratio. Although both data augmentations, JPEG artifacts and Poisson noise, yielded a significant reduction in false in-focus positives, overall accuracy could still be improved, hence simulations (b) and (c) were explored.
- Further visible prediction gains were observed by adding translational perturbations of in the range +/-8 pixels (both horizontally and vertically) to each 139×139 training patch. This was implemented by initially acquiring a 155×155 image patch, followed by cropping a randomly translationally placed 139×139 region within it.
- A large jump in overall accuracy of the OOF classifier was finally gained by implementing another, more generic, data augmentation in perturbing the brightness of training patches. In this step a random negative/positive intensity offset to all pixels in a training patch (i.e. fixed poslneg delta value to all three RGB color channels) is added. More particularly, RGB values ranged in [0, 1] were offset using an intensity shift randomly chosen from the interval [- 0.8,+ 0.8] (followed by a clipping to [0, 1]) for each training example. A similar approach was proposed in Liu et al, Detecting Cancer Metastases on Gigapixel Pathology Images, arXiv [cs.CV] (2017), available at http://arxiv.org/abs/1703.02442, supporting the hypothesis that OOF images can vary significantly in brightness, and hence a classifier ought to be relatively invariant to brightness variations.
- In addition, random perturbations of the training patches' contrast, color hue and color saturation were added, but only contrast perturbations delivered small performance gains.
-
Figure 2 is a flow chart showing thestep 100 ofFigure 1 in greater detail. The procedure shown inFigure 2 is to compute the expected classification error statistics for the classifier. As indicated at 200, we obtain a multitude (e.g., 100 or so, possibly more, such as 1,000 or tens of thousands, and optionally at different magnification levels) of completely in-focus, ground truth annotated digital microscope slide images of a given tissue type, e.g., lymph nodes from breast cancer patients or prostate tissue. Theseimages 200 are referred to as the "master images" in this document. These images could be obtained from scanners of different manufacturers. The ground truth labels exist for each image patch, i.e., (i) cancer/non-cancer for lymph node breast metastasis, or (ii) Gleason score for a prostate tissue. These gigapixel images consists of a multitude of rectangular pixel patches or tiles, the patches are shown at 210 inblock 208. The patch annotations can be performed manually by a trained pathologist or a team of pathologists. The size of the patches can vary depending on the tissue type and the particular disease classifier that is used. In a situation where a team of pathologists are used to assign ground truth (patch annotations), ground truth is determined from multiple annotations of the same patch. The following methods can be used if there is not unanimity: (a) majority vote, (b) force pathologists/annotators to adjudicate each patch where disagreeing votes are higher than a threshold or greater than zero; (c) apply (a) and for patches where there's no majority vote (e.g. for multi-class labels like Gleason) then do (b). - At
step 202, we add a synthetic (artificial) out-of-focus blur to theimages 200 with the pixel noise level fixed, both at varying degrees. The blur is added at different degrees or amounts of blur, indicated by parameter Y, where Y can take integer values from 0 (no blur) to N, where N can be 4, 10, or some other number such as 29. By contrast, the synthetic noise (multiplicative Poisson noise to be precise) degree does not depend on Y, but is randomly chosen from a range, which was determined prior from measuring noise levels of (non-blurred) original images. As indicated byloop 204 we repeat the process of creating synthetic OOF blur, and performsteps page 3 of the McGraw paper is a suitable approach for the instant application. We found that models trained using Gaussian-blurred examples overestimated weak OOF regions and underestimated strong OOF regions. Therefore, we next experimented with Bokeh-blurring (filtering), which is a physically more accurate representation of the underlying optics. Bokeh blurring was implemented by convolving the image with a circular step-function kernel. - Then, for each degree of out-of-focus (Y= 0 ... N), steps 206 and 212 are performed. At
step 206, we perform inference using the Disease Classifier and assign a label (e.g., cancer/no cancer, or Gleason score) to each of the patches in one of the images at that degree of OOF. The result ofstep 206 can be represented as a "heat map" showing the predicted disease probabilities for each patch in theentire slide 200. This heat map is shown at 208 with thepatches 210 not shown to scale. The small circles in the tissue blob for example could be red to indicate high probability of containing cancer cells. - At
step 212, we first use the predictions generated atstep 206 and the ground truth annotations for each patch to compute the disease classifier error for each patch. Then, we aggregate these results to compute a mean error = 1 - AUC over all patch predictions for this specific out of focus degree Y. We then store this result as the expected error for this synthetic blur level and this particular disease classifier. Note: the 1 - AUC error metric applies for 2-class disease classifiers. For multi-class classifiers other metrics apply. Such metrics are described in further detail below. - As indicated by
step 214 we repeat theloop 204 for each of the in-focus images withground truth 200. - By repeating
steps Figure 3 . For each OOF degree (0, 1, 2 . . . ) we have the mean error computed instep 212 for each of the master images 200 (identified ascase 1,case 2, . . . ). - Then at
step 216 we the average the errors for each OOF degree over all cases/master images. As indicated atloop 218, we repeat this process for different scan magnifications, thereby obtaining expected disease error statistics for all of the images at different magnifications. The different magnifications can be obtained from upsampling or downsampling theimages 200 or by obtaining physical tissue slides instead of theimages 200 and scanning them at different magnifications. The results are then stored in a table 220 shown inFigure 4. Figure 4 shows the expected disease classifier error statistics for different out-of-focus degrees at different magnification levels. - It will be appreciated that the procedure of
Figure 2 can be performed many times for different types ofmaster images 200 and disease classifiers, such as once for the lymph node master set of in-focus images and a lymph node metastasis classifier and once for a prostate tissue master set of in-focus images and a prostate Gleason scoring classifier. Additionally, the procedure ofFigure 2 can be performed repeatedly to generate disease classifier error statistics for different makes and models of whole-slide scanners. For example, the procedure forFigure 2 could be performed once to generate disease classifier error statistics for a Hamamatsu whole-slide scanner and then a second time for an Aperio line scan whole-slide scanner, or other makes and models that are currently in use commercially. This is because the disease classifier error statistics may vary from scanner to scanner, as the scanners perform differently in terms of image and focus quality. -
Figure 5 shows an example of the result ofFigure 2 , in terms of a plot of the disease classifier performance (AUC metric) for a particular disease classifier (in this example lymph node metastasis classification on a patch of pixels) at a given magnification power. The X axis indicates the degree of out-of-focus (0 being completely in focus) and examples of theimages Figure 5 , only OOF degrees up to "3" are shown but AUC performance could be plotted for further OOF degrees (not shown inFigure 5 ). It will be seen fromFigure 5 , as expected, that the disease classifier has the highest classification accuracy for OOF degree 0 (completely in focus) and the classification accuracy drops significantly forOOF degrees OOF degree 3. It will also be appreciated fromFigure 4 that while the disease error statistics indicate the disease classifier has higher performance at 40X as compared to 20X and 10X magnification, this may not necessarily be the case for all types of disease classifiers, and it may be that for some disease classifiers the classifier performance is actually higher at lower magnification (10X) than it is at higher magnifications, for example when larger scale structures and tissue morphology are significant in generating disease classifications which are most readily apprehended at lower power. - Once the disease classifier error statistics are obtained and stored as per the procedure of
Figure 2 , they can be used at the time of use on a new (previously unseen) digital magnified tissue image in order to generate a disease classifier error prediction for all or part of the image. This procedure is shown at 104 inFigure 1 and in more detail inFigure 6 . The "new" tissue image is shown at 600. Atstep 602 we perform inference on theimage 600 using the OOF classifier (deep or shallow CNN) described previously. This classifier is trained from synthetically blurred training images, as explained above, to generate a prediction of the degree to which each of the patches in theimage 600 is out-of-focus, using the out-of-focus degree scale which was used inFigure 2 , in this example Y = 0 ... 29 where 0 is completely in focus and 29 is completely out-of-focus. The results of theinference step 206 can be represented as a heat map of theimage 600 such as shown at 604, where the more out-of-focus patches in the image are colored light and the more in focus areas are given a darker color in accordance with the scale to the right of theheat map 604. - Then, in
step 606, for each patch we map the focus degree to the expected classifier error using the error statistics computed fromFigure 2 (seeFigure 4 ). This mapping can be conceptualized as a second heat map shown inFigure 7 , where the OOF degrees from heat map 604 (Figure 6 ) are translated or mapped to classifier error as indicated at 606 inFigure 6 . Note that the patches of theheat map 604 inFigure 6 which are the most out-of-focus have the highest expected classifier error (the higher degrees of classifier error are also light color inFigure 7 whereas the areas with the least classifier error are shown darker inFigure 7 .) Accordingly, this mapping is simply assigning a classifier error to a patch based on the patch's OOF degree using the stored error statistics and repeating this algorithm for all patches. - Then at
step 608 we aggregate the predictions of the patch errors (illustrated inFigure 7 ) to the whole-slide image. In one embodiment this aggregation can take the form of a computation of a classifier error score for the whole-slide. There are several possible methods by which this aggregation can be computed. One method is as follows: - a. Apply a disease/tissue type-specific threshold to the predicted classifier error prediction for each patch, e.g. 1.3%, essentially creating a binary mask of those patches with the predicted error above or below the threshold.
- b. Apply Connected Component Analysis to the binary mask of a.
- c. Drop every "connected components" region with an area smaller than a disease/tissue type-specific minimum area A, e.g. 200 sq. microns.
- d. Sum up areas of remaining regions to gain the final metric, in this example an area metric indicating how much of the slide has the disease classifier error below the threshold and excluding the areas that are too small as per c. This metric could be presented as an absolute area metric, or as a percent metric, e.g., percent of the tissue area in the image which has the disease classifier metric below the threshold.
- Another simple way of aggregating the predictions of patch errors to the whole slide would be to just count pixels above/below an error threshold without any connected component analysis and report the result as a percent of the tissue portion of the image.
- At
step 608, we then report a focus-weighted disease classifier error prediction for the whole-slide. For example, on a computer workstation used by a pathologist which is reviewing theimage 600 ofFigure 6 , the error prediction could be reported in a pop-up window on the display of the workstation alongside the image. Alternatively, the disease classifier error prediction could be reported in a screen used by the pathologist to enter a finding or diagnosis associated with the tissue image. - The above example has been in the context of a lymph node metastasis detector which predicts probability of breast cancer metastasis in a lymph node tissue image, and such as classifier would normally operate at 40× or 20× magnification, generate a class label of cancer/non-cancer for each of the patches in the image, and use as an error metric 1.0 - AUC, where AUC is the receiver operating characteristic plot for the classifier's performance. Such an error metric is shown in
Figures 3 and 4 . For a prostate cancer classifier, this classifier predicts a Gleason score on each patch of pixels in a prostate tissue image and typically operates at 10× magnification. The class labels assigned by the classifier on each patch is in the set {none, 1, 2, 3, 4, 5 and 6} where 1 ... 6 are Gleason scores known in the art. The error metrics for such as classifier may take a different format, such as weighted Cohen's Kappa (κ), a known statistical metric, or an average over one versus other classes AUCs. The expected error in the disease classifier can be represented as 1.0 minus the area under a receiver operating characteristic curve (AUC) for a binary classifier or 1.0 - Cohen's Kappa where the classifier is multiclass classifier. - The computations shown in
Figure 6 could be implemented locally in computing resources of a whole-slide scanner such that the scanner both scans the slide and then generates the disease classifier error statistics and reports them both to a connected pathology workstation. In this embodiment, the scanner includes a processing unit and the deep CNN focus classifier as well as a data store storing the statistics ofFigure 4 , as well as software for implementing the procedure explained inFigure 6 . - Several other alternative configurations are possible, one of which is shown in
Figure 8 . In this implementation, the whole-slide scanner 802 is connected to alocal area network 806 to which apathology workstation 804 is also connected. Thisnetwork 806 could for example take the form of a network in a hospital or medical clinic equipped with both the scanner and the pathology workstation. The network also has acomputing resource 808, which could also take the form of a general purpose computer, which is connected to a data store or memory storing the parameters for the deep CNN focus classifier and disease classifier error statistics ofFigure 4 , as well as code for implementing the procedure ofFigure 6 . In use, when thescanner 802 scans the slide (not shown) and generates theimage 600 ofFigure 6 , the image is passed to thecomputing resource 808 which then implements the procedure ofFigure 6 and forwards the disease classifier error metrics to theworkstation 804. The reporting of the disease classifier error prediction (step 610 ofFigure 6 ) could take the form of a heat map such as shown inFigure 7 along with the aggregated prediction of patch errors computed atstep 608. -
Figure 9 is another example of a system implementing the methods of this disclosure. In this example, the whole-slide scanner 802 andworkstation 804 are on anetwork 806 which is connected to the cloud 820 (internet). A service provider in thecloud 820 operates acomputing resource 808 withconnected data store 810. The service provider receives images (600,Figure 6 ) from thescanner 802 and by virtue of storing the OOF classifier and the disease classifier error statistics in thedata store 810 and generates the disease classifier error predictions for the image and reports them back to thepathology workstation 804. The transmission of the image 600 (Figure 6 ) to the service provider is accompanied by metadata for the image indicating the magnification level and make/model of the whole-slide scanner so that the proper disease classifier error statistics can be retrieved and used as appropriate for the particular image. The service provider performs this service for a multitude of distributed pathology laboratories, hospitals, clinics, universities, etc., one of which is indicated by the separate whole-slide scanner andpathology workstation 904 also connected to thecloud 820. - The number of OOF degrees in the scale used in
Figure 2 loop 204 can vary and it is also possible to use a floating point scale. - The aggregation of prediction of patch errors for the new image in
Figure 6 , step 608 could take other forms such as a) the absolute tissue area and percentage of total tissue area where predicted error above a classifier-dependent threshold, or b) total area of distinct tissue regions that are individually larger than a disease-specific size and for which the predicted errors are larger (or smaller) than a disease-specific predicted threshold, or c) min/max error statistics, or still some other format. According to the invention, the aggregation of prediction of patch errors is a mean expected error (i.e., the average across all tissue patches). - The main use of the aggregated error metrics are to report them alongside slide-level predictions, such as the slide-level Gleason score. E.g. an automated system could report to clinician/pathologist a
Gleason score 4+3, but with a focus-dependent predicted error of 3%. The predicted error then could trigger (a) an additional microscope-based manual examination by a pathologist, or (b) or it could trigger a re-scan of the slide, if the error is particularly high. Moreover, in scenario (a) the pathologist could use the heatmap to prioritize regions with high error predictions when doing the additional manual microscope examination. - It will be appreciated that we have described a computer-implemented method for characterizing a classifier configured to generate a classification label for digital microscope slide image. The method includes a step of acquiring a set of slide images (
Figure 2 , 200) (e.g., via an application programming interface (API) call to a data store storing such images, or from physically scanning a set of tissue slides with a whole slide scanner), each composed of patches of pixel image data, which are in focus and which are associated with ground truth labels for each image patch; - b) defining a set of out-of-focus degrees (e.g., degrees of-of-focus Y on a scale of 0 (in focus to N where N is some integer in a
range - 1) applying a corresponding amount of synthetic out-of-focus to each of the patches of an image in the set of slide images; (
Figure 2 , 202) - 2) computing a classification error for each patch in the image; (
Figure 2 , 206) - 3) computing a mean error across all of the patches in the image; (
Fig. 2 , 212)
- 1) applying a corresponding amount of synthetic out-of-focus to each of the patches of an image in the set of slide images; (
- c) storing the mean error computed in step b) 3) for all of the degrees defined in step b) as an expected error for the classifier for the out-of-focus degrees defined in step b); (
Figure 2 ,loop 204 for all synthetic out of focus degrees) - d) repeating steps b1), b2), b3), and c) for each of the slide images in the set. (loop
Figure 2 , loop 214) - In the above method, steps a), b), c) and d) can be repeated at least once for each of a plurality of different slide scanners of different manufacturers.
- The error metric computed in step b) 2) takes the form of a mean error. It is also computed as a receiver operating characteristic (ROC) area under the curve (AUC) metric. This latter approach requires to first compute the ROC curve over across all patches first, followed by the computation of the area below it ("area under the curve"). As such it is a metric that is not computed per individual patch and then aggregated.
- Thus in one variation forming part of the invention, in the above method step b), defining a set of out-of-focus degrees, and for each degree, the method consists of performing steps 1)-4):
- 1) applying a corresponding amount of synthetic out-of-focus to each of the patches of an image in the set of slide images;
- 2) computing a classification error prediction and probability.
- 3) computing a Receiver Operating Characteristic (ROC) curve against ground truth labels across all patches, and
- 4) computing an area under the ROC curve (AUC). In this variation the method continues with step c) storing the AUC computed in step b) 4) for all of the degrees defined in step b) as an expected error for the classifier for the out-of-focus degrees defined in step b); and d) repeating steps b1), b2), b3), b4) and c) for each of the slide images in the set.
- In one embodiment the tissue sample is in the form of a prostate tissue sample. Alternatively, the tissue sample can be a lymph node sample. The synthetic out-of-focus applied at step b) 1) is applied using a computational Bokeh filter in a preferred embodiment. The expected error in one embodiment can be represented by 1.0 minus the area under a receiver operating characteristic curve (AUC) for the disease classifier. As shown in
Figure 3 and inFigure 4 mean error stored in step c) can be stored in a table format of degrees of out-of-focus and associated expected disease classifier errors. - While the above description has been provided in the context of pathology microscope images (tissue samples) the methodology is generally applicable to other types of microscope images and classifiers built to identify or classify objects within microscope images.
Claims (9)
- A computer-implemented method for characterizing a classifier configured to generate a classification label for digital microscope slide image, comprising the steps of:a) acquiring a set of slide images, each composed of patches of pixel image data, which are in focus and which are associated with ground truth labels for each image patch;b) defining a set of out-of-focus degrees, and for each degree:1) applying a corresponding amount of synthetic out-of-focus to each of the patches of an image in the set of slide images;2) computing a classification error for each patch in the image;3) computing a mean error across all of the patches in the image;c) storing the mean error computed in step b) 3) for all of the degrees defined in step b) as an expected error for the classifier for the out-of-focus degrees defined in step b);d) repeating steps b1), b2), b3), and c) for each of the slide images in the set.
- The method of claim 1, further comprising the step of repeating steps b), c) and d) at different magnifications for the digital microscope slide images in the set.
- The method of claim 1, further comprising the step of repeating steps a), b), c) and d) at least once for each of a plurality of different slide scanners of different manufacturers.
- The method of claim 1, wherein the digital microscope slide image is an image of a tissue sample.
- The method of claim 4, wherein the tissue sample comprises a lymph node sample or a prostate tissue sample.
- The method of any of claims 1-5, wherein the synthetic out-of-focus applied at step b) 1) is applied using a computational Bokeh filter.
- The method of any of claims 1-5, wherein the expected error is presented by 1.0 minus an area under a receiver operating characteristic curve, AUC, for the classifier, or 1.0 - Cohen's Kappa if the classifier is a multiclass classifier.
- The method of any of claims 1-5 wherein the mean error stored in step c) is stored in a table format of degrees of out-of-focus and associated expected classifier errors.
- A computer-implemented method for characterizing a classifier configured to generate a classification label for digital microscope slide image, olido, comprising the steps of:a) acquiring a set of slide images, each composed of patches of pixel image data, which are in focus and which are associated with ground truth labels for each image patch;b) defining a set of out-of-focus degrees, and for each degree:1) applying a corresponding amount of synthetic out-of-focus to each of the patches of an image in the set of slide images;2) computing a classification error prediction and probability;3) computing a Receiver Operating Characteristic, ROC, curve against ground truth labels across all patches, and4) computing an area under the ROC curve, AUC.c) storing the AUC computed in step b) 4) for all of the degrees defined in step b) as an expected error for the classifier for the out-of-focus degrees defined in step b);d) repeating steps b1), b2), b3), b4) and c) for each of the slide images in the set.
Applications Claiming Priority (2)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US15/972,929 US10706328B2 (en) | 2018-05-07 | 2018-05-07 | Focus-weighted, machine learning disease classifier error prediction for microscope slide images |
PCT/US2018/065918 WO2019216955A1 (en) | 2018-05-07 | 2018-12-17 | Focus-weighted, machine learning classifier error prediction for microscope slide images |
Publications (2)
Publication Number | Publication Date |
---|---|
EP3788591A1 EP3788591A1 (en) | 2021-03-10 |
EP3788591B1 true EP3788591B1 (en) | 2023-10-18 |
Family
ID=65024006
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
EP18834117.6A Active EP3788591B1 (en) | 2018-05-07 | 2018-12-17 | Focus-weighted, machine learning classifier error prediction for microscope slide images |
Country Status (5)
Country | Link |
---|---|
US (3) | US10706328B2 (en) |
EP (1) | EP3788591B1 (en) |
JP (3) | JP6900581B1 (en) |
CN (1) | CN112106107A (en) |
WO (1) | WO2019216955A1 (en) |
Families Citing this family (15)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US10573003B2 (en) * | 2017-02-13 | 2020-02-25 | Amit Sethi | Systems and methods for computational pathology using points-of-interest |
US20220117544A1 (en) * | 2018-08-31 | 2022-04-21 | Seno Medical Instruments, Inc. | Optoacoustic feature score correlation to ipsilateral axillary lymph node status |
KR102498686B1 (en) | 2020-01-06 | 2023-02-09 | 페이지.에이아이, 인크. | Systems and methods for analyzing electronic images for quality control |
CN111369553A (en) * | 2020-03-13 | 2020-07-03 | 上海杏脉信息科技有限公司 | Sample slide scanning and image processing method and digital microscope system |
US20230085827A1 (en) * | 2020-03-20 | 2023-03-23 | The Regents Of The University Of California | Single-shot autofocusing of microscopy images using deep learning |
CN111462075B (en) * | 2020-03-31 | 2023-12-15 | 湖南国科智瞳科技有限公司 | Rapid refocusing method and system for full-slice digital pathological image fuzzy region |
CN111462076B (en) * | 2020-03-31 | 2023-05-16 | 湖南国科智瞳科技有限公司 | Full-slice digital pathological image fuzzy region detection method and system |
US20220139514A1 (en) | 2020-11-03 | 2022-05-05 | Nuance Communications, Inc. | Communication System and Method |
WO2022099309A1 (en) * | 2020-11-06 | 2022-05-12 | Verily Life Sciences Llc | Artificial intelligence prediction of prostate cancer outcomes |
US20220199212A1 (en) * | 2020-12-22 | 2022-06-23 | Nuance Communications, Inc. | AI Platform System and Method |
CN113139568B (en) * | 2021-02-22 | 2022-05-10 | 杭州深睿博联科技有限公司 | Class prediction model modeling method and device based on active learning |
US11893668B2 (en) | 2021-03-31 | 2024-02-06 | Leica Camera Ag | Imaging system and method for generating a final digital image via applying a profile to image information |
US11514654B1 (en) * | 2021-12-09 | 2022-11-29 | Unity Technologies Sf | Calibrating focus/defocus operations of a virtual display based on camera settings |
JP2023176256A (en) * | 2022-05-31 | 2023-12-13 | 楽天グループ株式会社 | Method, computer system, and computer-readable medium for predicting data from image |
CN117041531B (en) * | 2023-09-04 | 2024-03-15 | 无锡维凯科技有限公司 | Mobile phone camera focusing detection method and system based on image quality evaluation |
Family Cites Families (19)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
AU3490695A (en) * | 1994-09-20 | 1996-04-09 | Neopath, Inc. | Cytological slide scoring apparatus |
US7456377B2 (en) | 2004-08-31 | 2008-11-25 | Carl Zeiss Microimaging Ais, Inc. | System and method for creating magnified images of a microscope slide |
SG187479A1 (en) | 2009-10-19 | 2013-02-28 | Ventana Med Syst Inc | Imaging system and techniques |
US20120269418A1 (en) | 2011-04-22 | 2012-10-25 | Ge Global Research | Analyzing the expression of biomarkers in cells with clusters |
CN104704499B (en) * | 2012-06-21 | 2018-12-11 | 菲利普莫里斯生产公司 | System and method relevant to network-based biomarker signature |
DE102013104277A1 (en) | 2013-04-26 | 2014-10-30 | Hella Kgaa Hueck & Co. | Method for controlling a matrix beam headlamp with adaptive light functions |
EP3186778B1 (en) * | 2014-08-27 | 2023-01-11 | S.D. Sight Diagnostics Ltd. | System and method for calculating focus variation for a digital microscope |
US9665460B2 (en) * | 2015-05-26 | 2017-05-30 | Microsoft Technology Licensing, Llc | Detection of abnormal resource usage in a data center |
US9836839B2 (en) | 2015-05-28 | 2017-12-05 | Tokitae Llc | Image analysis systems and related methods |
US10049770B2 (en) * | 2015-12-30 | 2018-08-14 | Case Western Reserve University | Prediction of recurrence of non-small cell lung cancer |
CN107506314B (en) | 2016-06-14 | 2021-05-28 | 伊姆西Ip控股有限责任公司 | Method and apparatus for managing storage system |
US10025902B2 (en) | 2016-08-12 | 2018-07-17 | Verily Life Sciences Llc | Enhanced pathology diagnosis |
EP3570753A4 (en) | 2017-02-23 | 2020-10-21 | Google LLC | Method and system for assisting pathologist identification of tumor cells in magnified tissue images |
US10311573B2 (en) * | 2017-05-02 | 2019-06-04 | Techcyte, Inc. | Training and machine learning classification of mold in digital microscopy images |
US10255693B2 (en) * | 2017-05-02 | 2019-04-09 | Techcyte, Inc. | Machine learning classification and training for digital microscopy images |
US10552663B2 (en) * | 2017-05-02 | 2020-02-04 | Techcyte, Inc. | Machine learning classification and training for digital microscopy cytology images |
EP3669227B8 (en) | 2017-08-15 | 2024-02-28 | Siemens Healthineers AG | Identifying the quality of the cell images acquired with digital holographic microscopy using convolutional neural networks |
CN111226257B (en) * | 2017-09-22 | 2024-03-01 | 豪夫迈·罗氏有限公司 | Artifact removal in tissue images |
US20210192721A1 (en) * | 2017-10-26 | 2021-06-24 | Konica Minolta, Inc. | Image Processing Device, In-Focus Position Specifying Method, and In-Focus Position Specifying Program |
-
2018
- 2018-05-07 US US15/972,929 patent/US10706328B2/en active Active
- 2018-12-17 WO PCT/US2018/065918 patent/WO2019216955A1/en unknown
- 2018-12-17 CN CN201880093264.2A patent/CN112106107A/en active Pending
- 2018-12-17 EP EP18834117.6A patent/EP3788591B1/en active Active
- 2018-12-17 JP JP2020562587A patent/JP6900581B1/en active Active
-
2020
- 2020-05-26 US US16/883,014 patent/US11164048B2/en active Active
-
2021
- 2021-06-15 JP JP2021099377A patent/JP7134303B2/en active Active
- 2021-10-04 US US17/493,066 patent/US11657487B2/en active Active
-
2022
- 2022-08-17 JP JP2022130055A patent/JP7422825B2/en active Active
Also Published As
Publication number | Publication date |
---|---|
US10706328B2 (en) | 2020-07-07 |
US11657487B2 (en) | 2023-05-23 |
CN112106107A (en) | 2020-12-18 |
US20220027678A1 (en) | 2022-01-27 |
JP7422825B2 (en) | 2024-01-26 |
US11164048B2 (en) | 2021-11-02 |
WO2019216955A1 (en) | 2019-11-14 |
JP2022164718A (en) | 2022-10-27 |
JP7134303B2 (en) | 2022-09-09 |
US20200285908A1 (en) | 2020-09-10 |
JP6900581B1 (en) | 2021-07-07 |
EP3788591A1 (en) | 2021-03-10 |
JP2021518025A (en) | 2021-07-29 |
US20190340468A1 (en) | 2019-11-07 |
JP2021166062A (en) | 2021-10-14 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
EP3788591B1 (en) | Focus-weighted, machine learning classifier error prediction for microscope slide images | |
JP7466606B2 (en) | Image Analysis System Using Context Features | |
Kohlberger et al. | Whole-slide image focus quality: Automatic assessment and impact on ai cancer detection | |
Campanella et al. | Towards machine learned quality control: A benchmark for sharpness quantification in digital pathology | |
CN110033456B (en) | Medical image processing method, device, equipment and system | |
US11941900B2 (en) | Identifying regions of interest from whole slide images | |
US20200066407A1 (en) | Method and System for Assisting Pathologist Identification of Tumor Cells in Magnified Tissue Images | |
WO2021139258A1 (en) | Image recognition based cell recognition and counting method and apparatus, and computer device | |
US10346980B2 (en) | System and method of processing medical images | |
JP6342810B2 (en) | Image processing | |
JP2016052116A (en) | Image processing device, image processing method and computer program | |
KR101789513B1 (en) | Method of determining image quality in digital pathology system | |
Foucart et al. | Artifact identification in digital pathology from weak and noisy supervision with deep residual networks | |
KR101849458B1 (en) | Method of compressing image in digital pathology system | |
US20230206416A1 (en) | Computer-implemented method for quality control of a digital image of a sample | |
WO2019181072A1 (en) | Image processing method, computer program, and recording medium | |
CN114419401A (en) | Leukocyte detection and identification method and device, computer storage medium and electronic equipment | |
Xu et al. | A multistaged automatic restoration of noisy microscopy cell images | |
CN116433695B (en) | Mammary gland region extraction method and system of mammary gland molybdenum target image | |
KR20240032031A (en) | Systems and methods for processing electronic images to provide blur robustness | |
CN116797588A (en) | Diagnostic method, device, equipment and storage medium for abnormal cells | |
WO2023064186A1 (en) | Machine-learning techniques for detecting artifact pixels in images | |
CN117455791A (en) | Lightweight network-based rapid focusing method for scanning pathological images | |
CN117597709A (en) | Method and apparatus for recording training data |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
STAA | Information on the status of an ep patent application or granted ep patent |
Free format text: STATUS: UNKNOWN |
|
STAA | Information on the status of an ep patent application or granted ep patent |
Free format text: STATUS: THE INTERNATIONAL PUBLICATION HAS BEEN MADE |
|
STAA | Information on the status of an ep patent application or granted ep patent |
Free format text: STATUS: THE INTERNATIONAL PUBLICATION HAS BEEN MADE |
|
PUAI | Public reference made under article 153(3) epc to a published international application that has entered the european phase |
Free format text: ORIGINAL CODE: 0009012 |
|
STAA | Information on the status of an ep patent application or granted ep patent |
Free format text: STATUS: REQUEST FOR EXAMINATION WAS MADE |
|
17P | Request for examination filed |
Effective date: 20201204 |
|
AK | Designated contracting states |
Kind code of ref document: A1Designated state(s): AL AT BE BG CH CY CZ DE DK EE ES FI FR GB GR HR HU IE IS IT LI LT LU LV MC MK MT NL NO PL PT RO RS SE SI SK SM TR |
|
AX | Request for extension of the european patent |
Extension state: BA ME |
|
DAV | Request for validation of the european patent (deleted) | ||
DAX | Request for extension of the european patent (deleted) | ||
GRAP | Despatch of communication of intention to grant a patent |
Free format text: ORIGINAL CODE: EPIDOSNIGR1 |
|
STAA | Information on the status of an ep patent application or granted ep patent |
Free format text: STATUS: GRANT OF PATENT IS INTENDED |
|
INTG | Intention to grant announced |
Effective date: 20230504 |
|
P01 | Opt-out of the competence of the unified patent court (upc) registered |
Effective date: 20230615 |
|
GRAS | Grant fee paid |
Free format text: ORIGINAL CODE: EPIDOSNIGR3 |
|
GRAA | (expected) grant |
Free format text: ORIGINAL CODE: 0009210 |
|
STAA | Information on the status of an ep patent application or granted ep patent |
Free format text: STATUS: THE PATENT HAS BEEN GRANTED |
|
AK | Designated contracting states |
Kind code of ref document: B1Designated state(s): AL AT BE BG CH CY CZ DE DK EE ES FI FR GB GR HR HU IE IS IT LI LT LU LV MC MK MT NL NO PL PT RO RS SE SI SK SM TR |
|
REG | Reference to a national code |
Ref country code: GBRef legal event code: FG4D |
|
REG | Reference to a national code |
Ref country code: CHRef legal event code: EP |
|
REG | Reference to a national code |
Ref country code: IERef legal event code: FG4D |
|
REG | Reference to a national code |
Ref country code: DERef legal event code: R096Ref document number: 602018059698Country of ref document: DE |
|
PGFP | Annual fee paid to national office [announced via postgrant information from national office to epo] |
Ref country code: GBPayment date: 20231227Year of fee payment: 6 |
|
REG | Reference to a national code |
Ref country code: LTRef legal event code: MG9D |
|
REG | Reference to a national code |
Ref country code: NLRef legal event code: MPEffective date: 20231018 |
|
REG | Reference to a national code |
Ref country code: ATRef legal event code: MK05Ref document number: 1623117Country of ref document: ATKind code of ref document: TEffective date: 20231018 |
|
PG25 | Lapsed in a contracting state [announced via postgrant information from national office to epo] |
Ref country code: NLFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20231018 |
|
PG25 | Lapsed in a contracting state [announced via postgrant information from national office to epo] |
Ref country code: GRFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20240119 |
|
PG25 | Lapsed in a contracting state [announced via postgrant information from national office to epo] |
Ref country code: ISFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20240218 |
|
PG25 | Lapsed in a contracting state [announced via postgrant information from national office to epo] |
Ref country code: LTFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20231018 |
|
PG25 | Lapsed in a contracting state [announced via postgrant information from national office to epo] |
Ref country code: ATFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20231018 |
|
PG25 | Lapsed in a contracting state [announced via postgrant information from national office to epo] |
Ref country code: ESFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20231018 |
|
PG25 | Lapsed in a contracting state [announced via postgrant information from national office to epo] |
Ref country code: LTFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20231018Ref country code: ISFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20240218Ref country code: GRFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20240119Ref country code: ESFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20231018Ref country code: BGFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20240118Ref country code: ATFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20231018Ref country code: PTFree format text: LAPSE BECAUSE OF FAILURE TO SUBMIT A TRANSLATION OF THE DESCRIPTION OR TO PAY THE FEE WITHIN THE PRESCRIBED TIME-LIMITEffective date: 20240219 |
|
PGFP | Annual fee paid to national office [announced via postgrant information from national office to epo] |
Ref country code: DEPayment date: 20231229Year of fee payment: 6 |