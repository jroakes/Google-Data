US20030097267A1 - Complete optimization of model parameters in parametric speech coders - Google Patents
Complete optimization of model parameters in parametric speech coders Download PDFInfo
- Publication number
- US20030097267A1 US20030097267A1 US10/039,528 US3952801A US2003097267A1 US 20030097267 A1 US20030097267 A1 US 20030097267A1 US 3952801 A US3952801 A US 3952801A US 2003097267 A1 US2003097267 A1 US 2003097267A1
- Authority
- US
- United States
- Prior art keywords
- gradient
- speech
- search algorithm
- roots
- synthesis
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Abandoned
Links
Images
Classifications
-
- G—PHYSICS
- G10—MUSICAL INSTRUMENTS; ACOUSTICS
- G10L—SPEECH ANALYSIS OR SYNTHESIS; SPEECH RECOGNITION; SPEECH OR VOICE PROCESSING; SPEECH OR AUDIO CODING OR DECODING
- G10L19/00—Speech or audio signals analysis-synthesis techniques for redundancy reduction, e.g. in vocoders; Coding or decoding of speech or audio signals, using source filter models or psychoacoustic analysis
- G10L19/04—Speech or audio signals analysis-synthesis techniques for redundancy reduction, e.g. in vocoders; Coding or decoding of speech or audio signals, using source filter models or psychoacoustic analysis using predictive techniques
- G10L19/06—Determination or coding of the spectral characteristics, e.g. of the short-term prediction coefficients
Definitions
- the present invention relates generally to speech encoding, and more particularly, to an encoder and a gradient search algorithm.
- Speech compression is a well known technology for encoding speech into digital data for transmission to a receiver which then reproduces the speech.
- the digitally encoded speech data can also be stored in a variety of digital media between encoding and later decoding (i.e., reproduction) of the speech.
- Speech synthesis systems differ from other analog and digital encoding systems that directly sample an acoustic sound at high bit rates and transmit the raw sampled data to the receiver.
- Direct sampling systems usually produce a high quality reproduction of the original acoustic sound and is typically preferred when quality reproduction is especially important.
- Common examples where direct sampling systems are usually used include music phonographs and cassette tapes (analog) and music compact discs and DVDs (digital).
- One disadvantage of direct sampling systems is the large bandwidth required for transmission of the data and the large memory required for storage of the data. Thus, for example, in a typical encoding system which transmits raw speech data sampled from an original acoustic sound, a data rate as high as 96,000 bits per second is often required.
- speech synthesis systems use a mathematical model of human speech production.
- the fundamental techniques of speech modeling are known in the art and are described in B. S. Atal and Suzanne L. Hanauer, Speech Analysis and Synthesis by Linear Prediction of the Speech Wave, The Journal of the Acoustical Society of America 637-55 (vol. 50 1971).
- the model of human speech production used in speech synthesis systems is usually referred to as a source-filter model.
- this model includes an excitation signal that represents air flow produced by the vocal folds, and a synthesis filter that represents the vocal tract (i.e., the glottis, mouth, tongue, nasal cavities and lips).
- the excitation signal acts as an input signal to the synthesis filter similar to the way the vocal folds produce air flow to the vocal tract.
- the synthesis filter then alters the excitation signal to represent the way the vocal tract manipulates the air flow from the vocal folds.
- the resulting synthesized speech signal becomes an approximate representation of the original speech.
- One advantage of speech synthesis systems is that the bandwidth needed to transmit a digitized form of the original speech can be greatly reduced compared to direct sampling systems.
- direct sampling systems transmit raw acoustic data to describe the original sound
- speech synthesis systems transmit only a limited amount of control data needed to recreate the mathematical speech model.
- a typical speech synthesis system can reduce the bandwidth needed to transmit speech to about 4,800 bits per second.
- an improved gradient search algorithm is provided.
- the new, improved algorithm recalculates the gradient vector by taking into account the variations of the decomposition coefficients with respect to the roots.
- the gradient search algorithm is especially useful with linear predictive coding speech systems that optimize synthesized speech by searching for roots of a polynomial.
- FIG. 1 is a block diagram of a speech analysis-by-synthesis system
- FIG. 2A is a flow chart of the proposed speech synthesis system
- FIG. 2B is a flow chart of an alternative speech synthesis system
- FIG. 3 is a flow chart of a gradient search algorithm
- FIG. 4 is a timeline-amplitude chart, comparing an original speech sample to an LPC synthesized speech and an optimally synthesized speech;
- FIG. 5 is a chart, showing synthesis error reduction and improvement as a result of the optimization.
- FIG. 6 is a spectral chart, comparing an original speech sample to an LPC synthesized speech and an optimally synthesized speech.
- a speech synthesis system is provided that minimizes the synthesis error in order to more accurately model the original speech.
- a speech analysis-by-synthesis (“AbS”) system is shown which is commonly referred to as a source-filter model.
- source-filter models are designed to mathematically model human speech production.
- the model assumes that the human sound-producing mechanisms that produce speech remain fixed, or unchanged, during successive short time intervals (e.g., 20 to 30 ms).
- the model further assumes that the human sound producing mechanisms can change between successive intervals.
- the physical mechanisms modeled by this system include air pressure variations generated by the vocal folds, glottis, mouth, tongue, nasal cavities and lips.
- the speech decoder can reproduce the model and recreate the original speech.
- raw sampled data of the original speech is not transmitted from the encoder to the decoder.
- the digitally encoded data which is transmitted or stored i.e., the bandwidth, or the number of bits
- FIG. 1 shows an original digitized speech 10 delivered to an excitation module 12 .
- the excitation module 12 analyzes each sample s(n) of the original speech and generates an excitation function u(n).
- the excitation function u(n) is typically a series of pulse signals that represent air bursts from the lungs which are released by the vocal folds to the vocal tract.
- the excitation function u(n) may be either a voiced 13 , 14 or an unvoiced signal 15 .
- CELP Code - Excited Linear Prediction
- the excitation module 12 can also generate an unvoiced 15 excitation function u(n).
- An unvoiced 15 excitation function u(n) is used when the speaker's vocal folds are open and turbulent air flow is produced through the vocal tract.
- Most excitation modules 12 model this state by generating an excitation function u(n) consisting of white noise 15 (i.e., a random signal) instead of pulses.
- the synthesis filter 16 models the vocal tract and its effect on the air flow from the vocal folds.
- the synthesis filter 16 uses a polynomial equation to represent the various shapes of the vocal tract. This technique can be visualized by imagining a multiple section hollow tube with a number of different diameters along the length of the tube. Accordingly, the synthesis filter 16 alters the characteristics of the excitation function u(n) similar to the way the vocal tract alters the air flow from the vocal folds, or in other words, like a variable diameter hollow tube alters inflowing air.
- the synthesis filter 16 can be represented by the mathematical formula:
- G is a gain term representing the loudness of the voice.
- the order of the polynomial A(z) can vary depending on the particular application, but a 10th order polynomial is commonly used with an 8 kHz sampling rate.
- the coefficients a 1 . . . a M of this polynomial are computed using a technique known in the art as linear predictive coding (“LPC”).
- LPC-based techniques compute the polynomial coefficients a 1 . . . a M by minimizing the total prediction error E p .
- N is the length of the analysis window in number of samples.
- the polynomial coefficients a 1 . . . a M can now be computed by minimizing the total prediction error E p using well known mathematical techniques.
- N is the length of the analysis window.
- the total synthesis error E s should be minimized to compute the optimum filter coefficients a 1 . . . a M .
- the synthesized speech (n) as represented in formula (3) makes the total synthesis error E s a highly nonlinear function that is generally mathematically intractable.
- ⁇ 1 . . . ⁇ M represents the roots of the polynomial A(z). These roots may be either real or complex. Thus, in the preferred 10th order polynomial, A(z) will have 10 different roots.
- a number of root searching algorithms may be used to minimize the total synthesis error E s .
- One possible algorithm is an iterative gradient search algorithm. Accordingly, denoting the root vector at the j-th iteration as ⁇ (j) , the root vector can be expressed by the formula:
- ⁇ (j) [ ⁇ 1 (j) . . . ⁇ i (j) . . . ⁇ M (j) ] T (14)
- ⁇ i (j) is the value of the i-th root at the j-th iteration and T is the transpose operator.
- the search algorithm begins with the LPC solution as the starting point, which is expressed by the formula:
- ⁇ (0) [ ⁇ 1 (0) . . . ⁇ i (0) . . . ⁇ M (0) ] T (15)
- ⁇ (0) the LPC coefficients a 1 . . . a M are converted to the corresponding roots ⁇ 1 (0) . . . ⁇ M (0) using a standard root finding algorithm.
- ⁇ is the step size and ⁇ j E s is the gradient of the synthesis error E s relative to the roots at iteraton j.
- the step size ⁇ can be either fixed for each iteration, or alternatively, it can be variable and adapted for each iteration.
- Formula (17) demonstrates that the synthesis error gradient vector ⁇ j E s can be calculated using the gradient vector of the synthesized speech samples (k). Accordingly, the synthesized speech gradient vector ⁇ j (k) can be defined by the formula:
- ⁇ j ⁇ ( k ) [ ⁇ ⁇ ( k )/ ⁇ 1 (j) . . . ⁇ ( k )/ ⁇ r (j) . . . ⁇ ( k )/ ⁇ M (j) ] (18)
- ⁇ (k)/ ⁇ r (j) is the partial derivative of (k) at iteration j with respect to the r-th root.
- K ( i,r ) 1/(1 ⁇ r ⁇ i ⁇ 1 ) (if r i ) (24a)
- the first term of the formula i.e., K(i,r) ⁇ i (m ⁇ 1)
- the second term of the formula i.e., m ⁇ r (m ⁇ 1) ⁇ (r ⁇ i)
- the synthesis error gradient vector ⁇ j E s is now calculated by substituting formula (29) into formula (18) and formula (18) into formula (17).
- the subsequent root vector ⁇ (j+1) at the next iteration can then be calculated by substituting the result of formula (17) into formula (16).
- the iterations of the gradient search algorithm are then repeated until either the synthesis error E s is reduced by a desired percentage from the LPC prediction error E p , a predetermined number of iterations are completed, or the roots are resolved within a predetermined acceptable range.
- control data for the optimal synthesis polynomial A(z) can be transmitted in a number of different formats, it is preferable to convert the roots found by the optimization technique described above back into polynomial coefficients a 1 . . . a M .
- the conversion can be performed by well known mathematical techniques. This conversion allows the optimized synthesis polynomial A(z) to be transmitted in the same format as existing speech coders, thus promoting compatibility with current standards.
- the control data for the model is quantized into digital data for transmission or storage.
- the control data that is quantized includes ten synthesis filter coefficients a 1 , . . . a 10 , one gain value G for the magnitude of the excitation function pulses, one pitch period value P for the frequency of the excitation function pulses, and one indicator for a voiced 13 or unvoiced 15 excitation function u(n).
- this example does not include an optimized excitation pulse 14 , which could be included with some additional control data.
- the described example requires the transmission of thirteen distinct variables at the end of each speech frame. Commonly, the thirteen variables are quantized into a total of 80 bits.
- the synthesized speech (n) can be transmitted within a bandwidth of 4,000 bits/s (80 bits/frame ⁇ 0.020 s/frame).
- the order of operations can be changed depending on the accuracy desired and the computing capacity available.
- the excitation function u(n) was first determined to be a preset series of pulses 13 for voiced speech or an unvoiced signal 15 .
- the synthesis filter polynomial A(z) was determined using conventional techniques, such as the LPC method.
- the synthesis polynomial A(z) was optimized.
- FIGS. 2A and 2B different encoding sequences are shown which should provide more accurate synthesis and may be used with CELP-type speech encoders. However, some additional computing power will typically be required.
- the original digitized speech sample 30 is used to compute 32 the polynomial coefficients a 1 . . . a M using the LPC technique described above or another comparable method.
- the polynomial coefficients a 1 . . . a M are then used to find 36 the optimum excitation function u(n) from a codebook.
- an individual excitation function u(n) can be found 40 from the codebook for each iteration.
- the polynomial coefficients a 1 . . . a M are then also optimized. To make optimization of the coefficients a 1 . . . a M easier, the polynomial coefficients a 1 . . . a M are first converted 34 to the roots of the polynomial A(z). A gradient search algorithm is then used to optimize 38 , 42 , 44 the roots. Once the optimal roots are found, the roots are then converted 46 back to polynomial coefficients a 1 . . . a M for compatibility with existing encoding-decoding systems. Lastly, the synthesis model and the index to the codebook entry is quantized 48 for transmission or storage.
- Additional encoding sequences are also possible for improving the accuracy of the synthesis model or for changing the computing capacity needed to encode the synthesis model. Some of these alternative sequences are demonstrated in FIG. 1 by dashed routing lines.
- the excitation function u(n) can be reoptimized at various stages during encoding of the synthesis model.
- FIG. 3 a flow chart of the gradient search algorithm is shown.
- first roots of the polynominal are computed 50 .
- the initial roots may be determined by several methods, including root finding algorithms such as Newton-Raphson or interval halving.
- Decomposition coefficients b i are then calculated using the first computed roots 52 .
- the gradient vector of the polynominal is calculated using the contribution of the decomposition coefficients b i 54 .
- the gradient vector is used to calculate second estimated roots 56 .
- a test is then performed to determine whether the search should end or whether it should continue 58 .
- the gradient search algorithm stops and the estimated roots are passed on to the speech synthesis system for further processing 58 .
- the decomposition coefficients b i are recalculated using the second estimated roots 52 .
- the process of calculating the gradient vector and re-estimating the roots is then repeated using the new contribution of the recalculated decomposition coefficients be 54 , 56 .
- FIGS. 4 - 6 show the improved results provided by the optimized speech synthesis system.
- the figures show several different comparisons between a prior art LPC synthesis system and the optimized synthesis system.
- the speech sample used for this comparison is a segment of a voiced part of the nasal “m”.
- FIG. 4 a timeline-amplitude chart of the original speech, a prior art LPC synthesized speech and the optimized synthesized speech is shown. As can be seen, the optimally synthesized speech matches the original speech much closer than the LPC synthesized speech.
- the reduction in the synthesis error is shown for successive iterations of optimization.
- the synthesis error equals the LPC synthesis error since the LPC coefficients serve as the starting point for the optimization.
- the improvement in the synthesis error is zero at the first iteration.
- the synthesis error steadily decreases with each iteration.
- the synthesis error increases (and the improvement decreases) at iteration number three. This characteristic occurs when the root searching algorithm overshoots the optimal roots. After overshooting the optimal roots, the search algorithm can be expected to take the overshoot into account in successive iterations, thereby resulting in further reductions in the synthesis error.
- the synthesis error can be seen to be reduced by 59% after six iterations. Thus, a significant improvement over the LPC synthesis error is possible with the optimization.
- FIG. 6 shows a spectral chart of the original speech, the LPC synthesized speech and the optimized synthesized speech. As seen in this chart, the spectrum of the optimized speech provides a much better match to the spectrum of the original speech as compared to the LPC spectrum. The improvement in the synthesized spectrum is especially apparent in the frequency range of 0 to 1,500 Hz.
Abstract
A gradient search algorithm is provided for speech coding systems. The gradient search algorithm calculates the gradient of a speech synthesis polynomial using the contribution of decomposition coefficients. The contribution of the decomposition coefficients is then recalculated at successive iterations.
Description
- The present invention relates generally to speech encoding, and more particularly, to an encoder and a gradient search algorithm.
- Speech compression is a well known technology for encoding speech into digital data for transmission to a receiver which then reproduces the speech. The digitally encoded speech data can also be stored in a variety of digital media between encoding and later decoding (i.e., reproduction) of the speech.
- Speech synthesis systems differ from other analog and digital encoding systems that directly sample an acoustic sound at high bit rates and transmit the raw sampled data to the receiver. Direct sampling systems usually produce a high quality reproduction of the original acoustic sound and is typically preferred when quality reproduction is especially important. Common examples where direct sampling systems are usually used include music phonographs and cassette tapes (analog) and music compact discs and DVDs (digital). One disadvantage of direct sampling systems, however, is the large bandwidth required for transmission of the data and the large memory required for storage of the data. Thus, for example, in a typical encoding system which transmits raw speech data sampled from an original acoustic sound, a data rate as high as 96,000 bits per second is often required.
- In contrast, speech synthesis systems use a mathematical model of human speech production. The fundamental techniques of speech modeling are known in the art and are described in B. S. Atal and Suzanne L. Hanauer,Speech Analysis and Synthesis by Linear Prediction of the Speech Wave, The Journal of the Acoustical Society of America 637-55 (vol. 50 1971). The model of human speech production used in speech synthesis systems is usually referred to as a source-filter model. Generally, this model includes an excitation signal that represents air flow produced by the vocal folds, and a synthesis filter that represents the vocal tract (i.e., the glottis, mouth, tongue, nasal cavities and lips). Therefore, the excitation signal acts as an input signal to the synthesis filter similar to the way the vocal folds produce air flow to the vocal tract. The synthesis filter then alters the excitation signal to represent the way the vocal tract manipulates the air flow from the vocal folds. Thus, the resulting synthesized speech signal becomes an approximate representation of the original speech.
- One advantage of speech synthesis systems is that the bandwidth needed to transmit a digitized form of the original speech can be greatly reduced compared to direct sampling systems. Thus, by comparison, whereas direct sampling systems transmit raw acoustic data to describe the original sound, speech synthesis systems transmit only a limited amount of control data needed to recreate the mathematical speech model. As a result, a typical speech synthesis system can reduce the bandwidth needed to transmit speech to about 4,800 bits per second.
- One problem with speech synthesis systems however is that the quality of the reproduced speech is sometimes relatively poor compared to direct sampling systems. Most speech synthesis systems provide sufficient quality for the receiver to accurately perceive the content of the original speech. However, in some speech synthesis systems, the reproduced speech is not transparent. That is, while the receiver can understand the words originally spoken, the quality of the speech may be poor or annoying. Thus, a speech synthesis system that provides a more accurate speech production model is desirable.
- One solution that has been recognized for improving the quality of speech synthesis systems is described in U.S. patent application Ser. No. 09/800,071 to Lashkari et al., hereby incorporated by reference. Briefly stated, this solution involves minimizing a synthesis error between an original speech sample and a synthesized speech sample. One difficulty that was discovered in that speech synthesis system however is the highly nonlinear nature of the synthesis error, which made the problem mathematically intractable. This difficulty was overcome by solving the problem using the roots of the synthesis filter polynomial instead of the coefficients of the polynomial. Accordingly, a root searching algorithm is described therein for finding the roots of the synthesis filter polynomial.
- In parametric speech coders that resolve the synthesis filter polynomial using roots instead of coefficients, the effectiveness and efficiency of the root searching algorithm used has an impact on the quality and performance of the speech coder. One root searching algorithm that may be used in such speech coders is a gradient search algorithm. As those in the art well know, gradient search algorithms use an iterative solution process that calculates a gradient vector for a function and estimates the unknown variables using the calculated gradient vector. However, improved gradient search algorithms are desired for use in parametric speech coders.
- Accordingly, an improved gradient search algorithm is provided. The new, improved algorithm recalculates the gradient vector by taking into account the variations of the decomposition coefficients with respect to the roots. Thus, the gradient search algorithm is especially useful with linear predictive coding speech systems that optimize synthesized speech by searching for roots of a polynomial.
- The invention, including its construction and method of operation, is illustrated more or less diagrammatically in the drawings, in which:
- FIG. 1 is a block diagram of a speech analysis-by-synthesis system;
- FIG. 2A is a flow chart of the proposed speech synthesis system;
- FIG. 2B is a flow chart of an alternative speech synthesis system;
- FIG. 3 is a flow chart of a gradient search algorithm;
- FIG. 4 is a timeline-amplitude chart, comparing an original speech sample to an LPC synthesized speech and an optimally synthesized speech;
- FIG. 5 is a chart, showing synthesis error reduction and improvement as a result of the optimization; and
- FIG. 6 is a spectral chart, comparing an original speech sample to an LPC synthesized speech and an optimally synthesized speech.
- Referring now to the drawings, and particularly to FIG. 1, a speech synthesis system is provided that minimizes the synthesis error in order to more accurately model the original speech. In FIG. 1, a speech analysis-by-synthesis (“AbS”) system is shown which is commonly referred to as a source-filter model. As is well known in the art, source-filter models are designed to mathematically model human speech production. Typically, the model assumes that the human sound-producing mechanisms that produce speech remain fixed, or unchanged, during successive short time intervals (e.g., 20 to 30 ms). The model further assumes that the human sound producing mechanisms can change between successive intervals. The physical mechanisms modeled by this system include air pressure variations generated by the vocal folds, glottis, mouth, tongue, nasal cavities and lips. Therefore, by limiting the digitally encoded data to a small set of control data for each interval, the speech decoder can reproduce the model and recreate the original speech. Thus, raw sampled data of the original speech is not transmitted from the encoder to the decoder. As a result, the digitally encoded data which is transmitted or stored (i.e., the bandwidth, or the number of bits) is much less than required by typical direct sampling systems.
- Accordingly, FIG. 1 shows an original
digitized speech 10 delivered to anexcitation module 12. Theexcitation module 12 then analyzes each sample s(n) of the original speech and generates an excitation function u(n). The excitation function u(n) is typically a series of pulse signals that represent air bursts from the lungs which are released by the vocal folds to the vocal tract. Depending on the nature of the original speech sample s(n), the excitation function u(n) may be either a voiced 13, 14 or anunvoiced signal 15. - One way to improve the quality of reproduced speech in speech synthesis systems involves improving the accuracy of the voiced excitation function u(n). Traditionally, the excitation function u(n) has been treated as a series of
pulses 13 with a fixed magnitude G and period P between the pitch pulses. As those in the art well know, the magnitude G and period P may vary between successive intervals. In contrast to the traditional fixed magnitude M and period P, it has previously been shown to the art that speech synthesis can be improved by optimizing the excitation function u(n) by varying the magnitude and pitch period of theexcitation pulses 14. This improvement is described in Bishnu S. Atal and Joel R. Remde, A New Model of LPC Excitation For Producing Natural-Sounding Speech At Low Bit Rates, IEEE International Conference On Acoustics, Speech, And Signal Processing 614-17 (1982). This optimization technique usually requires more intensive computing to encode the original speech s(n), but this problem has not been a significant disadvantage since modern computers provide sufficient computing power foroptimization 14 of the excitation function u(n). A greater problem with this improvement has been the additional bandwidth that is required to transmit data for thevariable excitation pulses 14. One solution to this problem is a coding system that is described in Manfred R. Schroeder and Bishnu S. Atal, Code-Excited Linear Prediction (CELP): High-Quality Speech At Very Low Bit Rates, IEEE International Conference On Acoustics, Speech, And Signal Processing 937-40 (1985). This solution involves categorizing a number of optimized excitation functions into a library of functions, or a codebook. Theencoding excitation module 12 will then select an optimized excitation function from the codebook that produces a synthesized speech that most closely matches the original speech s(n). Then, a code that identifies the optimum codebook entry is transmitted to the decoder. When the decoder receives the transmitted code, the decoder then accesses a corresponding codebook to reproduce the selected optimal excitation function u(n). - The
excitation module 12 can also generate an unvoiced 15 excitation function u(n). An unvoiced 15 excitation function u(n) is used when the speaker's vocal folds are open and turbulent air flow is produced through the vocal tract.Most excitation modules 12 model this state by generating an excitation function u(n) consisting of white noise 15 (i.e., a random signal) instead of pulses. - Next, the
synthesis filter 16 models the vocal tract and its effect on the air flow from the vocal folds. Typically, thesynthesis filter 16 uses a polynomial equation to represent the various shapes of the vocal tract. This technique can be visualized by imagining a multiple section hollow tube with a number of different diameters along the length of the tube. Accordingly, thesynthesis filter 16 alters the characteristics of the excitation function u(n) similar to the way the vocal tract alters the air flow from the vocal folds, or in other words, like a variable diameter hollow tube alters inflowing air. - According to Atal and Remde, supra., the
synthesis filter 16 can be represented by the mathematical formula: - H(z)=G/A(z) (1)
-
- The order of the polynomial A(z) can vary depending on the particular application, but a 10th order polynomial is commonly used with an 8 kHz sampling rate. The relationship of the synthesized speech (n) to the excitation function u(n) as determined by the
synthesis filter 16 can be defined by the formula: -
-
- where N is the length of the analysis window in number of samples. The polynomial coefficients a1 . . . aM can now be computed by minimizing the total prediction error Ep using well known mathematical techniques.
- One problem with the LPC technique of computing the polynomial coefficients a1 . . . aM is that only the prediction error is minimized. Thus, the LPC technique does not minimize the error between the original speech s(n) and the synthesized speech (n). Accordingly, the sample synthesis error es(n) can be defined by the formula:
- e s(n)=s(n)−ŝ(n) (6)
-
- where N is the length of the analysis window. Like the total prediction error Ep discussed above, the total synthesis error Es should be minimized to compute the optimum filter coefficients a1 . . . aM. However, one difficulty with this technique is that the synthesized speech (n) as represented in formula (3) makes the total synthesis error Es a highly nonlinear function that is generally mathematically intractable.
-
- where * is the convolution operator. In this formula, it is also assumed that the excitation function u(n) is zero outside of the
interval 0 toN− 1. Using the roots of A(z), the polynomial can now be expressed by the formula: - A(z)=(1−λz −1) . . . (1−λ M z −1) (9)
- where λ1 . . . λM represents the roots of the polynomial A(z). These roots may be either real or complex. Thus, in the preferred 10th order polynomial, A(z) will have 10 different roots.
-
-
-
-
- Therefore, by substituting formula (13) into formula (7), the total synthesis error Es can be minimized using polynomial roots and a gradient search algorithm.
- A number of root searching algorithms may be used to minimize the total synthesis error Es. One possible algorithm, however, is an iterative gradient search algorithm. Accordingly, denoting the root vector at the j-th iteration as Λ(j), the root vector can be expressed by the formula:
- Λ(j)=[λ1 (j) . . . λi (j) . . . λM (j)]T (14)
- where λi (j) is the value of the i-th root at the j-th iteration and T is the transpose operator. The search algorithm begins with the LPC solution as the starting point, which is expressed by the formula:
- Λ(0)=[λ1 (0) . . . λi (0) . . . λM (0)]T (15)
- To compute Λ(0), the LPC coefficients a1 . . . aM are converted to the corresponding roots λ1 (0) . . . λM (0) using a standard root finding algorithm.
- Next, the roots at subsequent iterations can be expressed by the formula:
- Λ(j+1)=Λ(j)+μ∇j E s (16)
-
- Formula (17) demonstrates that the synthesis error gradient vector ∇jEs can be calculated using the gradient vector of the synthesized speech samples (k). Accordingly, the synthesized speech gradient vector ∇j(k) can be defined by the formula:
- ∇j ŝ(k)=[∂ŝ(k)/∂λ1 (j) . . . ∂ŝ(k)/∂λr (j) . . . ∂ŝ(k)/∂λM (j)] (18)
-
- (the superscript j is omitted from formula (19) through formula (28) for notational simplicity). Formula (19) can now be expressed using the chain rule of differentiation by the formula:
- [b iλi m]/λr=λi m b i/λr +mb iλr (m−1)δ(r−i) (20)
- where δ(r−i) is the delta function (i.e., δ(r−i)=1 for r=i and δ(r−i)=0 for r i).
-
- To resolve the partial derivative of formula (21), the partial derivative must be calculated for two cases, including r i and r=i.
-
- Next, the partial derivative of 1/(1−λrλi −1) can be calculated by the formula:
- [1/(1−λrλi −1)]/λr=λi/(λi−λr)2 (22b)
-
- By substituting formula (22c) into formula (21) and further simplifying, the partial derivative of ∂bi/∂λr for the case of r i can now be expressed by the formula:
- b j/λr=(b i/λi)[1/(1−λrλi −1)] (r i) (22d)
-
- Next, the partial derivative of 1/(1−λqλi −1) can be calculated by the formula:
- [1/(1−λqλi −1)]/λj=−λq/(λi−λq)2 (23b)
-
-
- In order to unify the two cases of r i and r=i, the function K(i,r) can be defined by the following formulas:
- The partial derivative of ∂bi/∂λr can now be simplified for both cases by the formula:
- b i/λr =b i K(i,r)/λi (for any r) (25)
- By substituting formula (25) into formula (20), the partial derivative of [biλi m]/λr can now be expressed by the formula:
- [b iλi m]/λr =b i [K(i,r)λi (m−1) +mλ r (m−1)δ(r−i)] (26)
- In formula (26), the first term of the formula (i.e., K(i,r)λi (m−1)) is the contribution of bi/λi, while the second term of the formula (i.e., mλr (m−1)δ(r−i)) is the contribution of the m-th power of λi.
-
-
-
- The synthesis error gradient vector ∇jEs is now calculated by substituting formula (29) into formula (18) and formula (18) into formula (17). The subsequent root vector Λ(j+1) at the next iteration can then be calculated by substituting the result of formula (17) into formula (16). The iterations of the gradient search algorithm are then repeated until either the synthesis error Es is reduced by a desired percentage from the LPC prediction error Ep, a predetermined number of iterations are completed, or the roots are resolved within a predetermined acceptable range.
- Although control data for the optimal synthesis polynomial A(z) can be transmitted in a number of different formats, it is preferable to convert the roots found by the optimization technique described above back into polynomial coefficients a1 . . . aM. The conversion can be performed by well known mathematical techniques. This conversion allows the optimized synthesis polynomial A(z) to be transmitted in the same format as existing speech coders, thus promoting compatibility with current standards.
- Now that the synthesis model has been completely determined, the control data for the model is quantized into digital data for transmission or storage. Many different industry standards exist for quantization. However, in one example, the control data that is quantized includes ten synthesis filter coefficients a1 , . . . a10, one gain value G for the magnitude of the excitation function pulses, one pitch period value P for the frequency of the excitation function pulses, and one indicator for a voiced 13 or unvoiced 15 excitation function u(n). As is apparent, this example does not include an optimized
excitation pulse 14, which could be included with some additional control data. Accordingly, the described example requires the transmission of thirteen distinct variables at the end of each speech frame. Commonly, the thirteen variables are quantized into a total of 80 bits. Thus, according to this example, the synthesized speech (n), including optimization, can be transmitted within a bandwidth of 4,000 bits/s (80 bits/frame÷0.020 s/frame). - As shown in FIG. 1, the order of operations can be changed depending on the accuracy desired and the computing capacity available. Thus, in the embodiment described above, the excitation function u(n) was first determined to be a preset series of
pulses 13 for voiced speech or anunvoiced signal 15. Second, the synthesis filter polynomial A(z) was determined using conventional techniques, such as the LPC method. Third, the synthesis polynomial A(z) was optimized. - In FIGS. 2A and 2B, different encoding sequences are shown which should provide more accurate synthesis and may be used with CELP-type speech encoders. However, some additional computing power will typically be required. In these sequences, the original
digitized speech sample 30 is used to compute 32 the polynomial coefficients a1 . . . aM using the LPC technique described above or another comparable method. The polynomial coefficients a1 . . . aM, are then used to find 36 the optimum excitation function u(n) from a codebook. Alternatively, an individual excitation function u(n) can be found 40 from the codebook for each iteration. After selection of the excitation function u(n), the polynomial coefficients a1 . . . aM are then also optimized. To make optimization of the coefficients a1 . . . aM easier, the polynomial coefficients a1 . . . aM are first converted 34 to the roots of the polynomial A(z). A gradient search algorithm is then used to optimize 38, 42, 44 the roots. Once the optimal roots are found, the roots are then converted 46 back to polynomial coefficients a1 . . . aM for compatibility with existing encoding-decoding systems. Lastly, the synthesis model and the index to the codebook entry is quantized 48 for transmission or storage. - Additional encoding sequences are also possible for improving the accuracy of the synthesis model or for changing the computing capacity needed to encode the synthesis model. Some of these alternative sequences are demonstrated in FIG. 1 by dashed routing lines. For example, the excitation function u(n) can be reoptimized at various stages during encoding of the synthesis model.
- In FIG. 3, a flow chart of the gradient search algorithm is shown. After the polynominal coefficients a1 . . . aM have been converted to
roots 34, first roots of the polynominal are computed 50. The initial roots may be determined by several methods, including root finding algorithms such as Newton-Raphson or interval halving. Decomposition coefficients bi are then calculated using the firstcomputed roots 52. Next, the gradient vector of the polynominal is calculated using the contribution of thedecomposition coefficients b i 54. Once the gradient vector is calculated for the first computed roots, the gradient vector is used to calculate second estimatedroots 56. A test is then performed to determine whether the search should end or whether it should continue 58. Several tests may be used, including testing whether the LPC prediction error Ep has been reduced by a desired percentage, whether a limited number of iterations has been completed, or whether the estimated roots are within an acceptable range. If the search is determined to be complete, the gradient search algorithm stops and the estimated roots are passed on to the speech synthesis system forfurther processing 58. On the other hand, if the search is not determined to be complete, the decomposition coefficients bi are recalculated using the second estimatedroots 52. The process of calculating the gradient vector and re-estimating the roots is then repeated using the new contribution of the recalculated decomposition coefficients be 54, 56. - The improvement of the gradient search algorithm is now apparent. In gradient search algorithms used in other speech synthesis systems, such as the system described in U.S. patent application Ser. No. 09/800,071 to Lashkari et al., the decomposition coefficients are assumed to be constant during successive iterations of the gradient search. While this assumption provides acceptable results for some applications, improved results are achieved by the gradient search algorithm because variations in the decomposition coefficients that occur during successive iterations are considered when calculating the gradient vector.
- FIGS.4-6, show the improved results provided by the optimized speech synthesis system. The figures show several different comparisons between a prior art LPC synthesis system and the optimized synthesis system. The speech sample used for this comparison is a segment of a voiced part of the nasal “m”. In FIG. 4, a timeline-amplitude chart of the original speech, a prior art LPC synthesized speech and the optimized synthesized speech is shown. As can be seen, the optimally synthesized speech matches the original speech much closer than the LPC synthesized speech.
- In FIG. 5, the reduction in the synthesis error is shown for successive iterations of optimization. At the first iteration, the synthesis error equals the LPC synthesis error since the LPC coefficients serve as the starting point for the optimization. Thus, the improvement in the synthesis error is zero at the first iteration. Accordingly, the synthesis error steadily decreases with each iteration. Noticeably, the synthesis error increases (and the improvement decreases) at iteration number three. This characteristic occurs when the root searching algorithm overshoots the optimal roots. After overshooting the optimal roots, the search algorithm can be expected to take the overshoot into account in successive iterations, thereby resulting in further reductions in the synthesis error. In the example shown, the synthesis error can be seen to be reduced by 59% after six iterations. Thus, a significant improvement over the LPC synthesis error is possible with the optimization.
- FIG. 6 shows a spectral chart of the original speech, the LPC synthesized speech and the optimized synthesized speech. As seen in this chart, the spectrum of the optimized speech provides a much better match to the spectrum of the original speech as compared to the LPC spectrum. The improvement in the synthesized spectrum is especially apparent in the frequency range of 0 to 1,500 Hz.
- While preferred embodiments of the invention have been described, it should be understood that the invention is not so limited, and modifications may be made without departing from the invention. The scope of the invention is defined by the appended claims, and all devices that come within the meaning of the claims, either literally or by equivalence, are intended to be embraced therein.
Claims (14)
1. A gradient search algorithm for a speech coding system, comprising calculating a gradient vector; and calculating a contribution to said gradient vector in response to variations in decomposition coefficients.
2. The gradient search algorithm according to claim 1 , used in combination with finding roots of a speech synthesis polynomial, wherein said gradient search algorithm further comprises iteratively calculating said gradient vector and recalculating said contribution at each iteration, whereby said decomposition coefficients vary between iterations.
3. The gradient search algorithm according to claim 2 , wherein one of said decomposition coefficients corresponds to each of a plurality of said roots.
5. The gradient search algorithm according to claim 1 , used in combination with a speech coding system for encoding original speech, the speech coding system comprising an excitation module responsive to an original speech sample and generating an excitation function; a synthesis filter responsive to said excitation function and said original speech sample and generating a synthesized speech sample; and a synthesis filter optimizer responsive to said excitation function and said synthesis filter and generating an optimized synthesized speech sample; wherein said synthesis filter optimizer minimizes a synthesis error between said original speech sample and said synthesized speech sample; wherein the gradient search algorithm is used by said synthesis filter optimizer.
6. The gradient search algorithm according to claim 5 , wherein said synthesis filter optimizer comprises a root optimization algorithm, thereby making possible said minimization of said synthesis error; wherein said synthesis filter comprises a predictive coding technique producing said synthesized speech sample from said original speech sample; wherein said predictive coding technique produces first coefficients of a polynomial; wherein said root optimization algorithm is an iterative algorithm using first roots derived from said first coefficients in a first iteration; and wherein said root optimization algorithm produces second roots using the gradient search algorithm in successive iterations resulting in a reduction of said synthesis error in said successive iterations.
7. The gradient search algorithm according to claim 6 , wherein the gradient search algorithm further comprises iteratively calculating said gradient vector and recalculating said contribution at each iteration, whereby said decomposition coefficients vary between iterations, and wherein one of said decomposition coefficients corresponds to each of a plurality of said roots.
9. A gradient search algorithm for a speech coding system, comprising calculating decomposition coefficients; calculating a first gradient of a polynomial using said decomposition coefficients; estimating roots of said polynomial using said first gradient; recalculating said decomposition coefficients based on said estimating; calculating a second gradient of said polynomial using said recalculated decomposition coefficients; and estimating said roots of said polynomial using said second gradient.
11. The gradient search algorithm according to claim 9 , used in combination with a linear predictive coding speech system.
12. The gradient search algorithm according to claim 9 , used in combination with a method of generating a speech synthesis filter representative of a vocal tract, the method comprising computing a first synthesis error between an original speech and a first synthesized speech sample corresponding to roots estimated with said first gradient; and computing a second synthesis error between said original speech and a second synthesized speech corresponding to roots estimated with said second gradient; wherein said second synthesis error is less than said first synthesis error.
14. A gradient search algorithm for a speech coding system, comprising means for calculating decomposition coefficients of a speech synthesis polynomial; means for calculating first roots of said polynomial using said decomposition coefficients; means for recalculating said decomposition coefficients based on said first roots; and means for calculating second roots of said polynomial using said recalculated decomposition coefficients.
Priority Applications (5)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US10/039,528 US20030097267A1 (en) | 2001-10-26 | 2001-10-26 | Complete optimization of model parameters in parametric speech coders |
JP2002061093A JP2002328692A (en) | 2001-03-06 | 2002-03-06 | Joint optimization and model parameter in parametric speech coder |
EP02005056A EP1267327B1 (en) | 2001-03-06 | 2002-03-06 | Optimization of model parameters in speech coding |
DE60215420T DE60215420T2 (en) | 2001-03-06 | 2002-03-06 | Optimization of model parameters for speech coding |
JP2004314437A JP2005099825A (en) | 2001-03-06 | 2004-10-28 | Joint optimization of excitation and model in parametric speech coder |
Applications Claiming Priority (1)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US10/039,528 US20030097267A1 (en) | 2001-10-26 | 2001-10-26 | Complete optimization of model parameters in parametric speech coders |
Publications (1)
Publication Number | Publication Date |
---|---|
US20030097267A1 true US20030097267A1 (en) | 2003-05-22 |
Family
ID=21905957
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
US10/039,528 Abandoned US20030097267A1 (en) | 2001-03-06 | 2001-10-26 | Complete optimization of model parameters in parametric speech coders |
Country Status (1)
Country | Link |
---|---|
US (1) | US20030097267A1 (en) |
Citations (2)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5307441A (en) * | 1989-11-29 | 1994-04-26 | Comsat Corporation | Wear-toll quality 4.8 kbps speech codec |
US6597787B1 (en) * | 1999-07-29 | 2003-07-22 | Telefonaktiebolaget L M Ericsson (Publ) | Echo cancellation device for cancelling echos in a transceiver unit |
-
2001
- 2001-10-26 US US10/039,528 patent/US20030097267A1/en not_active Abandoned
Patent Citations (2)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5307441A (en) * | 1989-11-29 | 1994-04-26 | Comsat Corporation | Wear-toll quality 4.8 kbps speech codec |
US6597787B1 (en) * | 1999-07-29 | 2003-07-22 | Telefonaktiebolaget L M Ericsson (Publ) | Echo cancellation device for cancelling echos in a transceiver unit |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
US5305421A (en) | Low bit rate speech coding system and compression | |
US8401843B2 (en) | Method and device for coding transition frames in speech signals | |
JP4005359B2 (en) | Speech coding and speech decoding apparatus | |
US20070055504A1 (en) | Optimized windows and interpolation factors, and methods for optimizing windows, interpolation factors and linear prediction analysis in the ITU-T G.729 speech coding standard | |
US20070118370A1 (en) | Methods and apparatuses for variable dimension vector quantization | |
EP1353323B1 (en) | Method, device and program for coding and decoding acoustic parameter, and method, device and program for coding and decoding sound | |
US20030195744A1 (en) | Determining linear predictive coding filter parameters for encoding a voice signal | |
US6219636B1 (en) | Audio pitch coding method, apparatus, and program storage device calculating voicing and pitch of subframes of a frame | |
US7200552B2 (en) | Gradient descent optimization of linear prediction coefficients for speech coders | |
EP1267327B1 (en) | Optimization of model parameters in speech coding | |
US6859775B2 (en) | Joint optimization of excitation and model parameters in parametric speech coders | |
US20030055633A1 (en) | Method and device for coding speech in analysis-by-synthesis speech coders | |
US20040210440A1 (en) | Efficient implementation for joint optimization of excitation and model parameters with a general excitation function | |
US20030097267A1 (en) | Complete optimization of model parameters in parametric speech coders | |
US7236928B2 (en) | Joint optimization of speech excitation and filter parameters | |
JPH0782360B2 (en) | Speech analysis and synthesis method | |
US7389226B2 (en) | Optimized windows and methods therefore for gradient-descent based window optimization for linear prediction analysis in the ITU-T G.723.1 speech coding standard | |
US20040083096A1 (en) | Method and apparatus for gradient-descent based window optimization for linear prediction analysis | |
US7512534B2 (en) | Optimized windows and methods therefore for gradient-descent based window optimization for linear prediction analysis in the ITU-T G.723.1 speech coding standard | |
JPS6162100A (en) | Multipulse type encoder/decoder | |
Yuan | The weighted sum of the line spectrum pair for noisy speech | |
JP3984021B2 (en) | Speech / acoustic signal encoding method and electronic apparatus | |
JPH05507796A (en) | Method and apparatus for low-throughput encoding of speech | |
Lashkari et al. | Joint optimization of model and excitation in CELP-type speech coders | |
JPH0242240B2 (en) |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
AS | Assignment |
Owner name: DOCOMO COMMUNICATION LABORATORIES USA, INC., CALIFFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:LASHKARI, KHOSROW;MIKI, TOSHIO;REEL/FRAME:012469/0373Effective date: 20011016 |
|
STCB | Information on status: application discontinuation |
Free format text: ABANDONED -- FAILURE TO RESPOND TO AN OFFICE ACTION |
|
AS | Assignment |
Owner name: GOOGLE INC, CALIFORNIAFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNOR:NTT DOCOMO, INC.;REEL/FRAME:039885/0615Effective date: 20160122 |