CN108337185A - The device and method of scalable traffic shaping with time index data structure - Google Patents
The device and method of scalable traffic shaping with time index data structure Download PDFInfo
- Publication number
- CN108337185A CN108337185A CN201711237582.5A CN201711237582A CN108337185A CN 108337185 A CN108337185 A CN 108337185A CN 201711237582 A CN201711237582 A CN 201711237582A CN 108337185 A CN108337185 A CN 108337185A
- Authority
- CN
- China
- Prior art keywords
- grouping
- time
- network interface
- transmission
- network
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Granted
Links
Classifications
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L47/00—Traffic control in data switching networks
- H04L47/10—Flow control; Congestion control
- H04L47/22—Traffic shaping
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L47/00—Traffic control in data switching networks
- H04L47/10—Flow control; Congestion control
- H04L47/22—Traffic shaping
- H04L47/225—Determination of shaping rate, e.g. using a moving window
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L47/00—Traffic control in data switching networks
- H04L47/10—Flow control; Congestion control
- H04L47/20—Traffic policing
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L69/00—Network arrangements, protocols or services independent of the application payload and not provided for in the other groups of this subclass
- H04L69/16—Implementation or adaptation of Internet protocol [IP], of transmission control protocol [TCP] or of user datagram protocol [UDP]
- H04L69/163—In-band adaptation of TCP data exchange; In-band control procedures
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L47/00—Traffic control in data switching networks
- H04L47/10—Flow control; Congestion control
- H04L47/19—Flow control; Congestion control at layers above the network layer
- H04L47/193—Flow control; Congestion control at layers above the network layer at the transport layer, e.g. TCP related
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L47/00—Traffic control in data switching networks
- H04L47/50—Queue scheduling
- H04L47/56—Queue scheduling implementing delay-aware scheduling
- H04L47/564—Attaching a deadline to packets, e.g. earliest due date first
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04L—TRANSMISSION OF DIGITAL INFORMATION, e.g. TELEGRAPHIC COMMUNICATION
- H04L47/00—Traffic control in data switching networks
- H04L47/50—Queue scheduling
- H04L47/56—Queue scheduling implementing delay-aware scheduling
- H04L47/568—Calendar queues or timing rings
Abstract
This application involves the device and method of the scalable traffic shaping with time index data structure.The system and method for executing rate limit traffic shaping using time index data structure are provided in the network device.The network interface driver of the network equipment can be from the grouping from the packet layer that multiple applications receive network host.Network interface driver can prevent one in applying to send the additional packet being used for transmission, and notice is transmitted until application receives instruction and transmitted the grouping of the packet layer that had previously been transmitted to network host.Network interface driver at least can handle the grouping of reception to determine the transmission time for being each grouped based on rate limit strategy.Network interface driver can store identifier associated with respective packets in the time index data structure at position associated with the transmission time to grouping determination.
Description
Technical field
This application involves the device and method of the scalable traffic shaping with time index data structure.
Background technology
Traffic shaping is the technology that network traffic data is adjusted using various mechanism, with shaping, speed limit, step, preferential
Change or delay is confirmed as more inessential than preferential Business Stream or more undesirable Business Stream or the grouping across All factors being equal, preference will be give to grade
Internet resources distribution is enforced on stream.Mechanism for shaping flow includes being based on strategy, delay, what discarding or label were grouped
Queue spy's shaping algorithm, and the grouping distribution of across different queue fair priorityization dispatching algorithm, between different queue
Match and move the grader of grouping.When in view of the requirement of the expectation network performance for maintaining a large amount of class of traffic or when various
When disposing traffic shaping system in network host framework, it is difficult to scale using the traffic shaping system of these mechanism.
Invention content
According to one side, this disclosure relates to a kind of network equipment.The network equipment includes network interface card, at least one
Processor, memory and network interface driver.The network interface driver is configured as receiving network host from multiple applications
Packet layer at grouping；And prevent one in applying to send the additional packet being used for transmission, until the application receives
The grouping for the packet layer for being previously transmitted to the network host has been transmitted to instruction is transmitted notice.The network connects
The grouping that mouthful drive processes are received with based at least one rate limit strategy come when determining the transmission for being each grouped
Between, and identifier associated with respective packets is stored in time index data structure, and it is determining to the grouping
At position in the associated time index data structure of transmission time.Network interface driver determination has arrived at
The time indexed in the time index data structure, and in response in at position associated with arrival time
The associated grouping of identifier stored in time index data structure.The network interface driver after transmitting the grouping,
Notice will be transmitted and be transmitted back to the application.
According to another aspect, this disclosure relates to a kind of method.This method includes by network interface driver from multiple applications
The grouping at the packet layer of network host is received, and prevents a transmission in applying to be used for transmission by network interface driver
Additional packet, be previously transmitted to the packet layer of the network host until the application receives instruction and transmitted
Grouping is transmitted notice.This method further comprises handling received grouping by scheduler module to be based at least one speed
Rate restriction strategy determines the transmission time for being each grouped；And will identifier associated with respective packets store when
Between in index data structure, and to the position in the associated time index data structure of the determining transmission time of the grouping
Set place.This method further comprises being determined by the scheduler module having arrived to be indexed in the time index data structure
Time, and in response on the network interface driver transmission in time index number associated with arrival time
According to the associated grouping of identifier at the position stored in structure.This method further comprises transmitting in network interface driver
After the grouping, notice will be transmitted and be transmitted back to the application.
Description of the drawings
When taken in conjunction with the following drawings, by reference to detailed description below part, the disclosure will be more fully understood
Above and relevant object, feature and advantage, in the accompanying drawings：
Fig. 1 is the block diagram of the network environment with the network equipment according to some embodiments；
Fig. 2A is the block diagram of example virtual machine environment；
Fig. 2 B are the block diagrams of example container environment；
Fig. 3 is the flow chart for the operation for showing the network equipment according to some embodiments；
Fig. 4 A to Fig. 4 C are the block diagrams for the operation for showing the network equipment according to some embodiments；
Fig. 5 is the flow chart for the operation for showing the network equipment according to some embodiments；
Fig. 6 A-6B are the exemplary block diagrams for the operation for indicating the network equipment according to some embodiments；
Fig. 7 A-7C are the exemplary block diagrams for the operation for indicating the network equipment according to some embodiments；
Fig. 8 is the flow chart for the operation for showing the network equipment according to some embodiments；
Fig. 9 is the flow chart for the operation for showing the network equipment according to some embodiments；
And
Figure 10 is the block diagram of exemplary computing system.
Specific implementation mode
Traffic shaping system should be designed to efficient memory use and primary processor power consumption, while manage such as
More advanced congestion control in transmission control protocol (TCP).For example, delay, step or rate limit grouping are to avoid burst
Or Internet resources may be implemented for the traffic shaping system of unnecessary transmission delay and the higher of host processing resources utilizes.Grouping
Delay mechanism can reduce the needs to large capacity core buffer.For example, when grouping is delayed by, feedback mechanism can apply
" back-pressure ", that is, send and feed back to sending module (for example, component software of equipment or such as software application), so as to sending module
Reduce the rate that grouping is sent at it.There is no packetization delay mechanism, application will continue to generate grouping, and be grouped and can be buffered
Or abandon, to spend additional memory and host processor power to carry out queue or regenerate grouping.
Present equipment related with usage time index data structure and the delay scalable traffic shaping of completion mechanism
And method.In some embodiments, the network interface driver of the network equipment is configured as receiving network master from multiple applications
Grouping at the TCP layer of machine.The grouping received is originated from the computing device, for example, by one of computing device trustship or
The application executed on multiple virtual machines or containerization performing environment.Network interface driver can prevent from being used for transmission using transmission
Additional packet, until application receives the message for confirming that the grouping that had previously forwarded has been successfully delivered.For example, network interface
Driver before additional data packet is forwarded to network interface driver, by grouping be transmitted messaging to etc. it is waiting
Contracture group is transmitted the software application or client operating system of message.As described herein, in some embodiments, network connects
The grouping that mouth drive processes receive based at least one rate limit strategy to determine the transmission time for being each grouped.
For example, rate limit strategy may include speed adjust strategy or targeted rate limitation.Additionally or alternatively, rate limit
Strategy may include the rate of polymerization of specific policy associated with the certain kinds of grouping or the certain kinds for grouping.At some
In embodiment, network interface driver, will identifier storage associated with respective packets based on received grouping is handled
In the time index data structure at position associated with the transmission time determined to respective packets.Time index data knot
Structure may include the queue based on the single time, such as timing wheel or calendar queue data structure, to be covered from multiple queues or TCP
It connects word and receives identifier associated with grouping.Packet identifier can be inserted into and extracted based on identified transmission time.
In some embodiments, network interface driver or network interface card can be determined and be had arrived in single time index queue
The time of index, and in response, be transmitted in the time index data structure at position associated with arrival time and deposit
The associated grouping of identifier of storage.For example, network interface driver or network interface card can determine and have arrived at time t0,
Therefore, network interface driver and/or network interface card make and specified t0The associated grouping of identifier of transmission time is by net
The network interface card of network equipment is transmitted.In some embodiments, after network interface card transmission grouping, network interface
Driver can notify to be transmitted back to the application for initiating transmission packe by being transmitted.
By the host process power consumption during reducing packet transaction and transmission, single queue shaping is capable of providing than more queue systems
It unites higher CPU efficiency.Single queue orthopedic systems can also packet-based transmission strategy, realize the more acurrate rate limit of grouping
System and schedulability.For example, using based on the single time queue or calendar queue, can utilize by grouping generate application create
Packet time stamp, with the combination based on rate limit associated with grouping, step rate, and/or bandwidth sharing strategy come
Dispatch best packet transmission time.
The network equipment discussed herein and method can be each by being based on rate policy or scheduling strategy timestamp label
It is grouped to realize the scalable traffic shaping being often grouped.In some embodiments, grouping is at least initially by originating answering for grouping
With carrying out timestamp label.It is marked by being stabbed to packet time at source, that is, by generating the application of grouping, can mitigate pair
The demand of pre-filtering grouping.Need that pre-filtered device and method can introduce expensive processing requirement or specific hardware is matched
It sets, multiple queues is such as required to carry out timestamp label to grouping according to one or more rate limit strategies.Therefore, in conjunction with source
The embodiment of timestamp can reduce processing time and resource used in these device and method.
The network equipment and method can according to timestamp, by by it is in single time index data structure, with grouping phase
Associated packet identifier queue further realizes the scalable traffic shaping of every grouping.It is realized when using specific transmission rule
When, the number with minimum processing expense can be supported with the embodiment of single time index data structure with this method
Stream of packets in terms of ten thousand.It is avoided having than current time for example, effective single time index data structure can be configured as,
Such as " present " is earlier or the packet queue of past timestamp, because these groupings should be immediately transmitted.Additionally or
Alternatively, efficient single time index data structure can be configured as including maximum time range, when exceeding the maximum
Between should not dispatch grouping except range.The replacement of effective single time index data structure configured with maximum time range
Embodiment may further include rate limit strategy, according to the grouping number of transmission, specify minimum supporting rate (example
Such as, the maximum support time between grouping) or maximum holding load.Additionally or alternatively, effective single time index
The embodiment of data structure may include the frequency for limiting network stack and being interacted with time index data structure, thus define the time
The granularity of index data structure.
In some embodiments, the network equipment and method are further by when the transmission identified in timestamp ends
Between pass by and to make newly to be grouped the grouping source that can be transmitted be sent completely message when, so that the grouping is gone out team as quickly as possible
To realize the scalable traffic shaping being each grouped.In traditional system, press from transmission queue, for example, first in first out
(FIFO) the order processing grouping of queue, and return complete in order.In some embodiments of the disclosure, the network equipment
It can postpone transmission (being grouped without abandoning) by removing some packets from transmission queue with method, make to complete message
Disorderly return.By the configuration of " unordered completion ", because using more packets are not retransmited, it is used for until receiving
Through being transmitted to the completion message of the packet of network interface driver, thus can mandatory use reduce its transmission rate.This
Kind configuration can prevent delayed data packet, avoid hol blocking by still having in the queue.In addition, in some implementations
In mode, " unordered " should complete configuration can be applied to apply in packet individual flows (flows) (or stream
(streams) or class), for example, being that corresponding flow or stream are opened with the application that largely connects, enabling selectively
Slow down or accelerate each flow.
In addition, in some embodiments, " unordered " completion configuration can apply " back-pressure " to sending module or application, and
Will not team head obstruction, with how many main transmission queue or be grouped how to be put into it is unrelated in each queue, as long as disorderly
It returns and completes message.In some embodiments, there is " unordered " traffic shaping mechanism for completing configuration can utilize spy
Network/hardware configuration (for example, given number and particular queue allocation rule of main transmission queue) is determined to realize.For example, in order to
Flow/stream of the thousands of a business of shaping only can realize stream with single queue or a small amount of queue (for example, 16-32 queue)
Measure shaping mechanism.When being realized in the system with a small amount of queue, traffic shaping mechanism, which can return, gives scheduled queue
Allocation rule and whether each grouping is put into " unordered " completion message in correct queue, or in queue " randomly "
Expanded packet flow.For example, can be realized in virtual machine for shaping in several hardware queues, extended from linux system
Packet Service " unordered " completion traffic shaping system, without change network/hardware configuration (for example, the team of linux system
The number of row allocation rule or hardware queue).In some embodiments, traffic shaping system can by from application or user
Traffic shaping layer, flow classification rule and strategy are hidden to provide this network/hardware compatibility.
The network equipment and the configuration of associated network interface driver may be implemented as having single scheduler and single time
Index data structure, or with the multiple schedulers and multiple time index data for using identical or different traffic shaping strategy
Structure.
In the above-described embodiment, it is grouped source, such as on the true OS of the network equipment (rather than in the visitor of virtual machine
On OS) operation software application or do not needed by the software application of the TCP stack in the visitor OS of management program management or upper layer
Know the traffic shaping strategy or algorithm realized on network interface driver or network interface card.Therefore, it is possible to reduce in void
The cost of network interface driver and guest operating system is realized in quasi- machine environment.In addition, grouping source also needs not know about other match
Parameter is set, for example, packet classification rule and other rate limit strategies.Therefore, traffic shaping can be with wherein than applying or using
Family configures these detailed algorithms mode more reliable with the method for strategy to execute.
Fig. 1 is the block diagram of the example network environment 100 with the network equipment 110.Generally, illustrated network environment
100 include the network 700 of the network node 750 of interconnection.Network node 750 participates in network 700, as data source, data purpose
Intermediate node ground (or data sink) and propagated data from source towards destination by network 700.Network 700 includes
With the network equipment 110 to various other links 600 for participating in network node 750.Referring more particularly to Fig. 1, network 700 is
Promote the network of the interaction between participation equipment.Illustrated examples network 700 is internet；However, in other embodiments,
Network 700 can be another network, the local network, network structure in such as data center or any other local area and wide area
Net.Network 700 can be made of the sub-network or autonomous networks of multiple connections.Network 700 can be LAN (LAN), such as
The internet or peer-to-peer network of corporate Intranet, Metropolitan Area Network (MAN) (MAN), wide area network (WAN), such as internet, such as self-organizing
WiFi peer-to-peer networks.The data network and/or communication network of any types and/or form can be used for network 700.Its energy
Enough it is the combination of public, privately owned or public network and private network.Usually, network 700 is used for for example in network section
Information is transmitted between the computing device of point 750, and the network equipment 110 of data flow reshaping system promotes to be somebody's turn to do according to its configuration
Communication.
As shown in Figure 1, the network equipment 110 is the one or more application that trustship executes on real system (OS)
The server of 150a-150c (typically applying 150).It is that in other embodiments, network is set as discussed further below
Standby can be that trustship is carrying out using 150 virtual machine or the server of container.The network equipment 110 drives including network interface
Device 120, memory 115, network interface card 140, true OS 220 and apply 150.Network interface driver 120 can include adjusting
Device 125, timing wheel data structure 130 are spent, and includes transponder 135 (shown in dotted line) in some embodiments.One
In a little embodiments, the network equipment 110 has the configuration similar with the configuration of computing system 1010 shown in Fig. 10.For example, depositing
Reservoir 115 can have the configuration similar with the configuration of memory shown in Figure 10 1070, and network interface card 140 can
With the configuration similar with the configuration of network interface card 1022 or network interface controller 1020 as shown in Figure 10.Below
In, with reference to figure 10, computing system 1010 is described more particularly below.Element shown in the computing system 1010 illustrated in Figure 10
Need not all exist in some embodiments of Fig. 1 network equipments 110 illustrated.
Referring again to Fig. 1, in some embodiments, 110 trustship one or more application 150 of the network equipment (such as using
150a, 150b and 150c).Can be the real system in the network equipment 110 using one or more of 150a-150c
The software application of upper operation.It is discussed as further related to Fig. 2A and 2B, in some embodiments, software application
One or more of 150a-150c can be run in the visitor OS by the management program management in virtual machine environment it is soft
The upper layer of the protocol stack (for example, TCP stack) of the visitor OS of part application or virtual machine environment.For example, with reference to figure 2A, using 150a-
150c can be individually the software application 230 run on true OS 220, in the virtual machine 1 managed by management program 250
The protocol stack 261 of the visitor OS 260 of virtual machine 1 in the software application 265 or Fig. 2A that are run on visitor OS260 it is upper
Layer.Hereinafter, with reference to figure 2A, management program 250 and relative virtual machine environment is more fully described.
Referring again to Fig. 1, in some embodiments, the network equipment 110 includes memory 115.In some embodiments,
The storage of memory 115 is via true OS 220, and the grouping received from application 150 is so that network interface card 140 transmits.In some realities
Apply in mode, memory 115 can store will execute on a processor transport protocol module 145 (such as Transmission Control Protocol module or
The TCP layer of network stack) computer executable instructions.In some other embodiments, memory 115 can store network and connect
The computer executable instructions of mouth driver 120.Additionally or alternatively, memory 115 can be stored by 125 profit of scheduler
Rate-limiting algorithm, rate limit strategy or computer executable instructions.In some embodiments, memory 115 can
To store flow or class phase with grouping being transmitted via the network equipment 110 and/or being scheduled for future transmission
Associated statistics or measurement.For example, memory 115 can store statistics or measurement, such as in the every class for limiting application rate
The previous and upcoming transmission time and historic transmission rate of grouping in grouping.Statistical data can also include currently existing
The number of grouping in timing wheel associated with each class 130 (being discussed further below).Memory 115 can store and net
The operation and use related data and/or instruction of network interface driver 120.Memory 115 may include such as arbitrary access
Memory (RAM), dynamic random access memory (DRAM), static RAM (SRAM), synchronous dynamic random are deposited
Access to memory (SDRAM), ferroelectric RAM (FRAM), read-only memory (ROM), programmable read only memory
(PROM), Erasable Programmable Read Only Memory EPROM (EPROM), electrically erasable programmable read-only memory (EEPROM), and/or sudden strain of a muscle
It deposits.In some embodiments, memory 115 stores computer executable instructions, is executed when by network interface driver 120
When, so that network interface driver 120 is at least executed processing stage 330,340 and 350 shown in Fig. 3, this is retouched further below
It states.
Network interface driver 120 can include the network interface driver software module run on true OS.Such as
The network interface driver of network interface driver 120 can be the computer executable instructions stored in memory 115
Set, when being executed by a processor, makes the function being discussed herein below be achieved.In some other implementations, network interface
Driver 120 may be implemented as the logic components realized in hardware processor or other integrated circuits, or be implemented as hard
The combination of part logic components and software logic part.Network interface driver 120 can be directly (if in the true of the network equipment 110
If being operated on real OS 220), via the visitor OS of virtual machine (or in some embodiments, pass through management program and visitor
OS), or via containerization environment container manager, with one in software application 150a-150c (for example, answering in Fig. 2A
With 265) communication.In some embodiments, network interface driver 120 is included in the biography of the true OS of the network equipment 110
Transport control protocol is discussed in the first layer of (TCP) stack, and with the software module or application communication that are included in the upper layer of TCP stack.
In one example, network interface driver 120 is included in the transport layer of TCP stack, and be included in answering for TCP stack
With the software module or application communication in layer.In another example, network interface driver 120 is included in the link of TCP stack
It is communicated in layer and with the TCP/IP modules in the internet/transport layer for being included in TCP stack.In some embodiments, should
Function additionally or is alternatively configured as from another network or such as User Datagram Protocol (UDP) module, reliable number
According to datagram protocol (RDP) module, Reliable User Datagram Protocol (RUDP) module or datagram congestion control protocol (DCCP) module
Transport layer protocol module receive grouping.In some other implementations, network interface driver 120 can be included as net
The part of network interface card 140.
As described above, network interface driver 120 includes scheduler 125.Such as scheduler of scheduler 125 can be example
The set of the computer executable instructions such as stored in memory 115 makes the function being discussed herein below when being executed by a processor
It is achieved.In some other implementations, scheduler 125 may be implemented as in hardware processor or other integrated circuits
The logic components of middle realization, or it is implemented as the combination of hardware logic part and software logic part.In some embodiments, it dispatches
Device 125 is utilized to manage the sequence for the packet identifier being inserted into timing wheel data structure 130 and from its extraction.It is attached
Add ground or alternatively, known, the existing network scheduling that can be used for different operating system kernel may be implemented in scheduler 125
Algorithm.In some embodiments, customization, user-defined dispatching algorithm may be implemented in scheduler 125.For example, scheduler
125 may include the rate limit policing algorithm for the timestamp that can calculate the grouping for being received.In some embodiments
In, weighted fair queuing algorithm may be implemented to ensure multiple stream of packets according to them in min-max justice point in scheduler 125
Bandwidth is proportionally shared with the weight in scheme.Additionally or alternatively, scheduler 125 can merge timestamp so that
Larger timestamp indicates smaller target transmission speed.In some embodiments, scheduler 125 can be stored and/or be examined
Rate limit dispatching algorithm of the rope from memory 115.Additionally or alternatively, scheduler 125 can be assessed and be connect by network
Grouping that mouthful driver 120 receives and packet identifier is stored in timing wheel data structure 130.In some embodiments
In, scheduler 125 can assess received grouped data, to determine that transmission time associated with the grouping received is stabbed.
Additionally or alternatively, scheduler 125 can determine for application received, with by originating grouping, virtual machine,
Or the updated transmission time stamp of the grouping of the timestamp of container application, and can be by the newer transmission time stamp application of institute
To packet identifier.In some embodiments, scheduler 125 can indicate timing wheel data structure 130 will have transmission
The packet identifier of timestamp is stored at the appropriate time slot in timing wheel data structure 130.Additionally or alternatively, scheduler
125 can indicate timing wheel 130 when having arrived at transmission time, to extract stored packet identifier, it may for example comprise pass
The packet identifier of defeated timestamp.Hereinafter, with reference to figure 4A-4C, scheduler 125 is more fully described.
As described above and as shown in Figure 1, network interface driver 120 (is also defined as including timing wheel data structure 130
Timing wheel 130).Timing wheel data structure is can be implemented as the time index queue of cyclic buffer, in O (1)
Specified time at queue object, and extract pending object at the specific time in O (1).According to by algorithm performs
The number of elementary operation, the time complexity of algorithm for estimating.The estimation can be indicated in the form of O (n).For example, if fortune
The value T (n) of row time is limited by the value for being not dependent on the size of input, then algorithm can have the constant time (for example, O
(n), wherein n=1).As described above, because only one operation must be performed to position the element, timing wheel number is accessed
The regular hour (for example, O (1)) is needed according to the individual element (for example, packet identifier) in structure.In some embodiments
In, the packet identifier provided by scheduler 125 can be stored in and the application by generating grouping by timing wheel data structure 130
During 150 specified timestamps are associated or the time slot that is stabbed according to the newer transmission time of institute determined by scheduler 125.Under
Timing wheel data structure 130 is more fully described with reference to figure 4A-4C in Wen Zhong.In some other implementations, instead of timing
Wheel, the time index data structure of generating heat different using such as calendar queue dispatch the transmission of grouping.
As further shown in Fig. 1, network interface driver 140 can also include transponder 135 (shown in dotted line).
Such as transponder of transponder 135 can be the set of the computer executable instructions for example stored in memory 115, when by
When processor executes, the function being discussed herein below is made to be achieved.In some embodiments, transponder 135 may be implemented as
The logic components realized in hardware processor or other integrated circuits, or it is implemented as hardware logic part and software logic part
Combination.Transponder 135 is configured as inquiry timing wheel 130 to determine whether to have arrived at the time indexed in timing wheel 130, and
And based on the transmission time for having arrived at them and being indexed in timing wheel 130 is determined, grouping mark appropriate is extracted from timing wheel 130
Know symbol.Transponder 135 can be executed instruction to be used for transmission with forwarding the packet to network interface card 140.In some embodiments
In, transponder 135 can be included in network interface driver 120.In some embodiments, the further institute of following article
It states, the function of transponder 135 or transponder 135 can be incorporated into scheduler 125.
Network interface card 140 includes being configured as sending and receiving the hardware of communication to and fro with network node 750.One
In a little embodiments, network interface card 140 can as needed support high-speed data to receive and transmit, for example, in data
Frame rate is close in the optical-fibre channel of 100 gigabit per second.In some embodiments, network interface card 140 can be configured
For example to support relatively low speed communication on copper (or other metals) line, wireless channel or other communication medias.
Be happened at as described above function in the TCP layer of the network equipment can additionally or alternatively transport layer,
It is executed in another network protocol module in network layer or combination of transmitted/network layer of network protocol stack.For example, can be in user
Datagram protocol (UDP) module, reliability datagram protocol (RDP) module, Reliable User Datagram Protocol (RUDP) module or number
The function is realized according to reporting in Congestion control protocol (DCCP) module.It is network layer, transport layer or combination as used herein
Transmission/network layer by the packet layer of commonly known as network protocol stack.
Fig. 2A shows to realize the block diagram of the example server 200a of virtual machine environment.In some embodiments, server
200a includes hardware 210, the real system run on hardware 210 (OS) 220, management program 250 and has visitor
Two virtual machines of operating system (visitor OS) 260 and 270.Hardware 210 can include the network interface card in addition to other assemblies
(NIC)215.Hardware 210 can have the configuration similar with the configuration of computing system shown in Figure 10 1010.Hardware 210
NIC 215 can be similar with network interface controller 1020 shown in Figure 10 or the configuration of network interface card 1022 configuration.One
In a little embodiments, true OS 220 has protocol stack 225 (for example, TCP stack) or transport protocol module 145 as shown in Figure 1.
In some embodiments, true OS 220 includes the software application run on true OS 220.In some embodiments,
Visitor OS 260 and 270 respectively includes protocol stack 261 and 271.Each of visitor OS 260 and 270 can trustship be various answers
With for example, software application 265,266,275 and 276.Server 200a can be file server, application server, web clothes
Be engaged in device, proxy server, instrument, structure of network instrument, gateway, gateway server, virtualized server, deployment services device, SSL VPN
Server or fire wall.
Referring again to Fig. 2A, server 200a executive supervisors 250 are instantiated and are managed in virtual machine 1 and void respectively
The first visitor OS 260 and the second visitor OS 270 on quasi- machine 2.260 trustships of the first visitor OS configured on virtual machine 1
One software application 265 and the second software application 266.270 trustship third softwares of the second visitor OS in the configuration of virtual machine 2 are answered
With 275 and the 4th software application 276.For example, using can include database server, data warehouse program, stock market transaction it is soft
Part, Web bank application, content publication and management system, the video-game of trustship, the desktop of trustship, e-mail server,
Travel reservation system, customer relation management application, storage controlling management database and ERP System.In some realities
It applies in mode, the other kinds of application of visitor's OS trustships.Hereinafter, the component of server 200a is further described in conjunction with Fig. 3
Between interaction.
Fig. 2 B show to realize the block diagram of the example server 200b of containerization environment.In some embodiments, server
200b includes hardware 210, the real system run on hardware 210 (OS) 220, container manager 240, executes answer respectively
With 241 and 242 two containerization environment (for example, container 1 and container 2).Hardware 210 can include the net in addition to other assemblies
Network interface card (NIC) 215 etc..Hardware 210 can have and the configuration of computing system 1010 as shown in Figure 10 is similar matches
It sets.The NIC 215 of hardware 210 can have to be matched with network interface controller 1020 shown in Fig. 10 or network interface card 1022
Set similar configuration.In some embodiments, true OS 220 is with protocol stack 225 (for example, TCP stack) and with true
The software application run on real OS 220.Each of these containers (such as container 1 and container 2) can the various applications of trustship,
Such as software application 241 and 242.Server 200b can be file server, application server, web server, agency service
Device, instrument, structure of network instrument, gateway, gateway server, virtualized server, deployment services device, SSL vpn servers or fire prevention
Wall.
The container manager 240 for instantiating and managing container 1 and container 2 respectively is executed referring again to Fig. 2 B, server 200b.
1 Hosted Software of container applies 241.2 Hosted Software of container applies 242.For example, using that can include database server, data
Warehouse procedures, stock market's transaction software, Web bank application, content publication and management system, trustship video-game, trustship desktop,
E-mail server, travel reservation system, customer relation management application, storage controlling management database and corporate resources pipe
Reason system.In some embodiments, container (for example, container 1 or container 2) can be with the other kinds of application of trustship.Below
In, the interaction between the component of server 200b is further described in conjunction with Fig. 3.
Fig. 3 is for using the exemplary method 300 by the network equipment execution of the network equipment 110 such as shown in FIG. 1 whole
The flow chart of l network flow.Method 300 is included at the TCP layer of network host, and grouping (stage 310) is received from multiple applications
And it prevents one in applying to send the additional packet being used for transmission, the notice (stage is transmitted until the application receives
320).This method further comprises handling received grouping to determine the transmission time (stage 330) for being each grouped, and
And identifier associated with each respective packets in time index data structure is stored in time index data structure
Time index data structure associated with the transmission time determined to the grouping in position at (stage 340).Method 300
Further include determining the time (stage 350) having arrived at, being indexed in time index data structure, and drive in network interface
Transmission is associated with the identifier stored in the time index data structure at institute's arrival time associated position on dynamic device
Grouping (stage 360).This method further comprises that will be transmitted notice is transmitted to application (stage 370).
Method 300, which is included at the TCP layer of network host from multiple applications, receives grouping (stage 310).In some implementations
In mode, the multiple applications for generating grouping can be the application of the trustship in virtualizing machine environment, the application in such as Fig. 2A
265, any in 266,275 or 276.Additionally or alternatively, the grouping received can be by answering in such as Fig. 2A
It is generated with the application executed on the true OS of 230 network host.In some embodiments, as shown in Figure 2 B, using can be with
It is included in the environment of containerization, such as using 241 or 242.Additionally or alternatively, the TCP layer for receiving grouping can be with
It is the upper-layer protocol stack of the visitor OS in virtual machine environment.
Method 300 further includes that one in preventing from applying sends the additional packet being used for transmission, until application receives biography
Defeated completion notice (stage 320).In some embodiments, traffic shaping can partially by rate limit by application will be attached
The message that addend has been completed according to TCP layer is forwarded a packet to, until receiving instruction grouping transmission, to realize.For example, network
Interface card 140 (as shown in fig. 1, and described in more detail in Fig. 6 A-6B later) can generate back to using 150 it is complete
At notice, notice instruction grouping is in transmission over networks.This is transmitted notice and provides feedback mechanism to the application, and
Limitation forwards additional packet from application 150 to TCP layer.This mechanism can be with the existing TCP functions of the small-sized queues of such as TCP
It is used in combination, the small-sized queues of the TCP are used as effectively limiting the byte number that can not be completed between transmitting terminal and receiving terminal.
As further shown in figure 3, the grouping received is processed to determine the transmission time (stage for each grouping
330).In some embodiments, scheduler 125 can based on the rate-limiting algorithm that is stored in memory 115 or strategy come
The grouping of processing received data is to determine the transmission time for being each grouped.For example, scheduler 125 can according to grouping
The associated rate-limiting algorithm of certain kinds or strategy processing be grouped and apply transmission time stamp.In some embodiments
In, scheduler 125 is configured as based on speed adjust strategy or targeted rate limitation come when determining the transmission for being each grouped
Between.For example, scheduler 125 can based on be such as grouped the speed adjust strategy of class rate policy and/or rate of polymerization strategy come
Determine the transmission time being each grouped.In some embodiments, scheduler 125 can be based on such as weighted fair queuing policy
Speed adjust strategy determine transmission time to handle multiple stream of packets.Additionally or alternatively, each grouping can have
There is the transmission time of the application request by generating the grouping to stab.In some embodiments, scheduler 125 can be received including asking
Ask the grouping of transmission time, the request transmission time be grouped in be received at TCP layer before and scheduled 125 processing of device
Preceding one by multiple applications distributes to the grouping.Scheduler 125 can handle grouping substantially in real time, to determine base
Exceed in the newer transmission time of institute of at least one rate limit strategy and calls rate limit associated with the grouping
Algorithm.For example, if the grouping received is handled and scheduler 125 determines that the transmission time for grouping will be more than to be used for
It is grouped the rate limit of class, then scheduler 125 can utilize the transmission for enabling to be grouped in the adjustment being transmitted at the time later
Timestamp updates the transmission time, and avoiding exceeding the rate defined by the rate limit strategy to be directed to specific cluster class limits
System.Scheduler 125 can be configured as via the Hash table for identifying associated with the grouping received rate-limiting algorithm or
It maps to find associated rate-limiting algorithm.
Method 300 further comprises the network equipment 110, the network equipment 110 by with the phase in time index data structure
The time index number that associated identifier is stored at position associated with the transmission time determined to the grouping should be grouped
According to (stage 340) in structure.The time index data structure of such as time index data structure 130 can be configured as including with
Store multiple positions or the time slot of data or event.Time index data structure includes time range, which is can be with
Store the maximum time period in the future of data or event.For example, when time index data structure can be configured as including 50
Gap, wherein each time slot indicates the minimum time granularity between two events.If including the time index data of 50 time slots
Structure is configured such that each time slot represents the granularity of 2 microseconds, then time range will be 100 microseconds.In this example, do not have
Any data or event will be scheduled in after 100 microseconds in future.Reasonable time scope and time wheel granularity (for example,
The number of time slot) it can be configured based on rate limit strategy to be enforced.For example, in order to enforce 1,000,000 ratio per second
The rate of special (Mb), reasonable time range will be 12 milliseconds.It can be for the suitable plurality of time slot of timing wheel 130 or position
In the range of 10-1,000,000 time slot or position.Reasonable time range for timing wheel 130 can be arrived in several microseconds
In the range of several seconds.In some embodiments, one or more timing wheels can be hierarchically implemented, and one or more
Each of timing wheel can be configured as different numbers and different timing wheel granularities with time slot.In this example, one
Each of a or multiple layering timing wheels can have different time ranges.In some embodiments, packet identifier
It can be stabbed with the transmission time adjusted determined using requested timestamp or by scheduler 125 by generating grouping opposite
It answers.For example, grouping may include the identifier that can specify the requested transmission time from 10 seconds current time.Scheduler
125 can handle grouping based on rate limit strategy associated with the certain kinds of grouping, to determine that transmission grouping immediately is
It is no to exceed rate limit.Assuming that be not above rate limit, then scheduler 125 packet identifier can be inserted into
In time index data structure 130 at the associated position of transmission time of following 10 microseconds.In some embodiments, such as
It is zero (for example, transmission time is present) or less than present any value that all groupings of fruit, which have timestamp, then time index
Data structure may be used as first in first out (FIFO) queue.For example, the packet identifier with zero timestamp will be passed immediately
It is defeated.Additionally or alternatively, when being inserted into minimum with all packet identifiers than timestamp now earlier
Between data structure location in, therefore they can be immediately transmitted.With the time range beyond time index data structure
Timestamp the rearmost position that is inserted into data structure of any packet identifier (for example, indicating maximum time range
Position) in.
Method 300 further includes that determination has arrived at the time (stage 350) indexed in time index data structure.At some
In embodiment, network interface driver 120 can determine point for having reached and being stored in time index data structure 130
The group identifier associated specific transmission time.Network interface driver 120 can utilize current time query time index number
According to structure 130, to determine whether there is any grouping to be sent.For example, network interface driver 120 can use currently
The cpu clock time (or such as regularly some other reference time value of incrementing integers value) inquires data structure.Frequently
Numerous poll can provide the bigger consistency of packet scheduling and rate limit strategy, and cause significantly with using due to interruption
The individual timer of CPU overhead, which is compared, can reduce expense.In some embodiments, time index data structure 130 can
To be realized in dedicated cpu core.Additionally or alternatively, time index data structure 130 can be held with constant interval
The poll of row data structure is realized in the system based on interruption to determine block transmission dispatching.For example, can utilize be equal to
Time index data structure 130 is periodically polled in the period of each time slot or the associated time span of its multiple.One
In a little embodiments, the poll of timing wheel can pass through the logic components different from scheduler 125, all forwardings as shown in Figure 1
Device 135 executes.
As further shown in figure 3, the network equipment 110 transmits on network interface card 140 associated with arrival time
The associated grouping (stage 360) of identifier stored in time index data structure at position.In some embodiments,
Network interface driver 120 can be based on reaching the packet identification of the storage of (or passing through) in time index data structure 130
The grouping stored in memory 115 is transferred to network interface card 140 by the transmission time identified in symbol.For example, network interface
Driver 120 can be with poll time index data structure 130, and can determine to have reached and be identified in packet identifier
Transmission time.In response, network interface driver 120 can indicate that the network equipment makes the grouping from memory 115 go out team,
And the grouping can be transmitted via network interface card 140.In some embodiments, network interface driver 120 can be known
Not than transmission time now earlier, and in response, the grouping is transmitted immediately.
Method 300 includes that will be transmitted notice to send back application (stage 370).It is successfully passed by network interface card 140
After defeated grouping, completion notice can be sent back the application 150 for originating grouping by network interface driver 120.Completion notice allows
Using 150 additional packet is sent to network interface driver 120.Be more fully described below with reference to Fig. 6 A-6B be transmitted it is logical
Know mechanism.
As the function of occurring in the TCP layer of the network equipment above additionally or can be assisted alternatively in network
It discusses and is executed in another network protocol module in the transport layer, network layer or combination of transmitted/network layer of stack.For example, can with
User data datagram protocol (UDP) module, reliability datagram protocol (RDP) module, Reliable User Datagram Protocol (RUDP) module or
The function is realized in datagram congestion control protocol (DCCP) module.
Fig. 4 A- Fig. 4 C are the schedulers and time index indicated using being executed by the network equipment of such as network equipment 110
Data structure carrys out the block diagram of the exemplary operations of shaping network traffic.Generally, as shown in Figure 4 A, the network equipment 110 is from application
150 (for example, using 150a, 150b and 150c) receive packet.The network equipment 110 includes that one or more sockets buffer
Device 405,410 and 415, the grouping received from application 150 with queue and processing.The network equipment 110 further comprises for storing
The rate-limiting algorithm or strategy that one or more memory devices 115 of instruction and data, basis store in memory 115
Handle the scheduler 125 of grouping.The network equipment 110 further comprises time index data structure 130, also referred to as timing wheel
130, to store packet identifier according to its transmission time.The network equipment 110 further includes the one or more with transmission packe
Network interface card 140.
With reference to figure 4A and Fig. 3, the network equipment 110 is at its TCP layer, from multiple applications 150 (for example, using 150a, 150b
Or 150c) receive grouping.As shown in Figure 4 A, the TCP layer of the network equipment 110 includes three socket word buffer (405,410 and
415), each to apply one.For example purpose, it is assumed that queue and processing come self-application 150a's in being socketed word buffer 405
Grouping queue and handles the grouping for carrying out self-application 150b, and in being socketed word buffer 415 in be socketed word buffer 410
Queue and processing carry out the grouping of self-application 150c.In some embodiments, the network equipment 110 can have processing from multiple
One or more socket word buffers of the grouping of application.The network equipment 110 can be configured as to be held from virtual machine environment, container
The combination of row environment or real system, virtual machine and/or container performing environment is received from the network equipment 110
The grouping of the application executed on real system.
As shown in Figure 4 A, the grouping for carrying out self-application 150a is buffered with the sequence order of its transmission by socket by application 150a
Device 405 receives.For example, grouping A1 is initial or the first grouping transmitted from application 150a, and start via scheduler 125
Processing.It is grouped A2, A3, A4 and A5 and still has queue in being socketed word buffer 405.Similarly, it generates and is grouped using 150b
And transmit the packet to socket word buffer 410.For example, grouping B1, B2, B3, B4 and B5 are indicated by application 150b transmission
The sequence order (for example, B1 is the first grouping) of grouping, and it still has queue with by adjusting in being socketed word buffer 410
Spend what device 125 was handled.Similarly, grouping C1, C2, C3, C4 and C5 indicates the sequence order (example of the grouping by application 150c transmission
Such as, C1 is the first grouping), and there are still queues to be handled by scheduler 125 in being socketed word buffer 415.At some
It in embodiment, and is discussed in more detail with reference to figure 6A- Fig. 6 B, prevents from sending the additional packet being used for transmission using 150, directly
It is received to application and is transmitted notice (as shown in the stage 320 of Fig. 3).
As further shown in the stage 330 of Fig. 4 A and Fig. 3, scheduler 125 handles the grouping of queue to determine for each
The transmission time of grouping.Scheduler 125 can be come sequentially with queue order, random order or some other scheduled order
Handle the grouping from one or more socket word buffers.Scheduler 125 can be by identifying rate associated with grouping
Limit algorithm or strategy and to grouping distribution is initial or newer transmission time determines the grouping for each being received
Transmission time.What scheduler 125 can be used to each be received from 115 retrieval rate limit algorithm of memory or strategy with determination
The initial or newer transmission time of grouping.The grouping of reception can be scheduled device 125 be identified to belong to grouping certain kinds.It is special
Determine the grouping in class to may require and the relevant specific rate-limiting algorithm of grouping class or strategy.Scheduler 125 can utilize
Specific rate-limiting algorithm or strategy determine the initial or newer transmission time being grouped for each of such.At some
In embodiment, scheduler 125 can be assessed by applying 150 requested grouping transmission times, and determine requested biography
Whether the defeated time is more than rate-limiting algorithm associated with grouping class or strategy (for example, giving other points transmitted recently
Group transmission history or in such to the grouping of future transmission planned dispatching in the case of, transmission rate is at request time
It is no to cause the transmission rate for the grouping class too high).Scheduler 125 can handle grouping and determine by 150 request of application
Transmission time violate and be grouped the associated rate limit of class or strategy.If exceeding or violating rate limit or strategy,
Scheduler 125 can be directed to each grouping and determine the newer transmission time for being no more than or not violating rate limit or strategy.It adjusts
Degree device 125 can determine that requested or newer transmission time is current time and can execute instruction to be grouped immediately
It is transmitted to the network interface card 140 being used for transmission.
As shown in Figure 4 A, associated with each grouping identifier is stored in and is determined to the grouping by scheduler 125
In time index data structure (for example, timing wheel) 130 at the associated position of transmission time (stage 340 of Fig. 3).Periodically
Wheel 130 can store and extract the time index of packet identifier based on the identified transmission time of associated packets
Data structure or queue.In some embodiments, each time slot storage single data element or event in timing wheel 130
(for example, packet identifier associated with grouping).In some embodiments, each time slot can store multiple data elements
Or event.Timing wheel 130 can include the multiple time slots being pre-configured or position, and each time slot or position can represent it is specific
Incremental time.In some embodiments, can the change level based on data traffic and congestion at the network equipment 110 come
Dynamically adjust the number of time slot or position.Timing wheel 130 can include any number of time slot or position, and each time slot is fixed on demand
Justice waits for the portfolio of shaping suitably to handle.The summation of all time slots or position in timing wheel 130 indicates 130 energy of timing wheel
The time range or forwarding queue time frame enough supported.Reasonable time scope and time wheel granularity (for example, number of time slot)
It can be configured based on rate limit strategy to be performed.For example, to implement the rate of 1 megabit (Mb) per second, when appropriate
Between range will be 12 milliseconds.The suitable plurality of time slot of timing wheel 130 or position can be in 10-1,000,000 time slot or positions
Range in.The reasonable time range of timing wheel 130 can be in the range of 10 microsecond -1 second.For example, as shown in Figure 4 A, it is fixed
There are hour wheel 130 10 time slots, each time slot can represent 2 microseconds.Therefore, example timing wheel 130 shown in Fig. 4 A when
Between range be 20 microseconds, and the granularity of timing wheel 130 is 2 microseconds.In some embodiments, timing wheel 130 will have most
Big time range will not dispatch packet identifier more than the time range.Timing wheel 130 can not require storage to have than present
The packet identifier of timestamp earlier, because should be immediately transmitted with the grouping than transmission time now earlier.Only
Want the time slot in timing wheel 130 than earlier, the element in time slot can go out team and be ready to transmit now.
For example, as shown in Figure 4 A, it is assumed that grouping A1 is handled via scheduler 125 and moved from socket word buffer 405
It removes.Grouping A1 can be retained in memory 115, and scheduler 125 will be with grouping A1 (for example, ID：A1) associated mark
Know in the timing wheel 130 that symbol is stored at the associated position of transmission time determined to grouping A1.Packet identifier ID：A1 packets
Include the transmission time t such as determined by scheduler 1250.Packet identifier ID：A1 is corresponding to transmission time t0Time slot at, be inserted into
Into timing wheel 130.Timing wheel 130 stores packet identifier ID：A1, until determining the transmission for having reached and being determined to grouping A1
Until time.Network interface driver 120 can utilize current time query time index data structure 130 to determine whether to deposit
In any grouping to be transmitted.For example, network interface driver 120 (or can indicate current time by cpu clock time
Some other values, such as regularly progressive whole number) polling data structure.The determination of network interface driver 120 has reached
In packet identifier ID：The transmission time and transmission packe A1 identified in A1.
As shown in Figure 4 B, next grouping of the processing of scheduler 125 from socket word buffer 410 is to determine for being grouped B1
Transmission time.Scheduler 125 can based on the associated rate-limiting algorithm of the class of grouping received from application 150b or
Strategy, it is determined that in time t1Transmission grouping B1.Grouping B1 can be stored in memory 115, be passed until having reached
Defeated time t1.Packet identifier ID：B1 can be stored in and the transmission time t to grouping B1 determinations1At associated position
In timing wheel 130.As further shown in fig. 4b, timing wheel 130 is when corresponding with the transmission time determined by scheduler 125
Packet identifier ID is stored in gap：A1 and packet identifier ID：B1.For example, packet identifier ID：When A1 is stored in transmission
Between t0In associated position, and packet identifier ID：B1 is stored in and transmission time t1In associated position.Grouping
Identifier ID：A1 and ID：B1 can be stored in timing wheel 130, had arrived at until scheduler 125 determines (such as
TimenowAt 420) transmission time that each of packet identifier is indexed, as described in the stage 350 of Fig. 3.
As shown in Figure 4 C, scheduler 125 continues with the grouping received from application 150.For example, scheduler 125 has been located
It manages grouping A2, the grouping B2 from socket buffer 410 from socket buffer 405 and comes from socket word buffer
415 grouping C1 and C2.The processing of scheduler 125 grouping A2, B2, C1 and C2 is to determine the transmission time for being each grouped.Point
Group A2, B2, C1 and C2 are stored in memory 115, until having reached their own transmission time.For example, scheduler
125 can execute the rate-limiting algorithm or strategy stored in memory 115, to determine biography associated with grouping A2 and B2
The defeated time.Based on rate-limiting algorithm associated with the grouping for coming self-application 150a or 150b or strategy respectively, for being grouped
The transmission time of A2 can be determined that t4, and transmission time for being grouped B2 can be determined that t5.Scheduler 125 is also
Processing carrys out the grouping of self-application 150c, to determine the transmission time for being grouped C1 and C2.Scheduler 125 can be determined to come from and be answered
Associated with specific rate-limiting algorithm or strategy with the grouping of 150c, the specific rate-limiting algorithm or strategy make scheduling
Device 125 can since twice of the rate processing of grouping of self-application 150a or application 150b carry out the grouping of self-application 150c.Such as
Shown in Fig. 4 C, scheduler 125 by it is being generated by application 150C, respectively with the associated packet identifier ID of grouping C1 and C2：C1
And ID：C2 is stored in timing wheel 130.When scheduler 125 determines that grouping C1 and C2 has transmission more faster than grouping A2 and B2
Between.As a result, by packet identifier ID：C1 and ID：C2 is stored in be determined with the identified associated position of faster transmission time
In hour wheel 130.For example, packet identifier ID：C1 and ID：C2 is stored in than packet identifier ID：A2 and ID：B2 is closer
TimeNowIn 420 position.
As further shown in Fig. 4 C, scheduler 125 continues associated with to the determining transmission time of each grouping
Storage identifier associated with grouping A2, B2, C1 and C2 in timing wheel 130 at position.Timing wheel 130 includes multiple groupings
Identifier, each packet identifier include the transmission time of the determination for its associated packet.Scheduler 125 will periodically
Poll timing wheel 130 is to determine the time having reached in timing wheel 130.For example, 125 poll timing wheel 130 of scheduler, and
It determines and packet identifier ID：The time that A1 is associated, is indexed in timing wheel 130 is (for example, t0) pass by or compared
TimeNow420 earlier.As a result, extracting packet identifier ID from timing wheel 130：A1 (such as dotted line ID：Shown in A1), and dispatch
Device 125 is executed instruction is forwarded to the network interface card 140 being used for transmission will be grouped A1.Grouping A1 is moved from memory 115
Except (for example, the dotted line being now shown as in memory 115 is grouped A1).In some embodiments, the poll of timing wheel and will point
Group is forwarded to network interface card 140 can be by the logic different from scheduler 125, and all transponders 135 as shown in Figure 1 are held
Row.
Fig. 5 is for using the exemplary method 500 executed by the network equipment 110 come the flow chart of shaping network traffic.Generally
For including, method 500 is since the stage 510, the net of network interface card 140 shown in such as Fig. 1 and 6A-6B in the stage 510
Network equipment determines whether successfully to be transmitted in the time index number at position associated with arrival time via network interface card
According to the associated grouping of the identifier stored in structure.At the stage 520, if the network equipment 110 determines that Successful transmissions exist
The associated grouping of identifier stored in time index data structure at position associated with arrival time, then network set
Standby 110, which will be transmitted notice, sends to before forwarding additional data packet to the network equipment, waits for and being received from the network equipment
It is transmitted the application of notice.
Referring more particularly to Fig. 5, at the stage 510, the network equipment determine by network interface card whether with arrival
Grouping associated with the identifier stored in time index data structure is successfully transmitted at the position of time correlation connection.Example
Such as, with reference to figure 6B, in response to successfully completing the transmission of grouping A1, B1 and C1 by network interface card 140, the network equipment passes through biography
Send single message or it is multiple be transmitted notice (for example, M-A1, M-B1 and M-C1), the Successful transmissions of grouping are notified into application
150.Based on the notice being transmitted from network interface card 140, determined via 140 success of network interface card using 150
Transmission is associated each with the identifier stored in the time index data structure at position associated with arrival time
Grouping.
At the stage 520, in response to the network equipment determine successfully transmission in position associated with arrival time
The associated grouping of identifier stored in the time index data structure at place, the network equipment will be transmitted notice and be transmitted to
Before additional data packet is transmitted to the network equipment, the application for being received from the network equipment and being transmitted notice has been waited for.Example
Such as, with reference to figure 6B, in response to determining by the grouping A1 that Successful transmissions are initially sent from application 150a of network interface card 140,
The network equipment 110 will be transmitted notice M-A1 and be transmitted to using 150c.Similarly, in response to determining by network interface card 140
The grouping B1 that Successful transmissions are initially sent from application 150b, the network equipment 110, which will be transmitted, notifies M-B1 is transmitted to answer
Use 150b.In some embodiments, it can be small (for example, 32 bytes or including several 64 integers) to be transmitted notice.
In some embodiments, it can be configured as forwarding line bonus to the network equipment 110 using each of 150
Before group, waits for from the reception of the network equipment 110 and be transmitted notice.It in some embodiments, can using each of 150
It is configured as before the additional packet for forwarding the same category to the network equipment 110, waits for and being received from the network equipment 110 for spy
That determines the grouping of class is transmitted message.For example, as shown in Figure 6B, A6, B6 and C6 will be grouped (such as dotted line institute using 150
Show) it is forwarded to respectively before socket word buffer 405,410 and 415, wait the notice to be received that is transmitted (for example, M-A1, M-
B1 and M-C1).
Fig. 6 A- Fig. 6 B are to indicate use scheduler, the time index data structure according to some embodiments and transfer
Carry out the exemplary block diagram of the operation of shaping network traffic at the delay completion of notice.In Fig. 6 A- Fig. 6 B, scheme using with Fig. 4 A-
The identical reference numbers of 4C, wherein omitting identical description.
As shown in Figure 6A, to sum up, the network equipment 110 connects from using 150 (for example, using 150a, 150b and 150c)
Receive packet.The network equipment 110 includes one or more socket word buffers 405,410 and 415, with queue and processing from
The grouping received using 150.The network equipment 110 further includes one or more memory devices 115 and scheduler 125, with basis
The rate-limiting algorithm being stored in memory 115 or strategy processing grouping.The network equipment 110 further comprises time index number
Packet identifier is stored according to structure 130, also referred to as timing wheel 130, and according to their transmission time.The network equipment 110
Further include one or more network interface cards 140 with transmission packe.Network interface card 140, which will be transmitted notice and be communicated to, answers
With 150.In some embodiments, network interface card 140 by be deferred to using 150 to be transmitted notice anti-to create
Pressure.The network equipment 110 can be transmitted notice by delay and be estimated until network interface card 140 has been successfully transferred grouping
In respect of limit network flow.Delay be transmitted notice can prevent using 150 production additional packets for the network equipment 110 at
Reason.In some embodiments, the network equipment 110 can be by limit using the small queues of TCP at socket word buffer
The packet count of network device processing.The small queues of TCP are flow restriction mechanism known to persons of ordinary skill in the art, can be by
In TCP protocol stack, the protocol stack being designed realizes smaller buffer size and reduces the biography in given time for configuration
The number of TCP groupings in defeated queue.The use of the small queues of TCP can allow the completion mechanism of delay with due in given time
Grouping number in place's transmission reduces and realizes lower memory utilization rate.
As shown in the stage 310 of Fig. 6 A and Fig. 3, the network equipment 110 is at TCP layer from multiple applications 150 (for example, answering
With 150a, 150b or 150c) receive grouping.As shown in Figure 6A, the network equipment 110 includes three socket word buffers (405,410
With 415).For illustrate purpose, it is assumed that be in be socketed word buffer 405 queue and handle come self-application 150a grouping,
It is socketed the grouping that queue and processing in word buffer 410 carry out self-application 150b, and queue and place in being socketed word buffer 415
Reason carrys out the grouping of self-application 150c.The network equipment 110 can also or optionally include grouping of the processing from multiple applications
One or more socket word buffer.As shown in Figure 6A, with the queue order by application 150a transmission by socket word buffer 405
Receive the grouping for carrying out self-application 150a.For example, grouping A1 is to transmit from application 150a and be processed for via scheduler 125
Initial or the first grouping of transmission.A2 is grouped to handle to determine transmission time (for example, t via scheduler 1253), and point
Group identifier ID：A2 is already stored at and transmission time t3In timing wheel 130 at associated position.Grouping A3-A5 exists
It waits for by still having queue in the socket word buffer 405 of the processing of scheduler 125.Grouping A6 is still present in application
150a, be forwarded it is (as indicated by dashed line) to socket word buffer 405 before, wait for by application 150a receive with previously by answering
The one or more packets that socket word buffer 405 is transmitted to 150a associated are transmitted notice.Similarly, it applies
150b, which can be generated, is grouped and is transmitted to socket word buffer 410.For example, grouping B1 is from the initial of application 150b transmission
Or first be grouped and be processed for transmitting via scheduler 125.Grouping B2 is handled via scheduler 125 and is used for determination
The transmission time of grouping is (for example, t4), and packet identifier ID：B2 is already stored at and transmission time t4Associated position
It sets in the timing wheel 130 at place.Being grouped B3-B5, there are still wait for by the processing of scheduler 125 in being socketed word buffer 410
Queue.Grouping B6, which is still present in, to be received by application 150b using 150b waitings and is previously forwarded (as indicated by dashed line) to socket
The one or more packets of word buffer 410 are associated to be transmitted notice.As further shown in fig. 6 a, grouping C1 is from answering
With initial or the first grouping of 150c transmission, and it is processed for transmitting via scheduler 125.C2 is grouped via scheduling
The processing of device 125 is to determine the transmission time for grouping (for example, t5), and packet identifier ID：C2 be already stored at
Transmission time t5In timing wheel 130 at associated position.Be grouped C3-C5 in be socketed word buffer 415 still have etc.
Wait for the queue of the processing by scheduler 125.Grouping C6 is still present in using 150c, is waited for and being received and first forward by application 150c
The hair one or more packets (as indicated by dashed line) to socket word buffer 415 are associated to be transmitted notice.
As shown in Figure 6A, scheduler 125 have determined and have arrived at (or process) in timing wheel 130 index and with point
The transmission time associated time of group A1, B1 and C1.A1, B1 and C1 is grouped to remove (for example, existing from memory 115
Dotted line grouping A1, B1 and C1 are shown as in memory 115) and network interface card 140 is forwarded to transmit.Scheduler
125 have handled grouping A2, B2 and C2 to determine for the transmission time that is each grouped and will be related to each grouping
The identifier of connection be stored in in the timing wheel 130 at the associated position of the determining transmission time of each grouping.For example, point
Group identifier ID：A2 is already stored at and transmission time t3In associated position, and packet identifier ID：B2 is stored
With transmission time t4In associated position.Similarly, packet identifier ID：C2 is stored in and transmission time t5It is associated
Position in.Grouping A2, B2 and C2 are stored in memory 115.
As shown in Figure 6B, next grouping of the processing of scheduler 125 from socket word buffer 405,410 and 415 is with determination
Transmission time for being grouped A3, B3 and C3.Scheduler 125 is based on speed associated with the class of grouping received from application 150a
Rate limit algorithm or strategy are determined in time t6Place should transmit grouping A3.Grouping A3 is stored in memory 115, until
Have reached transmission time t6.Scheduler 125 is based on rate limit associated with the class of grouping received from application 150b
Algorithm or strategy are determined in time t7Place should transmit grouping B3.Grouping B3 is stored in memory 115, until having reached
To transmission time t7.Packet identifier ID：B3 is stored in and the transmission time t to grouping B3 determinations7At associated position
In timing wheel 130.Scheduler 125 is based on rate-limiting algorithm associated with the class of grouping received from application 150c or plan
Slightly, it determines in time t8Place should transmit grouping C3.Grouping C3 is stored in memory 115, when having reached transmission
Between t8.Packet identifier ID：The transmission time t that C3 is stored in timing wheel 130 and is determined to grouping B38Associated position
Place.Timing wheel 130 stores packet identifier ID in time location corresponding with the transmission time determined by scheduler 125：
A3、ID：B3 and ID：C3.Packet identifier ID：A3、ID：B3 and ID：C3 is stored in timing wheel 130, until scheduler
125 determine the transmission time for having arrived at and indexing to each packet identifier (for example, in TimeNow420)。
As further shown in figure 6b, scheduler 125, which has determined, has arrived at associated with grouping A2, B2 and C2
Timing wheel 130 in time for indexing and execute so that the instruction that A2, B2 and C2 are transmitted to network interface card 140 will be grouped.Point
Group A2, B2 and C2 from memory 115 be removed (for example, be now shown as in memory 115 dotted line grouping A2, B2 and
C2) and it is forwarded to the network interface card 140 being used for transmission.
As shown in Figure 6B, network interface card 140 will be transmitted notice and send to using 150.Based on transmission grouping A1,
The network interface card 140 of B1 and C1 is respectively transmitted to transmission completion notice to apply 150a, 150b and 150c.For example, using
150a is based on successfully transmitting grouping A1 by network interface card 140, and reception is transmitted notice M-A1.It prevents from using using 150a forwardings
In the additional packet of transmission, until receiving transmission completion notice M-A1 using 150a.As the successful biography received with grouping A1
M-A1's delay defeated corresponding transmission completion notice as a result, will be grouped A6 using 150a and be forwarded to the socket of the network equipment 110
Rush device 405.It prevents from that additional packet is sent to the network equipment 110 using 150a, until receiving next transfer using 150a
At notice.As a result, grouping A7 is still present in using 150a, and it is not forwarded to the socket buffering of the network equipment 110
Device 405.In some embodiments, the network equipment 110 can be configured as a transmission in preventing from applying and be used for transmission
Additional packet before, from the grouping of one in multiple groupings reception predetermined number.In some embodiments, it is transmitted
Notice can be delayed by help shaping network traffic.For example, can postpone to be transmitted notice until from net
After the transmission grouping of network interface card 140.Delay, which will be transmitted, notifies delay to be transmitted back to source and reduce by applying using 150
150 numbers being newly grouped generated and reduction are transferred to the number of the grouping of the network equipment 110.In some embodiments,
Notice is transmitted to transmit with delayed mode to handle the order of grouping by network interface card 140.For example, with in net
Receive the identical order that is compared of order for receiving grouping at network interface card 140 or different order be transmitted it is logical
Know M-A1, M-B1 and M-C1.Grouping is received to be respectively transmitted after grouping A1, B1 and C1 from network interface card 140
Identical or different order is transmitted notice.When being executed by being disorderly transmitted notice, it is transmitted notice
Delay completes that the head obstruction of the team in the network equipment 110 can be reduced.In some embodiments, being transmitted notice can
It is small (for example, 32 bytes or including several 64 integers).As further shown in figure 6b, it is received based on application 150
The application 150 for being transmitted notice for being grouped A1, B1 and C1, the network equipment 110 respectively from socket word buffer 405,
Application 150 in 410 and 415 receives next sequential packet (for example, grouping A6, B6 and C6).
Fig. 7 A- Fig. 7 C are indicated according to some embodiments for using multiple schedulers, multiple time index data
Structure and the delay for being transmitted notice are completed to carry out the exemplary block diagram of the network device operation of shaping network traffic.
The network equipment 110 includes two processors, memory 115 and the network interface card for being shown as processor 1 and processor 2
140.Each processor includes one or more socket word buffers (for example, the socket word buffer for including in processor 1
720) and one or more scheduler is (for example, processor 1 705 and 710 and the socket word buffer 715 in processor 2 and
In scheduler 125a or the scheduler 125b in processor 2).Each processor includes one or more time index data knots
Structure, also referred to as timing wheel (such as timing wheel 130a in the processor 1 or timing wheel 130b in processor 2).
As further shown in Fig. 7 A, network equipment trustship includes applying 150 using 150a and using the multiple of 150b, each
The packet that self-generating is used to be transmitted by the network equipment 110.In some embodiments, can will divide using 150a and 150b
Group is exclusively transmitted to processor 1 or processor 2.In some other implementations, using one in 150a and 150b or
Two can will be grouped with identical or different rate while be forwarded to processor 1 and processor 2.As shown in Figure 7 A, from application
The grouping that 150a is received is received by processor 1 in being socketed word buffer 705.The grouping received from application 150b is by processor 1
It receives in being socketed word buffer 710.For example, as shown in Figure 7 A, grouping P1A1 to P1A10, Yi Jiyou are received from application 150a
The socket word buffer 710 of processor 1 receives grouping P1B1 to P1B10.Similarly, as shown in Figure 7 A, it is received from application 150a
Grouping by processor 2 receive in being socketed word buffer 715.It is received from the grouping received using 150b by processor 2
It is socketed in word buffer 720.For example, grouping P2A1 is received to P2A5 from application 150a by socket word buffer 715, and by
The socket word buffer 720 for managing device 2 receives grouping P2B1 to P2B5 from application 150b.
As further shown in Fig. 7 A, the network equipment 110 includes by the shared memory 115 of processor 1 and processor 2.
In some embodiments, memory 115 can not be shared, and each processor can be with the memory 115 of their own.
Memory 115 can store packet and be used by scheduler 125 to determine the speed for the transmission time for being used for each being grouped
Rate limit algorithm or strategy.Processor 1 and processor 2 respectively including scheduler 125 to handle received grouping, and according to
Appropriate rate-limiting algorithm corresponding with each specific cluster class or application packet flow or strategy determine transmission time.Example
Such as, processor 1 includes scheduler 125a to handle grouping associated with 150a and application 150b is applied.Similarly, processor 2
Including scheduler 125b to handle the grouping received from application 150a and application 150b.Each scheduler 125 can be configured with
Unique logic components or process instruction, it is associated with the class of packet that it is handled or type or based on handling to realize
The rate-limiting algorithm or strategy of device memory or power requirements.
In some embodiments, network interface driver 120 can be executed instruction so that manage and/or adjust will be to across one
The rate of polymerization of the grouping of the certain kinds or steaming transfer of the grouping of a or multiple processors.In some embodiments, network connects
Mouth driver 120 can be determined using the statistical data stored in memory 115 by the certain kinds or stream applied to grouping
Processor special speed limitation.For example, network interface driver 120 can be based on the given class to being sent to processor 1
The history of the ratio of grouping averagely determines the special speed limitation for processor 1.For example, if passing through processor in history
1 transmission gives the 70% of the sum of the grouping of classification, then the scheduler 125a of processor 1 can utilize the polymerization for that class
The rate limit of the class of that of 70% grouping of rate limit.Distribution about various types of other grouping between processor
Statistical data can be maintained in memory, and the specific rate limit of processor can be updated between processor
The grouping of time to time change is distributed.
As further shown in Fig. 7 A, processor 1 includes timing wheel 130a and processor 2 includes timing wheel 130b.One
In a little embodiments, each processor can be configured with the timing wheel 130 of their own, and in other embodiments, place
Reason device can share timing wheel 130.Each timing wheel 130 be with to the associated time rope of the determining transmission time of each grouping
Draw the time index data structure that packet identifier is stored at the position in data structure.It also shows in fig. 7, the network equipment
110 include network interface card 140, to be had arrived at based on scheduler 125 (for example, scheduler 125a or scheduler 125b) determination
The time indexed in timing wheel 130 (for example, timing wheel 130a or timing wheel 130b) transmits grouping.In some embodiments
In, processor 1 and processor 2 can respectively include the network interface card 140 of themselves.Network interface card 140 can also incite somebody to action
Notice is transmitted to be transmitted back to using 150 to help the rate limit for carrying out self-application 150 to be grouped generation.
As shown in Figure 7 A, the scheduler 125a processing of processor 1 is from point of the reception of socket word buffer 705 and 710
Group, to determine the transmission time for being each grouped.Scheduler 125a will identifier associated with respective packets be stored in
In timing wheel 130a at the associated position of transmission time determining to grouping.For example, first generated from application 150a is suitable
Sequence is grouped, packet identifier ID：P1A1 is treated and stored in and identified transmission time (example via scheduler 125a
Such as, t0) in timing wheel 130a at associated position.Similarly, the first sequential packet associated with application 150b, grouping
Identifier ID：P1B1 is treated and stored in determining transmission time via scheduler 125a (for example, t1) associated
In timing wheel 130a at position.Packet identifier ID：P1A1 and ID：P1B1 is stored in timing wheel 130a, until scheduling
Device 125a determinations have arrived at the time indexed in timing wheel 130a.For example, timing wheel is periodically polled in scheduler 125a
130a is to determine and packet identifier ID：P1A1 or ID：The associated transmission times of P1B1 whether earlier than current time or
TimeNow725.In some embodiments, poll timing wheel and network interface card 140 is forwarded the packet to by being different from
The logic components of scheduler 125, all transponders 135 as shown in Figure 1 execute.Grouping P1A1 and P1B1, which still has, to be stored
In device 115, had reached and be each grouped relevant transmission time until scheduler 125a has determined.Similarly, such as Fig. 7 A
Further shown in, the grouping that is received of the scheduler 125b processing from socket word buffer 715 and 720 of processor 2, with true
The fixed transmission time for being each grouped.Identifier associated with respective packets is stored in and determining biography by scheduler 125b
In timing wheel 130b at the position of defeated time correlation connection.For example, from the grouping mark of application 150a the first sequential packets generated
Know symbol ID：P2A1 is treated and stored in determining transmission time via scheduler 125b (for example, t2) associated position
It sets in the timing wheel 130b at place.Similarly, the packet identifier ID of the first sequential packet associated with application 150b：P2B1 is
Via scheduler 125b processing, and store it in identified transmission time (for example, t3) determine at associated position
In the 130B of hour wheel.Packet identifier ID：P2A1 and ID：P2B1 is stored in timing wheel 130b, until scheduler 125b is true
Surely the time being indexed in timing wheel 130b is had arrived at.For example, timing wheel 130b is periodically polled in scheduler 125b, with
It determines and packet identifier ID：P2A1 or ID：Whether the associated transmission times of P2B1 are earlier than current time or TimeNow730。
Grouping P2A1 and P2B1 still have in memory 115 until scheduler 125b determination have reached it is associated with each grouping
Transmission time.
As shown in Figure 7 B, scheduler 125a handle respectively from socket word buffer 705 and 710 grouping P1A2 and
P1B2, to determine the transmission time for being each grouped.Based on determining the transmission time that is each grouped, scheduler 125a will with it is every
A associated identifier of grouping is stored in the timing wheel 130a at position associated with identified transmission time.Example
Such as, packet identifier ID：P1A2 and ID：P1B2 is stored in and its identified transmission time (such as being respectively t4 and t5) phase
In timing wheel 130a at associated position.Grouping P1A2 and P1B2 is stored in memory 115.Scheduler 125a is periodical
Ground poll timing wheel 130a, to pass through the identified transmission time and current time Time that will be used for each groupingNow725 ratios
Compared with, it is determined whether have arrived at the time indexed in timing wheel 130a.For example, being had arrived at based on determining to being grouped P1A1
(for example, t0) and be grouped P1B1 (for example, t1) index time, scheduler 125a executes instruction will be grouped P1A1 and P1B1 turn
It is dealt into the network interface card 140 being used for transmission.It is grouped P1A1 and P1B1 and is removed (shown in dotted line) from memory 115.
As shown in Figure 7 B, scheduler 125b poll timing wheel 130b and for being grouped P2A1 determination arrived
Up to the time (730) indexed in timing wheel 130b.For example, based on the time having arrived to being grouped P2A1 indexes is determined, adjust
Degree device 125b is executed instruction, and will be grouped P2A1 and is forwarded to the network interface card 140 being used for transmission.P2A1 is grouped from memory
It is removed (shown in dotted line) in 115.
As seen in figure 7 c, processor 1 continues to receive new grouping from application 150, and scheduler 125a continues with than processing
The grouping that the faster rate processings of scheduler 125b of device 2 are received.Scheduler 125a has been processed by respectively from socket
The grouping P1A3 and P1B3 of buffer 705 and 710, to determine the transmission time for being each grouped.It is used for each based on determining
Identifier associated with each grouping is stored in and identified transmission time phase by the transmission time of grouping, scheduler 125a
In timing wheel 130a at associated position.For example, packet identifier ID：P1A3 and ID：P1B3 is stored in and determining biography
Defeated time (such as be respectively t6And t7) in timing wheel 130A at associated position.Grouping P1A3 and P1B3, which is stored in, to be deposited
In reservoir 115.Timing wheel 130a is periodically polled in scheduler 125a, when with by that will be used to transmit determined by each grouping
Between with current time TimeNow725 compare, it is determined whether have arrived at the time indexed in timing wheel 130a.For example, being based on
Determine have arrived to grouping P1A2 and be grouped P1B2 indexes time, scheduler 125a execute instruction with will be grouped P1A2 with
P1B2 is forwarded to the network interface card 140 being used for transmission.P1A2 and P1B2 is grouped to be removed (such as dotted line institute from memory 115
Show).
As further shown in Fig. 7 C, based on the transmission grouping P1A1 and P1B1 of network interface card 140, it is transmitted notice and is passed
It is sent to and applies 150.For example, network interface card 140 has been successfully delivered grouping P1A1 and P1B1 and in response to Successful transmissions,
It is respectively transmitted to the application 150 for initially generating the grouping and notice is transmitted (for example, M-P1A1 and M- to each grouping
P1B1).It will prevent from sending the additional packet being used for transmission using 150a, notice M-P1A1 be transmitted until receiving.It is similar
Ground will prevent from sending the additional packet being used for transmission using 150b, and notice M-P1B1 is transmitted until it is received.Based on connecing
It receives and is transmitted notice, will can newly be grouped (for example, P1A11 and P1B11) respectively using 150 is forwarded to network equipment socket
Word buffer 705 and 710, for scheduler 125a processing.
As seen in figure 7 c, scheduler 125b has been processed by the grouping P2A2 from socket word buffer 715, and not yet
Handle the new grouping from socket word buffer 720.The transmission time of the true grouping P2A2 of scheduler 125b, and by identifier
ID：P2A2 is stored in the timing wheel 130B at position associated with the transmission time determined.Grouping P2A2, which is stored in, to be deposited
In reservoir 115.Timing wheel 130b is periodically polled in scheduler 125b, with by the transmission time of the determination to each grouping with
Current time TimeNow730 compare, it is determined whether have reached the time indexed in timing wheel 130b, and based on determination
Through reaching the time to being grouped P2B1 indexes, scheduler 125b is executed is forwarded to the network interface card being used for transmission by grouping P2B1
140 instruction.It is grouped P2B1 and is removed (shown in dotted line) from memory 115.
As further shown in Fig. 7 C, it is based on 140 transmission packe P2A1 of network interface card, from network interface card
After 140 transmission grouping P2A1, notice will be transmitted and be transmitted to using 150.It prevents from being used for transmission using 150a transmissions attached
Bonus point group is transmitted notice M-P2A1 until it is received.It is transmitted notice based on receiving, it can will be new using 150a
Grouping (for example, P2A6) is forwarded to the network equipment and is socketed word buffer 715 for scheduler 125b processing.
As described above, time index data structure and delay completion mechanism can be used for rate limit transmission network equipment
The network flow at place.Can also confirmation data packet receipt be dispatched using similar mechanism at the network equipment receiving, with reality
Existing receiving terminal rate limiting technique.In some embodiments, receiving terminal rate limiting technique can utilize the existing of Transmission Control Protocol
The revision of function, that is, the TCP congestion windows of sending device send the following rate being grouped to limit transmission device at it.
Such as those skilled in the art, it is evident that, TCP congestion windows are that transmission device be not confirmed to be reception
In the case of the dynamic adjustment threshold value of the amount of TCP data that can send.That is, when TCP points of unacknowledged transmissions
When data volume in group meets TCP congestion window threshold values, transmission device can not send any additional packet.It is set as a result, receiving
The standby time that TCP acknowledgment message (TCP ACK) can be sent back to by controlling at its transmission device, how manipulate transmission device
When can send additional packet.In some embodiments, for example, wherein transmission device is in containerization or virtual machine environment
It executes, individual TCP congestion windows can be maintained in each virtual machine or each container, to allow that it will be individually controlled
The rate of grouping of the place from each virtual machine or container.In some embodiments, to by the true OS of sending device
Or each stream of the grouping of the transport protocol mould transmission device transmission in the block operated in it, individual TCP can be maintained to gather around
Fill in window.In some embodiments, the congestion window function of modification can include completion notice feature, wherein apply, is virtual
Machine, and/or container environment can not be forwarded to additional packet on the practical OS of transmission device or the transport protocol of middle operation
Completion notice message is sent to respective application, virtual machine or container environment by module, the transmission device.This completion notice disappears
Breath confirms that the TCP ACK that the grouping that is previously sent is successfully received really disappear being received from receiver end by Transmission Control Protocol message
It is sent after breath.Hereinafter, the function is further described in conjunction with Fig. 8 and 9.Fig. 8 is shown and above-mentioned receiver end rate limit
The flow chart of the example collection of the associated transmitter terminal operation of technology.Fig. 9 shows associated with receiver end rate limiting technique
Receiver end operation example collection flow chart.
Fig. 8 is for using the exemplary method 800 executed by transmission network equipment 110 come the flow of shaping network traffic
Figure.Generally, method 800 is since the stage 830, wherein the network equipment 110 by packet from data source to network
Equipment 110.At the stage 835, if the congestion window for data source has been expired, this method includes preventing packet to net
The transport protocol module of network equipment sends other packet, until as shown in the stage 838, being led to completion by data sources
Know.At the stage 840, if the network equipment 110 determines that packet acknowledgement is set from destination for transmitted packet
Standby to receive, then the network equipment 110 will be transmitted notice and send packet source to, as shown in the stage 850, and for being somebody's turn to do
The congestion window of data source had been previously full, then allowed the transport protocol module of the network equipment to receive from packet data source attached
Bonus point group, as shown in the stage 855.At the stage 860, if the grouping received not yet for the packet transmitted is true
Recognize message, then the network equipment 110 determines whether congestion window timeout value has exceeded.At the stage 870, gathered around if exceeded
Window timeout value is filled in, then the network equipment 110 transmits the packet again.At the stage 880, if the network equipment 110 determines
Not yet exceed congestion window timeout value, then the network equipment 110 redefines the packet transmitted and whether has been received
Packet acknowledgement message.
Referring more particularly to Fig. 8, at the stage 830, transmission network equipment 110 is by packet from data source to connecing
Receive the network equipment 110.For example, data source can be the application executed on network devices.Transmission square end as noted above
Rate limiting technique, the application as data source 150 can be hosted on the real system of the network equipment 110, trustship
In virtual machine on the network equipment 110 or trustship is in the performing environment of the containerization by 110 trustship of the network equipment.
At the stage 835, the transport protocol module determination of the TCP layer of such as network protocol stack is associated with the grouping of transmission
Congestion window whether become full due to the transmission of the grouping.The network equipment 110 is able to maintain that by transport protocol module and is used for
The congestion window of various data sources, such as TCP congestion windows.The network equipment 110 can be to each of executing on the network equipment 110
Using, it is every to each virtual machine or containerization environment by 110 trustship of the network equipment, or to being transmitted by the network equipment 110
A stream of packets maintains individual congestion window.Congestion window definition can via for applying, virtual machine, container, stream etc.
Equipment transmission maximum data volume, the maximum data volume be not yet be confirmed as by target destination equipment it is received
's.In some embodiments, congestion window is initially set to the maximum in link initialization or after time-out occurs
Twice of the value of Duan great little, but can also use other values.If transmit at the stage 830 transmit packet cause with
The associated congestion window of the packet becomes full, then the network equipment 110 can prevent packet from the number for originating the grouping
The transport protocol module of the network equipment 110 is further forwarded to according to source, until data sources to completion notice message, the completion
Notification message instruction, which has been received in grouping, has previously made some that it is transmitted.In some embodiments, wherein
Relative to multiple applications, using specific congestion window, when determining that congestion window has been expired, the network equipment can prevent and the congestion
Additional packet is transmitted to the transport protocol module of the network equipment 110 by each of associated application of window.In congestion window
When having expired (at the stage 838), prevent from mitigating to the grouping of transport protocol module forwards related to the queue in transport protocol module
The memory of connection limits.
At the stage 840, the determination of the network equipment 110 disappears to whether the packet of transmission has been received packet acknowledgement
Breath.For example, transmission network equipment 110 can determine after receiving the TCP ACK groupings from destination network equipment 110
It is successfully delivered the packet.
At the stage 850, TCP ACK, net are had been received to the packet determination of transmission in response to the network equipment 110
Network equipment 110 is transmitted notice to packet data source.For example, the transport protocol module 145 of transmission network equipment 110 can
To be transmitted notice to the data source for originating the grouping for confirming that it is received.It is logical by being transmitted of receiving of packet source
Know for notifying the packet source such as using 150, it can be with additional data packet (stage 855) that queue is used for transmission.
As further described in association with figure 8, at the stage 860, based on the grouping for being not received by the packet for being transmitted
Confirmation message, transmission network equipment 110 determine whether to have exceeded congestion window timeout value.In some embodiments, it transmits
The network equipment 110 can be configured with the individual congestion window of every class for grouping to be transmitted.For example, transmission network is set
Standby 110 can be configured with multiple congestion windows, and each congestion window is corresponding with the inhomogeneity of grouping, such as by applying 150
Each of (such as 150a, 150b and 150c) generate packet.
At the stage 870, if the determination of the network equipment 110 has exceeded congestion window timeout value, 110 weight of the network equipment
Newly transmit the packet.Timeout value is arranged to timer threshold and indicates when by the reception network equipment 110 to be confirmed
The conservative estimation of the packet of transmission.If timer expires, but is not received by instruction and receives grouping by destination
Confirmation message (for example, TCP ACK messages), then transmission network equipment 110 will trial transmit the packet again.
At the stage 880, if the network equipment 110 is determined without departing from TCP congestion window timeout values, the network equipment
Whether 110 redefine to the data packet receipt that had previously transmitted to packet acknowledgement message.
Fig. 9 shows the receiver end rate limit skill with the network equipment execution by the network equipment 110 such as shown in FIG. 1
The flow chart of the example collection of the associated receiver end operation of art.Method 900 includes receiving packet from remote computing device
(stage 910), and packet acknowledgement message (rank is generated by the transport protocol module 145 of the network equipment of reception packet 110
Section is 920).This method further comprises based at least one rate limit strategy associated with received data grouping, really
Surely it is used for the transmission time (stage 930) of packet acknowledgement message, and will identifier associated with the grouping of packet acknowledgement message
It is stored in time index data structure, time index data knot associated with the transmission time determined to packet acknowledgement message
At the position of structure (stage 940).Method 900 further includes that determination has arrived at the time (rank indexed in time index data structure
Section 950), and on the network interface card of the network equipment 110 transmission and the time at position associated with arrival time
The associated packet acknowledgement message (stage 960) of identifier stored in index data structure.
Method 900 includes receiving packet (stage 910) from remote computing device 110.Remote computing device 110 can
It is any network equipment 110 that can generate packet.In some embodiments, remote computing device is configured with
Method 800 shown in Fig. 8 controls the transmission of packet.Method 900 further includes by transport protocol module (such as, network stack
Transmission Control Protocol module or TCP layer) generate packet acknowledgement message (for example, TCP ACK messages) (stage 920).As described above, by
The network equipment 110 of packet is received by packet acknowledgement message packets to the network equipment 110, the network equipment 110 is
Transmitted data have been received to confirm through transmitting the packet.
As further illustrated in figure 9, based at least one rate limit strategy associated with received data grouping come
Determine the transmission time (stage 930) for packet acknowledgement message.In some embodiments, the network of the network equipment 110 connects
Mouth driver 120 can be based on rate-limiting algorithm being stored in memory 115, associated with received data grouping
Or strategy, to determine the transmission time for each packet acknowledgement message.For example, network interface driver 120 can according to
It is true to be applied to grouping by the associated rate-limiting algorithm of specific class or strategy of received data grouping for transmission time stamp
Recognize message.Additionally or alternatively, each packet acknowledgement message can have is transmitted by the request that transport protocol module generates
Timestamp.In some such embodiments, network interface driver 120 can be based on related to beyond the grouping received
At least one rate limit strategy and calling rate-limiting algorithm associated with received data grouping of connection, to determine
Newer transmission time.For example, if receive the associated packet of rate-constrained class with grouping, and network interface
Driver 120 determines that the transmission time for packet acknowledgement message will lead to the additional data transmission from identical traffic equipment,
So that will exceed corresponding rate limit, network interface driver 120 can by adjusting transmission time stamp come more new biography
The defeated time, transmission time stamp makes packet acknowledgement message be transmitted at the time later, to be effectively reduced and the grouping
The transmission rate of the associated transmission network equipment of class 110.In some embodiments, the network interface for receiving the network equipment drives
Dynamic device 120 can be configured to ensure that the transmission of packet acknowledgement message is not delayed the delay and congestion window timeout value is made to exceed
Range because this occur that makes transmission rate significantly more be reduced than desired transmission rate.
Method 900 further comprises that network interface driver 120 will identifier storage associated with packet acknowledgement message
In time index data structure, time index data structure associated with the transmission time determined to packet acknowledgement message
At position (stage 940).Reasonable time index data structure another example is above-mentioned timing wheels 130.
Method 900 further includes that determination has arrived at the time (stage 950) indexed in time index data structure.At some
In embodiment, network interface driver 120 can determine point for having reached and being stored in time index data structure 130
The group acknowledge message identifier associated specific transmission time.Network interface driver 120 can be inquired with current time
Time index data structure 130 is to determine whether there is any packet acknowledgement message to be transmitted.For example, network interface driver
120 can be looked into using the current cpu clock time (or such as regularly other reference time value of progressive whole number value)
Ask data structure.
As further illustrated in figure 9, the network equipment 110 transmitted on network interface card 140 with associated with arrival time
Position at time index data structure in the associated packet acknowledgement message (stage 960) of identifier that stores.At some
In embodiment, network interface driver 120 can be based on reaching (or process) in point stored in index data structure 130
The packet acknowledgement message stored in memory 115 is transferred to network by the transmission time identified in group acknowledge message identifier
Interface card 140.
Although being described above as two different rate limiting techniques, in some embodiments, the network equipment can
To realize above-mentioned transmitter terminal rate limit processing and the processing of receiver end rate limit simultaneously.That is, the network equipment
The network interface similar to the time index data structure of timing wheel 130 and similar to network interface driver 120 can be used
Driver dispatches the transmission of the new data packet originated at the network equipment 110, and to dispatch the biography of packet acknowledgement message
It is defeated.The configured in this way network equipment is able to carry out the rate limit strategy of their own, while having an effect on to not executing themselves
Rate limit processing the network equipment rate limit.
In addition, although receiver end rate limiting technique described above is described as realizing in conjunction with TCP transmission agreement,
But it can be in conjunction with other transport protocols for requiring explicit confirmation grouping to receive or in the network for not departing from the scope of the present disclosure
These functions are realized at other layers of protocol stack.
Figure 10 is to show that system and side with shown in is described herein according to the realization that can be adopted to of example embodiment
The block diagram of the generic structure of the computer system 1000 of the element of method.
Generally, computing system 1010 include at least one processor 1050 for being acted according to instruction execution and
For storing instruction with one or more memory devices 1070 or 1075 of data.Shown in exemplary computing system 1010 include
Via bus 1015 with being connected to one or more network interface cards 1022 of one or more network equipments 1024 extremely
A few network interface driver controller 1020, memory 1070 and any other equipment 1080, such as I/O interfaces are logical
The one or more processors 1050 of letter.Network interface card 1022 can be with one with the equipment or assembly communication that are connect
A or multiple network interface drivers port.In general, the instruction that processor 1050 receives execution from memory.Shown in handle
Device 1050 merges or is directly connected to cache memory 1075.
In more detail, processor 1050 can be process instruction, such as from memory 1070 or cache memory
Any logic circuit of the instruction of 1075 extractions.In many examples, processor 1050 is microprocessor unit or special place
Manage device.Computing device 1000 is based upon any processor operated as described herein or one group of processor.Processor
1050 can be single or multiple core processor.Processor 1050 can be multiple processors.In some embodiments, processor
1050 can be configured as operation multithreading operation.In some embodiments, processor 1050 can be with trustship one or more
Virtual machine or container, and operation for managing virtual machine or container management program or container manager.In such reality
It applies in mode, it is real in the environment for the virtualization or containerization that method can provide on processor 1050 shown in Fig. 3 and Fig. 5
It is existing.
Memory 1070 can be suitable for any equipment of storage mechanized data.Memory 1070 can be tool
There are the equipment of fixed memory or the equipment for reading movable storage medium.Example includes nonvolatile memory, medium
With memory devices, semiconductor memory devices (for example, EPROM, EEPROM, SDRAM and flash memory device), disk,
Magneto-optic disk and CD (for example, CD ROM, DVD-ROM andCD) form of ownership.Computing system 1000 can be with
With any number of memory devices 1070.In some embodiments, memory 1070 is supported by by computing system 1010
The addressable virtualization of virtual machine or container performing environment of offer or the memory of containerization.
Cache memory 1075 be usually located at the form close proximity to the computer storage of processor 1050 with
Fast read-time.In some embodiments, cache memory 1075 be processor 1050 a part or with
On 1050 identical chip of processor.In some embodiments, there are more levels of cache memory 1075, such as L2 and L3
Cache layer.
Network interface driver controller 1020 is via (the also referred to as network interface driver of network interface driver 1022
Port), manage data exchange.Physics sum number of the processing of network interface drive control device 1020 for the osi model of network communication
According to link layer.In some embodiments, some tasks of network interface drive control device are handled by processor 1050.At some
In embodiment, network interface drive control device 1020 is the part of processor 1050.In some embodiments, computing system
1010 have multiple network interface drive control devices 1020.The network interface driver port configured in network interface card 1022
It is the tie point for physical network links.In some embodiments, network interface controller 1020 supports wireless network to connect
It connects, and interface port associated with network interface card 1022 is wireless receiver/transmitter.In general, computing device 1010
Via the physics or Radio Link being connect with the network interface driver port configured in network interface card 1022 and other networks
Equipment 1024 exchanges data.In some embodiments, network interface controller 1020 realizes the procotol of such as Ethernet.
Other network equipments 1024 are via the network interface driver port for including in network interface card 1022 and calculating
Equipment 1010 connects.Other network equipments 1024 can be that the peer computing device for having network functionality, the network equipment or tool are appointed
What his computing device.For example, first network equipment 1024 can be that computing device 1010 is connected to the number of such as internet
According to the network equipment of network, such as hub, bridge, interchanger or router.
Other equipment 1080 may include I/O interfaces, external series device port and any additional coprocessor.
For example, computing system 1010 may include that (such as keyboard, microphone, mouse or other directions are set for connecting input equipment
It is standby), output equipment (such as video display, loud speaker or printer) or additional memory storage devices are (for example, portable flash
Driver or external agency driver) interface (for example, universal serial bus (USB) interface).In some embodiments, it counts
The optional equipment 1080 that equipment 1000 includes such as coprocessor is calculated, for example, mathematics coprocessor can be with high precision or multiple
Miscellaneous calculating helps processor 1050.
Theme described in this specification and the embodiment of operation can be in Fundamental Digital Circuit or tangible
It is realized in embedded computer software on medium, firmware or hardware, including in structure disclosed in this specification and its structure
Equivalent or they one or more of combination.The embodiment of theme described in this specification can be implemented
For embedded one or more computer programs on tangible medium, that is, encoded on one or more computer storage medias
To be executed by data processing equipment or one or more of the computer program instructions of operation for controlling data processing equipment
A module.Computer storage media can be computer readable storage devices, computer-readable storage substrate, deposit at random or sequentially
Access to memory array or equipment or they one or more of combination, or be included therein.Computer storage media is also
It can be one or more individually component or media (for example, more CD, disk or other storage devices), or be included in it
In.Computer storage media can also be tangible and non-transitory.
Operation described in this specification can be implemented as by data processing equipment to can in one or more computers
Read the operation that the data stored or the data received from other sources execute in storage device.Operation can be in data processing equipment
Home environment in or executed in the one or more virtual machines or container by data processing equipment trustship.
Computer program (being also known as program, software, software application, script or code) can be with any form of volume
Cheng Yuyan writes, including compiled or interpreted language, statement or procedural language, and it can come portion with arbitrary form
Administration includes stand-alone program suitable for using in a computing environment or including module, component, subroutine, object or other lists
Member.Computer program can with but need not be corresponding with the file in file system.Program can be stored in trustship other journeys
In the part of the file of sequence or data (for example, the one or more scripts stored in marking language document), it can be stored
In the single file for being exclusively used in discussed program, or it can be stored in multiple coordinated files (for example, storage one
Or the file of multiple modules, subprogram or partial code).Can deploying computer programs on a computer or multiple
Executed on computer or one or more virtual machine or container, one computer or multiple computer bits in one place or
Person is distributed in multiple places and by interconnection of telecommunication network.The example of communication network includes LAN (" LAN ") and wide area network
(" WAN "), interference networks (for example, internet) and peer-to-peer network (for example, reciprocity point to point network).
Process and logic flow described in this specification can be executed by one or more programmable processors, and described one
A or multiple programmable processors execute one or more computer programs with by operation input data and generate output come
Execute action.Process and logic flow can also be executed by equally can be implemented as the device of dedicated logic circuit, for example,
FPGA (field programmable gate array) or ASIC (application-specific integrated circuit).
Although this specification includes numerous specific embodiment details, limitation energy should not be construed as
Enough claimed ranges arbitrarily invented, but the feature to the particular implementation specific to specific invention should be construed to
Description.The certain features described in the present specification in the context of individual embodiment can also in single embodiment
Enough realize in combination.On the contrary, the various features described in the context of single embodiment can also exist respectively
It realizes in multiple embodiments or is realized in any suitable sub-portfolio.In addition, although can be as above by feature description
For with it is certain combination come work and even initially in this way require, the one or more features from claimed combination
It can be deleted from combination in some cases, and claimed combination can point at the modification of sub-portfolio or sub-portfolio.
Similarly, although depicting each operation in the accompanying drawings according to particular order, this should not be understood as require that in this way
Operation particular order or consecutive order shown in execute, or be understood as require that the operation for executing all diagrams, with
Reach desired result.In some cases, multitask and parallel processing can be advantageous.In addition, reality described above
The separation for applying the various system components in mode is not construed as requiring such separation in all embodiments, and
And it should be understood that described program assembly and system usually can together be integrated in single software product or be packaged into it is more
A software product.
Inclusive can be construed to the reference of "or" so that the arbitrary term described using "or" can indicate to be retouched
In the term stated it is single, multiple and all of any one.Label " first ", " second ", " third " etc. are not necessarily anticipated
Instruction sorts and is generally used only for distinguishing between same or similar item or element.
It is apparent to those skilled in the art to the various modifications of the embodiment described in the disclosure, and
And without departing from the spirit or the scope of the present disclosure, the General Principle being defined herein can be applied to other embodiment party
Formula.Therefore, claim is not intended to be limiting embodiment shown in this article, but will be endowed in disclosure disclosed herein
Hold, the widest range that principle is consistent with novel feature.
Claims (22)
1. a kind of network equipment, including：
Network interface card,
At least one processor,
Memory；And
Network interface driver, the network interface driver execute computer-readable finger at least one processor
It enables, the network interface driver is configured as：
It receives and is grouped from multiple applications at the packet layer of network host；
It prevents one in the multiple application to send the additional packet being used for transmission, is transmitted until the application receives
Notice, the grouping for being transmitted notice instruction and having transferred the packet layer for being previously transmitted to the network host；
Received grouping is handled by scheduler module, to determine the transmission being each grouped based at least one rate limit strategy
Time；
To each of grouping to be sent, identifier associated with respective packets is stored in time index data structure
, with to the position in the associated time index data structure of the transmission time determined by the grouping at；
The time for having arrived at and being indexed in the time index data structure is determined by the scheduler module, and as sound
It answers, following groupings is transmitted by the network interface driver：The grouping with the arrival time at associated position
The time index data structure in the identifier that stores it is associated；And
After the network interface driver transmits the grouping, notice will be transmitted and be transmitted back to the application.
2. the network equipment as described in claim 1, wherein the network interface driver is further configured to：It is preventing
Before one in the multiple application sends the additional packet being used for transmission, received from one in the multiple application predetermined
The grouping of number.
3. the network equipment as described in claim 1, wherein the network interface driver is further configured to：Receive from
What multiple applications on one in virtual machine, container performing environment or virtual machine and the combination of container performing environment received
Grouping.
4. the network equipment as described in claim 1, wherein the network interface driver is configured to：Based on speed
Rate adjustable strategies or targeted rate limitation, determine the transmission time being each grouped.
5. the network equipment as claimed in claim 4, wherein the speed adjust strategy further comprises being grouped class rate policy
And/or rate of polymerization strategy.
6. the network equipment as claimed in claim 5, wherein the speed adjust strategy further comprises for handling multiple points
The weighted fair queuing policy of group flow.
7. the network equipment as described in claim 1, wherein the network interface driver is configured to：Receive packet
Include request transmission time grouping, the request transmission time be grouped in be received at the packet layer before and described
The grouping is distributed to by one in the multiple application before scheduler module processing.
8. the network equipment as claimed in claim 7, wherein the network interface driver is configured to：Based on extremely
A few rate limit strategy is exceeded and calls rate-limiting algorithm associated with the grouping received, to determine update
Transmission time.
9. the network equipment as claimed in claim 8, wherein the network interface driver is configured to：Search phase
Associated rate-limiting algorithm, the associated rate-limiting algorithm include identification rate associated with the grouping received
The Hash table of limit algorithm or mapping.
10. the network equipment as described in claim 1, wherein execute the network interface driver of computer-readable instruction
It is realized in dedicated cpu core.
11. the network equipment as described in claim 1, wherein the network interface driver is configured to：Identification ratio
Transmission time earlier now, and in response to the identification, the grouping is transmitted by the network interface driver.
12. a kind of method, including：
It receives and is grouped from multiple applications at the packet layer of network host；
It prevents one in the multiple application to send the additional packet being used for transmission, is transmitted until the application receives
Notice, the grouping for being transmitted notice instruction and having transferred the packet layer for being previously transmitted to the network host；
Received grouping is handled by scheduler module, to determine the transmission being each grouped based at least one rate limit strategy
Time；
To each of grouping to be sent, identifier associated with respective packets is stored in time index data structure
, with to the position in the associated time index data structure of the transmission time determined by the grouping at；
The time for having arrived at and being indexed in the time index data structure is determined by the scheduler module, and as sound
It answers, following groupings is transmitted by the network interface driver：The grouping with the arrival time at associated position
The time index data structure in the identifier that stores it is associated；And
After the network interface driver transmits the grouping, notice will be transmitted and be transmitted back to the application.
13. method as claimed in claim 12, wherein a transmission in preventing the multiple application is used for transmission additional
Before grouping, from the grouping of a reception predetermined number in the multiple application.
14. method as claimed in claim 12, wherein the grouping received include from virtual machine, container performing environment or
The grouping that multiple applications on one in person's virtual machine and the combination of container performing environment receive.
15. method as claimed in claim 12, wherein at least one rate limitation strategy further comprises speed adjust
Strategy or targeted rate limitation.
16. method as claimed in claim 12, wherein the speed adjust strategy further comprises being grouped class rate policy
And/or rate of polymerization strategy.
17. the method described in claim 16, wherein the speed adjust strategy further comprises for handling multiple groupings
The weighted fair queuing policy of flow.
18. method as claimed in claim 12, wherein when the transmission time of at least one grouping is based on request transmission
Between, the request transmission time be grouped in be received at the packet layer before and by the scheduler module processing before by
One in the multiple application is distributed to the grouping.
19. method as claimed in claim 12, wherein determine that the transmission time being each grouped further comprises：
Rate-limiting algorithm associated with the grouping received is exceeded and called based at least one rate limit strategy,
To determine update transmission time.
20. method as claimed in claim 18, further comprises：Associated rate-limiting algorithm is searched, it is described associated
Rate-limiting algorithm include Hash table or the mapping for identifying rate-limiting algorithm associated with the grouping received.
21. method as claimed in claim 12, wherein the method is come in dedicated cpu core with computer-readable instruction
It realizes.
22. method as claimed in claim 12, wherein determine that the transmission time being each grouped includes：
The transmission time of identification ratio now earlier, and in response to the identification, described in network interface driver transmission
Grouping.
Applications Claiming Priority (2)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US15/411,341 | 2017-01-20 | ||
US15/411,341 US10454835B2 (en) | 2017-01-20 | 2017-01-20 | Device and method for scalable traffic shaping with a time-indexed data structure |
Publications (2)
Publication Number | Publication Date |
---|---|
CN108337185A true CN108337185A (en) | 2018-07-27 |
CN108337185B CN108337185B (en) | 2021-09-24 |
Family
ID=60473620
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
CN201711237582.5A Active CN108337185B (en) | 2017-01-20 | 2017-11-30 | Apparatus and method for scalable traffic shaping with time-indexed data structure |
Country Status (4)
Country | Link |
---|---|
US (1) | US10454835B2 (en) |
CN (1) | CN108337185B (en) |
DE (2) | DE102017126470A1 (en) |
WO (1) | WO2018136131A1 (en) |
Cited By (3)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN110502322A (en) * | 2019-07-12 | 2019-11-26 | 苏宁云计算有限公司 | The triggering method and device of timer-triggered scheduler |
CN110928851A (en) * | 2019-10-12 | 2020-03-27 | 中国平安财产保险股份有限公司 | Method, device and equipment for processing log information and storage medium |
CN114424507A (en) * | 2019-09-26 | 2022-04-29 | 三菱电机株式会社 | Method for transmitting data packets and device for carrying out said method |
Families Citing this family (8)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US11570117B2 (en) * | 2016-08-23 | 2023-01-31 | Netduma Software, LTD. | Congestion control |
US10862617B2 (en) * | 2017-05-30 | 2020-12-08 | Marvell Asia Pte, Ltd. | Flowlet scheduler for multicore network processors |
US10778545B2 (en) * | 2018-07-19 | 2020-09-15 | Futurewei Technologies, Inc. | Network verification system |
FR3088789B1 (en) * | 2018-11-16 | 2021-08-06 | Blade | TRANSMISSION PROTOCOL OF A DATA FLOW TRANSITTING BETWEEN A HOST COMPUTER AND A REMOTE CLIENT |
DE112020002497T5 (en) | 2019-05-23 | 2022-04-28 | Hewlett Packard Enterprise Development Lp | SYSTEM AND PROCEDURE FOR DYNAMIC ALLOCATION OF REDUCTION ENGINES |
US11948001B2 (en) * | 2020-06-18 | 2024-04-02 | Sonicwall Inc. | Adaptive CPU usage mechanism for networking system in a virtual environment |
JP2022046292A (en) * | 2020-09-10 | 2022-03-23 | キヤノン株式会社 | Communication device, control method, and program |
US11784933B2 (en) * | 2020-12-08 | 2023-10-10 | Google Llc | Traffic shaping offload on a network interface controller |
Citations (5)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5920701A (en) * | 1995-01-19 | 1999-07-06 | Starburst Communications Corporation | Scheduling data transmission |
US20020163885A1 (en) * | 2001-02-26 | 2002-11-07 | Seabridge Ltd. | Queue control method and system |
US7106693B1 (en) * | 2000-11-02 | 2006-09-12 | Cisco Technology, Inc. | Method and apparatus for pacing the flow of information sent from a device |
US20130077486A1 (en) * | 2011-06-27 | 2013-03-28 | Seth Keith | Prioritizing classes of network traffic to provide a predetermined quality of service |
CN104081736A (en) * | 2012-02-03 | 2014-10-01 | 苹果公司 | System and method for scheduling packet transmission on a client device |
Family Cites Families (18)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5751708A (en) * | 1995-10-25 | 1998-05-12 | Lucent Technologies Inc. | Access method for broadband and narrowband networks |
US6359884B1 (en) * | 1998-06-26 | 2002-03-19 | Nortel Networks Limited | Modular scalable packet scheduler with rate based shaping and virtual port scheduler |
US6894974B1 (en) | 2000-05-08 | 2005-05-17 | Nortel Networks Limited | Method, apparatus, media, and signals for controlling packet transmission rate from a packet source |
US7284047B2 (en) * | 2001-11-08 | 2007-10-16 | Microsoft Corporation | System and method for controlling network demand via congestion pricing |
US20030152096A1 (en) | 2002-02-13 | 2003-08-14 | Korey Chapman | Intelligent no packet loss networking |
US7236459B1 (en) | 2002-05-06 | 2007-06-26 | Packeteer, Inc. | Method and apparatus for controlling data transmission volume using explicit rate control and queuing without data rate supervision |
US8478811B2 (en) * | 2002-10-08 | 2013-07-02 | Netlogic Microsystems, Inc. | Advanced processor with credit based scheme for optimal packet flow in a multi-processor system on a chip |
US7389336B2 (en) | 2003-01-24 | 2008-06-17 | Microsoft Corporation | Pacing network packet transmission using at least partially uncorrelated network events |
US7349337B1 (en) * | 2003-12-12 | 2008-03-25 | Novell, Inc. | Techniques for shaping data transmission rates |
JP2007013449A (en) * | 2005-06-29 | 2007-01-18 | Nec Commun Syst Ltd | Shaper control method, data communication system, network interface device and network repeating device |
GB0517304D0 (en) | 2005-08-23 | 2005-10-05 | Netronome Systems Inc | A system and method for processing and forwarding transmitted information |
US8018845B2 (en) | 2006-01-25 | 2011-09-13 | Cisco Technology, Inc | Sampling rate-limited traffic |
US20080112318A1 (en) * | 2006-11-13 | 2008-05-15 | Rejean Groleau | Traffic shaping and scheduling in a network |
US8949392B2 (en) * | 2007-11-07 | 2015-02-03 | Brocade Communications Systems, Inc. | Workload management with network dynamics |
US9407550B2 (en) | 2008-11-24 | 2016-08-02 | Avago Technologies General Ip (Singapore) Pte. Ltd. | Method and system for controlling traffic over a computer network |
JP5352852B2 (en) | 2010-03-19 | 2013-11-27 | 株式会社日立製作所 | Mobile communication system and communication method |
US9461927B2 (en) | 2012-03-31 | 2016-10-04 | Intel Corporation | Method, device, and system for delaying packets during a network-triggered wake of a computing device |
US9401860B2 (en) | 2013-08-09 | 2016-07-26 | Citrix Systems, Inc. | High performance quality-of-service packet scheduling for multiple packet processing engines |
-
2017
- 2017-01-20 US US15/411,341 patent/US10454835B2/en active Active
- 2017-10-31 WO PCT/US2017/059385 patent/WO2018136131A1/en active Application Filing
- 2017-11-10 DE DE102017126470.1A patent/DE102017126470A1/en active Granted
- 2017-11-10 DE DE202017106860.9U patent/DE202017106860U1/en active Active
- 2017-11-30 CN CN201711237582.5A patent/CN108337185B/en active Active
Patent Citations (6)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US5920701A (en) * | 1995-01-19 | 1999-07-06 | Starburst Communications Corporation | Scheduling data transmission |
US7106693B1 (en) * | 2000-11-02 | 2006-09-12 | Cisco Technology, Inc. | Method and apparatus for pacing the flow of information sent from a device |
US20020163885A1 (en) * | 2001-02-26 | 2002-11-07 | Seabridge Ltd. | Queue control method and system |
US6990115B2 (en) * | 2001-02-26 | 2006-01-24 | Seabridge Ltd. | Queue control method and system |
US20130077486A1 (en) * | 2011-06-27 | 2013-03-28 | Seth Keith | Prioritizing classes of network traffic to provide a predetermined quality of service |
CN104081736A (en) * | 2012-02-03 | 2014-10-01 | 苹果公司 | System and method for scheduling packet transmission on a client device |
Cited By (4)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN110502322A (en) * | 2019-07-12 | 2019-11-26 | 苏宁云计算有限公司 | The triggering method and device of timer-triggered scheduler |
CN110502322B (en) * | 2019-07-12 | 2022-07-12 | 苏宁云计算有限公司 | Triggering method and device for timing scheduling |
CN114424507A (en) * | 2019-09-26 | 2022-04-29 | 三菱电机株式会社 | Method for transmitting data packets and device for carrying out said method |
CN110928851A (en) * | 2019-10-12 | 2020-03-27 | 中国平安财产保险股份有限公司 | Method, device and equipment for processing log information and storage medium |
Also Published As
Publication number | Publication date |
---|---|
CN108337185B (en) | 2021-09-24 |
US10454835B2 (en) | 2019-10-22 |
US20180212886A1 (en) | 2018-07-26 |
DE102017126470A1 (en) | 2018-07-26 |
WO2018136131A1 (en) | 2018-07-26 |
DE202017106860U1 (en) | 2018-03-06 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
CN108337185A (en) | The device and method of scalable traffic shaping with time index data structure | |
CN108337186B (en) | Apparatus and method for scalable traffic shaping | |
US9888048B1 (en) | Supporting millions of parallel light weight data streams in a distributed system | |
CN112041826B (en) | Fine-grained traffic shaping offload for network interface cards | |
JP6632966B2 (en) | Network device and traffic shaping method | |
CN109412958A (en) | The jamming control method and device of data center | |
US10944683B1 (en) | Hybrid queue system for request throttling | |
WO2018233425A1 (en) | Network congestion processing method, device, and system | |
Huang et al. | ARS: Cross-layer adaptive request scheduling to mitigate TCP incast in data center networks | |
Li et al. | OPTAS: Decentralized flow monitoring and scheduling for tiny tasks | |
US20210067458A1 (en) | Methods, systems, and devices for classifying layer 4-level data from data queues | |
Podlesny et al. | Solving the tcp-incast problem with application-level scheduling | |
CN113259415A (en) | Network message processing method and device and network server | |
Mehra et al. | Network load balancing in software defined network: A survey | |
CN109729113A (en) | Manage method, server system and the computer program product of dedicated processes resource | |
Wu et al. | Potential performance bottleneck in Linux TCP | |
Du et al. | R-AQM: Reverse ACK active queue management in multitenant data centers | |
EP3016333B1 (en) | Handling high throughput and low latency network data packets in a traffic management device | |
Khalid et al. | Analysis of transmission control protocol incast over large-scale HPC clusters | |
Gutiérrez et al. | An Adaptable and Agnostic Flow Scheduling Approach for Data Center Networks | |
EP4012990A1 (en) | Traffic shaping offload on a network interface controller | |
CN117795926A (en) | Data packet prioritization in multiplexed sessions | |
Liu et al. | Flow Scheduling Strategies for Minimizing Flow Completion Times in Information-agnostic Data Center Networks |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
PB01 | Publication | ||
PB01 | Publication | ||
SE01 | Entry into force of request for substantive examination | ||
SE01 | Entry into force of request for substantive examination | ||
REG | Reference to a national code |
Ref country code: HKRef legal event code: DERef document number: 1259547Country of ref document: HK |
|
GR01 | Patent grant | ||
GR01 | Patent grant |