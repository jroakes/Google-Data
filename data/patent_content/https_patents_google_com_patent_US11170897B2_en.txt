US11170897B2 - Method and system for assisting pathologist identification of tumor cells in magnified tissue images - Google Patents
Method and system for assisting pathologist identification of tumor cells in magnified tissue images Download PDFInfo
- Publication number
- US11170897B2 US11170897B2 US16/488,029 US201716488029A US11170897B2 US 11170897 B2 US11170897 B2 US 11170897B2 US 201716488029 A US201716488029 A US 201716488029A US 11170897 B2 US11170897 B2 US 11170897B2
- Authority
- US
- United States
- Prior art keywords
- patch
- neural network
- tissue
- deep neural
- image
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Active, expires
Links
Images
Classifications
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T7/00—Image analysis
- G06T7/0002—Inspection of images, e.g. flaw detection
- G06T7/0012—Biomedical image inspection
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F15/00—Digital computers in general; Data processing equipment in general
- G06F15/76—Architectures of general purpose stored program computers
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F18/00—Pattern recognition
- G06F18/20—Analysing
- G06F18/21—Design or setup of recognition systems or techniques; Extraction of features in feature space; Blind source separation
- G06F18/214—Generating training patterns; Bootstrap methods, e.g. bagging or boosting
-
- G06K9/6256—
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/04—Architecture, e.g. interconnection topology
- G06N3/045—Combinations of networks
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/08—Learning methods
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T11/00—2D [Two Dimensional] image generation
- G06T11/001—Texturing; Colouring; Generation of texture or colour
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T7/00—Image analysis
- G06T7/10—Segmentation; Edge detection
- G06T7/11—Region-based segmentation
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V10/00—Arrangements for image or video recognition or understanding
- G06V10/70—Arrangements for image or video recognition or understanding using pattern recognition or machine learning
- G06V10/82—Arrangements for image or video recognition or understanding using pattern recognition or machine learning using neural networks
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V20/00—Scenes; Scene-specific elements
- G06V20/60—Type of objects
- G06V20/69—Microscopic objects, e.g. biological cells or cellular parts
- G06V20/698—Matching; Classification
-
- G—PHYSICS
- G16—INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR SPECIFIC APPLICATION FIELDS
- G16H—HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA
- G16H30/00—ICT specially adapted for the handling or processing of medical images
- G16H30/40—ICT specially adapted for the handling or processing of medical images for processing medical images, e.g. editing
-
- G—PHYSICS
- G16—INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR SPECIFIC APPLICATION FIELDS
- G16H—HEALTHCARE INFORMATICS, i.e. INFORMATION AND COMMUNICATION TECHNOLOGY [ICT] SPECIALLY ADAPTED FOR THE HANDLING OR PROCESSING OF MEDICAL OR HEALTHCARE DATA
- G16H50/00—ICT specially adapted for medical diagnosis, medical simulation or medical data mining; ICT specially adapted for detecting, monitoring or modelling epidemics or pandemics
- G16H50/20—ICT specially adapted for medical diagnosis, medical simulation or medical data mining; ICT specially adapted for detecting, monitoring or modelling epidemics or pandemics for computer-aided diagnosis, e.g. based on medical expert systems
-
- G—PHYSICS
- G01—MEASURING; TESTING
- G01N—INVESTIGATING OR ANALYSING MATERIALS BY DETERMINING THEIR CHEMICAL OR PHYSICAL PROPERTIES
- G01N33/00—Investigating or analysing materials by specific methods not covered by groups G01N1/00 - G01N31/00
- G01N33/48—Biological material, e.g. blood, urine; Haemocytometers
- G01N33/483—Physical analysis of biological material
- G01N33/4833—Physical analysis of biological material of solid biological material, e.g. tissue samples, cell cultures
-
- G06K2209/05—
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/10—Image acquisition modality
- G06T2207/10056—Microscopic image
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20081—Training; Learning
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/20—Special algorithmic details
- G06T2207/20084—Artificial neural networks [ANN]
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/30—Subject of image; Context of image processing
- G06T2207/30004—Biomedical image processing
- G06T2207/30024—Cell structures in vitro; Tissue sections in vitro
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T2207/00—Indexing scheme for image analysis or image enhancement
- G06T2207/30—Subject of image; Context of image processing
- G06T2207/30168—Image quality inspection
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06V—IMAGE OR VIDEO RECOGNITION OR UNDERSTANDING
- G06V2201/00—Indexing scheme relating to image or video recognition or understanding
- G06V2201/03—Recognition of patterns in medical or anatomical images
Definitions
- This disclosure relates generally to the field of digital pathology and more particularly to methods and systems for assisting a pathologist in identifying the presence of tumor cells (i.e., cancer) in a magnified digital image of tissue, such as for example lymph node tissue, or breast or prostate cancer tissue obtained from a biopsy.
- tumor cells i.e., cancer
- lymph nodes for metastasis are central the staging of many types of solid tumors, including breast cancer.
- the process requires highly skilled pathologists and is fairly time-consuming and error-prone, especially for nodes that are negative for cancer or have a small foci of cancer.
- the current standard of care involves examination of digital slides of nodes biopsies that have been stained with hematoxylin and eosin (H&E)
- H&E hematoxylin and eosin
- reader fatigue and intra and inter-grader reliability that negatively impact the sensitivity of the process.
- Accurate review and assessment of lymph node biopsy slides is important because the presence of tumor cells in the lymph node tissue may warrant new or more aggressive treatment for the cancer and improve the patient's chances of survival.
- the prior art includes descriptions of the adaptation of deep learning techniques and trained neural networks to the context of digital tissue images in order to improve cancer diagnosis, characterization and/or staging.
- Pertinent background art includes the following articles: G. Litjens, et al., Deep learning as a tool for increasing accuracy and efficiency of histopathological diagnosis (May 2016); D. Wang et al., Deep Learning for Identifying Metastatic Breast Cancer (June 2016); A. Madabhushi et al., Image analysis and machine learning in digital pathology: Challenges and opportunities , Medical Image Analysis 33 p 170-175 (2016); A. Schuamberg, et al., H & E - stained Whole Slide Deep Learning Predicts SPOP Mutation State in Prostate Cancer.
- a method for analyzing a tissue biopsy includes the steps of (a) receiving image data representing tissue from the tissue biopsy, the image data obtained at a first magnification; (b) subdividing the image data into a plurality of patches, each patch comprising a portion of the image data representing a respective portion of the tissue from the tissue biopsy; and (c) for each of the patches, determining a likelihood of malignancy score, wherein the score is obtained by processing the patch using an ensemble of deep neural network pattern recognizers and combining the outputs of each of the deep neural network pattern recognizers, wherein the ensemble of deep neural network pattern recognizers are arranged to process the patch at a plurality of levels of magnification including the first magnification and a second magnification.
- a method for assisting a pathologist in identifying the presence of tumor cells in magnified digital image of tissue obtained from a biopsy is disclosed.
- the tissue is fixed on a slide, stained (e.g., with H&E) and scanned by a digital slide scanner.
- the method involves obtaining a digital image at a first magnification (e.g. 40 ⁇ ) of the slide.
- the digital image is then subdivided into a multitude of “patches.”
- Each patch is a two dimensional array of pixels (e.g., square or rectangle) from the digital image, e.g., 128 ⁇ 128 or 299 ⁇ 299 pixels.
- each patch is a portion of the image data representing a respective portion of the tissue from the tissue biopsy.
- a likelihood of malignancy score is then determined for each of the patches.
- the score is obtained by analyzing pixel data in the digital image including the patch (e.g., pixel data centered on and including the patch) using an ensemble of deep neural network pattern recognizers.
- the pixel data including the patch is analyzed by the ensemble at multiple levels of magnification including the first magnification (e.g., 40 ⁇ ) and a second magnification centered on or containing the patch, e.g., 20 ⁇ .
- the pixel data is analyzed by the ensemble at four different magnifications, including 5 ⁇ , 10 ⁇ , 20 ⁇ and 40 ⁇ .
- the pixel data for the second magnification can be obtained from a second or additional scan(s) of the slide, or from a downsampling or upsampling of the original digital slide image data.
- Each member of the ensemble generates an output (e.g., score) and the outputs are combined to generate of overall output or score for the patch.
- outputs e.g., score
- Various methods for combining the outputs are described in detail below, including calculation of average, median, or weighted average, or combining the outputs with the use of a convolutional neural network.
- a representation of the slide is generated for the user, e.g., displayed on a workstation display used by the pathologist.
- This representation is described in the following disclosure as a “heatmap”.
- each of the patches is assigned a color (or other alternative and equivalent representation, such as degree of grayscale) in accordance with (1) the likelihood of malignancy score assigned to the patch by the ensemble of deep neural network pattern recognizers and (2) a code, e.g., key or other assignment mechanism, which assigns distinct colors (or equivalently grayscale values) to different values of likelihood of malignancy scores assigned to the patches.
- those areas (patches) with the highest scores indicating high likelihood of presence of tumor cells are shown as red areas and areas (patches) with lowest scores, low likelihood of presence of tumor cells, are blue or black.
- These heatmap representations are useful for directing the pathologist to particular areas of the slide to investigate for presence of tumor cells.
- the heatmap representation is accompanied by a list of regions of interest, e.g., ranked by size.
- a computer system programmed as a machine for assisting a pathologist in assessing the likelihood of presence of tumor cells in a magnified digital slide image containing tissue, such as lymph node or prostate tissue.
- the computer system which may take the form of a single programmed computer or a network of several computers, is in the form of an ensemble of deep neural network pattern recognizers, each of which are trained on a multitude of digital slide images of tissue at a particular and different magnification level, including slides of benign tissue and slides containing tumor cells.
- Each member of the ensemble generates an output in the form of a likelihood of malignancy score for a patch of a digital slide containing tissue (i.e., a slide of a particular patient being investigated by a pathologist).
- the outputs of each of the members of the ensemble are combined to generate an overall likelihood of malignancy score for the patch.
- a system for assisting a user (e.g., pathologist) in identifying tumor cells in a tissue obtained from a biopsy.
- the system includes a workstation configured to display a magnified digital image of a slide containing the tissue.
- the system further includes an application programming interface (API) to a software system configured as an ensemble of deep neural network pattern recognizers, each trained on a training set comprising multitude of digital slide images of lymph node tissue at a particular and different magnification level of the digital slide images.
- the software system is further configured to subdivide the digital image into a multitude of patches, each patch in the form of a two dimensional array of pixels, such as rectangular or square.
- the software system is further configured for determining, for each of the patches, a likelihood of malignancy score, wherein the score is obtained by analyzing pixel data in the digital image including the patch using the ensemble of deep neural network pattern recognizers.
- the workstation is further configured to present on the display a representation of the slide wherein each of the patches is assigned a color or equivalent (e.g. grayscale value) in accordance with (1) the likelihood of malignancy score assigned to the patch by a combination of the outputs of the ensemble of deep neural network pattern recognizers and (2) a code, e.g., key or other assignment mechanism, which assigns distinct colors equivalently grayscale values) to different values of likelihood of malignancy scores assigned to the patches.
- a color or equivalent e.g. grayscale value
- FIG. 1A illustrates a magnified digital image of a slide containing lymph node tissue stained with H&E.
- FIG. 1B is a ground truth image or mask of the slide image of FIG. 1A with the areas in white indicating areas where tumor cells are present and areas in black indicating areas where no tumor cells are present.
- FIG. 1C is a heatmap image of the slide of FIG. 1A .
- the areas in red are the areas where the corresponding patches have a high score indicating high probability of tumor cells
- the blue areas are areas where the patches have a low score indicating low probability of tumor cells. Note that the areas in red in FIG. 1C correspond to the white (tumor) areas in FIG. 1B .
- FIG. 2 is a detailed illustration of the code or key for assigning colors to patches based on tumor probability scores generated by the ensemble of deep neural network pattern recognizers.
- An analogous key would be used if grayscale instead of color is used for the heatmap.
- FIG. 3 is a flow chart showing a process and software architecture for generating the heatmap of FIG. 1C .
- FIG. 4 is a detailed view of the slide image of FIG. 1A showing the division of the image into a multitude of patches, one of which is shown isolated to illustrate the cellular detail at 40 ⁇ . The patches are not shown to scale in FIG. 4 .
- FIG. 5 is a block diagram of the ensemble of deep neural network pattern recognizers which are used to generate the score for each of the patches of FIG. 4 .
- the ensemble of FIG. 5 can be considered a software system which may reside on a pathologist workstation or may alternatively reside on one or more computers in a local or wide area network.
- FIG. 6 is a plot of the tumor detection accuracy of the method we have developed shown in FIG. 3 over the period from April 2016 to January 2017.
- FIG. 7 is an illustration of a pathologist at a workstation using the heatmap of FIG. 1C to assist in identification of tumor cells in lymph node tissue.
- this disclosure is directed to a method for assisting a pathologist in identifying the presence of tumor cells in magnified digital tissue images.
- the following discussion will be primarily in the context of identification of tumor cells in lymph node biopsies, however the architecture of the system, and the performance of the general method is the same for other types of tissue (e.g., detecting tumor cells in prostate or breast cancer tissue).
- the only difference is that the training slides for training the pattern recognizers of FIG. 5 may be selected from particular sets of tissue slides that are germane to the tissue of interest.
- the tissue to be analyzed is fixed on a slide, stained and scanned by a digital slide scanner.
- Digital whole slide scanners and systems for staining slides are known in the art. Such devices and related systems are available from Aperio Technologies, Hamamatsu Photonics, Ventana Medical Systems, Inc., and others.
- the digital image can be obtained at a first magnification level (e.g. 40 ⁇ ), which is customary.
- the goal of assisting the pathologist is achieved by presenting to the pathologist on a display a “heatmap” image in which discrete areas (i.e., patches) of the slide which have a high probability of containing tumor cells are indicated in a particular color, e.g., dark red, whereas areas with relatively low probability of containing tumor cells are shown in a contrasting color, e.g., blue or violet.
- the heatmap image can be accompanied by a list of for example 10 different regions where there are groups of cells with a high probability of containing tumor cells. The pathologist is this directed or encouraged to review the areas highlighted in red or in the list of regions of interest and therefor there is an increased likelihood that areas containing tumor cells are not missed by the pathologist.
- FIG. 1A illustrates a magnified digital image 10 of a slide containing lymph node tissue 12 stained with H&E. In such an image, it is not immediately obvious or apparent which regions of the image have a high likelihood of containing tumor cells.
- FIG. 1B is a ground truth image 14 or mask of the slide image of FIG. 1A with the areas in white 16 indicating areas where tumor cells are present and areas in black 18 indicating areas where no tumor cells are present, which is provided here for the sake of illustration but in practice may not be produced for a given slide of a patient biopsy. This ground truth image can be obtained from the use an immunohistochemical stain and analysis by a pathologist.
- FIG. 1C is a heatmap image 20 or representation of the slide of FIG.
- the areas in red are the areas where the corresponding patches have a high score indicating high probability of tumor cells
- the blue or violet areas are areas where the patches have low scores indicating a low probability of containing tumor cells.
- the white region 16 of FIG. 1B corresponds essentially to the area in red ( 24 ) of FIG. 1C , indicating that the red area 24 of the heatmap 20 of FIG. 1C correctly identifies the areas containing tumor cells.
- the blue or violet area 26 of FIG. 1C corresponds to the black area 18 of FIG. 1B , indicating that the areas where the patches have low scores in fact do not contain tumor cells.
- FIG. 1C also shows a code or key 22 which relates colors (or equivalently grayscale values) to scores which are assigned to patches in the image.
- the code or key 22 is shown in more detail in FIG. 2 .
- the scores for each patch in the digital slide image range from 0.0 to 1.0.
- the areas of the heatmap 20 with the highest scores are shown as dark red, whereas the areas with the areas with the lowest scores are shown as violet.
- the code of FIG. 2 essentially uses the visible spectrum (i.e., colors of the rainbow) to assign colors to tumor probability scores. However, it would be possible to use only a portion of the visible spectrum.
- only degrees of grayscale could be used for the code, e.g., with white corresponding to a score of 0, black corresponding to score of 1, and degrees of gray making up the values between 0 and 1.
- a biopsy of tissue potentially containing cancer cells is obtained from a patient and is formalin fixed and paraffin embedded, optionally in a tissue block which is conventional.
- tissue block is sectioned, stained with H&E and laid on a clear glass slide.
- the slide is digitally scanned by a whole slide digital slide scanner.
- this scan produces a digitized image of the slide, scanned at 40 ⁇ .
- the slide image is subdivided into a multitude of rectangular patches, such as ⁇ 12,000 or so.
- the number of patches per slide can range from 10,000 to 400,000.
- each patch is in the form of a square of 128 ⁇ 128 pixels or 299 ⁇ 299 pixels.
- the patches need not be square, and other two-dimensional configurations such as rectangles could be used.
- FIG. 4 shows a scanned lymph node tissue image 10 and a multitude of the patches 200 , one of which is shown isolated in FIG. 4 showing the cellular details at 40 ⁇ . The patches are not shown to scale.
- the system 108 is a machine-learning based software device that assists pathologists in the assessment for the presence of tumor cells in tissue specimens that have been formalin-fixed paraffin-embedded, stained with Hematoxylin and Eosin (H&E).
- the system includes three software components, including a first component 110 that provides image quality assessment for each of the patches, a second component 112 which calculates a likelihood of malignancy score between 0 and 1 on a per-patch basis, and a third component 114 which combines all the patches into a representation or heatmap ( 20 , see FIG. 1C ) for display to the pathologist on their workstation or device, including a ranked list of potential regions of interest based upon the size of the metastasis.
- a representation or heatmap 20 , see FIG. 1C
- This component of the system 108 analyzes each patch to determine whether the image is of sufficient quality that it can be graded.
- This component 110 returns one of the following as an indicator of image quality for each patch of the image: Gradable, meaning that the patch is of a quality which is adequate for analysis by the software component 112 , or Not Gradable, meaning that patch does not have an image quality which is adequate for analysis by software component 112 . If Not Gradable is returned, the user could be instructed to either rescan the entire slide, or send the image patch for evaluation by a qualified pathologist.
- Not Gradable patches will be color coded gray in the heatmap in an embodiment with color for the code or key of FIG. 2 .
- the performance of the image quality assessment in software component 110 is preferably performed by a trained pattern recognition neural network or other classification model.
- a trained pattern recognition neural network or other classification model To develop such as model, human raters (pathologists) determine which patches in a set of H&E stained biopsy training slides are gradable or not gradable, and the resulting class-label patches are used as a training set for a pattern recognition neural network or other classification model. It is further contemplated that such a classification model or trained neural network could be added to the ensemble of trained pattern recognizers of FIG. 5 in a multi-headed model that will predict the gradability of an image patch.
- the system of 108 includes an automatic quality control module which evaluates the whole slide image for gradability (e.g., the presence of ink or other dirt on the slide, or evaluates whether the whole slide is out of focus, etc.).
- a QC module could be similarly generated as a trained neural network or classification model from class-labeled training slides.
- the software component 112 evaluates each patch of pixels and generates a likelihood of malignancy score (i.e., the likelihood of tumor cells present in the patch) from between 0 and 1 for each patch.
- a likelihood of malignancy score i.e., the likelihood of tumor cells present in the patch
- each member of an ensemble of deep neural network pattern recognizers analyze pixel information of the patch, including some surrounding pixels, and generates a probability score of between 0 and 1.
- Each member operates on a patch of pixels but at different magnification levels.
- there are four such members in the ensemble For example, one operates on a 128 ⁇ 128 patch at 40 ⁇ magnification.
- a third one operates on a 128 ⁇ 128 patch but at 10 ⁇ (again, centered on or containing the 128 ⁇ 128 patch at 40 ⁇ ).
- a fourth one operates on a 128 ⁇ 128 patch at 5 ⁇ (again, centered on or containing the 128 ⁇ 128 patch at 40 ⁇ ).
- the outputs of the four pattern recognizers are then combined, in the manner described below in conjunction with the description of FIG. 5 .
- the original pixel data at 40 ⁇ is downsized or resampled to the corresponding magnification.
- the original input image is 20 ⁇ we upsample the image to create a 40 ⁇ image out of it, and downsample the 20 ⁇ image to obtain the 10 ⁇ and 5 ⁇ images. It is also possible to obtain four different digital images of the slide, one at each of 5 ⁇ , 10 ⁇ , 20 ⁇ and 40 ⁇ , thereby avoiding the need to downsample or upsample the images.
- the advantage to using an ensemble of deep neural network pattern recognizers at different magnifications centered on or containing a given patch of pixels at 40 ⁇ is that there are structures or features in the tissue images that are not fully revealed or difficult to accurately find in a pattern recognizer that operates at any one given magnification level, e.g., 40 ⁇ .
- the overall sensitivity and performance of the pattern recognizer in module 112 is enhanced by performing pattern recognition at at least two different powers of magnification, and as stated here preferably at at least four different powers. This enhancement is made so that the algorithm can recognize different morphological or cellular features at the different magnifications, so that the eventual prediction reflects a comprehensive picture or analysis of the tissue that takes detail, as well as context, into account.
- a final or ensemble score for the 128 ⁇ 128 pixel patch at 40 ⁇ is generated from the outputs of each member of the ensemble, such as an average of the scores generated by each member ( 306 A, 306 B, 3060 , 306 D) of the ensemble.
- Each final or ensemble score is associated a different color (per the key or code of FIG. 2 ) and the patches are combined to generate a heatmap 20 (see also FIG. 1C ).
- a score >0.9 means that the scoring algorithm has determined that the patch has the highest likelihood to have cancer cells.
- a score of 0.1-0.9 means that the algorithm does not have high enough confidence about the presence of metastasis. This often occurs with isolated tumor cells.
- a score ⁇ 0.1 means that the algorithm has determined the patch is likely to be normal.
- the code or key of FIG. 2 is used to convert the scores to color in the heatmap representation.
- Other grading scales or interpretations of the scores could be possible in alternative embodiments.
- the representation of the heatmap 20 preferably further includes a list of the top 10 regions of interest. This is a list of 10 areas that are the most “suspicious” for the pathologist to review. This list is ranked by the size of the region (as measured by the longest dimension of a region), which is also shown to the pathologist. Crosshairs are generated in the heatmap to approximate the center of each region of interest.
- the original digitized image (see FIG. 1A ) is displayed side by side with the heatmap.
- the software prompts the user to go over all 10 regions of interest to assess for metastasis at multiple zoom levels. The user can also then use caliper tools to confirm the size of the regions.
- a threshold of 0.9 is applied to the image to generate a mask of tiles that have score ⁇ 0.9 and ⁇ 0.9.
- the mask is dilated 37.5 microns in all directions such that positive tiles that are within 75 microns of each other are considered contiguous.
- the software calculates the largest dimension (diameter) and marks the center of each contiguous region and generates a list of up to 10 regions in order of largest dimension.
- a threshold of 0.5 is then applied to the image to generate another binary mask of patches that have score ⁇ 0.5 and ⁇ 0.5.
- the mask is again dilated 37.5 microns in all directions such that positive patches that are within 75 microns of each other are considered contiguous.
- the software calculates the largest dimension (diameter) and marks the center of each contiguous region and generates additional regions of interest until the maximum 10 regions of interest is provided.
- the pathologist is then prompted to review the ranked list of regions of interest.
- the pathologist can also at any time toggle back to see the full heatmap.
- the slide is considered reviewed if the pathologist has looked the ranked list of regions of interest. After review, the pathologist will be prompted to enter in the final results for the slide.
- FIG. 5 is a block diagram of the ensemble 300 of deep convolutional neural network pattern recognizers 306 A, 306 B, 306 C, 306 D and a module 310 which combines the outputs from each pattern recognizer to generate a final or ensemble score for each of the patches of FIG. 4 .
- the ensemble of FIG. 5 can be considered a software system which may reside on a pathologist workstation or may alternatively reside on one or more computers in a local or wide area network, in which case the workstation includes an application programming interface to the ensemble 300 .
- the ensemble was developed using a deep neural network approach. Specifically, a convolutional neural net model based on Google's Inception-v3 (also known as GoogleLeNet) was used and modified to classify abnormal tissue in image patches without explicit feature engineering.
- the development dataset consisted of 269 digitized slides from unique lymph node specimens, which consisted of 159 normal slides and 110 slides with the presence of tumor cells.
- Our sources of slide images for training included Naval Medical Center in San Diego, Calif. (NMCSD) and publicly available sources such as from the CAMELYON16 challenge and The Cancer Genome Atlas. Masks of tumor regions (see FIG.
- IHC immunohistochemical
- Each member of the ensemble has its own input 304 A, 304 B, 304 C, 304 D, namely the pixel data for a 128 ⁇ 128 patch plus surrounding pixel data, at the respective magnification level, e.g., the 299 ⁇ 299 pixel square centered on the 128 ⁇ 128 patch as shown at 302 .
- Each network 306 A, 306 B, 306 C, 306 D was then trained to predict whether the central 128 pixel square patch contained tumor cells based upon a larger 299 pixel square which shared the same center point as the 128 pixel square patch. This larger 299 ⁇ 299 pixel square is shown at 302 and at the top of FIG. 5 in dashed lines surrounding the 128 ⁇ 128 patch 200 .
- Each network 306 A, 306 B, 306 C, 306 D generates its own output 308 A, 308 B, 308 C, 308 D in the form of a score between 0 and 1.
- the score between 0 and 1 is usually generated as the last layer of the neural network pattern recognizers 306 A.
- 306 B, 306 C, 306 D in the form of a multinomial logistic regression, which generates a prediction, in the form of a probability of between 0 and 1, of which of the classes (here, healthy vs tumor) the input data (patch) belongs to.
- Multinomial logistical regression is known in the art of supervised learning and optimization, and is sometimes referred to as “Softmax Regression.”
- the outputs 308 A- 308 D of each of the pattern recognizers 306 A- 306 D is then combined in module 310 .
- the prediction at each location is averaged across the ensemble to generate an average score between 0 and 1 for the likelihood that the 128 pixel by 128 pixel image patch at 40 ⁇ was positive for the metastasis.
- the ensemble or average score for the patch is then converted to a color (or grayscale) per the code or key 22 ( FIG. 2 ). This process proceeds for every patch 200 in the image (see FIG. 4 ) and the overall aggregate of patches represented as a heatmap, see FIG. 1C , and provided for display on a pathologist workstation.
- the module “ensemble average” 310 in FIG. 5 could be implemented in a variety of ways. These include:
- the input to this further convolutional neural network is a matrix for each pattern recognizer 306 .
- the input heatmaps are not only a 1-dimensional matrix of probabilities for each patch, but also a higher dimensional feature vector for each patch, e.g. the last layer of the CNN in the pattern recognizer before the logistic regression layer in each respective pattern recognizer 306 .
- “Depth concatenation” is one way the stacking of N 1-d heatmaps into 1 N-d heatmap as input for a CNN.
- the model training in FIG. 5 makes use of pixel data surrounding the patch to generate the score.
- the patch 200 e.g., 128 ⁇ 128 pixels
- the patch is analyzed in the context of surrounding tissue whereby the patch is located within, e.g., centered in a 299 ⁇ 299 region.
- the pattern recognizers use surrounding pixel data as explained above to determine a score for the 128 ⁇ 128 pixel patch.
- the additional pixel data is only available on three sides of the patch and at the corner only at two of the edges of the patch.
- every given pixel patch is analyzed in a larger context of adjacent or surrounding pixels.
- Deep convolutional neural network pattern recognizers of the type used in 306 A- 306 D of FIG. 5 , are widely known in the art of pattern recognition and machine vision, and therefore a detailed description thereof is omitted for the sake of brevity.
- the Inception-v3 deep convolutional neural network architecture upon which the present pattern recognizers are based, is described in the scientific literature. See the following references, the content of which is incorporated by reference herein: C. Szegedy et al., Going Deeper with Convolutions (September 2014); C. Szegedy et al., Rethinking the Inception Architecture for Computer Vision (December 2015); see also US patent application of C.
- Inception-v4 is considered an alternative architecture for the pattern recognizers 306 .
- C. Vanhoucke “Image Classification Neural Networks”, Ser. No. 15/395,530 filed Dec. 30, 2016. The description of the convolutional neural networks in these papers and patent applications is incorporated by reference herein.
- the convolutional neural networks mentioned in the Background section of this document present alternatives tor the architecture of the pattern recognizers 306 A-D of FIG. 5 .
- augmentation techniques include performing at least one and preferably all of the following operations:
- step 1 we separate color and intensity information of the image by mapping from the raw RGB values to a Hue-Saturation-Density-Space. Such techniques are described in van Der Laak et al., Hue - saturation - density ( hsd ) model for stain recognition in digital images from transmitted light microscopy . Cytometry 39(4), 275-284 (2000)”). This creates a 2D color space.
- step 2 we fit a single Gaussian to the color coordinates in that 2D color space for each tissue-containing patch, and then determine transformation from those color coordinates to those of a reference image to which the colors should be normalized to.
- step 3 we map the colors from the 2D color space back to RGB values using the inverse transform from step 1 to create the color normalized image patch.
- the result of this normalization can be an image from a “virtual median” scanner, or from a particular scanner that we use as reference.
- training of the ensemble of neural network pattern recognizers 306 of FIG. 5 can be and optionally is performed across all of the possible rotations and flips of slides and all the possible types of perturbations of the training images, as well as the normalizations, or just some of them. Further, three or more different training runs on the same model may be performed to assess performance.
- FIG. 6 is a plot of the tumor detection accuracy of the method we have developed shown in FIG. 4 over the period from April 2016 to January 2017.
- the Y axis represents the free-response receiver operating characteristic (FROC) and is a measure of tumor detection accuracy in the present context.
- FROC free-response receiver operating characteristic
- the accuracy has increased from our initial efforts in April 2016, at a level of approximately 0.53, steadily to our current performance of approximately 0.9, which is higher than the current state of the art or the ability of a trained pathologist with infinite time.
- the April 2016 results were using only one Inception-v3 pattern recognizer or trained model.
- per slide balancing allowed us to achieve >75 percent accuracy by October 2016.
- We used to do this balancing over the whole set i.e. we did not make sure that that 1:1 balanced between normal and tumor was true for each individual slide image, but only for the set as a whole.
- FIG. 7 is an illustration of a pathologist 400 at a workstation 402 including keyboard 404 and display 406 , using the heatmap 20 of FIG. 1C and a list of regions of interest 408 to assist in identification of tumor cells in lymph node tissue.
- the red areas 24 indicate areas of high probability of tumor cells and blue or violet areas 26 indicate areas of low probability of tumor cells.
- the workstation 402 may include a processor and software storing the ensemble of deep neural network pattern recognizers of FIG. 5 .
- the workstation 402 could include software in the form of an application programming interface (API) which interfaces to the computer and software system 108 of FIG. 3 , in which case the ensemble of deep neural network pattern recognizers of FIG.
- API application programming interface
- the images may be digitized and stored on a host network remote from the pathologist office.
- the pathologist workstation has work flow software that guides the pathologist in evaluating slides but the processing of the image data in module 112 to score the individual patches could take place in remote computers connected via the API and the network 410 .
- the implementation of the software functions of FIG. 3 can be implemented as an API, as a browser-based web service, or as a part of an imaging or display device which is paired to a mobile or hand-held device or computer.
- the term “workstation” is intended to refer broadly to include, among other things, a desk-top computer, a laptop computer, a tablet computer, a head-up display and other mobile computers including smart phones or special purpose handheld devices.
- a method for analyzing a tissue biopsy comprises (a) receiving image data representing tissue from the tissue biopsy, the image data obtained at a first magnification (e.g., 40 ⁇ ); (b) subdividing the image data into a plurality of patches (see FIG.
- each patch comprising a portion of the image data representing a respective portion of the tissue from the tissue biopsy; and (c) for each of the patches, determining a likelihood of malignancy score, wherein the score is obtained by processing the patch using an ensemble of deep neural network pattern recognizers, and combining the outputs of each of the deep neural network pattern recognizers, wherein the ensemble of deep neural network pattern recognizers are arranged to process the patch at a plurality of levels of magnification including the first magnification (e.g. 40 ⁇ ) and a second magnification, e.g., 20 ⁇ , 10 ⁇ or 5 ⁇ .
- first magnification e.g. 40 ⁇
- a second magnification e.g. 20 ⁇ , 10 ⁇ or 5 ⁇ .
- the method may further comprise assigning a value to each patch in accordance with the likelihood of malignancy score assigned to the patch by the deep neural network pattern recognizer.
- Output data representing the tissue, e.g., a heatmap as shown in FIG. 1C , from the tissue biopsy may be generated based upon the assigned values.
- the method may further comprise training the ensemble of pattern recognizers using a plurality of training images.
- At least one training image of the plurality of training images may be generated by performing at least one operation on at least one image representing tissue from a tissue biopsy.
- the at least one operation may comprise a modification of image data represented in the at least one image representing tissue from the tissue biopsy.
- the at least one operation may be selected from the group consisting of: 1) performing geometric perturbations to the training images, 2) performing image color statistics perturbation on the training images, 3) normalization of image color statistics of the training images, 4) rotations, up/down and left/right flips of the training images, and 5) introduction of jitter into the training images.
- the method may comprise performing one or more combinations of the operations to generate the at least one training image. For example, a plurality of images representing tissue may be obtained.
- the ensemble of pattern recognizers may be trained using the plurality of images representing tissue and further training images generated based upon the plurality of images.
- the method may further comprise using both image data in the patch and image data from a region of the image surrounding each patch to assign the likelihood of malignancy score to the patch.
- the region of the image data surround the patch may comprise image data representing a portion of the tissue from the tissue biopsy adjacent to the portion of the tissue represented by the patch, or for example image data representing a portion of the tissue surrounding the patch.
- the patch may comprise a square or rectangular region comprising a plurality of pixels.
- the region may be centered within the portion of the image data representing the respective portion of the tissue from the tissue biopsy represented by the patch.
- Processing each patch at a plurality of levels of magnification may comprise processing a first portion of the image data representing the portion of the tissue from the tissue biopsy associated with the patch; and processing a second portion of the image data comprising the first portion of the image data and additional image data representing a portion of the tissue from the tissue biopsy surrounding the portion of the tissue from the tissue biopsy associated with the patch.
- Each of the plurality of levels of magnification may represent a different portion of the tissue from the tissue biopsy including the portion of the tissue biopsy associated with the patch.
- Each of the plurality of levels of magnification may, for example, comprise an array of pixels such as a two-dimensional array of pixels, each of the arrays of pixels representing a portion of the image data comprising the first portion of the image data.
- Each of the arrays of pixels may be of the same size. That is, each array of pixels may comprise a corresponding number of pixels. Pixels in arrays associated with different levels of magnification may therefore represent different portions of the tissue from the tissue biopsy of different sizes.
- the method may further comprise initially performing an image quality assessment for each patch.
- the method may comprise determining a score for the patch if the image quality assessment determines that the patch is gradable. That is, the score may indicate whether the image data representing the patch is of sufficiently high quality for further processing.
- the image quality assessment for the patch may be performed by a trained neural network.
- the method may further comprise generating a list of regions of interest present in the representation.
- each patch comprising a portion of the digital image representing a respective portion of the tissue.
- the patch may be any two dimensional array of pixels, such as a rectangular or square array.
- determining a likelihood of malignancy score wherein the score is obtained by analyzing pixel data in the digital image including the patch using an ensemble of deep neural network pattern recognizers ( FIG. 5, 306 ) at multiple levels of magnification including the first magnification (e.g., 40 ⁇ ) and at least a second magnification (e.g., 20 ⁇ ) centered on or containing the patch, and combining the outputs of each of the deep neural network pattern recognizers.
- image augmentation is performed during training of the ensemble of models, including performing at least one of the following operations: geometric perturbations, image color statistics perturbation, normalization of image color statistics, rotations and up/down flips of training images, and introduction of jitter.
- the models are trained using image data surrounding the patch to generate scores by each member of ensemble.
- an initial image quality assessment is performed for each patch.
- a trained neural network can be used to make this image quality assessment.
- the heatmap is preferably generated along with a list of regions of interest, which may be ranked or ordered by size.
- Crosshairs can be generated in the heatmap to approximate the center of each region.
- the original digitized image may be displayed side by side with the heatmap.
- the software will then prompt the user to go over all regions of interest to assess for metastasis at multiple zoom levels. The user can also then use caliper tools to confirm the size of the regions.
- a computer system e.g., FIG. 7 workstation 400 , or remote computer 412 which is programmed as a machine for assessing the likelihood of presence of tumor cells in digital slide containing lymph node tissue.
- the computer includes an ensemble of deep neural network pattern recognizers ( FIG. 5, 306 ), each trained on a multitude of digital slide images of lymph node tissue at a particular and different magnification level of the digital slide images (e.g., 40 ⁇ , 20 ⁇ , 10 ⁇ and 5 ⁇ ).
- Each member of the ensemble generates an output ( FIG. 5, 308 ) in the form of a likelihood of malignancy score for a patch 200 of the digital slide 10 containing lymph node tissue.
- the outputs of each of the members of the ensemble are combined ( FIG. 5, 310 ) to generate an overall or ensemble likelihood of malignancy score for the patch.
- a system for assisting a user (e.g., pathologist) in identifying tumor cells in a tissue sample obtained from a biopsy.
- the system includes a workstation 400 ( FIG. 7 ) configured to display a magnified digital image of a slide containing the tissue.
- the system further includes an application programming interlace (API) to a software system ( FIG. 3 ) configured as an ensemble of deep neural network pattern recognizers ( FIG. 5 ), each trained on a training set comprising multitude of digital slide images of benign and cancerous tissue at a particular and different magnification level of the digital slide images.
- the software system ( FIG. 3 ) is further configured to subdivide the digital image into a multitude of patches ( FIG.
- each patch in the form of a rectangular array of pixels.
- the software system is further configured for determining, for each of the patches, a likelihood of malignancy score, wherein the score is obtained by analyzing pixel data in the digital image including the patch using the ensemble of deep neural network pattern recognizers ( FIG. 5, 306 ).
- the workstation 400 is further configured to present on the display a representation of the slide (i.e., heatmap 20 ) wherein each of the patches is assigned a color or equivalent (e.g. grayscale value) in accordance with (1) the likelihood of malignancy score assigned to the patch by the ensemble of deep neural network pattern recognizers and (2) a code, e.g., key or other assignment mechanism (see 22 , FIG. 2 ) which assigns distinct colors (or equivalently grayscale values) to different values of likelihood of malignancy scores assigned to the patches.
- a code e.g., key or other assignment mechanism
- aspects can be implemented in any convenient way.
- other example aspects of the present disclosure are directed to systems, apparatus, tangible, non-transitory computer-readable media, user interfaces, memory devices, and electronic devices for analyzing a tissue biopsy.
Abstract
Description
4. Code implementing a convolutional neural network (“CNN”). If the training set is large enough we believe this approach may be the most effective and most generalizable one. In further detail, the input to this further convolutional neural network is a matrix for each pattern recognizer 306. Specifically, one option is to take the whole heatmap for each of the N pattern recognizers (a matrix consisting of an array of scores for each patch in the slide) and have the CNN use those N heatmaps as input to output one combined heatmap. A more general approach to this is that the input heatmaps are not only a 1-dimensional matrix of probabilities for each patch, but also a higher dimensional feature vector for each patch, e.g. the last layer of the CNN in the pattern recognizer before the logistic regression layer in each respective pattern recognizer 306. “Depth concatenation” is one way the stacking of N 1-d heatmaps into 1 N-d heatmap as input for a CNN.
(c) For each of the
(d) Generating a representation of the slide (
Claims (20)
Applications Claiming Priority (1)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
PCT/US2017/019051 WO2018156133A1 (en) | 2017-02-23 | 2017-02-23 | Method and system for assisting pathologist identification of tumor cells in magnified tissue images |
Publications (2)
Publication Number | Publication Date |
---|---|
US20200066407A1 US20200066407A1 (en) | 2020-02-27 |
US11170897B2 true US11170897B2 (en) | 2021-11-09 |
Family
ID=63254456
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
US16/488,029 Active 2037-06-26 US11170897B2 (en) | 2017-02-23 | 2017-02-23 | Method and system for assisting pathologist identification of tumor cells in magnified tissue images |
Country Status (4)
Country | Link |
---|---|
US (1) | US11170897B2 (en) |
EP (1) | EP3570753A4 (en) |
CN (1) | CN110337644A (en) |
WO (1) | WO2018156133A1 (en) |
Cited By (1)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US11544843B2 (en) * | 2019-04-26 | 2023-01-03 | California Institute Of Technology | Tracking biological objects over time and space |
Families Citing this family (43)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
WO2018231204A1 (en) | 2017-06-13 | 2018-12-20 | Google Llc | Augmented reality microscope for pathology |
US11195274B2 (en) * | 2017-08-03 | 2021-12-07 | Nucleai Ltd | Systems and methods for analysis of tissue images |
JP7076698B2 (en) * | 2017-11-17 | 2022-05-30 | 国立研究開発法人国立がん研究センター | Image analysis method, image analysis device, program, learned deep learning algorithm manufacturing method and learned deep learning algorithm |
JP7137935B2 (en) * | 2018-02-27 | 2022-09-15 | シスメックス株式会社 | Image analysis method, image analysis device, program, method for manufacturing trained deep learning algorithm, and trained deep learning algorithm |
US10878569B2 (en) * | 2018-03-28 | 2020-12-29 | International Business Machines Corporation | Systems and methods for automatic detection of an indication of abnormality in an anatomical image |
WO2019190518A1 (en) | 2018-03-29 | 2019-10-03 | Google Llc | Similar medical image search |
US11893739B2 (en) | 2018-03-30 | 2024-02-06 | The Regents Of The University Of California | Method and system for digital staining of label-free fluorescence images using deep learning |
US10706328B2 (en) | 2018-05-07 | 2020-07-07 | Google Llc | Focus-weighted, machine learning disease classifier error prediction for microscope slide images |
JP2019195304A (en) | 2018-05-10 | 2019-11-14 | 学校法人順天堂 | Image analysis method, device, computer program, and generation method of deep learning algorithm |
US10957041B2 (en) | 2018-05-14 | 2021-03-23 | Tempus Labs, Inc. | Determining biomarkers from histopathology slide images |
US11741365B2 (en) | 2018-05-14 | 2023-08-29 | Tempus Labs, Inc. | Generalizable and interpretable deep learning framework for predicting MSI from histopathology slide images |
US20210264214A1 (en) * | 2018-07-19 | 2021-08-26 | The Regents Of The University Of California | Method and system for digital staining of label-free phase images using deep learning |
US10769744B2 (en) * | 2018-10-31 | 2020-09-08 | Kabushiki Kaisha Toshiba | Computer vision system and method |
WO2020121678A1 (en) * | 2018-12-14 | 2020-06-18 | 富士フイルム株式会社 | Mini-batch learning device, operating program for mini-batch learning device, operating method for mini-batch learning device, and image processing device |
CA3125448A1 (en) * | 2018-12-31 | 2020-07-09 | Tempus Labs, Inc. | Artificial intelligence segmentation of tissue images |
KR102202361B1 (en) * | 2019-01-08 | 2021-01-14 | 전남대학교산학협력단 | System for detecting bone tumour |
KR102307995B1 (en) * | 2019-01-11 | 2021-10-01 | 경북대학교 산학협력단 | The diagnostic system of lymph node metastasis in thyroid cancer using deep learning and method thereof |
US10936160B2 (en) | 2019-01-11 | 2021-03-02 | Google Llc | System, user interface and method for interactive negative explanation of machine-learning localization models in health care applications |
CN110097580B (en) * | 2019-03-18 | 2021-10-19 | 山东师范大学 | Ultrasonic image marker motion tracking method |
JP7381003B2 (en) * | 2019-04-26 | 2023-11-15 | 学校法人順天堂 | METHODS, APPARATUS AND COMPUTER PROGRAMS TO ASSIST DISEASE ANALYSIS AND METHODS, APPARATUS AND PROGRAMS FOR TRAINING COMPUTER ALGORITHM |
WO2020227298A1 (en) * | 2019-05-06 | 2020-11-12 | Verint Americas Inc. | Systems and methods for combining model interpreters |
CN113785365A (en) | 2019-05-10 | 2021-12-10 | 拜耳消费者护理股份有限公司 | Identification of candidate markers indicative of NTRK oncogenic fusion |
JP7100336B2 (en) * | 2019-05-16 | 2022-07-13 | ペイジ．エーアイ インコーポレイテッド | Systems and methods for processing images and classifying processed images for digital pathology |
CN114787876A (en) * | 2019-06-25 | 2022-07-22 | 奥金股份有限公司 | System and method for image pre-processing |
WO2021002813A1 (en) * | 2019-07-01 | 2021-01-07 | Manti̇scope Tibbi̇ Ci̇hazlar Araştirma Ve Geli̇şti̇rme Ltd. Şti̇. | System and method for digitialization, analysis and storage of biological samples |
EP4014156A1 (en) * | 2019-08-13 | 2022-06-22 | Sanofi | Predicting patient responses to a chemical substance |
CN110689525B (en) * | 2019-09-09 | 2023-10-13 | 上海中医药大学附属龙华医院 | Method and device for identifying lymph nodes based on neural network |
CN111008953B (en) * | 2019-10-29 | 2023-10-31 | 平安科技（深圳）有限公司 | Digital pathological image quality control method and device |
CN110866908B (en) * | 2019-11-12 | 2021-03-26 | 腾讯科技（深圳）有限公司 | Image processing method, image processing apparatus, server, and storage medium |
US11908130B2 (en) * | 2020-01-03 | 2024-02-20 | Protein Metrics Llc | Apparatuses and methods for digital pathology |
EP3855452A1 (en) * | 2020-01-24 | 2021-07-28 | Koninklijke Philips N.V. | Tumor classification |
WO2021202482A1 (en) * | 2020-03-30 | 2021-10-07 | Verily Life Sciences Llc | Artificial intelligence-based assistant for concurrent review of needle core prostate biopsies |
CN111751371B (en) * | 2020-06-24 | 2021-01-08 | 武汉中纪生物科技有限公司 | Immunohistochemical digital slide reading system and method |
CN112233061A (en) * | 2020-09-07 | 2021-01-15 | 中国人民解放军海军军医大学第一附属医院 | Deep learning-based skin basal cell carcinoma and Babylonia disease identification method |
WO2022101902A1 (en) * | 2020-11-11 | 2022-05-19 | Imagene Ai Ltd. | Methods and systems for training a model to diagnose abnormalities in tissue samples |
CN112560675B (en) * | 2020-12-15 | 2022-06-21 | 三峡大学 | Bird visual target detection method combining YOLO and rotation-fusion strategy |
CN112884725B (en) * | 2021-02-02 | 2022-12-20 | 杭州迪英加科技有限公司 | Correction method for neural network model output result for cell discrimination |
DE102021203251B3 (en) * | 2021-03-31 | 2022-09-08 | Siemens Healthcare Gmbh | Digital pathology using an artificial neural network |
CN113256573B (en) * | 2021-05-12 | 2023-03-14 | 山东志盈医学科技有限公司 | Method and device for judging quality of digital slice |
US20230024468A1 (en) * | 2021-07-26 | 2023-01-26 | PAIGE.AI, Inc. | Systems and methods to process electronic images to determine histopathology quality |
CN113704412B (en) * | 2021-08-31 | 2023-05-02 | 交通运输部科学研究院 | Early identification method for revolutionary research literature in transportation field |
CN113889261B (en) * | 2021-09-23 | 2022-06-10 | 之江实验室 | Pathological feature assistance-based PET/CT automatic lung cancer diagnosis classification model training method |
CN114648680B (en) * | 2022-05-17 | 2022-08-16 | 腾讯科技（深圳）有限公司 | Training method, device, equipment and medium of image recognition model |
Citations (9)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US20060018524A1 (en) * | 2004-07-15 | 2006-01-26 | Uc Tech | Computerized scheme for distinction between benign and malignant nodules in thoracic low-dose CT |
US20080044080A1 (en) * | 2006-04-17 | 2008-02-21 | Fujifilm Corporation | Image processing method, apparatus, and program |
US20120136255A1 (en) | 2010-06-07 | 2012-05-31 | Shu Feng Fan | Tissue malignant tumor detection method and tissue malignant tumor detection apparatus |
US20130156279A1 (en) | 2011-12-20 | 2013-06-20 | Definiens Ag | Evaluation of Co-Registered Images of Differently Stained Tissue Slices |
US20150063667A1 (en) * | 2013-08-29 | 2015-03-05 | General Electric Company | Methods and systems for evaluating bone lesions |
US20160063359A1 (en) | 2014-08-29 | 2016-03-03 | Google Inc. | Processing images using deep neural networks |
US20160328606A1 (en) * | 2013-11-15 | 2016-11-10 | Facebook, Inc. | Pose-aligned networks for deep attribute modeling |
US20170032244A1 (en) * | 2015-07-31 | 2017-02-02 | International Business Machines Corporation | Learning a model for recognition processing |
US10460211B2 (en) | 2016-02-18 | 2019-10-29 | Google Llc | Image classification neural networks |
Family Cites Families (2)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN101714153A (en) * | 2009-11-16 | 2010-05-26 | 杭州电子科技大学 | Visual perception based interactive mammography image searth method |
CN106127255B (en) * | 2016-06-29 | 2020-01-10 | 深圳先进技术研究院 | Classification system of cancer digital pathological cell images |
-
2017
- 2017-02-23 EP EP17897692.4A patent/EP3570753A4/en active Pending
- 2017-02-23 WO PCT/US2017/019051 patent/WO2018156133A1/en unknown
- 2017-02-23 US US16/488,029 patent/US11170897B2/en active Active
- 2017-02-23 CN CN201780087287.8A patent/CN110337644A/en active Pending
Patent Citations (9)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US20060018524A1 (en) * | 2004-07-15 | 2006-01-26 | Uc Tech | Computerized scheme for distinction between benign and malignant nodules in thoracic low-dose CT |
US20080044080A1 (en) * | 2006-04-17 | 2008-02-21 | Fujifilm Corporation | Image processing method, apparatus, and program |
US20120136255A1 (en) | 2010-06-07 | 2012-05-31 | Shu Feng Fan | Tissue malignant tumor detection method and tissue malignant tumor detection apparatus |
US20130156279A1 (en) | 2011-12-20 | 2013-06-20 | Definiens Ag | Evaluation of Co-Registered Images of Differently Stained Tissue Slices |
US20150063667A1 (en) * | 2013-08-29 | 2015-03-05 | General Electric Company | Methods and systems for evaluating bone lesions |
US20160328606A1 (en) * | 2013-11-15 | 2016-11-10 | Facebook, Inc. | Pose-aligned networks for deep attribute modeling |
US20160063359A1 (en) | 2014-08-29 | 2016-03-03 | Google Inc. | Processing images using deep neural networks |
US20170032244A1 (en) * | 2015-07-31 | 2017-02-02 | International Business Machines Corporation | Learning a model for recognition processing |
US10460211B2 (en) | 2016-02-18 | 2019-10-29 | Google Llc | Image classification neural networks |
Non-Patent Citations (25)
Title |
---|
"Breast cancer histopathological image classification using Convolutional Neural Networks", Fabio Alexandre Spanhol et al., 2016 International Joint Conference On Neural Networks (IJCNN), IEEE, pp. 2560-2567 (Jul. 24, 2016). |
"Deep Learning as a Tool for Increasing Accuracy and Efficiency of Histopathological Diagnosis"; Geert Litjens, et al.; Scientific Reports | 6:26286 | DOI: 10.1038/srep26286 (May 23, 2016). |
"Deep Learning for Identifying Metastatic Breast Cancer"; Dayong Wang, et al.; arXiv:1606.05718v1 (Jun. 18, 2016). |
"Evaluating Stability of Histomorphometric Features Across Scanner and Staining Variations: Prostate Cancer Diagnosis from Whole Slide Images"; Patrick Leo, et al.; Journal of Medical Imaging 3(4), 047502 (Dec. 2016). |
"Going Deeper with Convolutions"; Christian Szegedy, et al.; arXiv:1409.4842v1 (Sep. 17, 2014). |
"H&E-stained Whole Slide Deep Learning Predicts SPOP Mutation State in Prostate Cancer"; Andrew J. Schaumbert, et al.; bioRxiv preprint; http://biorxiv.org/content/early/2016/07/17/064279 (Jul. 17, 2016). |
"Histopathological Image Analysis: A Review", M. N. Gurcan et al., IEEE Reviews in Biomedical Engineering, IEEE, USA, vol. 2, pp. 147-171 (Jan. 1, 2009). |
"Hue-Saturation-Density (HSD) Model for Stain Recognition in Digital Images from Transmitted Light Microscopy" Jeroen A.W.M. van der Laak, et al.; Cytometry 39:275-284 (2000). |
"Image Analysis and Machine Learning in Digital Pathology: Challenges and Opportunities"; Anant Madabhushi, et al.; Medical Image Analysis 33, pp. 170-175 (Jul. 4, 2016). |
"Inception-v4, Inception-ResNet and the Impact of Residual Connections on Learning"; Christian Szegedy, et al.; arXiv:1602.07261v2 (Aug. 23, 2016). |
"Locality Sensitive Deep Learning for Detection and Classification of Nuclei in Routine Colon Cancer Histology Images", Sirinukunwattana Korsuk et al., IEEE Transactions on Medical Imaging, vol. 35, No. 5 , pp. 1196-1206 (May 1, 2016). |
"Mitosis Detection in Breast Cancer Histology Images with Deep Neural Networks", Dan C. Ciresan et al., Annual International Conference on the Theory and Applications of Cryptographic Techniques, Eurocrypt 2018, Springer, Berlin, Heidelberg, pp. 411-418 (Sep. 22, 2013). |
"Pathology imaging informatics for quantitative analysis of whole-slide images", Kothari Sonal et al., Journal of the American Medical Informatics Association, vol. 20, No. 6, pp. 1099-1108 (Nov. 1, 2013). |
"Rethinking the Inception Architecture for Computer Vision"; Christian Szegedy, et al.; arXiv:1512.00567v3 (Dec. 11, 2015). |
"Softmax Regression"; Unsupervised Feature Learning and Deep Learning Tutorial; retrieved from URL: http://ufldl.stanford.edu/tutorial/supervised/SoftmaxRegression/; formatted version, as well as version retrieved from archive.org corresponding to (Dec. 5, 2016) included. |
"Stain Specific Standardization of Whole Slide Histopathological Images"; Babak Ehteshami Bejnordi, et al.; IEEE Transactions on Medical Imaging; DOI 11.1109/TMI.2015.2476509 (Feb. 2016). |
"The Linear Monge-Kantorovitch Linear Colour Mapping for Example-Based Colour Transfer"; F. Pitie′, et al.; 4th European Conference on Visual Media Production (2007). |
D. Mahapatra, P. K. Roy, S. Sedai and R. Garnavi, "A CNN based neurobiology inspired approach for retinal image quality assessment," 2016 38th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), Orlando, FL, USA, 2016, pp. 1304-1307, (Year: 2016). * |
F. A. Spanhol, L. S. Oliveira, C. Petitjean and L. Heutte, "Breast cancer histopathological image classification using Convolutional Neural Networks," 2016 International Joint Conference on Neural Networks (IJCNN), Vancouver, BC, Canada, 2016, pp. 2560-2567, doi: 10.1109/IJCNN.2016.7727519. (Year: 2016). * |
Frazão X., Alexandre L.A. (2014) Weighted Convolutional Neural Network Ensemble. In: Bayro-Corrochano E., Hancock E. (eds) Progress in Pattern Recognition, Image Analysis, Computer Vision, and Applications. CIARP 2014. Lecture Notes in Computer Science, vol. 8827. Springer, Cham. (Year: 2014). * |
Le Hou, Dimitris Samaras, Tahsin M. Kurc, Yi Gao, James E. Davis, Joel H. Saltz; Patch-Based Convolutional Neural Network for Whole Slide Tissue Image Classification. Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR), 2016, pp. 2424-2433 (Year: 2016). * |
N. Bayramoglu, J. Kannala and J. Heikkilä, "Deep learning for magnification independent breast cancer histopathology image classification," 2016 23rd International Conference on Pattern Recognition (ICPR), Cancun, Mexico, 2016, pp. 2440-2445, doi: 10.1109/ICPR.2016.7900002. (Year: 2016). * |
PCT International Search Report and Written Opinion, PCT International Application No. PCT/US2017/019051, dated May 4, 2017, 11 pages. |
V. Gupta and A. Bhavsar, "Breast Cancer Histopathological Image Classification: Is Magnification Important?," 2017 IEEE Conference on Computer Vision and Pattern Recognition Workshops (CVPRW), Honolulu, HI, 2017, pp. 769-776, doi: 10.1109/CVPRW.2017.107. (Year: 2017). * |
Wang, D., Khosla, A., Gargeya, R., Irshad, H., & Beck, A. (2016). Deep Learning for Identifying Metastatic Breast Cancer. ArXiv, abs/1606.05718. (Year: 2016). * |
Cited By (2)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US11544843B2 (en) * | 2019-04-26 | 2023-01-03 | California Institute Of Technology | Tracking biological objects over time and space |
US20230394675A1 (en) * | 2019-04-26 | 2023-12-07 | California Institute Of Technology | Tracking biological objects over time and space |
Also Published As
Publication number | Publication date |
---|---|
EP3570753A1 (en) | 2019-11-27 |
US20200066407A1 (en) | 2020-02-27 |
EP3570753A4 (en) | 2020-10-21 |
CN110337644A (en) | 2019-10-15 |
WO2018156133A1 (en) | 2018-08-30 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
US11170897B2 (en) | Method and system for assisting pathologist identification of tumor cells in magnified tissue images | |
JP7422825B2 (en) | Focus-weighted machine learning classifier error prediction for microscope slide images | |
US11288795B2 (en) | Assessing risk of breast cancer recurrence | |
Van Eycke et al. | Segmentation of glandular epithelium in colorectal tumours to automatically compartmentalise IHC biomarker quantification: A deep learning approach | |
JP6086949B2 (en) | Image analysis method based on chromogen separation | |
US9031294B2 (en) | Region segmented image data creating system and feature extracting system for histopathological images | |
JP2020205063A (en) | Image analysis system using context features | |
US11977984B2 (en) | Using a first stain to train a model to predict the region stained by a second stain | |
CN110853005A (en) | Immunohistochemical membrane staining section diagnosis method and device | |
Shafiei et al. | Class-agnostic weighted normalization of staining in histopathology images using a spatially constrained mixture model | |
CN111656393A (en) | Histological image analysis | |
Paeng et al. | A unified framework for tumor proliferation score prediction in breast histopathology | |
US20240112341A1 (en) | Digital synthesis of histological stains using multiplexed immunofluorescence imaging | |
Teverovskiy et al. | Improved prediction of prostate cancer recurrence based on an automated tissue image analysis system | |
CN115018820A (en) | Breast cancer multi-classification method based on texture enhancement | |
Gandomkar et al. | Determining image processing features describing the appearance of challenging mitotic figures and miscounted nonmitotic objects | |
CN113837255A (en) | Methods, devices and media for predicting karyotype classes of cell-based antibodies | |
WO2016076104A1 (en) | Image processing method, image processing device, and program | |
Les et al. | Localization of spots in FISH images of breast cancer using 3‐D shape analysis | |
Morreale | A Perceptual Colour Separation Methodology for Automated Quantification of Ki67 and Hematoxylin Stained Digital Histopathology Images | |
CN111325732B (en) | Face residue detection method and related equipment | |
CN115984164A (en) | Labeling method of light source bounding box, training method and device of region detection model | |
CN116580397A (en) | Pathological image recognition method, device, equipment and storage medium | |
CN116416615A (en) | Pathological image IHC dyeing quality evaluation device | |
Tiwaria | Computational Assessment of Tumor Microenvironment Heterogeneity and Tumor-Stroma Interactions Using SE-ResNet based Enhanced Feature Extraction Networks in High-Resolution Breast Cancer Histopathology |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
FEPP | Fee payment procedure |
Free format text: ENTITY STATUS SET TO UNDISCOUNTED (ORIGINAL EVENT CODE: BIG.); ENTITY STATUS OF PATENT OWNER: LARGE ENTITY |
|
AS | Assignment |
Owner name: GOOGLE INC., CALIFORNIAFree format text: ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:STUMPE, MARTIN CHRISTIAN;PENG, LILY;LIU, YUN;AND OTHERS;SIGNING DATES FROM 20170310 TO 20170316;REEL/FRAME:050738/0440Owner name: GOOGLE LLC, CALIFORNIAFree format text: CHANGE OF NAME;ASSIGNOR:GOOGLE INC.;REEL/FRAME:051798/0216Effective date: 20170930 |
|
STPP | Information on status: patent application and granting procedure in general |
Free format text: NON FINAL ACTION MAILED |
|
STPP | Information on status: patent application and granting procedure in general |
Free format text: RESPONSE TO NON-FINAL OFFICE ACTION ENTERED AND FORWARDED TO EXAMINER |
|
STPP | Information on status: patent application and granting procedure in general |
Free format text: NOTICE OF ALLOWANCE MAILED -- APPLICATION RECEIVED IN OFFICE OF PUBLICATIONS |
|
STPP | Information on status: patent application and granting procedure in general |
Free format text: PUBLICATIONS -- ISSUE FEE PAYMENT VERIFIED |
|
STCF | Information on status: patent grant |
Free format text: PATENTED CASE |