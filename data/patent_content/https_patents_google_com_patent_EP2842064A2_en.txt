EP2842064A2 - Providing query suggestions - Google Patents
Providing query suggestionsInfo
- Publication number
- EP2842064A2 EP2842064A2 EP13812569.5A EP13812569A EP2842064A2 EP 2842064 A2 EP2842064 A2 EP 2842064A2 EP 13812569 A EP13812569 A EP 13812569A EP 2842064 A2 EP2842064 A2 EP 2842064A2
- Authority
- EP
- European Patent Office
- Prior art keywords
- query
- suggestions
- completeness
- measure
- query suggestions
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Withdrawn
Links
- 238000000034 method Methods 0.000 claims abstract description 36
- 238000004590 computer program Methods 0.000 claims abstract description 14
- 238000013507 mapping Methods 0.000 claims description 55
- 230000008569 process Effects 0.000 description 13
- 230000009471 action Effects 0.000 description 11
- 238000004891 communication Methods 0.000 description 7
- 238000012545 processing Methods 0.000 description 7
- 238000010586 diagram Methods 0.000 description 6
- 238000013515 script Methods 0.000 description 4
- 230000003993 interaction Effects 0.000 description 3
- 230000004044 response Effects 0.000 description 3
- 239000000284 extract Substances 0.000 description 2
- 238000000926 separation method Methods 0.000 description 2
- 230000006870 function Effects 0.000 description 1
- 239000004973 liquid crystal related substance Substances 0.000 description 1
- 230000003287 optical effect Effects 0.000 description 1
- 238000010079 rubber tapping Methods 0.000 description 1
- 239000004065 semiconductor Substances 0.000 description 1
- 230000001953 sensory effect Effects 0.000 description 1
- 239000000758 substrate Substances 0.000 description 1
- 238000012546 transfer Methods 0.000 description 1
- 230000000007 visual effect Effects 0.000 description 1
Classifications
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F16/00—Information retrieval; Database structures therefor; File system structures therefor
- G06F16/90—Details of database functions independent of the retrieved data types
- G06F16/95—Retrieval from the web
- G06F16/953—Querying, e.g. by the use of web search engines
- G06F16/9532—Query formulation
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F16/00—Information retrieval; Database structures therefor; File system structures therefor
- G06F16/90—Details of database functions independent of the retrieved data types
- G06F16/95—Retrieval from the web
- G06F16/951—Indexing; Web crawling techniques
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06F—ELECTRIC DIGITAL DATA PROCESSING
- G06F16/00—Information retrieval; Database structures therefor; File system structures therefor
- G06F16/30—Information retrieval; Database structures therefor; File system structures therefor of unstructured textual data
- G06F16/33—Querying
- G06F16/332—Query formulation
- G06F16/3322—Query formulation using system suggestions
Definitions
- This specification relates to providing search query suggestions.
- Internet search engines provide information about Internet accessible resources (e.g., web pages, images, text documents, multimedia content) that are responsive to a user's search query by returning a set of search results in response to the query.
- a search result includes, for example, a Uniform Resource Locator (URL) and a snippet of information for resources responsive to a query.
- Some search engines provide query suggestions to users. For example, a search engine can provide query suggestions to be displayed below a text entry field while a user enters a query into the text entry field, or a search engine can provide query suggestions for a submitted query on a search results web page, e.g., below the search results.
- one innovative aspect of the subject matter described in this specification can be embodied in methods that include the actions of receiving a search string from a user device; determining a measure of query completeness for the search string; comparing the measure of query completeness to a threshold measure of query completeness; and providing one or more specific query suggestions to the user device, selected from a plurality of specific query suggestions for the search string, when the measure of query completeness exceeds the threshold measure of query completeness; or providing one or more general query suggestions to the user device, selected from a plurality of general query suggestions for the search string, when the measure of query completeness does not exceed the threshold measure of query completeness.
- inventions of this aspect include corresponding systems, apparatus, and computer programs, configured to perform the actions of the methods, encoded on computer storage devices.
- a system of one or more computers can be configured to perform particular actions by virtue of having software, firmware, hardware, or a combination of them installed on the system that in operation causes or cause the system to perform the actions.
- One or more computer programs can be configured to perform particular actions by virtue of including instructions that, when executed by data processing apparatus, cause the apparatus to perform the actions.
- Providing the one or more selected specific query suggestions or the one or more selected general query suggestions is performed prior to receiving a command from the user device to perform a search using the search string as a query.
- Determining the measure of query completeness for the search string includes determining a probability of receiving the N most probable query suggestions for the search string, wherein N is an integer greater than zero.
- Determining the probability of receiving a first one of the N most probable query suggestion includes: determining, from a query log, a plurality of candidate query suggestions based on the search string; determining, from the query log, a count of the number of times the plurality of candidate query suggestions were received and a count of the number of times the first one of the N most probable query suggestions was received; and dividing the count of the number of times the first one of the N most probable query suggestions were received by the count of the number of times the plurality of candidate query suggestions were received.
- Comparing the measure of query completeness to the threshold measure of query completeness includes comparing the probability of the user selecting the N most probable query suggestions to a threshold probability.
- Determining the measure of query completeness for the search string includes: selecting a plurality of candidate query suggestions; determining, for each candidate query suggestion, a probability for the candidate query suggestion based on a count in a query log of the number of times that the plurality of candidate query suggestions were submitted as search queries and a count in the query log of the number of times that the candidate query was submitted as a search query; determining, for each candidate query suggestion, a product of the probability of the candidate query suggestion multiplied by a logarithm of the probability of the candidate query suggestion; and summing the determined products of the candidate query suggestions. Selecting the plurality of candidate query suggestions includes selecting the N most probable query suggestions, wherein N is an integer greater than zero.
- Comparing the measure of query completeness to a threshold measure of query completeness comprises comparing the sum of the determined entropies to a threshold sum.
- Each specific query suggestion is stored in a query suggestion repository, and wherein the query suggestion repository includes information matching each specific query suggestion to a respective general category, each general category having an associated general query suggestion.
- Providing one or more general query suggestions further comprises: determining one or more specific query suggestions; determining, from the one or more specific query suggestions, one or more general categories; and determining, from the one or more general categories, one or more general query suggestions.
- the actions further include: providing instructions to the user device that, when executed by the user device, cause the user device to display a user interface for a mapping application, the user interface including a user interface element for receiving queries from a user and a displayed map; receiving an indication from the user device that a user has selected a query suggestions; and providing instructions to the user device to update the displayed map based on the selected query suggestion.
- the general query suggestions are category labels and the specific query suggestions are geographic locations, and wherein the general query suggestions are stored in a query repository including data matching each general query suggestion with one or more specific query suggestions.
- Query suggestions can be chosen for the display for the user according to the completeness of an entered search string.
- general query suggestions can be provided to a user, which can be more useful to the user than specific query suggestions that are not likely to be selected by the user.
- specific query suggestions can be provided to a user, which can be useful, for example, so that the user does not have to continue typing a long query.
- FIGS. 1 A-C illustrate a user interface for a mapping application.
- FIG. 2 is a block diagram of a mapping system configured to execute a mapping application and provide query suggestions.
- FIG. 3 is a flow diagram of an example process for providing query suggestions.
- FIG. 4 is a flow diagram of an example process for determining a measure of query completeness for a search string.
- a search system receives queries and provides information in response to the queries.
- the search system provides query suggestions.
- the search system determines a measure of query completeness for an entered search string and provides general query suggestions if the measure of query completeness is below a threshold or specific query suggestions if the measure of query completeness is above the threshold.
- One such search system can be a mapping application, as further described below. While the query suggestion feature is described in terms of a mapping application, it can be incorporated into other types of search engines, such as an internet search engine, a database search engine, a book finding search engine, and related types of search engines.
- FIGS. 1 A-C illustrate a user interface 100 for a mapping application.
- the user interface can be displayed in a web browser 130 or other application executing on a user device.
- the mapping application can execute on a server system of one or more computers that communicates with the user device over a data communications network.
- the user interface includes a text entry field 105 where a user can enter a search string.
- the user can submit the search string as a query to the mapping application by performing an explicit action, e.g., by selecting a search button 120 or by tapping an "enter" key on a keyboard.
- the mapping application identifies geographic entities that satisfy the query in an index of resources and then updates a displayed map 140 so that the map displays indicators at the map locations of the geographic entities.
- Geographic entities can be, for example, homes, businesses, tourist attractions, political regions, restaurants, and so on. Each geographic entity has an associated location, specified, for example, by an address or latitude and longitude coordinates.
- FIG. 1 A illustrates an example scenario where the user has entered the search string "new" 110.
- the user has not expressly submitted the search string, but the user device has sent the search string to the mapping application so that the mapping application can provide query suggestions.
- the user interface is a web page displayed by a web browser, for example, the web page can include client-side script code that sends a search string to the mapping application before the user submits the string.
- the mapping application provides query suggestions 112-115 that the user device can display in a drop down menu below the text entry field. This display operation can also be implemented by client-side script code in a user interface web page, for example. Because the user has not submitted the search string, the query suggestions can be useful to the user, for example, to assist the user in submitting a specific query and finding geographic entities relevant to the user's search.
- the mapping application determines a measure of query completeness for the entered search string. If the measure of query completeness is below a threshold, the mapping application provides general query suggestions. If the measure of query completeness is not below the threshold, the mapping application provides specific query suggestions.
- Determining a measure of query completeness is described further with reference to FIG. 4.
- General and specific query suggestions are described further with reference to FIG. 2.
- the mapping application has determined that the measure of query completeness for the search string "new" is below the threshold.
- the mapping application has therefore provided general query suggestions 112-115.
- the general query suggestions in this example are category labels for categories of specific query suggestions. The way the category labels are determined is described more fully below in reference to FIG. 2.
- FIG. IB illustrates an example scenario in which the user has selected one of the general query suggestions 113 by moving a cursor over the general query suggestion.
- the mapping application can provide specific query suggestions 150 associated with the category referred to by the selected general query suggestion. .
- the user device can display the specific query suggestions in a menu that overlays the drop down menu for the general query suggestions.
- the user can select one of the specific query suggestions to be submitted to the mapping application, e.g., by clicking on the specific query suggestion.
- FIG. 1C illustrates an example scenario in which the user, instead of moving a cursor over one of the general query suggestions, has continued to enter characters into the text entry field.
- the search string 125 in the text entry field is now "new y," and the user still has not submitted the search string as a query to the mapping application.
- the mapping application has determined that the measure of query completeness for the search string "new y" is above the threshold.
- the mapping application provides specific query suggestions 116- 1 19 for display in the drop down menu below the text entry field. The user can select one of the specific query suggestions, e.g., by clicking on the specific query suggestion, causing the suggestion to be submitted to the mapping application.
- FIG. 2 is a block diagram of a mapping system 202 configured to execute a mapping application and provide query suggestions.
- the mapping system can be implemented in a system of one or more computers.
- the mapping system communicates with a user device 206 over a data
- a user can send queries to the mapping system using the user device, e.g., using a web browser or other application executing on the user device.
- the mapping system responds by updating a map in a user interface displayed on the user device, e.g., as described above with reference to FIGS. 1A-C.
- the mapping system includes a mapping engine 208.
- engine will be used broadly to refer to a software -based system or subsystem that can perform one or more specific functions.
- an engine will be implemented as one or more software modules or components, installed on one or more computers in one or more locations. In some cases, one or more computers will be dedicated to a particular engine; in other cases, multiple engines can be installed and running on the same computer or computers.
- the mapping engine 208 identifies geographic entities relevant to queries.
- the mapping engine can rank geographic entities, e.g., by quality, by relevancy to a query, or both.
- the mapping engine provides maps from a map data repository 210 for display on the user device.
- the mapping engine can provide maps that include indicators of locations of geographic entities.
- the mapping system includes a query suggest engine 212.
- the query suggest engine generates query suggestions for a search string, e.g., a search string received from the user device.
- the query suggest engine can generate query suggestions by selecting queries stored in a query repository 216.
- the mapping system also includes a query completeness engine.
- the query completeness engine determines a measure of query completeness for a search string, e.g., a search string received from the user device.
- the query completeness engine can determine a measure of query completeness using a query log 218, or a repository of query probabilities 220, or both. Determining a measure of query completeness is discussed further with reference to FIG. 4.
- the mapping system provides query suggestions using both the query suggest engine and the query completeness engine.
- the query completeness engine determines a measure of query completeness for a received search string, and the mapping system uses the query suggest engine to provide general query suggestions when the measure of query
- the general query suggestions can be categories associated with specific query suggestions.
- the specific query suggestions can be, for example, geographic locations as illustrated in FIG. 1 A-C.
- the general query suggestions can be stored in the query repository and associated with one or more specific query suggestions.
- a general query suggestion can, for example be a category that identifies a type of entity, and the specific query suggestions can be names of specific entities of that category or type.
- the general query suggestions have structure, so that the system can combine specific and general parts within the same suggestion. For example consider a query that refers to the name of a street. The system could determine that the street is highly likely to be selected for submission as a query, but that no single house number on the street is highly likely to be selected. The system can generate a specific query suggestion for the street with a [house number here] placeholder. When a user selects such a suggestion, the system provides specific suggestions with house numbers.
- the mapping system provides query suggestions having an amount of information that varies based on the measure of query completeness.
- the mapping system can provide general query suggestions (e.g., search categories such as "hotels" and "restaurants” )when the measure of query completeness is low.
- the mapping system can provide specific query suggestions (e.g., specific hotel and restaurant names) when the measure of query completeness is above a first threshold.
- the mapping system can provide even more detailed specific query suggestions (e.g., hotel or restaurant names together with street addresses, phone numbers, opening hours, etc.) when the measure of query completeness is above a second, even higher threshold.
- the system can provide for a variable number of query completeness thresholds and associated levels of detail for query suggestions.
- the query suggestions can be stored in a hierarchy spanning specific query suggestions to general query suggestions, and the mapping system can select more specific query suggestions in the hierarchy as the measure of query completeness rises.
- each query suggestion can include information at various levels of specificity, ranging from general categories and sub-categories to more particular information such as names, addresses, telephone numbers, and operating hours.
- the amount of information revealed for a given query suggestion can be based on the measure of query completeness, such that more information is revealed for a given query suggestion when the measure of query completeness is higher.
- the query completeness engine determines and stores measures of query completeness for various search strings before search time. At search time, when the mapping system receives a search string, the mapping system can access the stored measure of query completeness for the received search string.
- the query suggest engine determines and stores general or specific query suggestions for a search string before search time. At search time, when the mapping system receives a search string, the mapping system can provide the stored query suggestions.
- FIG. 3 is a flow diagram of an example process 300 for providing query suggestions.
- the mapping system 202 of FIG. 2 can perform the process 300.
- the process will be described with respect to a system that performs the process 300.
- the system receives a search string, e.g., from a user device (step 302).
- a search string e.g., from a user device
- the system can receive the search string from a user device displaying the user interface 100 illustrated in FIGS. 1 A-C.
- the system determines a measure of query completeness for the search string (step 304). For example, the system can determine the measure of query completeness as described below with reference to FIG. 4.
- the system determines whether the measure of query completeness is greater than a threshold (step 306). If the measure of query completeness is greater than the threshold, the system provides one or more specific query suggestions to the user device (step 308). If the measure of query completeness is not greater than the threshold, the system provides one or more general query suggestions to the user device (step 310). For example, the system can provide the query suggestions to the user device for display as illustrated in FIGS. 1A-C.
- the system can provide the top N most probable queries that include the entered search string, for example.
- the number of specific query suggestions, N can be the number of available spaces for query suggestions in a user interface element, e.g., the drop down menu of FIG. 1A. Determining the top N most probable specific query suggestions is described further below with reference to FIG. 4.
- the system can determine one or more specific query suggestions, e.g., the top N most probable queries that include the entered search string.
- the system next determines, from the one or more specific query suggestions, one or more general categories.
- each specific query suggestion can be stored in a query suggestion repository that includes information associating each specific query suggestion to one or more general categories.
- the system determines one or more general query suggestions.
- each general category can have an associated general query suggestion stored in the query repository.
- the system can determine the top N most probable general categories from all queries that include the entered search string.
- FIG. 4 is a flow diagram of an example process 400 for determining a measure of query completeness for a search string, e.g., a search string received from a user device or a search string stored in a query repository of queries submitted by users.
- the mapping system 202 of FIG. 2 can perform the process 400.
- the process will be described with respect to a system that performs the process 400.
- the system selects one or more candidate query suggestions for the search string
- the candidate query suggestions are specific query suggestions. Techniques for selecting candidate query suggestions are known in the art. For example, candidate query suggestions can be all stored queries that begin with or include the search string. The operation of the system does not depend on how the suggestions are selected, as long as the suggestions are selected based on the search string.
- the system determines, for each candidate query suggestion, a probability of the candidate query suggestion being submitted by a user as a search query given that the user has entered the search string (step 404). The system can determine the probability from a query log, e.g., the query log 218 of FIG. 2.
- the system first extracts from the query log a count of the number of times that users submitted any query that has been identified as a candidate query suggestion. For example, where candidate query suggestions are queries that begin with the search string, the system determines from the query log the number of submitted queries that begin with the search string. Next, the system extracts from the query log a count of the number of times that users submitted the first candidate query suggestion.
- the system determines the ratio of the count of the number of times that users submitted the first candidate query suggestion to the count of the number of times that users submitted any of the candidate query suggestions.
- the system can determine the probability for the first candidate query suggestion as that ratio or as a number based on that ratio.
- the system determines probabilities based on the frequencies of each term in the query. This is useful, for example, because the system can determine probabilities for a wider range of queries, including queries which are not in the query log, as long as the individual words in the query are in the query log.
- the system can optionally store the probability in a query probability repository, e.g., the query probability repository 220 of FIG. 2.
- a query probability repository e.g., the query probability repository 220 of FIG. 2.
- Each entry in the query probability repository contains at least the search string, the candidate query suggestion, and the probability associated with the candidate query suggestion given the search string.
- the system determines a measure of query completeness for the search string using the determined probabilities (step 406).
- the system can determine the measure of query completeness using any of various techniques. Two alternative methods will be described.
- the system selects a most probable query suggestion for the search string.
- a query suggest engine e.g., the query suggest engine 212 of FIG. 2
- the most probably query suggestion can be the highest ranking candidate query suggestion.
- the system can use the probability associated with the most probable query suggestion as the measure of query completeness.
- the system can add the probabilities associated with the N most probable query suggestions for the search string as the measure of query completeness. When the probabilities associated with the most probable or N most probable candidate queries for the search string are high, the user has likely entered the search string in order to search for information responsive to one of those candidate queries.
- the system determines an entropy for the search string.
- the entropy of a search string refers to a property of the distribution of probabilities of the candidate query suggestions. If the entropy is low, little information is missing from the search string; the search string is nearly complete.
- the system can determine, for each candidate query suggestion, a product of the probability of the candidate query suggestion multiplied by a logarithm of the probability of the candidate query suggestion. The system then sums the products.
- the system uses the sum or a number based on the sum as the measure of query completeness.
- a high sum indicates that there is a large number of candidate query suggestions for the search string, and that the user is therefore unlikely to select one of the top N candidate query suggestions.
- the entropy of the search string can be based on the most probable candidate query suggestion or the top N most probable candidate query suggestions.
- query suggestion engine was described above in terms of a mapping application, it can be used in any application or system in which a user enters a query or portion of a query.
- the system can determine the measure of query completeness as described, and provide either specific or general query suggestions depending on the measure of completeness.
- Such systems can include, for example, search engines and databases.
- Embodiments of the subject matter and the operations described in this specification can be implemented in digital electronic circuitry, or in computer software, firmware, or hardware, including the structures disclosed in this specification and their structural equivalents, or in combinations of one or more of them.
- Embodiments of the subject matter described in this specification can be implemented as one or more computer programs, i.e., one or more modules of computer program instructions, encoded on computer storage medium for execution by, or to control the operation of, data processing apparatus.
- a computer storage medium can be, or be included in, a computer-readable storage device, a computer-readable storage substrate, a random or serial access memory array or device, or a combination of one or more of them.
- the computer storage medium can also be, or be included in, one or more separate physical components or media (e.g., multiple CDs, disks, or other storage devices).
- the operations described in this specification can be implemented as operations performed by a data processing apparatus on data stored on one or more computer-readable storage devices or received from other sources.
- the term "data processing apparatus” encompasses all kinds of apparatus, devices, and machines for processing data, including by way of example a programmable processor, a computer, a system on a chip, or multiple ones, or combinations, of the foregoing
- the apparatus can include special purpose logic circuitry, e.g., an FPGA (field programmable gate array) or an ASIC (application-specific integrated circuit).
- the apparatus can also include, in addition to hardware, code that creates an execution environment for the computer program in question, e.g., code that constitutes processor firmware, a protocol stack, a database management system, an operating system, a cross-platform runtime environment, a virtual machine, or a combination of one or more of them.
- the apparatus and execution environment can realize various different computing model infrastructures, such as web services, distributed computing and grid computing infrastructures.
- a computer program (also known as a program, software, software application, script, or code) can be written in any form of programming language, including compiled or interpreted languages, declarative or procedural languages, and it can be deployed in any form, including as a stand-alone program or as a module, component, subroutine, object, or other unit suitable for use in a computing environment.
- a computer program may, but need not, correspond to a file in a file system.
- a program can be stored in a portion of a file that holds other programs or data (e.g., one or more scripts stored in a markup language document), in a single file dedicated to the program in question, or in multiple coordinated files (e.g., files that store one or more modules, sub-programs, or portions of code).
- a computer program can be deployed to be executed on one computer or on multiple computers that are located at one site or distributed across multiple sites and interconnected by a communication network.
- the processes and logic flows described in this specification can be performed by one or more programmable processors executing one or more computer programs to perform actions by operating on input data and generating output.
- the processes and logic flows can also be performed by, and apparatus can also be implemented as, special purpose logic circuitry, e.g., an FPGA (field programmable gate array) or an ASIC (application-specific integrated circuit).
- processors suitable for the execution of a computer program include, by way of example, both general and special purpose microprocessors, and any one or more processors of any kind of digital computer.
- a processor will receive instructions and data from a read-only memory or a random access memory or both.
- the essential elements of a computer are a processor for performing actions in accordance with instructions and one or more memory devices for storing instructions and data.
- a computer will also include, or be operatively coupled to receive data from or transfer data to, or both, one or more mass storage devices for storing data, e.g., magnetic, magneto -optical disks, or optical disks.
- mass storage devices for storing data, e.g., magnetic, magneto -optical disks, or optical disks.
- a computer need not have such devices.
- a computer can be embedded in another device, e.g., a mobile telephone, a personal digital assistant (PDA), a mobile audio or video player, a game console, a Global Positioning System (GPS) receiver, or a portable storage device (e.g., a universal serial bus (USB) flash drive), to name just a few.
- PDA personal digital assistant
- GPS Global Positioning System
- USB universal serial bus
- Devices suitable for storing computer program instructions and data include all forms of non-volatile memory, media and memory devices, including by way of example semiconductor memory devices, e.g., EPROM, EEPROM, and flash memory devices;
- magnetic disks e.g., internal hard disks or removable disks; magneto-optical disks; and CD-ROM and DVD-ROM disks.
- the processor and the memory can be supplemented by, or incorporated in, special purpose logic circuitry.
- a computer having a display device, e.g., a CRT (cathode ray tube) or LCD (liquid crystal display) monitor, for displaying information to the user and a keyboard and a pointing device, e.g., a mouse or a trackball, by which the user can provide input to the computer.
- a display device e.g., a CRT (cathode ray tube) or LCD (liquid crystal display) monitor
- keyboard and a pointing device e.g., a mouse or a trackball
- Other kinds of devices can be used to provide for interaction with a user as well; for example, feedback provided to the user can be any form of sensory feedback, e.g., visual feedback, auditory feedback, or tactile feedback; and input from the user can be received in any form, including acoustic, speech, or tactile input.
- a computer can interact with a user by sending documents to and receiving documents from a device that is used by the user; for example, by sending web pages to a
- Embodiments of the subject matter described in this specification can be implemented in a computing system that includes a back-end component, e.g., as a data server, or that includes a middleware component, e.g., an application server, or that includes a front-end component, e.g., a client computer having a graphical user interface or a Web browser through which a user can interact with an implementation of the subject matter described in this specification, or any combination of one or more such back-end, middleware, or front-end components.
- the components of the system can be interconnected by any form or medium of digital data communication, e.g., a communication network.
- Examples of communication networks include a local area network (“LAN”) and a wide area network (“WAN”), an inter-network (e.g., the Internet), and peer-to-peer networks (e.g., ad hoc peer- to-peer networks).
- LAN local area network
- WAN wide area network
- inter-network e.g., the Internet
- peer-to-peer networks e.g., ad hoc peer- to-peer networks.
- the computing system can include clients and servers.
- a client and server are generally remote from each other and typically interact through a communication network. The relationship of client and server arises by virtue of computer programs running on the respective computers and having a client-server relationship to each other.
- a server transmits data (e.g., an HTML page) to a user device, e.g., for purposes of displaying data to and receiving user input from a user interacting with the user device, which acts as a client.
- Data generated at the user device e.g., a result of the user interaction, can be received from the user device at the server.
Abstract
Methods, systems, and apparatus, including computer programs encoded on a computer storage medium, for providing query suggestions. In one aspect, a method includes receiving a search string from a user device. A measure of query completeness is determined for the search string. The measure of query completeness is compared to a threshold measure of query completeness. One or more specific query suggestions are provided to the user device, selected from a plurality of specific query suggestions for the search string, when the measure of query completeness exceeds the threshold measure of query completeness; or one or more general query suggestions are provided to the user device, selected from a plurality of general query suggestions for the search string, when the measure of query completeness does not exceed the threshold measure of query completeness.
Description
PROVIDING QUERY SUGGESTIONS
BACKGROUND
This specification relates to providing search query suggestions.
Internet search engines provide information about Internet accessible resources (e.g., web pages, images, text documents, multimedia content) that are responsive to a user's search query by returning a set of search results in response to the query. A search result includes, for example, a Uniform Resource Locator (URL) and a snippet of information for resources responsive to a query. Some search engines provide query suggestions to users. For example, a search engine can provide query suggestions to be displayed below a text entry field while a user enters a query into the text entry field, or a search engine can provide query suggestions for a submitted query on a search results web page, e.g., below the search results.
SUMMARY
In general, one innovative aspect of the subject matter described in this specification can be embodied in methods that include the actions of receiving a search string from a user device; determining a measure of query completeness for the search string; comparing the measure of query completeness to a threshold measure of query completeness; and providing one or more specific query suggestions to the user device, selected from a plurality of specific query suggestions for the search string, when the measure of query completeness exceeds the threshold measure of query completeness; or providing one or more general query suggestions to the user device, selected from a plurality of general query suggestions for the search string, when the measure of query completeness does not exceed the threshold measure of query completeness. Other embodiments of this aspect include corresponding systems, apparatus, and computer programs, configured to perform the actions of the methods, encoded on computer storage devices. A system of one or more computers can be configured to perform particular actions by virtue of having software, firmware, hardware, or a combination of them installed on the system that in operation causes or cause the system to perform the actions. One or more computer programs can be configured to perform
particular actions by virtue of including instructions that, when executed by data processing apparatus, cause the apparatus to perform the actions.
These and other embodiments can each optionally include one or more of the following features. Providing the one or more selected specific query suggestions or the one or more selected general query suggestions is performed prior to receiving a command from the user device to perform a search using the search string as a query. Determining the measure of query completeness for the search string includes determining a probability of receiving the N most probable query suggestions for the search string, wherein N is an integer greater than zero. Determining the probability of receiving a first one of the N most probable query suggestion includes: determining, from a query log, a plurality of candidate query suggestions based on the search string; determining, from the query log, a count of the number of times the plurality of candidate query suggestions were received and a count of the number of times the first one of the N most probable query suggestions was received; and dividing the count of the number of times the first one of the N most probable query suggestions were received by the count of the number of times the plurality of candidate query suggestions were received. Comparing the measure of query completeness to the threshold measure of query completeness includes comparing the probability of the user selecting the N most probable query suggestions to a threshold probability. Determining the measure of query completeness for the search string includes: selecting a plurality of candidate query suggestions; determining, for each candidate query suggestion, a probability for the candidate query suggestion based on a count in a query log of the number of times that the plurality of candidate query suggestions were submitted as search queries and a count in the query log of the number of times that the candidate query was submitted as a search query; determining, for each candidate query suggestion, a product of the probability of the candidate query suggestion multiplied by a logarithm of the probability of the candidate query suggestion; and summing the determined products of the candidate query suggestions. Selecting the plurality of candidate query suggestions includes selecting the N most probable query suggestions, wherein N is an integer greater than zero. Comparing the measure of query completeness to a threshold measure of query completeness comprises comparing the sum of the determined entropies to a threshold sum. Each specific query suggestion is stored in a query suggestion repository, and wherein the query suggestion repository includes
information matching each specific query suggestion to a respective general category, each general category having an associated general query suggestion. Providing one or more general query suggestions further comprises: determining one or more specific query suggestions; determining, from the one or more specific query suggestions, one or more general categories; and determining, from the one or more general categories, one or more general query suggestions. The actions further include: providing instructions to the user device that, when executed by the user device, cause the user device to display a user interface for a mapping application, the user interface including a user interface element for receiving queries from a user and a displayed map; receiving an indication from the user device that a user has selected a query suggestions; and providing instructions to the user device to update the displayed map based on the selected query suggestion. The general query suggestions are category labels and the specific query suggestions are geographic locations, and wherein the general query suggestions are stored in a query repository including data matching each general query suggestion with one or more specific query suggestions.
Particular embodiments of the subject matter described in this specification can be implemented so as to realize one or more of the following advantages. Query suggestions can be chosen for the display for the user according to the completeness of an entered search string. For search strings that are short or non-specific, general query suggestions can be provided to a user, which can be more useful to the user than specific query suggestions that are not likely to be selected by the user. For longer or more specific search strings, specific query suggestions can be provided to a user, which can be useful, for example, so that the user does not have to continue typing a long query.
The details of one or more embodiments of the subject matter described in this specification are set forth in the accompanying drawings and the description below. Other features, aspects, and advantages of the subject matter will become apparent from the description, the drawings, and the claims.
BRIEF DESCRIPTION OF THE DRAWINGS FIGS. 1 A-C illustrate a user interface for a mapping application.
FIG. 2 is a block diagram of a mapping system configured to execute a mapping application and provide query suggestions.
FIG. 3 is a flow diagram of an example process for providing query suggestions.
FIG. 4 is a flow diagram of an example process for determining a measure of query completeness for a search string.
Like reference numbers and designations in the various drawings indicate like elements.
DETAILED DESCRIPTION
A search system receives queries and provides information in response to the queries. The search system provides query suggestions. The search system determines a measure of query completeness for an entered search string and provides general query suggestions if the measure of query completeness is below a threshold or specific query suggestions if the measure of query completeness is above the threshold. One such search system can be a mapping application, as further described below. While the query suggestion feature is described in terms of a mapping application, it can be incorporated into other types of search engines, such as an internet search engine, a database search engine, a book finding search engine, and related types of search engines.
FIGS. 1 A-C illustrate a user interface 100 for a mapping application. The user interface can be displayed in a web browser 130 or other application executing on a user device. The mapping application can execute on a server system of one or more computers that communicates with the user device over a data communications network.
The user interface includes a text entry field 105 where a user can enter a search string. The user can submit the search string as a query to the mapping application by performing an explicit action, e.g., by selecting a search button 120 or by tapping an "enter" key on a keyboard. The mapping application identifies geographic entities that satisfy the query in an index of resources and then updates a displayed map 140 so that the map displays indicators at the map locations of the geographic entities. Geographic entities can be, for example, homes, businesses, tourist attractions, political regions, restaurants, and so on. Each geographic entity has an associated location, specified, for example, by an address or latitude and longitude coordinates.
FIG. 1 A illustrates an example scenario where the user has entered the search string "new" 110. The user has not expressly submitted the search string, but the user device has sent the search string to the mapping application so that the mapping application can provide
query suggestions. If the user interface is a web page displayed by a web browser, for example, the web page can include client-side script code that sends a search string to the mapping application before the user submits the string. The mapping application provides query suggestions 112-115 that the user device can display in a drop down menu below the text entry field. This display operation can also be implemented by client-side script code in a user interface web page, for example. Because the user has not submitted the search string, the query suggestions can be useful to the user, for example, to assist the user in submitting a specific query and finding geographic entities relevant to the user's search.
The mapping application determines a measure of query completeness for the entered search string. If the measure of query completeness is below a threshold, the mapping application provides general query suggestions. If the measure of query completeness is not below the threshold, the mapping application provides specific query suggestions.
Determining a measure of query completeness is described further with reference to FIG. 4. General and specific query suggestions are described further with reference to FIG. 2.
In the scenario illustrated in FIG. 1 A, the mapping application has determined that the measure of query completeness for the search string "new" is below the threshold. The mapping application has therefore provided general query suggestions 112-115. The general query suggestions in this example are category labels for categories of specific query suggestions. The way the category labels are determined is described more fully below in reference to FIG. 2.
FIG. IB illustrates an example scenario in which the user has selected one of the general query suggestions 113 by moving a cursor over the general query suggestion. The mapping application can provide specific query suggestions 150 associated with the category referred to by the selected general query suggestion. . For example, the user device can display the specific query suggestions in a menu that overlays the drop down menu for the general query suggestions. The user can select one of the specific query suggestions to be submitted to the mapping application, e.g., by clicking on the specific query suggestion. Methods for identifying and displaying both general query suggestions 113 and specific query suggestions 150 are further described below in reference to FIG 3.
FIG. 1C illustrates an example scenario in which the user, instead of moving a cursor over one of the general query suggestions, has continued to enter characters into the text
entry field. The search string 125 in the text entry field is now "new y," and the user still has not submitted the search string as a query to the mapping application. The mapping application has determined that the measure of query completeness for the search string "new y" is above the threshold. The mapping application provides specific query suggestions 116- 1 19 for display in the drop down menu below the text entry field. The user can select one of the specific query suggestions, e.g., by clicking on the specific query suggestion, causing the suggestion to be submitted to the mapping application.
FIG. 2 is a block diagram of a mapping system 202 configured to execute a mapping application and provide query suggestions. The mapping system can be implemented in a system of one or more computers.
The mapping system communicates with a user device 206 over a data
communications network 214. A user can send queries to the mapping system using the user device, e.g., using a web browser or other application executing on the user device. The mapping system responds by updating a map in a user interface displayed on the user device, e.g., as described above with reference to FIGS. 1A-C.
The mapping system includes a mapping engine 208. In this specification the term "engine" will be used broadly to refer to a software -based system or subsystem that can perform one or more specific functions. Generally, an engine will be implemented as one or more software modules or components, installed on one or more computers in one or more locations. In some cases, one or more computers will be dedicated to a particular engine; in other cases, multiple engines can be installed and running on the same computer or computers.
The mapping engine 208 identifies geographic entities relevant to queries. The mapping engine can rank geographic entities, e.g., by quality, by relevancy to a query, or both. The mapping engine provides maps from a map data repository 210 for display on the user device. The mapping engine can provide maps that include indicators of locations of geographic entities.
The mapping system includes a query suggest engine 212. The query suggest engine generates query suggestions for a search string, e.g., a search string received from the user device. The query suggest engine can generate query suggestions by selecting queries stored in a query repository 216.
The mapping system also includes a query completeness engine. The query completeness engine determines a measure of query completeness for a search string, e.g., a search string received from the user device. The query completeness engine can determine a measure of query completeness using a query log 218, or a repository of query probabilities 220, or both. Determining a measure of query completeness is discussed further with reference to FIG. 4.
The mapping system provides query suggestions using both the query suggest engine and the query completeness engine. The query completeness engine determines a measure of query completeness for a received search string, and the mapping system uses the query suggest engine to provide general query suggestions when the measure of query
completeness is below a threshold and specific query suggestions when the measure of query completeness is not below the threshold.
The general query suggestions can be categories associated with specific query suggestions. The specific query suggestions can be, for example, geographic locations as illustrated in FIG. 1 A-C. The general query suggestions can be stored in the query repository and associated with one or more specific query suggestions. A general query suggestion can, for example be a category that identifies a type of entity, and the specific query suggestions can be names of specific entities of that category or type.
In some implementations, the general query suggestions have structure, so that the system can combine specific and general parts within the same suggestion. For example consider a query that refers to the name of a street. The system could determine that the street is highly likely to be selected for submission as a query, but that no single house number on the street is highly likely to be selected. The system can generate a specific query suggestion for the street with a [house number here] placeholder. When a user selects such a suggestion, the system provides specific suggestions with house numbers.
In some implementations, the mapping system provides query suggestions having an amount of information that varies based on the measure of query completeness. For example, the mapping system can provide general query suggestions (e.g., search categories such as "hotels" and "restaurants" )when the measure of query completeness is low. The mapping system can provide specific query suggestions (e.g., specific hotel and restaurant names) when the measure of query completeness is above a first threshold. And, the
mapping system can provide even more detailed specific query suggestions (e.g., hotel or restaurant names together with street addresses, phone numbers, opening hours, etc.) when the measure of query completeness is above a second, even higher threshold. In general, the system can provide for a variable number of query completeness thresholds and associated levels of detail for query suggestions. The query suggestions can be stored in a hierarchy spanning specific query suggestions to general query suggestions, and the mapping system can select more specific query suggestions in the hierarchy as the measure of query completeness rises. Alternatively, each query suggestion can include information at various levels of specificity, ranging from general categories and sub-categories to more particular information such as names, addresses, telephone numbers, and operating hours. The amount of information revealed for a given query suggestion can be based on the measure of query completeness, such that more information is revealed for a given query suggestion when the measure of query completeness is higher.
In some implementations, the query completeness engine determines and stores measures of query completeness for various search strings before search time. At search time, when the mapping system receives a search string, the mapping system can access the stored measure of query completeness for the received search string. In some
implementations, the query suggest engine determines and stores general or specific query suggestions for a search string before search time. At search time, when the mapping system receives a search string, the mapping system can provide the stored query suggestions.
FIG. 3 is a flow diagram of an example process 300 for providing query suggestions. The mapping system 202 of FIG. 2 can perform the process 300. For convenience, the process will be described with respect to a system that performs the process 300.
The system receives a search string, e.g., from a user device (step 302). For example, the system can receive the search string from a user device displaying the user interface 100 illustrated in FIGS. 1 A-C.
The system determines a measure of query completeness for the search string (step 304). For example, the system can determine the measure of query completeness as described below with reference to FIG. 4.
The system determines whether the measure of query completeness is greater than a threshold (step 306). If the measure of query completeness is greater than the threshold, the
system provides one or more specific query suggestions to the user device (step 308). If the measure of query completeness is not greater than the threshold, the system provides one or more general query suggestions to the user device (step 310). For example, the system can provide the query suggestions to the user device for display as illustrated in FIGS. 1A-C.
To provide specific query suggestions, the system can provide the top N most probable queries that include the entered search string, for example. The number of specific query suggestions, N, can be the number of available spaces for query suggestions in a user interface element, e.g., the drop down menu of FIG. 1A. Determining the top N most probable specific query suggestions is described further below with reference to FIG. 4.
To provide general query suggestions, the system can determine one or more specific query suggestions, e.g., the top N most probable queries that include the entered search string. The system next determines, from the one or more specific query suggestions, one or more general categories. For example, each specific query suggestion can be stored in a query suggestion repository that includes information associating each specific query suggestion to one or more general categories. From the one or more general categories, the system determines one or more general query suggestions. For example, each general category can have an associated general query suggestion stored in the query repository. Alternatively, the system can determine the top N most probable general categories from all queries that include the entered search string.
FIG. 4 is a flow diagram of an example process 400 for determining a measure of query completeness for a search string, e.g., a search string received from a user device or a search string stored in a query repository of queries submitted by users. The mapping system 202 of FIG. 2 can perform the process 400. For convenience, the process will be described with respect to a system that performs the process 400.
The system selects one or more candidate query suggestions for the search string
(step 402). The candidate query suggestions are specific query suggestions. Techniques for selecting candidate query suggestions are known in the art. For example, candidate query suggestions can be all stored queries that begin with or include the search string. The operation of the system does not depend on how the suggestions are selected, as long as the suggestions are selected based on the search string.
The system determines, for each candidate query suggestion, a probability of the candidate query suggestion being submitted by a user as a search query given that the user has entered the search string (step 404). The system can determine the probability from a query log, e.g., the query log 218 of FIG. 2.
Consider a first candidate query suggestion. The system first extracts from the query log a count of the number of times that users submitted any query that has been identified as a candidate query suggestion. For example, where candidate query suggestions are queries that begin with the search string, the system determines from the query log the number of submitted queries that begin with the search string. Next, the system extracts from the query log a count of the number of times that users submitted the first candidate query suggestion.
The system determines the ratio of the count of the number of times that users submitted the first candidate query suggestion to the count of the number of times that users submitted any of the candidate query suggestions. The system can determine the probability for the first candidate query suggestion as that ratio or as a number based on that ratio.
In some implementations, the system determines probabilities based on the frequencies of each term in the query. This is useful, for example, because the system can determine probabilities for a wider range of queries, including queries which are not in the query log, as long as the individual words in the query are in the query log.
After determining the probability, the system can optionally store the probability in a query probability repository, e.g., the query probability repository 220 of FIG. 2. Each entry in the query probability repository contains at least the search string, the candidate query suggestion, and the probability associated with the candidate query suggestion given the search string.
The system determines a measure of query completeness for the search string using the determined probabilities (step 406). The system can determine the measure of query completeness using any of various techniques. Two alternative methods will be described.
Performing a first method, the system selects a most probable query suggestion for the search string. In some implementations, a query suggest engine, e.g., the query suggest engine 212 of FIG. 2, ranks the candidate query suggestions for a given search string. The most probably query suggestion can be the highest ranking candidate query suggestion. The system can use the probability associated with the most probable query suggestion as the
measure of query completeness. Alternatively, the system can add the probabilities associated with the N most probable query suggestions for the search string as the measure of query completeness. When the probabilities associated with the most probable or N most probable candidate queries for the search string are high, the user has likely entered the search string in order to search for information responsive to one of those candidate queries.
Performing a second method, the system determines an entropy for the search string. The entropy of a search string refers to a property of the distribution of probabilities of the candidate query suggestions. If the entropy is low, little information is missing from the search string; the search string is nearly complete. To determine an entropy for the search string, the system can determine, for each candidate query suggestion, a product of the probability of the candidate query suggestion multiplied by a logarithm of the probability of the candidate query suggestion. The system then sums the products.
The system uses the sum or a number based on the sum as the measure of query completeness. A high sum indicates that there is a large number of candidate query suggestions for the search string, and that the user is therefore unlikely to select one of the top N candidate query suggestions. The entropy of the search string can be based on the most probable candidate query suggestion or the top N most probable candidate query suggestions.
While the query suggestion engine was described above in terms of a mapping application, it can be used in any application or system in which a user enters a query or portion of a query. The system can determine the measure of query completeness as described, and provide either specific or general query suggestions depending on the measure of completeness. Such systems can include, for example, search engines and databases.
Embodiments of the subject matter and the operations described in this specification can be implemented in digital electronic circuitry, or in computer software, firmware, or hardware, including the structures disclosed in this specification and their structural equivalents, or in combinations of one or more of them. Embodiments of the subject matter described in this specification can be implemented as one or more computer programs, i.e., one or more modules of computer program instructions, encoded on computer storage medium for execution by, or to control the operation of, data processing apparatus. A computer storage medium can be, or be included in, a computer-readable storage device, a
computer-readable storage substrate, a random or serial access memory array or device, or a combination of one or more of them. The computer storage medium can also be, or be included in, one or more separate physical components or media (e.g., multiple CDs, disks, or other storage devices).
The operations described in this specification can be implemented as operations performed by a data processing apparatus on data stored on one or more computer-readable storage devices or received from other sources.
The term "data processing apparatus" encompasses all kinds of apparatus, devices, and machines for processing data, including by way of example a programmable processor, a computer, a system on a chip, or multiple ones, or combinations, of the foregoing The apparatus can include special purpose logic circuitry, e.g., an FPGA (field programmable gate array) or an ASIC (application-specific integrated circuit). The apparatus can also include, in addition to hardware, code that creates an execution environment for the computer program in question, e.g., code that constitutes processor firmware, a protocol stack, a database management system, an operating system, a cross-platform runtime environment, a virtual machine, or a combination of one or more of them. The apparatus and execution environment can realize various different computing model infrastructures, such as web services, distributed computing and grid computing infrastructures.
A computer program (also known as a program, software, software application, script, or code) can be written in any form of programming language, including compiled or interpreted languages, declarative or procedural languages, and it can be deployed in any form, including as a stand-alone program or as a module, component, subroutine, object, or other unit suitable for use in a computing environment. A computer program may, but need not, correspond to a file in a file system. A program can be stored in a portion of a file that holds other programs or data (e.g., one or more scripts stored in a markup language document), in a single file dedicated to the program in question, or in multiple coordinated files (e.g., files that store one or more modules, sub-programs, or portions of code). A computer program can be deployed to be executed on one computer or on multiple computers that are located at one site or distributed across multiple sites and interconnected by a communication network.
The processes and logic flows described in this specification can be performed by one or more programmable processors executing one or more computer programs to perform actions by operating on input data and generating output. The processes and logic flows can also be performed by, and apparatus can also be implemented as, special purpose logic circuitry, e.g., an FPGA (field programmable gate array) or an ASIC (application-specific integrated circuit).
Processors suitable for the execution of a computer program include, by way of example, both general and special purpose microprocessors, and any one or more processors of any kind of digital computer. Generally, a processor will receive instructions and data from a read-only memory or a random access memory or both. The essential elements of a computer are a processor for performing actions in accordance with instructions and one or more memory devices for storing instructions and data. Generally, a computer will also include, or be operatively coupled to receive data from or transfer data to, or both, one or more mass storage devices for storing data, e.g., magnetic, magneto -optical disks, or optical disks. However, a computer need not have such devices. Moreover, a computer can be embedded in another device, e.g., a mobile telephone, a personal digital assistant (PDA), a mobile audio or video player, a game console, a Global Positioning System (GPS) receiver, or a portable storage device (e.g., a universal serial bus (USB) flash drive), to name just a few. Devices suitable for storing computer program instructions and data include all forms of non-volatile memory, media and memory devices, including by way of example semiconductor memory devices, e.g., EPROM, EEPROM, and flash memory devices;
magnetic disks, e.g., internal hard disks or removable disks; magneto-optical disks; and CD-ROM and DVD-ROM disks. The processor and the memory can be supplemented by, or incorporated in, special purpose logic circuitry.
To provide for interaction with a user, embodiments of the subject matter described in this specification can be implemented on a computer having a display device, e.g., a CRT (cathode ray tube) or LCD (liquid crystal display) monitor, for displaying information to the user and a keyboard and a pointing device, e.g., a mouse or a trackball, by which the user can provide input to the computer. Other kinds of devices can be used to provide for interaction with a user as well; for example, feedback provided to the user can be any form of sensory feedback, e.g., visual feedback, auditory feedback, or tactile feedback; and input from the
user can be received in any form, including acoustic, speech, or tactile input. In addition, a computer can interact with a user by sending documents to and receiving documents from a device that is used by the user; for example, by sending web pages to a web browser on a user's user device in response to requests received from the web browser.
Embodiments of the subject matter described in this specification can be implemented in a computing system that includes a back-end component, e.g., as a data server, or that includes a middleware component, e.g., an application server, or that includes a front-end component, e.g., a client computer having a graphical user interface or a Web browser through which a user can interact with an implementation of the subject matter described in this specification, or any combination of one or more such back-end, middleware, or front-end components. The components of the system can be interconnected by any form or medium of digital data communication, e.g., a communication network. Examples of communication networks include a local area network ("LAN") and a wide area network ("WAN"), an inter-network (e.g., the Internet), and peer-to-peer networks (e.g., ad hoc peer- to-peer networks).
The computing system can include clients and servers. A client and server are generally remote from each other and typically interact through a communication network. The relationship of client and server arises by virtue of computer programs running on the respective computers and having a client-server relationship to each other. In some embodiments, a server transmits data (e.g., an HTML page) to a user device, e.g., for purposes of displaying data to and receiving user input from a user interacting with the user device, which acts as a client. Data generated at the user device, e.g., a result of the user interaction, can be received from the user device at the server.
While this specification contains many specific implementation details, these should not be construed as limitations on the scope of any inventions or of what may be claimed, but rather as descriptions of features specific to particular embodiments of particular inventions. Certain features that are described in this specification in the context of separate
embodiments can also be implemented in combination in a single embodiment. Conversely, various features that are described in the context of a single embodiment can also be implemented in multiple embodiments separately or in any suitable subcombination.
Moreover, although features may be described above as acting in certain combinations and
even initially claimed as such, one or more features from a claimed combination can in some cases be excised from the combination, and the claimed combination may be directed to a subcombination or variation of a subcombination.
Similarly, while operations are depicted in the drawings in a particular order, this should not be understood as requiring that such operations be performed in the particular order shown or in sequential order, or that all illustrated operations be performed, to achieve desirable results. In certain circumstances, multitasking and parallel processing may be advantageous. Moreover, the separation of various system components in the embodiments described above should not be understood as requiring such separation in all embodiments, and it should be understood that the described program components and systems can generally be integrated together in a single software product or packaged into multiple software products.
Thus, particular embodiments of the subject matter have been described. Other embodiments are within the scope of the following claims. In some cases, the actions recited in the claims can be performed in a different order and still achieve desirable results. In addition, the processes depicted in the accompanying figures do not necessarily require the particular order shown, or sequential order, to achieve desirable results. In certain implementations, multitasking and parallel processing may be advantageous.
What is claimed is:
Claims
1. A method performed by one or more computers, the method comprising:
receiving a search string from a user device;
determining a measure of query completeness for the search string;
comparing the measure of query completeness to a threshold measure of query completeness; and
providing one or more specific query suggestions to the user device, selected from a plurality of specific query suggestions for the search string, when the measure of query completeness exceeds the threshold measure of query completeness; or
providing one or more general query suggestions to the user device, selected from a plurality of general query suggestions for the search string, when the measure of query completeness does not exceed the threshold measure of query completeness.
2. The method of claim 1, wherein providing the one or more selected specific query suggestions or the one or more selected general query suggestions is performed prior to receiving a command from the user device to perform a search using the search string as a query.
3. The method of claim 1, wherein determining the measure of query completeness for the search string includes determining a probability of receiving the N most probable query suggestions for the search string, wherein N is an integer greater than zero.
4. The method of claim 3, wherein determining the probability of receiving a first one of the N most probable query suggestion includes:
determining, from a query log, a plurality of candidate query suggestions based on the search string;
determining, from the query log, a count of the number of times the plurality of candidate query suggestions were received and a count of the number of times the first one of the N most probable query suggestions was received; and
dividing the count of the number of times the first one of the N most probable query suggestions were received by the count of the number of times the plurality of candidate query suggestions were received.
5. The method of claim 3, wherein comparing the measure of query completeness to the threshold measure of query completeness includes comparing the probability of the user selecting the N most probable query suggestions to a threshold probability.
6. The method of claim 1, wherein determining the measure of query completeness for the search string includes:
selecting a plurality of candidate query suggestions;
determining, for each candidate query suggestion, a probability for the candidate query suggestion based on a count in a query log of the number of times that the plurality of candidate query suggestions were submitted as search queries and a count in the query log of the number of times that the candidate query was submitted as a search query;
determining, for each candidate query suggestion, a product of the probability of the candidate query suggestion multiplied by a logarithm of the probability of the candidate query suggestion; and
summing the determined products of the candidate query suggestions.
7. The method of claim 6, wherein selecting the plurality of candidate query suggestions includes selecting the N most probable query suggestions, wherein N is an integer greater than zero.
8. The method of claim 6, wherein comparing the measure of query completeness to a threshold measure of query completeness comprises comparing the sum of the determined entropies to a threshold sum.
9. The method of claim 1, wherein each specific query suggestion is stored in a query suggestion repository, and wherein the query suggestion repository includes information matching each specific query suggestion to a respective general category, each general category having an associated general query suggestion.
10. The method of claim 9, wherein providing one or more general query suggestions further comprises:
determining one or more specific query suggestions;
determining, from the one or more specific query suggestions, one or more general categories; and
determining, from the one or more general categories, one or more general query suggestions.
11. The method of claim 1 , further comprising:
providing instructions to the user device that, when executed by the user device, cause the user device to display a user interface for a mapping application, the user interface including a user interface element for receiving queries from a user and a displayed map; receiving an indication from the user device that a user has selected a query suggestions; and
providing instructions to the user device to update the displayed map based on the selected query suggestion.
12. The method of claim 11, wherein the general query suggestions are category labels and the specific query suggestions are geographic locations, and wherein the general query suggestions are stored in a query repository including data matching each general query suggestion with one or more specific query suggestions.
13. A system of one or more computers configured to perform operations comprising: receiving a search string from a user device;
determining a measure of query completeness for the search string;
comparing the measure of query completeness to a threshold measure of query completeness; and
providing one or more specific query suggestions to the user device, selected from a plurality of specific query suggestions for the search string, when the measure of query completeness exceeds the threshold measure of query completeness; or
providing one or more general query suggestions to the user device, selected from a plurality of general query suggestions for the search string, when the measure of query completeness does not exceed the threshold measure of query completeness.
14. The system of claim 13, wherein providing the one or more selected specific query suggestions or the one or more selected general query suggestions is performed prior to receiving a command from the user device to perform a search using the search string as a query.
15. The system of claim 13, wherein determining the measure of query completeness for the search string includes determining a probability of receiving the N most probable query suggestions for the search string, wherein N is an integer greater than zero.
16. The system of claim 15, wherein determining the probability of receiving a first one of the N most probable query suggestion includes:
determining, from a query log, a plurality of candidate query suggestions based on the search string;
determining, from the query log, a count of the number of times the plurality of candidate query suggestions were received and a count of the number of times the first one of the N most probable query suggestions was received; and
dividing the count of the number of times the first one of the N most probable query suggestions were received by the count of the number of times the plurality of candidate query suggestions were received.
17. The system of claim 15, wherein comparing the measure of query completeness to the threshold measure of query completeness includes comparing the probability of the user selecting the N most probable query suggestions to a threshold probability.
18. The system of claim 13, wherein determining the measure of query completeness for the search string includes:
selecting a plurality of candidate query suggestions;
determining, for each candidate query suggestion, a probability for the candidate query suggestion based on a count in a query log of the number of times that the plurality of candidate query suggestions were submitted as search queries and a count in the query log of the number of times that the candidate query was submitted as a search query;
determining, for each candidate query suggestion, a product of the probability of the candidate query suggestion multiplied by a logarithm of the probability of the candidate query suggestion; and
summing the determined products of the candidate query suggestions.
19. The system of claim 18, wherein selecting the plurality of candidate query
suggestions includes selecting the N most probable query suggestions, wherein N is an integer greater than zero.
20. The system of claim 18, wherein comparing the measure of query completeness to a threshold measure of query completeness comprises comparing the sum of the determined entropies to a threshold sum.
21. The system of claim 13, wherein each specific query suggestion is stored in a query suggestion repository, and wherein the query suggestion repository includes information matching each specific query suggestion to a respective general category, each general category having an associated general query suggestion.
22. The system of claim 21 , wherein providing one or more general query suggestions further comprises:
determining one or more specific query suggestions;
determining, from the one or more specific query suggestions, one or more general categories; and
determining, from the one or more general categories, one or more general query suggestions.
23. The system of claim 13, the operations further comprising:
providing instructions to the user device that, when executed by the user device, cause the user device to display a user interface for a mapping application, the user interface including a user interface element for receiving queries from a user and a displayed map; receiving an indication from the user device that a user has selected a query suggestions; and
providing instructions to the user device to update the displayed map based on the selected query suggestion.
24. The system of claim 23, wherein the general query suggestions are category labels and the specific query suggestions are geographic locations, and wherein the general query suggestions are stored in a query repository including data matching each general query suggestion with one or more specific query suggestions.
25. A computer storage medium encoded with a computer program, the program comprising instructions that when executed by one or more computers cause the one or more computers to perform operations comprising:
receiving a search string from a user device;
determining a measure of query completeness for the search string;
comparing the measure of query completeness to a threshold measure of query completeness; and
providing one or more specific query suggestions to the user device, selected from a plurality of specific query suggestions for the search string, when the measure of query completeness exceeds the threshold measure of query completeness; or
providing one or more general query suggestions to the user device, selected from a plurality of general query suggestions for the search string, when the measure of query completeness does not exceed the threshold measure of query completeness.
Applications Claiming Priority (2)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US13/525,524 US9275147B2 (en) | 2012-06-18 | 2012-06-18 | Providing query suggestions |
PCT/US2013/045792 WO2014007970A2 (en) | 2012-06-18 | 2013-06-14 | Providing query suggestions |
Publications (1)
Publication Number | Publication Date |
---|---|
EP2842064A2 true EP2842064A2 (en) | 2015-03-04 |
Family
ID=49756896
Family Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
EP13812569.5A Withdrawn EP2842064A2 (en) | 2012-06-18 | 2013-06-14 | Providing query suggestions |
Country Status (4)
Country | Link |
---|---|
US (1) | US9275147B2 (en) |
EP (1) | EP2842064A2 (en) |
CN (1) | CN104380292A (en) |
WO (1) | WO2014007970A2 (en) |
Families Citing this family (8)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US9684395B2 (en) * | 2012-06-02 | 2017-06-20 | Tara Chand Singhal | System and method for context driven voice interface in handheld wireless mobile devices |
EP2778959B1 (en) * | 2012-06-27 | 2020-04-08 | Rakuten, Inc. | Information processing device, information processing method, and information processing program |
US9317585B2 (en) * | 2013-03-15 | 2016-04-19 | Google Inc. | Search query suggestions based on personal information |
US9507879B2 (en) * | 2014-01-02 | 2016-11-29 | Adobe Systems Incorporated | Query formation and modification |
US20150193447A1 (en) * | 2014-01-03 | 2015-07-09 | Microsoft Corporation | Synthetic local type-ahead suggestions for search |
CN105069014B (en) * | 2015-07-10 | 2018-09-25 | 无锡天脉聚源传媒科技有限公司 | A kind of map search method and device |
US11636102B2 (en) * | 2019-09-05 | 2023-04-25 | Verizon Patent And Licensing Inc. | Natural language-based content system with corrective feedback and training |
US11860884B2 (en) * | 2021-03-30 | 2024-01-02 | Snap Inc. | Search query modification database |
Family Cites Families (34)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US7734565B2 (en) * | 2003-01-18 | 2010-06-08 | Yahoo! Inc. | Query string matching method and apparatus |
US7836044B2 (en) | 2004-06-22 | 2010-11-16 | Google Inc. | Anticipated query generation and processing in a search engine |
WO2006047654A2 (en) * | 2004-10-25 | 2006-05-04 | Yuanhua Tang | Full text query and search systems and methods of use |
US8260771B1 (en) * | 2005-07-22 | 2012-09-04 | A9.Com, Inc. | Predictive selection of item attributes likely to be useful in refining a search |
KR100754768B1 (en) | 2006-04-06 | 2007-09-03 | 엔에이치엔(주) | System and method for providing recommended word of adjustment each user and computer readable recording medium recording program for implementing the method |
US7716236B2 (en) | 2006-07-06 | 2010-05-11 | Aol Inc. | Temporal search query personalization |
US7685119B2 (en) * | 2006-12-20 | 2010-03-23 | Yahoo! Inc. | System and method for query expansion |
US8364695B2 (en) * | 2006-12-22 | 2013-01-29 | Gary Charles Berkowitz | Adaptive e-procurement find assistant using algorithmic intelligence and organic knowledge capture |
EP2158540A4 (en) | 2007-06-18 | 2010-10-20 | Geographic Services Inc | Geographic feature name search system |
US8694483B2 (en) * | 2007-10-19 | 2014-04-08 | Xerox Corporation | Real-time query suggestion in a troubleshooting context |
US8667004B2 (en) | 2007-11-30 | 2014-03-04 | Microsoft Corporation | Providing suggestions during formation of a search query |
US20090144262A1 (en) * | 2007-12-04 | 2009-06-04 | Microsoft Corporation | Search query transformation using direct manipulation |
US7984004B2 (en) * | 2008-01-17 | 2011-07-19 | Microsoft Corporation | Query suggestion generation |
US9092454B2 (en) * | 2008-04-22 | 2015-07-28 | Microsoft Technology Licensing, Llc | Discovering co-located queries in geographic search logs |
US8082278B2 (en) * | 2008-06-13 | 2011-12-20 | Microsoft Corporation | Generating query suggestions from semantic relationships in content |
US8060513B2 (en) * | 2008-07-01 | 2011-11-15 | Dossierview Inc. | Information processing with integrated semantic contexts |
US8312032B2 (en) | 2008-07-10 | 2012-11-13 | Google Inc. | Dictionary suggestions for partial user entries |
US8504582B2 (en) * | 2008-12-31 | 2013-08-06 | Ebay, Inc. | System and methods for unit of measurement conversion and search query expansion |
US9805089B2 (en) * | 2009-02-10 | 2017-10-31 | Amazon Technologies, Inc. | Local business and product search system and method |
WO2010139277A1 (en) | 2009-06-03 | 2010-12-09 | Google Inc. | Autocompletion for partially entered query |
US8745065B2 (en) * | 2009-07-07 | 2014-06-03 | Google Inc. | Query parsing for map search |
US20120284253A9 (en) | 2009-12-01 | 2012-11-08 | Rishab Aiyer Ghosh | System and method for query suggestion based on real-time content stream |
WO2011079415A1 (en) * | 2009-12-30 | 2011-07-07 | Google Inc. | Generating related input suggestions |
US8954422B2 (en) * | 2010-07-30 | 2015-02-10 | Ebay Inc. | Query suggestion for E-commerce sites |
US8935199B2 (en) * | 2010-12-14 | 2015-01-13 | Xerox Corporation | Method and system for linking textual concepts and physical concepts |
US9443026B2 (en) * | 2010-12-28 | 2016-09-13 | Yahoo! Inc. | Method and system to utilize session queries in real time to improve geo precision of sponsored listings |
US8983995B2 (en) * | 2011-04-15 | 2015-03-17 | Microsoft Corporation | Interactive semantic query suggestion for content search |
US8898182B2 (en) * | 2011-04-27 | 2014-11-25 | International Business Machines Corporation | Methods and arrangements for providing effective interactive query suggestions without query logs |
US8930837B2 (en) | 2011-05-23 | 2015-01-06 | Facebook, Inc. | Graphical user interface for map search |
US8589429B1 (en) * | 2011-07-11 | 2013-11-19 | Amazon Technologies, Inc. | System and method for providing query recommendations based on search activity of a user base |
US8650031B1 (en) * | 2011-07-31 | 2014-02-11 | Nuance Communications, Inc. | Accuracy improvement of spoken queries transcription using co-occurrence information |
US20130073541A1 (en) | 2011-09-15 | 2013-03-21 | Microsoft Corporation | Query Completion Based on Location |
US20130080412A1 (en) | 2011-09-22 | 2013-03-28 | International Business Machines Corporation | Short search result along with query suggestions |
US8744838B2 (en) * | 2012-01-31 | 2014-06-03 | Xerox Corporation | System and method for contextualizing device operating procedures |
-
2012
- 2012-06-18 US US13/525,524 patent/US9275147B2/en active Active
-
2013
- 2013-06-14 EP EP13812569.5A patent/EP2842064A2/en not_active Withdrawn
- 2013-06-14 WO PCT/US2013/045792 patent/WO2014007970A2/en active Application Filing
- 2013-06-14 CN CN201380032224.4A patent/CN104380292A/en active Pending
Non-Patent Citations (1)
Title |
---|
See references of WO2014007970A3 * |
Also Published As
Publication number | Publication date |
---|---|
WO2014007970A3 (en) | 2014-03-20 |
WO2014007970A2 (en) | 2014-01-09 |
US9275147B2 (en) | 2016-03-01 |
CN104380292A (en) | 2015-02-25 |
WO2014007970A9 (en) | 2014-01-30 |
US20130339380A1 (en) | 2013-12-19 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
US11514035B1 (en) | Query refinements using search data | |
US9275147B2 (en) | Providing query suggestions | |
AU2011282258B2 (en) | Predictive query suggestion caching | |
US8386495B1 (en) | Augmented resource graph for scoring resources | |
RU2546308C2 (en) | Information search system with real-time feedback | |
US8688667B1 (en) | Providing intent sensitive search results | |
US9679079B2 (en) | Search query suggestions based in part on a prior search and searches based on such suggestions | |
US9507801B2 (en) | Enforcing category diversity | |
US9146972B2 (en) | Ranking of presentation modes for particular content | |
WO2012148293A1 (en) | Using feedback reports to determine performance of an application in a geographic location | |
US10102222B2 (en) | Semantic geotokens | |
US10936584B2 (en) | Searching and accessing application-independent functionality | |
WO2017039869A1 (en) | Context based instant search suggestions | |
US20230244657A1 (en) | Query composition system | |
US9348925B2 (en) | Locally significant search queries | |
US8825698B1 (en) | Showing prominent users for information retrieval requests | |
US20150227583A1 (en) | Managing search results | |
JP2014532942A (en) | Social page trigger | |
WO2015175313A1 (en) | Disambiguation of queries implicit to multiple entities | |
US9116996B1 (en) | Reverse question answering | |
US9317528B1 (en) | Identifying geographic features from query prefixes | |
US9418156B2 (en) | Providing local data with search results |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
PUAI | Public reference made under article 153(3) epc to a published international application that has entered the european phase |
Free format text: ORIGINAL CODE: 0009012 |
|
17P | Request for examination filed |
Effective date: 20141030 |
|
AK | Designated contracting states |
Kind code of ref document: A2Designated state(s): AL AT BE BG CH CY CZ DE DK EE ES FI FR GB GR HR HU IE IS IT LI LT LU LV MC MK MT NL NO PL PT RO RS SE SI SK SM TR |
|
AX | Request for extension of the european patent |
Extension state: BA ME |
|
DAX | Request for extension of the european patent (deleted) | ||
STAA | Information on the status of an ep patent application or granted ep patent |
Free format text: STATUS: THE APPLICATION IS DEEMED TO BE WITHDRAWN |
|
18D | Application deemed to be withdrawn |
Effective date: 20160105 |
|
P01 | Opt-out of the competence of the unified patent court (upc) registered |
Effective date: 20230519 |