Embodiment
For simple and illustrative purpose, mainly by describing the present invention with reference to one or more embodiment.In the following description, a plurality of details have been set forth, so that provide to thorough of the present invention.Yet, it is evident that for those of ordinary skill in the art, can be not limited to these detail ground and implement the present invention.In other cases, be not described in detail known method and structure, so that can obscure the description of embodiments of the invention necessarily.
According to embodiment, disclose a kind of safe, strong, platform method flexibly and fast, this method is used for determining that in security password operation or wherein uncertain result be at random, uncertain, the seed that can not guess that required or useful other use.
Password Operations is used to hide Info.For example, the owner of content, distributor and the user operation that accesses to your password, this content comprises commercial content, content of copyright, other purposes contents or may need or benefit from any content of security.These Password Operations are used to protect, hide, store, control and/or manage duplicating, distribute, visit and using of such content, and are called as " digital rights management " operation (DRM).In this, Pseudo-random number generator can be used as the basis of DRM operation.
Pseudo-random number generator uses seed to come initialization or illustration Pseudo-random number generator, to generate pseudo-random sequence.Pseudo-random sequence can be called as pseudo random number, pseudo-random number sequence or be intended to have the pseudo random number of attribute of sequence of approximate true uncertain random number or one or more set of sequence.Usually, seed itself is the sequence of random number, and can be called as sequence and Bit String etc.Yet, the seed typical pseudo-random sequence much shorter that ratio generates from seed on bit length usually.
Because normal Pseudo-random number generator is deterministic, so identical seed will be exported identical pseudo-random sequence with identical Pseudo-random number generator.Pseudo-random sequence itself is " deterministic ", this means that it repeats basically.Pseudo-random sequence is more near completely random, and then Password Operations or wherein uncertain result are that required or useful other uses are safer.On the contrary, pseudo-random sequence is far away more apart from completely random, and then this security password operation or other uses are more dangerous.Therefore, can use following knowledge to come " attack " or " distorting (hack) " pseudo-random sequence: 1) Pseudo-random number generator, and, 2) be used to generate the seed of pseudo-random sequence.
Fortunately, seed can have so many value, makes that can not pass through " brute force " in assailant/hacker's operating period obtains seed, wherein, mean by calculating each probable value of seed by " brute force ", must predict its value and still obtain its value so that avoid.Therefore, deterministic Pseudo-random number generator can remain safe.Yet each (or being close to each) when using Pseudo-random number generator, generate at random, can not guess become very crucial with uncertain seed.
Even seed can be at random, can not guess and uncertain, but the security of such seed still depends on 3) the maintaining secrecy of seed.Such seed is generated, and therefore exists, and this means that it can be found, duplicates and use.Seed is secret more, and then Password Operations or other uses are safe more, and vice versa.For example, seed then is somebody's turn to do operation or uses safe more apart near more in the position that is hidden in completely random.On the contrary, seed then is somebody's turn to do operation or uses dangerous more apart from far away more in the position that is hidden in completely random.Therefore, can 3) use the knowledge of its position to come " attack " or " distorting " pseudo-random sequence.
Fortunately, seed can be kept maintaining secrecy.For example, can not can hide seed under the many situations by " brute force " location seed in the operating period assailant/hacker, wherein, mean by each possible position of search seed, must predict its position and still find its position so that avoid by " brute force ".Yet hiding seed makes it can keep secret and becomes very crucial.For example, each seed is generated, determines, when processing, guidance, modification and change etc., seed can be hidden at random, the uncertain and position that can not guess.
Turn to Fig. 1, show the simplified block diagram according to the electronic equipment 100 of embodiment, electronic equipment 100 is configured to carry out various function described herein.In Fig. 2, show simplified block diagram according to the calculation element 200 of embodiment, calculation element 200 is configured to carry out various function described herein.In the embodiment in figure 1, with reference to figure 2.Yet, Fig. 2 further even is in more detail described below.Should be understood that electronic equipment 100 can comprise the media component that can in the operation of electronic equipment 100, realize such as digital signal processor, such as the Control Component of general processor or the medium and the Control Component of any number.
Electronic equipment 100 can comprise software, firmware, hardware or its combination that is configured to generate the seed that will be used for definite pseudo-random sequence.Electronic equipment 100 can be a media device.Other examples of electronic equipment 100 include, but are not limited to portable media player, Still Media player, be used to support the electronic equipment of video code conversion, the electronic equipment that does not have the hardware random number maker, set-top box (for example, cable, satellite or DSL), PC, phone, cell phone, any other phone, televisor, wireless high-definition degree interface, any other high definition interface, computing equipment, MP3 player, such as the transceiver of intercom, need the equipment of DRM or can be used for any other equipment and/or the processing that safety is supported.
As shown in fig. 1, electronic equipment 100 comprises Pseudo-random number generator 117, entropy data acquisition module 155, entropy evaluation module 175, seed determination module 180, pseudo-random sequence determination module 185 and Password Operations module 190.In addition, Fig. 1 illustrates entropy source 150N, entropy data bit 151, (one or more) key 195 and content/other are 199 years old.
One or more the obtain entropy data bits 151 of entropy data acquisition module 155 from the 150N of entropy source, wherein, N is a positive integer.Individually, " entropy data bit " can be: 1) always measurable, 2) some time measurable, or 3) not measurable.Term " entropy data " or " entropy data bit " are for the quoting of one or more bits, any one in these one or more bits can be these three kinds may one of." entropy source " is the source of such " entropy data bit ".Entropy data bit 151 is used for exporting by entropy data acquisition module 155 and is called the content of " Bit String " at this.
Entropy data acquisition module 155 uses the time that can measure quantity to export such Bit String.Yet in order so to use Bit String in Password Operations or other uses, such Bit String must satisfy predetermined " security intensity ", and is following further described in more detail." security intensity " is safe tolerance.Can be according to " entropy intensity " definition " security intensity "." entropy intensity " is the tolerance of randomness.
In example, the user of electronic equipment 100 or calculation element 200 is starting to Password Operations or is waiting between other operating periods usually, till the Bit String from 155 outputs of entropy data acquisition module satisfies predetermined security intensity.Because the wait period of the length between the starting period may cause negative user experience, so as the said wait period of avoiding length.As another exemplary characteristics, avoid subscriber equipment to freeze or even the collapse perception or reality.At this, entropy data acquisition module 155 is configured to make to start when the Bit String of predetermined security intensity is satisfied in output proceed to Password Operations.On the contrary, entropy data acquisition module 155 is configured to carry out where necessary one or more iteration, so that the Bit String of predetermined security intensity is satisfied in output, with protection Password Operations or other uses.Other parts are all identical, 1) more iteration means longer start-up time, 2) better the entropy source trend towards causing iteration still less, and, 3) use the entropy source to trend towards causing still less iteration better.Usually, better the entropy source be can (1) at any given time and (2) come to obtain the more entropy source of the uncertain bit of big figure with bigger frequency from it.
When determining not satisfy predetermined " entropy intensity ", entropy data acquisition module 155 obtains additional entropy data bit from entropy source 150N iteratively, till entropy data acquisition module 155 was carried out following behavior: 1) Bit String of predetermined security intensity was satisfied in output, or 2) obtained predetermined " the entropy data bit of maximum number ", but fail to satisfy necessary predetermined security intensity, as further described below.Under latter event, as described herein, electronic equipment 100 or computing equipment 200 can restart or begin again.
As option, entropy data acquisition module 155 also can be further, handle Bit String in combination individually or with any one or a plurality of added bit and any one or a plurality of added bit strings etc.Entropy data acquisition module 155 can comprise individually or with any example of the processing of execution in combination: combination; Connect; Hash; Mapping; And conversion.Yet, should be understood that entropy data acquisition module 155 can carry out the additional treatments except enumerating for example at this.By being arranged to further processing, entropy data acquisition module 155 is configured to operation in electronic equipment 100, generates with guiding adaptively to have the seed that neither can predict the value that can not locate easily easily.
By handling (or according to circumstances, by carrying out additional treatments by this way) by this way, entropy data acquisition module 155 makes the more difficult conjecture random series of assailant/hacker.Therefore, can increase the security of Password Operations or other uses.From entropy data acquisition module 155 output Bit Strings the time, this Bit String is imported into entropy evaluation module 175.
Entropy evaluation module 175 is configured to receive each Bit String mode of iteration (where necessary, with) from entropy data acquisition module 155.When receiving Bit String, entropy evaluation module 175 is at assess Bit String to get off: 1) whether the entropy intensity of Bit String satisfies predetermined security intensity, 2) whether obtained the entropy data bit (not having Bit String satisfy/to reach predetermined security intensity) of pre-determined maximum number even determined simultaneously, and, 3) satisfy/reach the estimation of being scheduled to security intensity about how many additional entropy data bits of needs.Unless entropy evaluation module 175 the entropy data bit that does not have identification to satisfy to have obtained pre-determined maximum number under the situation of Bit String of predetermined security intensity (this can first or any subsequently iteration in), entropy evaluation module 175 triggers entropy data acquisition module 155 iteratively and obtains additional entropy data bit 151 iteratively from entropy source 155N, and the added bit string of output correspondence iteratively is so that assess in mode described herein.Therefore, as further described below, entropy evaluation module 175 guides the generation of (one or more) seed to save time adaptively.
Relate to guide seed generation with time saving first situation under, the number of the additional entropy data bit that entropy evaluation module 175 is estimated required (satisfying predetermined security intensity) on sum than the entropy data bit sum much less of pre-determined maximum number.In this case, when each iteration needed the time of measurable quantity, entropy data bit that can be by only obtaining estimated number rather than total predetermined maximum were saved time.
Relate to guide seed generation with time saving second situation under, entropy evaluation module 175 determine it obtained the entropy data bit of pre-determined maximum number and not energy measurement comprise the Bit String of the entropy intensity that satisfies predetermined security intensity.At this, electronic equipment 100 is reporting errors for example, restarts, and begins again.By beginning again, quickly rather than more slowly, the user of electronic equipment 100 can avoid since the electronic equipment 100 that the failure iteration that repeats causes be attributable to the negative experience may freezing and/or collapse.By beginning again rather than using the Bit String that comprises less than the entropy intensity of predetermined security intensity, avoid the risk of unsafe Password Operations.
Under the 3rd situation that relates to the generation that guides seed, entropy evaluation module 175 is measured the Bit String that receives from entropy data acquisition module 155, and for example to determine that this Bit String has satisfied/reach the entropy intensity of predetermined security intensity.At this, entropy evaluation module 175 is to seed determination module 180 output Bit Strings.
As the 4th option, entropy evaluation module 175 also can be further, handle Bit String in combination individually or with any one or a plurality of added bit string.Entropy evaluation module 175 can comprise separately or with any example of the processing of execution in combination: combination; Connect; Hash; Mapping; And conversion.Yet, should be understood that entropy evaluation module 175 can carry out the additional treatments except enumerating for example at this.By being arranged to further processing, entropy evaluation module 175 is configured to operation in electronic equipment 100, generates with guiding adaptively to have the seed that neither can predict the value that can not locate easily easily.
By handling (or according to circumstances, by carrying out additional treatments by this way) by this way, entropy evaluation module 175 makes the more difficult conjecture random series of assailant/hacker.Therefore, can increase the security of Password Operations or other uses.
When entropy evaluation module 175 output is not satisfied the Bit String of predetermined security intensity, this Bit String is output to entropy data acquisition module 155, and for example is used as the part of iterative processing described herein.As the 5th option, entropy data acquisition module 155 can be configured to from entropy evaluation module 175 received signals, rather than receives Bit String itself.At this, entropy data acquisition module 155 is also preserved the Bit String that outputs to entropy evaluation module 175 except to entropy evaluation module 175 output Bit Strings.In any option, as said, Bit String can be used for iteration by entropy data acquisition module 155, to be used for subsequently to entropy evaluation module 175 output Bit Strings.Yet behind the Bit String of the satisfied predetermined security intensity of output, this Bit String is imported into seed determination module 180.
Seed determination module 180 uses with definite seed that gets off: 1) with the Bit String of mode as discussed further below from 155 outputs of entropy data acquisition module, and, 2) one or more data bit strings, such as key 195, at least one in feasible (one or more) key 195 can be privacy key.After determining seed, seed determination module 180 output seeds are to be imported by pseudo-random sequence determination module 185.
In (one or more) key 195 each is to be used for the private data of " conversion " or " not changing " content/other 199 materials to gather in encryption and decryption operations.The different keys of (one or more) key 195 are specified the different pieces of information conversion.An example of (one or more) key is " public keys ", and public keys is the right public part of public keys.Another example of (one or more) key is " private cipher key ", and private cipher key can for example be right another of public keys or privately owned part.The another kind of type of (one or more) key 195 is can be " the random secret key " of " symmetric key ".An example of the symmetric key of (one or more) key 195 is privacy keys of storing on the disposable programmable memory of electronic equipment 100.Specific one of this of (one or more) key is " key that equipment is unique ".It can be programmed once, so nobody can revise it, and it can not be read usually, but it can use in Password Operations or other use.For example, it can be used for encrypted content/other 199 materials.As option, it can be used to encrypt any one or a plurality of (one or more) key 195, and can be stored on the electronic equipment 100.This specific key of (one or more) key 195 can be called as " KEK " (key-encrypting key).
In example, seed determination module 180 is after receiving (satisfying predetermined safe intensity) Bit String and after receiving the key of (one or more) key 195 from entropy evaluation module 175, at least according to definite seed that gets off: 1) Bit String, and, 2) key of (one or more) key 195.As first option, at least one in (one or more) key 195 can or privacy key or unclassified key or its combination.As second option, this in (one or more) key 195 is one or more can be encrypted, not encrypted or its combination.In second option, can come at least one in storage (one or more) key 195 or a plurality of in storer with encrypted form, non-encrypted form or its combination.In arbitrary option, can in currently or later Password Operations or other use, use in (one or more) key 195 that is stored in the storer this at least one or a plurality of.Can in Password Operations or other uses, use any key of in storer, storing with encryption format.
As the 3rd option, seed determination module 180 also can be further, handle Bit String in combination individually or with any one or a plurality of added bit string.Seed determination module 180 can comprise separately or with any example of the processing of execution in combination: combination; Connect; Hash; Mapping; And conversion.Yet, should be understood that seed determination module 180 can carry out the additional treatments except enumerating for example at this.By being arranged to further processing, seed determination module 180 is configured to operation in electronic equipment 100, generates with guiding adaptively to have the seed that neither can predict the value that can not locate easily easily.
By handling (or according to circumstances, by carrying out additional treatments by this way) by this way, seed determination module 180 makes the more difficult conjecture random series of assailant/hacker.Therefore, can increase the security of Password Operations or other uses.After determining seed, seed determination module 180 is to pseudo-random sequence determination module 185 output seeds.
As said, pseudo-random sequence determination module 185 uses this seed to determine pseudo-random sequence after receiving seed.For example, pseudo-random sequence determination module 185 uses seed to be used as the source that entropy is imported, to determine pseudo-random sequence.Seed is the part of the initial internal state of pseudo-random sequence determination module 185 at least.
As first option, pseudo-random sequence determination module 185 uses seed to determine pseudo-random sequence separately or with one or more other sources of entropy input in combination.As second option, pseudo-random sequence determination module 185 can be further, handle seed in combination individually or with any one or a plurality of added bit string.Can by pseudo-random sequence determination module 185 separately or the example of the processing of carrying out with any combination comprise: combination; Connect; Hash; Mapping; And, conversion.Yet, should be understood that pseudo-random sequence determination module 185 can carry out the additional treatments except enumerating for example at this.By being arranged to further processing, pseudo-random sequence determination module 185 is configured to operation in electronic equipment 100, generates with guiding adaptively to have the seed that neither can predict the value that can not locate easily easily.
By handling (or according to circumstances, by carrying out additional treatments by this way) by this way, pseudo-random sequence determination module 185 makes assailant/hacker even more difficult conjecture random series.Therefore, can increase the security of Password Operations or other uses.
As the 3rd option, pseudo-random sequence determination module 185 can be exported one or more set of (one or more) pseudo-random sequence to be stored in storer (dish or other) for later use.For example, any one or a plurality of pseudo-random sequence can be individually or are used as the basis of another Pseudo-random number generator seed in combination with any one or a plurality of added bit string.Example comprises the entropy data bit 151 of any number, any one or a plurality of part or all of Bit String from entropy data acquisition module 155 output, any one or a plurality of part or all of Bit String from entropy evaluation module 175 output, any one or a plurality of part or all of Bit String from seed determination module 180 output, any one that itself generates in advance by pseudo-random sequence determination module 185 or a plurality of part or all of Bit String, cryptographically or additionally any Bit String and any other Bit String of storage in storer.At this, the 4th option is can encrypt, not encrypt and/or store from any random series of Pseudo-random number generator 117 outputs in storer.Pseudo-random sequence determination module 185 is to Password Operations module 190 output pseudo-random sequences.
Password Operations module 190 uses this pseudo-random sequence to carry out Password Operations or other uses after receiving pseudo-random sequence.For example, can in operation or use, use content/other 199 materials.Use privacy key in any case in operation or other uses, operation or other uses can according to circumstances be called as " secret key encryption ", " privacy key deciphering " or " privacy key Password Operations ".
As first option, Password Operations module 190 can be further, handle pseudo-random sequence in combination individually or with any one or a plurality of added bit string.Can by Password Operations module 190 separately or the example of the processing of carrying out with any combination comprise: combination; Connect; Hash; Mapping; And, conversion.Yet, should be understood that Password Operations module 190 can carry out the additional treatments except enumerating for example at this.By being arranged to further processing, Password Operations module 190 is configured to operation in electronic equipment 100, generates with guiding adaptively to have the seed that neither can predict the value that can not locate easily easily.
By handling (or according to circumstances, by carrying out additional treatments by this way) by this way, Password Operations module 190 makes assailant/hacker even more difficult conjecture random series.Therefore, can increase the security of Password Operations or other uses.
Fig. 2 illustrates the block diagram 200 according to the calculation element of the embodiment of the invention, this calculation element be configured to realize or the embodiment of execution graph 1 in electronic equipment 100 and/or the feature of the method 300 among the embodiment of Fig. 3.Calculation element 200 can be used as and be used to carry out above platform with respect to electronic equipment 100 and following one or more features of describing with respect to method 300.
Calculation element 200 comprises one or more processors 202, these one or more processors 202 can realize or manner of execution 300 in some or all steps in the step described.On communication bus 204, send the order and the data of self processor 202.Calculation element 200 also comprises: primary memory 206, such as random-access memory (ram), wherein, can during working time, carry out the program code that is used for processor 202; And, supplementary storage 208.Supplementary storage 208 for example comprises one or more hard disk drives 210 and/or removable storage drive 212, wherein, can store the copy of the program code that is used for method 300, this removable memory driver is represented floppy disk, tape memory, CD drive etc.
Removable storage drive 210 reads and/or writes to removable storage unit 214 from removable storage element 214 in known manner.User's input and output device can comprise keyboard 216, mouse 218 and display 220.Display adapter 222 can be docked with communication bus 204 and display 220, and can receive video data from processor 202, and this video data is converted to the display command that is used for display 220.In addition, (one or more) processor 202 can communicate on the network of for example the Internet, LAN (Local Area Network) etc. by network interface 224.
It is evident that for those of ordinary skill in the art, can in calculation element 200, add or replace other known electronic packages.Should it is evident that also one or more assemblies of describing can be optional (for example, user input device, supplementary storages etc.) in Fig. 2.
Though in full content of the present disclosure, be described particularly, but representative embodiment of the present invention has effectiveness in the application on a large scale, and above-mentioned and following embodiment is not intended to and it is restrictive should not to be interpreted as, but is provided as the illustrative discussion of aspect of the present invention.
Process flow diagram referring now to the following method of describing in the embodiments of figure 3 300 is described a kind of method, and this method comprises the example of the feature that electronic equipment 100 and calculation element 200 can adopt.Should it is evident that for those of ordinary skill in the art, under the situation of the scope that does not depart from method 300, can add other steps, maybe can remove, revise or rearrange existing step.
Carry out the description of method 300 with reference to the calculation element among the embodiment of the electronic equipment among the embodiment of figure 1 100 and Fig. 2 200.Therefore, describe with reference to the element shown in Fig. 1 and 2.Yet, should be understood that method 300 is not limited to the element that provides in electronic equipment 100 or calculation element 200.On the contrary, should be understood that and to come implementation method 300 by electronic equipment with configuration different with the configuration that in the embodiment of electronic equipment 100 and calculation element 200, provides.
Some or all operations that provide in the method 300 can be used as utility, software program or subroutine and are comprised in any desired computer accessible.In addition, method 300 can embody by computer program, and this computer program can exist with movable and inactive various ways.For example, method 300 can be used as (one or more) software program and exists, this software program by with compression or not the programmed instruction of source code, object code, executable code or the extended formatting of compressed format constitute.Any one of above-mentioned part can be embodied on the computer-readable medium that comprises storage facilities.
The exemplary computer readable storage medium comprises: any substrate, this substrate are embedded into the one or more computer programs that are used to carry out one or more features described herein; And various conventional computer system substrates are such as RAM, ROM, EPROM, EEPROM and disk or CD or belt.Can be configured to visit such (one or more) program in suprabasil exemplary computer-readable signals or the exemplary computer-readable signals on one or more computer programs, moved, comprise the signal that uses by the Internet or other network download.The program distribution that the concrete example of above-mentioned part is included in (one or more) program distribution on the CD ROM or downloads via the Internet.On certain implication, the Internet itself is a computer-readable medium.This also sets up for computer network usually.Therefore should be understood that any electronic equipment that can carry out feature described herein can carry out those functions of enumerating above.
Can realize or carry out electronic equipment 100 and calculation element 200 such as one or more any combination of the controller of processor (not shown), digital signal processor, ASIC, microcontroller etc. or any one or a plurality of computer chips that make up these assemblies, with manner of execution 300.Alternatively, electronic equipment 100 and calculation element 200 can be configured to be independent of any other processor, digital signal processor, chip or computing equipment and operate.
Embodiment with reference to figure 3, Fig. 3 shows the process flow diagram according to the method 300 that is used for definite seed of embodiment, this seed is as the source of entropy in Pseudo-random number generator input, and this Pseudo-random number generator is to use during required or useful other use in Password Operations or wherein uncertain result.
In step 310, entropy data acquisition module 155 for example with above in the embodiment of Fig. 1-2 mode described here obtain entropy data bit 151 from any one or multiple source 150N of entropy.
Depend on platform, system, application etc., some in the entropy data source are at some platforms and use unavailable.Yet, because need to satisfy the Bit String (to carry out Password Operations) of predetermined security intensity, so the unavailability in one or more entropys source also can mean the longer time that is used for satisfying predetermined security intensity.For example, may require to be used for obtaining the additional iteration (needing more time) of adding the entropy data bit to satisfy predetermined security intensity in any platform, system or application, this any platform, system or use the entropy source preferably of not using, this preferably the entropy source may be in addition to other platforms, system or use available.Yet, because method 300 can be suitable for guiding obtaining of entropy data bit based on available entropy source, so feature of the present invention comprises: avoid the unnecessary wait in platform, system and/or application, described platform, system and/or application can be obtained the entropy data bit of enough numbers quickly to export the Bit String that satisfies predetermined security intensity.
In method 300, as required, for example processing of entropy data acquisition module 155, additional treatments and/or execution iterative operation etc.Comprise by entropy data acquisition module 155 examples independent or that handle with any combination: combination; Connect; Hash; Mapping; And conversion.Yet, should be understood that the additional treatments that can carry out except enumerating for example at this.At this, method 300 guides to generate adaptively has the seed that neither can predict the value that can not locate easily easily.
In first example of handling, at first and second Bit Strings relative to each other independently under the situation, can be by improving entropy intensity via connecting two Bit Strings of combination.For example, consider to have first Bit String of the first entropy intensity and being connected of second Bit String with the second entropy intensity that is independent of the first entropy intensity.As described herein, " entropy intensity " can be expressed as the number of the predictability that is used to indicate Bit String.The entropy intensity that connects can be the first and second entropy intensity and.
Handle in the example second, by the Hash entropy intensity that distributes.At this, the Hash randomness that can in whole connection, distribute equably.Consider to use the digital video record of hard disk to no dish set-top box.Use the method 300 of entropy data acquisition module 155 to be configured to obtain " entropy data bit " from one or more entropys source 150N.For example, digital video recorder is to make hard disk be used as the platform in entropy source alternatively usually.Count under situation at usage counter for clock period in time durations past that one or more read spent of hard disk, can the enabling counting device, carry out read, and read counter.At this, owing in time uncertain variation causes unpredictable (one or more) read, this uncertain variation in time is owing to for example temperature or other operations of carrying out during (one or more) read etc.From then on, the value of the counting that reads from counter is the example of " entropy data bit 151 ".Usually, the counting that reads from counter more may have uncertain bit in the minimum effective bit position of the Bit String that is used to represent count.At this, minimum effective bit may all or be close to unpredictable fully, and therefore can be used as uncertain entropy data bit individually.Yet, as option, whole Bit Strings or its any part that can the Hash value, this means can be for distribute the equably randomness of minimum effective bit of other bits.After Hash, each bit in whole Bit String can have identical randomness.Usually, can Hash have the minimum effective bit of height random and at random the Bit String (such as the value that reads from counter) of high significant bit hardly.At this, the randomness of minimum significant bit is distributed evenly on all bits that comprise the highest significant bit usually, makes that the randomness of high significant bit can improve with the randomness near the minimum effective bit that has reduced.
For no dish set-top box, it is not used in the dish of the clock period in the past of counting during one or more read.On the contrary, for example, no dish set-top box can for example be counted the clock period in past during sleep operation.Yet when making comparisons with the minimum effective bit of hard disk read-write operations, the minimum effective bit of the counter of sleep operation may be more unpredictable.
Under the identical situation of every other part, in no dish set-top box, need more iteration to export to satisfy predetermined security intensity, from the Bit String of entropy data acquisition module 155.At this, the speed that starts Password Operations can be different because of platform difference (and/or in response to usefulness difference and/or because of system's difference).
For example, the PC platform can be connected to network, and this network has the available random data as the source.The same PC that is not connected to that network is not like this.In another example of different platform, no dish set-top box is different with the digital video recorder with hard disk.Therefore, no dish set-top box is not used in counting in the past hard disk of clock period during one or more read.On the contrary, no dish set-top box can for example be counted the clock period in past during one or more sleep operation.In another example, different platforms can not visited same entropy source.For example, the calculation element 200 among the embodiment of following Fig. 2 can use hard disk to be used as the entropy source alternatively.On the contrary, the electronic equipment 100 among the embodiment of Fig. 1 can even not have hard disk etc.
Method 300 can make up the entropy data bit string of any number.For example, entropy data acquisition module 155 can make up a plurality of entropy data bit strings, described a plurality of entropy data bit string: 1) during same iteration, 2) during any one or more additional iteration, 3) from any one or a plurality of different entropy source, 4) from before be defined as not satisfying any one or a plurality of different Bit String of predefine security intensity, 4 by entropy evaluation module 175) from the data of storage, and 5) from any other data, or the like be acquired.With the example class of the Bit String of Hash Counter Value seemingly, the Bit String that Hash the connects randomness that in all connecting, distributes equably.
By handling (or according to circumstances, by carrying out additional treatments by this way) by this way, random series determination module 185 makes assailant/hacker even more difficult conjecture random series.Therefore, can increase the security of Password Operations or other uses.
Method 300 can for example comprise: measure from the randomness of each Bit String of entropy data acquisition module 155 outputs, whether have the entropy intensity that satisfies predetermined security intensity to determine each string; Estimate/determine to need how many additional entropy data bits to satisfy predetermined security intensity based on the uncertainty of any given bit of conjecture in current Bit String; And as required, obtain the additional entropy bit of determined estimation iteratively.
In step 320, entropy evaluation module 175 determines whether (exporting from entropy data acquisition module 155) Bit String satisfies predetermined safe intensity.For example, Bit String can be quantified as the number that can be expressed as the bit number aspect entropy intensity.Can mention entropy intensity according to bit number.Entropy intensity and term " entropy data bit " should not obscured, the entropy data bit refers to the input of entropy data acquisition module 155 in the embodiment in figure 1.Yet feature of the present invention is to estimate to satisfy the needed entropy data bit of predetermined safe intensity, makes entropy data acquisition module 155 obtain estimation with an iteration where necessary.
As the estimated number of entropy data bit, predetermined " security intensity " can be quantified as bit number.From these two numbers, can determine whether satisfy predetermined safe intensity in step 320 from the Bit String of entropy data acquisition module 155 outputs.For example, when the number of " the entropy intensity " of decision bit string was equal to or greater than predetermined safe intensity, Bit String satisfied predetermined safe intensity.
In step 330, determining when the entropy intensity of the Bit String of entropy data acquisition module 155 outputs satisfies predetermined safe intensity, seed determination module 180 for example receives Bit Strings from entropy evaluation module 175, and for example as above to determine the seed that in Password Operations, will use with reference to the described mode of the embodiment of Fig. 1 and 2.
When Bit String does not satisfy predetermined safe intensity and is no more than the pre-determined maximum number of entropy data bit, method 300 is obtained additional entropy data bit in each iteration iteratively, for example causes exporting each added bit string iteratively from the additional output of " Bit String " of entropy data acquisition module 155.At this, the duration of the start-up time to the Password Operations is can be because of system different and/or because of different on the different basis of platform.Yet,, on the basis of for example operating one by one, guide to the start-up time in the Password Operations with system and platform independence.
Normally, when satisfying (being determined by entropy evaluation module 175) predetermined safe intensity at Bit String, as described below, entropy data acquisition module 155 is not exported additional " Bit String ".At this, reduced the duration of the start-up time to the Password Operations.
In step 340, entropy evaluation module 175 for example estimates satisfy/to reach the sum of the needed entropy data bit of predetermined safe intensity.Entropy evaluation module 175 is measured the entropy intensity of Bit String in known manner, for example uses standard NIST SP 800-90, appendix C, in March, 2007, this standard to describe use equation H
Min=-lg
2(p
Max) measure the conservative metering system of the entropy in the Bit String.
Suppose that predetermined safe intensity is 112 bits altogether.Normally, the number that interrupts the needed combination of random series by " brute force " is 2 altogether
Security_strengh" brute force " (BruteForce) attempts all possible combination exhaustively, so that find the combination of deciphering, avoids conjecture thus.Security intensity is big more, and the combination that then more may need calculating " brute force " is to solve predetermined entropy bit length.In this example, 112 predetermined safe intensity has altogether 5.19229685853 * 10 altogether
33Combinatorial enumeration (2
112=5.19229685853 * 10
33).Under first situation, when the decision bit string satisfied predetermined safe intensity, method 300 was carried out to determine seed in step 330.Under second situation, when the decision bit string fails to satisfy predetermined safe intensity, need to estimate how many additional entropy data bits to satisfy predetermined safe intensity.Under the 3rd situation, when the entropy data bit of pre-determined maximum number had been obtained in judgement, method 300 sent mistakes, restarts, and begins again.
The bit length of supposing Bit String also is altogether 112.In addition, the counting of supposing whole Bit String is that 70 " 1 " and 42 " 0 " (72+42=112 bit) (notices that the counting of this particular type is 1 a bit value counting.Can carry out the counting of other known type, such as 2 bit values counting, 4 bit value countings etc.).At this, for each bit, 1) p
MaxOr the maximum probability of guessing each bit (" 0 " or " 1 ") is 62.5% (70/112=0.625), and, 2) H
MinOr the estimation of the randomness of each bit is 67.8% (H
Min=-lg
2(0.625)=0.678).The entropy length of the whole string of expressing in " entropy bit " is 76 (112 * 0.678=75.936) altogether.Therefore, estimated number needs 36 (112-76=36) individual additional " entropy bit " altogether.
For example, the principle according to count the probability of (70 " 1 " and 42 " 0 ") with respect to 1 bit value this means that the maximum probability of any given bit value of the Bit String of guessing 112 bits is 0.625 or 62.5% (70/112=0.625).According to top equation, estimate that (from the Bit String of entropy data acquisition module 155 outputs) each bit is to have the entropy (H of every bit 67.8% randomness
Min=-lg
2(0.625)=0.678).By being rounded to nearest integer, the entropy intensity of expressing with " entropy bit " (from the Bit String of entropy data acquisition module 155 outputs) is 76 (112 * 0.678=75.936) altogether.Therefore, 76 " entropy bits " less than predetermined safe intensity, predetermined safe intensity is 112.At this, 112 security intensity be estimated as need be altogether 36 additional " entropy bits " (112-76=36).When each data bit has 0.678 estimation entropy, estimate that 112 predetermined safe intensity need be obtained 54 additional " entropy data bits " (36/0.678=53.097) altogether.
As option, be used to make entropy to estimate that more accurate a kind of technology is to follow the tracks of average minimum entropy, and for example, store average minimum entropy hereof.Average minimum entropy file can be stored in the average minimum entropy of whole, all intimate or some the entropy data bits that generate in the past in the electronic equipment 100.Generate at every turn and/or obtain when adding the entropy data bit, can upgrade the value of average minimum entropy.In step 340, for example be not based on the number (the relatively little samplings of the data of an iteration, obtaining) of estimating the additional entropy data bit that will obtain from a Bit String of entropy data acquisition module 155 outputs, but method 300 can be used the history average of previous estimation, so that obtain history average subsequently.For example, history average can require to obtain than current estimation additional entropy data bit still less.On average rather than separately depend on current estimation by depending on history, method 300 can be obtained the additional entropy data bit that satisfies predetermined safe intensity fifty-fifty.When history average require to obtain successfully on average satisfy predetermined safe intensity than the additional entropy data bit of peanut the time, method 300 can improve the speed that satisfies security intensity by saving time, avoid obtaining higher estimation.At this, this higher number can become a following average part, or the like.
In step 350, entropy evaluation module 175 for example determines whether to have obtained the entropy data bit of pre-determined maximum number.The pre-determined maximum number of supposing the entropy data bit is 512 altogether.In example, when first iteration, the entropy data acquisition module is exported the string of 212 bits altogether.Do not satisfy at Bit String under the situation of predetermined safe intensity, method 300 can be obtained additional entropy data bit iteratively in mode described herein.For example, export altogether 212 bits from the Bit String of data acquisition module 155 time, data acquisition module 155 is limited to obtain altogether and surpasses 300 additional entropy data bit (512-212=400).For example, irrelevant with the number of iteration, when amounting to 512 bits, method 300 reporting errors restart, and begin again.At this, method 300 can send again wrong, again restart and begin again before obtain 512 entropy data bits altogether.
Estimate to obtain 54 entropy data bits with the example that satisfies security intensity in, suppose to estimate to be accurately, make and after obtaining 54 additional entropy data bits, satisfy predetermined safe intensity.The number of the entropy data bit that obtains at this point is 266 (212+54=266) altogether, the pre-determined maximum number (512) of this number specific entropy data bit is much smaller, can be by obtaining 266 entropy data bits rather than obtaining 512 entropy data bits and save time, because do not need this difference satisfy/to reach predetermined safe intensity.
Yet, be characterised in that after step 320 fails to determine to satisfy the repeatedly iteration of predetermined safe intensity from the entropy intensity of the Bit String of entropy data acquisition module 155 outputs the entropy data bit of determining to have obtained pre-determined maximum number is possible.In this case, electronic equipment 100 output errors, restart and attempt again determining to satisfy the seed of predetermined safe intensity.
Method 300 can carry out mapping/switch technology with the entropy data bit from less spatial mappings to bigger space, so that the uncertain seed in more difficult location.For example, use equipment unique security key that the seed application of shorter bit length is encrypted and seed can be mapped to big " search volume " from less " search volume ", and therefore make assailant/hacker guess that seed is more difficult.At this, " search volume " is that assailant/hacker may need by to find the data space of the matched data that he is seeking.
For example, after the 128 bit A ES cryptographic algorithm that use has 128 bit keys are encrypted 64 bit random numbers and are used 128 bit encryption data as the PRNG seed, because encrypt the secret value (feature of AES) of whole 64 Bit datas that can in 128 Bit data spaces, distribute equably, so assailant/hacker must search for 128 Bit data spaces to find seed, this is more much more difficult than search in 64 Bit data spaces.Though this mapping/conversion is not mapped to all data in 128 bit space, assailant/hacker does not know that from which part of 64 bit space mapping (enum) datas, he must search for whole 128 bit space, because may shine upon any data.For example, method 300 can use secret key encryption that the N Bit String of entropy data bit is converted to the M Bit String of entropy data bit, and wherein, N and M are integers, and N is less than M.For example, N can be 64 bits, and M can be 128 bits.
Except other entropy sources this person of description can be used as the basis of the string that is used to obtain the entropy data bit.The additional example of the entropy source 150N of electronic equipment 100 comprises digitized processing, evaluation processing, optional adjusting processing, interrupt call, timestamp, file system etc.Therefore can have the fileinfo of change and be that one type the file system of entropy source 150N is the Linux file system.For example, the fileinfo that changes in the Linux file system can comprise: 1) access file when, 2) revised file when, 3) the timing changing file, 4) size of any file, and, 5) the index node title of any file or the like.Yet the alternative document system can have the fileinfo of change, and is the additional example of entropy source 150N therefore.
Because can be from any source separately or with any entropy data bit 151 that obtains in combination, so can obtain entropy data bit 151 from the additional entropy source outside those described herein.However, can be from obtaining the entropy data bit about being used as anything the one or more measurements entropy data bit, uncertain entropy source, provide example in this description.At this on the one hand, additional description example comprises counter or over and done with timer, this counter or over and done with timer these variable move, incident, activity, operation and processing one or more during can be read to obtain the entropy data bit.As example, can the enabling counting device, can carry out one or more read, and can read counter and be used to represent the Bit String counted to obtain for hard disk drive/dish file.Because the hard disk drive read changes usually in time,, and therefore be counted as the string of entropy data bit so count value is uncertain.Other examples comprise time of counting interrupt call and operation of sleep mode etc.Further example comprises the moving of computer mouse, the thump of computer small keyboard, the characteristic of Network and/or any measurement of feature and/or quantity, thermonoise and electronic noise etc.
Exemplary characteristics of the present invention comprises based on the following seed that guides adaptively and generating: the 1) use in better entropy source, 2) the better use in available entropy source, 3) quicken the generation of each seed, 4) predetermined safe intensity, 5) minimize the appearance of obtaining or reaching the entropy bit of pre-determined maximum number, 6) restart and begin again to avoid the appearance of freezing or collapsing of electronic equipment, 7) user who is minimized between starting period in using to Password Operations or other waits for the period, 8) speed of maximization startup, 9) avoid dangerous, 10) generate be used for each operation or use new seed (alternatively, even more continually), 11) by the mapping conversion (for example, from less to big position) hide Bit String, and, 12) estimate iteratively or to calculate the number that reaches the required bit of predetermined safe intensity (for example, average based on the history of iteration or iteration, average, standard deviation etc.).Yet which kind of mode no matter, this method are measured entropy intensity and to need to be estimated how many more data bits based on the result of measured entropy intensity.At this, if the entropy intensity of the sleep operation of an electronic equipment is used to obtain than the more entropy data bit of the read-write operation of another dish, then the entropy evaluation module is estimated needed residue entropy data bit based on obtaining one by one, and guides electronic equipment adaptively according to the result.
Though in full content of the present disclosure, be described particularly, but representative embodiment of the present invention has effectiveness in the application on a large scale, and top discussion is not intended to and it is restrictive should not to be construed as, but is provided as the illustrative discussion of aspect of the present invention.
Described and the content that illustrates is embodiments of the invention and their some versions at this.Term, description and accompanying drawing only provide by explanation as used herein, and do not mean that restriction.Person of skill in the art will appreciate that many within the spirit and scope of the present invention changes are possible, wherein, this invention is intended to that---and equivalent---limits by claim, wherein, all terms are represented implication with the reasonable meaning of they broad sense, unless otherwise instructed.
Though reference example has been described embodiment, those skilled in the art can carry out various modifications to described embodiment under the situation that does not depart from true spirit and scope.Term and description only provide by explanation as used herein, and do not mean that restriction.Specifically, though described method, can or side by side carry out the step of this method with the order different with illustrated order by example.Person of skill in the art will appreciate that these and other change in the spirit and scope that limit is possible in claim and equivalent thereof.