JP7225333B2 - Tiled image compression using neural networks - Google Patents
Tiled image compression using neural networks Download PDFInfo
- Publication number
- JP7225333B2 JP7225333B2 JP2021134157A JP2021134157A JP7225333B2 JP 7225333 B2 JP7225333 B2 JP 7225333B2 JP 2021134157 A JP2021134157 A JP 2021134157A JP 2021134157 A JP2021134157 A JP 2021134157A JP 7225333 B2 JP7225333 B2 JP 7225333B2
- Authority
- JP
- Japan
- Prior art keywords
- tile
- context
- image
- input
- particular tile
- Prior art date
- Legal status (The legal status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status listed.)
- Active
Links
Images
Classifications
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T9/00—Image coding
- G06T9/002—Image coding using neural networks
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/50—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using predictive coding
- H04N19/593—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using predictive coding involving spatial prediction techniques
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/04—Architecture, e.g. interconnection topology
- G06N3/044—Recurrent networks, e.g. Hopfield networks
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/04—Architecture, e.g. interconnection topology
- G06N3/045—Combinations of networks
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06N—COMPUTING ARRANGEMENTS BASED ON SPECIFIC COMPUTATIONAL MODELS
- G06N3/00—Computing arrangements based on biological models
- G06N3/02—Neural networks
- G06N3/08—Learning methods
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T3/00—Geometric image transformation in the plane of the image
- G06T3/40—Scaling the whole image or part thereof
- G06T3/4046—Scaling the whole image or part thereof using neural networks
-
- G—PHYSICS
- G06—COMPUTING; CALCULATING OR COUNTING
- G06T—IMAGE DATA PROCESSING OR GENERATION, IN GENERAL
- G06T7/00—Image analysis
- G06T7/0002—Inspection of images, e.g. flaw detection
-
- H—ELECTRICITY
- H04—ELECTRIC COMMUNICATION TECHNIQUE
- H04N—PICTORIAL COMMUNICATION, e.g. TELEVISION
- H04N19/00—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals
- H04N19/10—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding
- H04N19/169—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the coding unit, i.e. the structural portion or semantic portion of the video signal being the object or the subject of the adaptive coding
- H04N19/17—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the coding unit, i.e. the structural portion or semantic portion of the video signal being the object or the subject of the adaptive coding the unit being an image region, e.g. an object
- H04N19/176—Methods or arrangements for coding, decoding, compressing or decompressing digital video signals using adaptive coding characterised by the coding unit, i.e. the structural portion or semantic portion of the video signal being the object or the subject of the adaptive coding the unit being an image region, e.g. an object the region being a block, e.g. a macroblock
Description
本明細書は、ニューラルネットワークを使用して画像を圧縮し、再構築することに関する。 This specification relates to compressing and reconstructing images using neural networks.
ニューラルネットワークは、受け取られた入力に関する出力を予測するために非線形ユニットの1つまたは複数の層を使用する機械学習モデルである。一部のニューラルネットワークは、出力層に加えて1つまたは複数の隠れ層を含む。各隠れ層の出力は、ネットワーク内の次の層、すなわち、次の隠れ層または出力層への入力として使用される。ネットワークの各層は、パラメータのそれぞれの組の現在の値に従って、受け取られた入力から出力を生成する。 A neural network is a machine learning model that uses one or more layers of non-linear units to predict the output given the input received. Some neural networks contain one or more hidden layers in addition to the output layer. The output of each hidden layer is used as input to the next layer in the network, ie the next hidden or output layer. Each layer of the network produces an output from the received input according to the current values of its respective set of parameters.
一部のニューラルネットワークは、再帰型ニューラルネットワークである。再帰型ニューラルネットワークは、入力シーケンスを受け取り、入力シーケンスから出力シーケンスを生成するニューラルネットワークである。特に、再帰型ニューラルネットワークは、現在の時間ステップにおいて出力を計算する際に前の時間ステップからのネットワークの内部状態の一部またはすべてを使用し得る。再帰型ニューラルネットワークの例は、1つまたは複数の長期短期(LSTM: long short term)記憶ブロックを含むLSTMニューラルネットワークである。各LSTM記憶ブロックは、たとえば、現在の活性化(activation)を生成する際に使用するためまたはLSTMニューラルネットワークのその他の構成要素に提供されるための、セルに関する前の状態をセルが記憶することを可能にする、入力ゲート、忘却ゲート、および出力ゲートをそれぞれが含む1つまたは複数のセルを含み得る。 Some neural networks are recurrent neural networks. A recurrent neural network is a neural network that receives an input sequence and produces an output sequence from the input sequence. In particular, a recurrent neural network may use some or all of the network's internal state from a previous time step in computing the output at the current time step. An example of a recurrent neural network is an LSTM neural network that includes one or more long short term (LSTM) storage blocks. Each LSTM storage block allows a cell to store a previous state for the cell, e.g., for use in generating current activations or for provision to other components of the LSTM neural network. may include one or more cells each including an input gate, a forget gate, and an output gate that allow
本明細書は、タイル型深層ネットワークを使用する画像圧縮および再構築のためのテクノロジーを説明する。概して、これらのテクノロジーは、入力画像をタイルに分割することと、各タイル内のピクセル値の最初の予測を行うために空間コンテキスト(spatial context)を使用することと、残差を漸次符号化することとを含む。 This specification describes techniques for image compression and reconstruction using tiled deep networks. In general, these technologies divide the input image into tiles, use a spatial context to make an initial prediction of pixel values within each tile, and progressively encode the residuals. Including things.
概して、本明細書に記載の主題の1つの革新的な態様は、画像圧縮および再構築の行為を含む方法に具現化され得る。この態様のその他の実施形態は、方法の行為を実行するようにそれぞれが構成された対応するコンピュータシステム、装置、および1つまたは複数のコンピュータ記憶装置上に記録される可能性があるコンピュータプログラムを含む。1つまたは複数のコンピュータのシステムが特定の動作または行為を実行するように構成されることは、システムが、動作中にシステムに動作または行為を実行させるソフトウェア、ファームウェア、ハードウェア、またはそれらの組合せをそのシステム上にインストール済みであることを意味する。1つまたは複数のコンピュータプログラムに関して、特定の動作または行為を実行するように構成されることは、1つまたは複数のプログラムが、データ処理装置によって実行されるときに装置に動作または行為を実行させる命令を含むことを意味する。 In general, one innovative aspect of the subject matter described herein can be embodied in a method that includes acts of image compression and reconstruction. Other embodiments of this aspect include corresponding computer systems, apparatus, and computer programs that may be recorded on one or more computer storage devices, each configured to perform the acts of the method. include. To configure a system of one or more computers to perform a particular action or action can be defined as the software, firmware, hardware, or combination thereof that, during operation, causes the system to perform the action or action. is installed on that system. With respect to one or more computer programs, being configured to perform a particular action or action causes the device to perform the action or action when the program or programs are executed by a data processing device Meant to contain instructions.
上述のおよびその他の実施形態は、それぞれ任意で以下の特徴のうちの1つまたは複数を単独でまたは組み合わせて含むことが可能である。特に、1つの実施形態が、以下の特徴をすべて組み合わせて含む。 The above and other embodiments can each optionally include one or more of the following features, alone or in combination. In particular, one embodiment includes all of the following features in combination.
画像エンコーダシステムは、タイルに区分けされた入力画像の符号化された表現を生成する要求を受け取る可能性がある。それから、画像エンコーダシステムは、入力画像の符号化された表現を生成する。符号化された表現は、タイルの各々に関する2進符号のそれぞれの組を含む。特定のタイルに関する符号化された表現を生成することは、入力タイルの予測である出力タイルを生成するために入力タイルに関するコンテキストを処理するために訓練された空間コンテキスト予測ニューラルネットワークを使用して特定のタイルに関するコンテキストを処理することを含む可能性がある。コンテキストは、入力画像内の特定のタイルに隣接する1つまたは複数のタイルを含む可能性がある。残差画像が、特定のタイルと、特定のタイルに関するコンテキストを処理することによって空間コンテキスト予測ニューラルネットワークによって生成された出力タイルとの間で決定される可能性があり、特定のタイルに関する2進符号の組が、エンコーダのニューラルネットワークを使用して残差画像を符号化することによって生成される可能性がある。 An image encoder system may receive a request to generate an encoded representation of a tiled input image. The image encoder system then produces an encoded representation of the input image. The encoded representation includes a respective set of binary codes for each of the tiles. Generating an encoded representation for a particular tile is identified using a spatial context prediction neural network trained to process context for the input tile to generate an output tile that is a prediction of the input tile. may involve processing the context for the tiles of the A context may include one or more tiles adjacent to a particular tile in the input image. A residual image may be determined between a particular tile and an output tile produced by a spatial context prediction neural network by processing the context for the particular tile, and the binary code for the particular tile , may be generated by encoding the residual image using a neural network of encoders.
入力画像は、データ圧縮アルゴリズムを使用して、符号化された表現の2進符号を圧縮することによって圧縮される可能性がある。データ圧縮アルゴリズムは、訓練されたエントロピーコーダである可能性がある。圧縮された入力画像は、入力画像の解凍のために画像デコーダシステムに送られる可能性がある。 The input image may be compressed by compressing the binary code of the encoded representation using a data compression algorithm. A data compression algorithm may be a trained entropy coder. A compressed input image may be sent to an image decoder system for decompression of the input image.
エンコーダのニューラルネットワークは、各時間ステップにおいて、時間ステップのためのエンコーダ入力を受け取ることと、時間ステップに関する2進符号の組を生成するためにエンコーダ入力を処理することとによって残差を符号化するように構成された再帰型ニューラルネットワークである可能性がある。第1の時間ステップのためのエンコーダ入力は、残差画像である可能性がある。第1の時間ステップの後の時間ステップのためのエンコーダ入力は、(i)残差と、(ii)前の時間ステップにおいて2進符号の組からデコーダのニューラルネットワークによって生成された再構築との間の暫定残差画像である可能性があり、デコーダのニューラルネットワークは、各時間ステップにおいて、時間ステップに関する2進符号の組を含むデコーダ入力を受け取り、時間ステップにおいてエンコーダ入力の再構築を生成するためにデコーダ入力を処理するように構成される再帰型ニューラルネットワークである。 An encoder neural network encodes the residual at each time step by receiving the encoder input for the time step and processing the encoder input to generate a binary code set for the time step. It may be a recurrent neural network configured as follows. The encoder input for the first time step can be the residual image. The encoder input for the time step after the first time step is the combination of (i) the residual and (ii) the reconstruction generated by the decoder's neural network from the binary code set at the previous time step. A neural network in the decoder, at each time step, receives the decoder input containing the set of binary codes for the time step and produces a reconstruction of the encoder input at the time step. is a recurrent neural network configured to process decoder input for
特定のタイルに関する2進符号の組を生成することが、各時間ステップにおいて、時間ステップおよび任意の以前の時間ステップにおいて既に生成された2進符号から再構築されるときに特定のタイルに関する品質の閾値が満たされたかどうかを、時間ステップのためのエンコーダ入力の再構築から判定することを含む。 Generating a set of binary codes for a particular tile is, at each time step, the quality of the particular tile when reconstructed from binary codes already generated at the time step and any previous time steps. Determining from reconstruction of the encoder input for the time step whether a threshold has been met.
特定のタイルに関する2進符号の組を生成することが、品質の閾値が満たされたとの判定に応じて、既に生成された2進符号を、入力画像の符号化された表現における特定のタイルに関する2進符号の組として使用することを含む可能性がある。 Generating a set of binary codes for a particular tile replaces an already generated binary code for a particular tile in an encoded representation of the input image in response to a determination that a quality threshold has been met. May include use as a binary code set.
特定のタイルに関する2進符号の組を生成することは、各時間ステップにおいて、特定のタイルが現在の時間ステップにおいて生成された2進符号の組から再構築されるときに特定のタイルに関する品質の閾値が満たされたかどうかを判定することと、品質の閾値が満たされるとの判定に応じて、特定のタイルに関して現在の時間ステップにおいて生成された2進符号の組を、入力画像の符号化された表現における特定のタイルに関する2進符号の組として使用することとを含む可能性がある。 Generating a set of binary codes for a particular tile means that, at each time step, the quality of the set of codes for the particular tile as it is reconstructed from the set of binary codes generated at the current time step. Determining whether the threshold has been met and, in response to determining that the quality threshold has been met, the set of binary codes generated at the current time step for a particular tile into the encoded image of the input image. as a set of binary codes for a particular tile in the representation.
特定のタイルが入力画像の左または上の境界上にない場合、コンテキストは、入力画像内の特定のタイルの左および上の隣接するタイルである可能性がある。 If the particular tile is not on the left or top border of the input image, the context may be the neighboring tiles to the left and above of the particular tile in the input image.
特定のタイルが入力画像の左の境界上にあり、入力画像の上の境界にない場合、コンテキストは、特定のタイルの上の隣接するタイルおよびプレースホルダコンテキストデータ(placeholder context data)である可能性がある。 If a given tile is on the left border of the input image and not on the top border of the input image, the context can be the neighboring tiles above the given tile and the placeholder context data. There is
特定のタイルが入力画像の左上の角にある場合、コンテキストは、プレースホルダコンテキストデータである可能性がある。 If a particular tile is in the upper left corner of the input image, the context can be placeholder context data.
特定のタイルが入力画像の上の境界上にあり、入力画像の左上の角にない場合、コンテキストは、特定のタイルの左の隣接するタイルおよびプレースホルダコンテキストデータである可能性がある。 If a particular tile is on the upper border of the input image and not in the upper left corner of the input image, the context may be the left neighboring tile and placeholder context data of the particular tile.
別の実施形態は、入力画像の符号化された表現から入力画像を再構築する要求を受け取ることを含む可能性があり、入力画像は、タイルに区分けされる可能性があり、符号化された表現は、タイルの各々に関する2進符号のそれぞれの組を含む可能性がある。入力画像の再構築が、入力タイルの最初の再構築画像である出力タイルを生成するために入力タイルに関するコンテキストを処理するために訓練された空間コンテキスト予測ニューラルネットワークを使用して特定のタイルに関するコンテキストを処理することによって特定のタイルに関して生成される可能性がある。コンテキストは、入力画像内の特定のタイルに隣接する1つまたは複数のタイルの再構築を含む可能性がある。特定のタイルの残差再構築画像が、デコーダのニューラルネットワークを使用してタイルに関する2進符号の組を処理することによって生成することによって生成される可能性があり、最初の再構築画像が、特定のタイルの最後の再構築を生成するために特定のタイルの残差再構築画像と合成される可能性がある。 Another embodiment may include receiving a request to reconstruct the input image from an encoded representation of the input image, the input image may be partitioned into tiles, the encoded A representation may include a respective set of binary codes for each of the tiles. The reconstruction of the input image is the context about a particular tile using a spatial context prediction neural network trained to process the context about the input tile to produce an output tile that is the first reconstructed image of the input tile. may be generated for a particular tile by processing Context may include reconstruction of one or more tiles adjacent to a particular tile in the input image. A residual reconstructed image for a particular tile may be generated by using a decoder neural network to generate a set of binary codes for the tile, the initial reconstructed image being It may be combined with a residual reconstructed image of a specific tile to produce a final reconstruction of the specific tile.
再構築を生成することは、圧縮された入力画像を受け取ることと、タイルに関する2進符号のそれぞれの組を生成するためにデータ解凍アルゴリズムを使用して、圧縮された入力画像を解凍することとを含む可能性がある。 Generating the reconstruction includes receiving a compressed input image and decompressing the compressed input image using a data decompression algorithm to generate respective sets of binary codes for the tiles. may contain
データ解凍アルゴリズムは、訓練されたエントロピーデコーダである可能性がある。 A data decompression algorithm may be a trained entropy decoder.
特定のタイルに関する2進符号の組は、各時間ステップに関する2進符号のそれぞれのサブセットを含む可能性がある。デコーダのニューラルネットワークは、各時間ステップにおいて、時間ステップ再構築残差画像を生成するために時間ステップに関する2進符号のサブセットを処理することによって残差を生成するように構成された再帰型ニューラルネットワークである可能性がある。 The set of binary codes for a particular tile may contain a respective subset of binary codes for each time step. The decoder neural network is configured to generate a residual at each time step by processing a subset of the binary code for the time step to generate a time step reconstructed residual image. could be.
再構築残差画像を生成することは、時間ステップに関する時間ステップ再構築残差画像を合成することを含む可能性がある。 Generating the reconstructed residual image can include combining time-step reconstructed residual images for the time steps.
本明細書に記載の対象は、以下の利点のうちの1つまたは複数を実現するように特定の実施形態に実装され得る。本明細書に記載の画像圧縮および再構築システムは、タイル型畳み込みニューラルネットワークを使用して深層畳み込みニューラルネットワーク(deep convolutional neural network)の利点をビットレートの適応と組み合わせる。システムは、画像を符号化し、復号するために画像タイルに関する空間コンテキスト予測データと真の画像タイルとの間の残差を使用する。このプロセスは、高品質の出力を引き続き生成しながら、エンコーダからデコーダに送られる必要があるデータを少なくする結果となる。特に、圧縮されたビットがタイル全体ではなく残差を表しさえすればよいので、空間コンテキスト予測ニューラルネットワークの使用のおかげで、所与のタイルが、より少ないビット、またはより小さなサイズに圧縮され得るビットのより複雑でない列を使用して表される可能性がある。 The subject matter described herein can be implemented in particular embodiments to achieve one or more of the following advantages. The image compression and reconstruction system described herein uses tiled convolutional neural networks to combine the advantages of deep convolutional neural networks with bitrate adaptation. The system uses the residuals between the spatial context prediction data for the image tiles and the true image tiles to encode and decode the image. This process results in less data needing to be sent from the encoder to the decoder while still producing high quality output. In particular, a given tile can be compressed to fewer bits, or to a smaller size, thanks to the use of spatial context prediction neural networks, as the compressed bits only need to represent the residual rather than the entire tile. It could be represented using a less complex string of bits.
通常の画像圧縮技術においては、局所的な情報の共有が、近くの2進符号への従属関係を生じ、画像全域のビットレートの調整を難しくする。ニューラルネットワークに基づく既存の画像圧縮アルゴリズムは、各画像全域で一定の空間ビットレート(spatial bit rate)を用いる量子化された表現を学習する。対照的に、説明されるタイル型畳み込みニューラルネットワークのブロックに基づくアーキテクチャを使用することによって、画像圧縮システムは、局所的な再構築の品質に基づくビットレートの適用の実装を大幅に簡単にしながらも、解像度の柔軟性および局所的な情報の共有を実現する。 In conventional image compression techniques, local information sharing creates dependencies on nearby binary codes, making it difficult to adjust the bitrate across the image. Existing image compression algorithms based on neural networks learn a quantized representation that uses a constant spatial bit rate across each image. In contrast, by using the block-based architecture of the described tiled convolutional neural network, the image compression system can significantly simplify the implementation of local reconstruction quality-based bitrate adaptation, while at the same time , to achieve resolution flexibility and local information sharing.
さらに、適応的なビット割り当ては、モデルが畳み込み層のみで構成されている(fully-convolutional)ので既存のニューラルネットワーク圧縮アーキテクチャにおいては難しい。そのようなネットワークが2進符号のすべてが存在するようにして訓練される場合、欠けた符号のある再構築は、不定的に悪くなり得る。 Moreover, adaptive bit allocation is difficult in existing neural network compression architectures because the models are fully-convolutional. If such a network is trained with all of the binary codes present, reconstruction with the missing codes can be variably bad.
システムは、各タイル内で2進符号からの情報を共有することによって不定的に悪い再構築を避ける。この方針は、近隣のタイルの品質を落とすことなくタイルの1つのエリア内でビットレートが下げられることを可能にする。システムは、空間コンテキスト予測ニューラルネットワーク、残差符号化ニューラルネットワーク、および残差復号ニューラルネットワークを使用して画像の詳細を正確に再構築し、物体の境界にまたがるピクセル値を予測する。システムは、比較的離れたピクセルの間の相関を利用し、したがって、タイル間で一貫している視覚的情報を再符号化するコストを避ける。 The system avoids arbitrarily bad reconstructions by sharing information from the binary code within each tile. This policy allows the bitrate to be lowered within one area of a tile without compromising the quality of neighboring tiles. The system accurately reconstructs image details using spatial context prediction neural networks, residual coding neural networks, and residual decoding neural networks to predict pixel values across object boundaries. The system takes advantage of correlations between relatively distant pixels, thus avoiding the cost of re-encoding visual information that is consistent across tiles.
別の利点は、タイル型の適応的な手法が、一定の品質(たとえば、画像全体で同様のPSNR)で画像を符号化することをより容易にすることであり、それが、主観評価を改善する。 Another advantage is that tiled adaptive techniques make it easier to encode images with constant quality (e.g., similar PSNR across images), which improves subjective ratings. do.
本明細書の対象の1つまたは複数の実施形態の詳細が、添付の図面および以下の説明に記載されている。対象のその他の特徴、態様、および利点は、説明、図面、および請求項から明らかになるであろう。 The details of one or more embodiments of the subject matter of this specification are set forth in the accompanying drawings and the description below. Other features, aspects, and advantages of the subject matter will become apparent from the description, drawings, and claims.
様々な図面における同様の参照番号および参照指示は、同様の要素を示す。 Like reference numbers and reference designations in the various drawings indicate like elements.
本明細書は、概して、画像を圧縮し、再構築するための、タイル型畳み込みニューラルネットワークを用いた空間適応的な手法を使用する画像圧縮および再構築システムおよび方法を説明する。 This specification generally describes image compression and reconstruction systems and methods that use spatially adaptive techniques with tiled convolutional neural networks to compress and reconstruct images.
画像圧縮は、デジタル画像を記憶または送信するコストを削減するためにデジタル画像に適用されるある種のデータ圧縮である。この画像圧縮は、可逆であるかまたは非可逆である可能性がある。可逆圧縮は、元のデータが圧縮されたデータから完全に再構築されることを可能にし、一方、非可逆圧縮は、元のデータの近似の再構築を提供する。 Image compression is a type of data compression applied to digital images to reduce the cost of storing or transmitting the digital images. This image compression can be lossless or lossy. Lossless compression allows the original data to be completely reconstructed from the compressed data, while lossy compression provides an approximate reconstruction of the original data.
例示的な画像圧縮および再構築システムは、非可逆画像圧縮のための、タイル型畳み込みニューラルネットワークを用いた、ブロックに基づく空間適応的な手法を使用する。 An exemplary image compression and reconstruction system uses a block-based spatially adaptive approach with tiled convolutional neural networks for lossy image compression.
図1は、例示的な画像圧縮および再構築システム100を示す。画像圧縮および再構築システム100は、以下で説明されるシステム、構成要素、および技術が実装され得る、1つまたは複数の場所の1つまたは複数のコンピュータ上のコンピュータプログラムとして実装されたシステムの例である。システム100は、タイル型ニューラルネットワークを使用して、品質に影響を受けるビットレートの空間適応を用いて入力画像104を圧縮し、入力画像の画像再構築を決定する。この空間適応は、より複雑なまたは視覚的に目立つ入力画像の領域を優先的に記述することによってシステムが追加のビットをより効果的に使用することを可能にする。図1はシステムの符号化構成要素と復号構成要素との両方を同じシステムの一部として示すが、一部の実装において、構成要素は、別々のシステムであり、別々のコンピューティングデバイスに置かれることが可能である。たとえば、1つの例示的な実装において、符号化構成要素、つまり、入力画像を圧縮するために必要なそれらの構成要素は、サーバに置かれることが可能であり、復号構成要素、つまり、入力画像を再構築するために必要なそれらの構成要素は、クライアントデバイスに置かれることが可能である。
FIG. 1 shows an exemplary image compression and
動作中、画像圧縮および再構築システム100は、圧縮されることになる入力画像104を取り込み、分割エグゼキュータ106が、画像をタイルに分割する。たとえば、入力画像104は、それぞれが32×32ピクセルから形成されるタイルに分割されるか、または任意のその他の好適な数のピクセルのタイルに分割される可能性がある。
In operation, image compression and
それから、システム100は、画像104を1タイルずつ符号化する。
各タイルに関して、空間コンテキストプレディクタ108が、「コンテキストパッチ」を生成するために、隣接するタイルを空間コンテキストとして使用する。
For each tile,
図2a～図2dは、目標タイル202の値がまだ処理されていない例示的な64×64のコンテキストパッチ200a～dを示す。特定のタイル202aが入力画像の左または上の境界上にない場合、図2aに示されるように、空間コンテキストは、入力画像内の特定のタイルの左および上の隣接するタイル204a、206a、208を使用して生成される。特定のタイル202bが入力画像の左の境界上にあり、入力画像の左上の角にない場合、図2bに示されるように、空間コンテキストは、特定のタイル202bの上の隣接するタイル204aを使用して生成される。図2cは、特定のタイル202cが入力画像の左上の角にある場合に、特定のタイル202cに関する空間コンテキストがプレースホルダコンテキストデータを用いて生成されることを示す。図2dは、特定のタイル202dが入力画像の上の境界上にあり、入力画像の左上の角にない場合に、空間コンテキストが特定のタイル205dの左の隣接する画像およびプレースホルダコンテキストデータを使用して生成されることを示す。
Figures 2a-2d show exemplary
再び図1を参照すると、空間コンテキストプレディクタ108は、入力タイルの予測である出力タイルを生成するために入力タイルに関するコンテキストを処理するために訓練されるニューラルネットワークである。たとえば、空間コンテキストプレディクタ108は、入力タイルに関する画像コンテキストパッチ、たとえば、図2a～図2dに示される64×64ピクセルのコンテキストパッチを受け取り、入力タイルの予測を生成することができる。空間コンテキストプレディクタは、図3に関連して下でより詳細に検討される。
Referring again to FIG. 1,
それから、システム100は、再構築画像の詳細を埋めるために残差ネットワーク(residual network) 130を使用する。残差ネットワーク130は、再帰型オートエンコーダ(recurrent auto-encoder)に基づくディープネットワークである。残差ネットワーク130は、エンコーダ110およびデコーダ114を含む。エンコーダ110およびデコーダ114のニューラルネットワークのための例示的な再帰型アーキテクチャが、G. Toderici、D. Vincent、N. Johnston、S.J. Hwang、D. Minnen、J. Shor、およびM. Covell、「Full resolution image compression with recurrent neural networks」、CoRR、vol. abs/1608.05148、2016年に記載されており、この文献の内容全体は、特にエンコーダおよびデコーダのニューラルネットワークのための再帰型アーキテクチャに関連して、参照により本明細書に組み込まれる。
各タイルに関して、エンコーダ110は、真の画像タイルと最初の予測との間の残差を符号化する。一部の実装において、エンコーダは、符号化を反復して実行する。各反復で、エンコーダ110は、反復のためのエンコーダ入力を受け取り、タイルの符号化されたバージョンを表す入力画像の各タイルに関する2進符号の組を生成するためにエンコーダ入力を符号化する。最初の繰り返しで、エンコーダ入力は、真の画像タイルと最初の予測との間の残差である。エンコーダ110は、残差を符号化して2進符号を生成し、前の反復から残っている残差を捕捉するためにデコーダ114を使用して2進数から入力を再構築する。復号されたピクセル値は、記憶され(122)、後続のタイルを予測するためのコンテキストとして使用される。最初の反復の後、各反復で、エンコーダ入力は、前の反復からの残差タイルである。タイルを再構築し、前の反復から残っている残差を捕捉することによって、システムは、元の入力のより近い近似を次々と提供する。
For each tile,
残差ネットワーク130は、画像入力104のすべてのタイルが処理されるまで符号化プロセスを反復的に続ける。そして、画像圧縮および再構築システム100は、画像に関する圧縮された2進数140を提供する。
一部の実装においては、タイルが符号化されると、残差ネットワークは、符号化された残差142、つまり、2進符号または圧縮された2進符号を、復号するためにデコーダ128に送る可能性がある。画像の復号は、ラスタ順に1タイルずつ進行する。画像圧縮および再構築システム100は、予測されたタイルを得るためにタイルに関するコンテキストに対してデコーダのための空間コンテキストプレディクタ124を実行する。コンテキストは、既に再構築されたタイル150を使用して取得され得る。デコーダ128は、実際の復号されたタイルと空間コンテキストプレディクタ124からの予測されたタイルとの間の残差を得るために2進符号を反復的に復号する。そして、コンバイナ132が、復号された残差と予測されたタイルとを合成してタイルの完全な再構築150を得る。空間コンテキストプレディクタ124は、ビットレートを上げることなくタイルの境界をまたがって情報を共有することによってタイル間の境界アーチファクトの起こり得る発生を防ぐことによって有利であり得る。本質的に、コンテキスト予測ニューラルネットワークは、ピクセルのコンテキストとうまく合わさるピクセルを生成することができ、タイルの予測されたピクセルはコンテキストピクセルの近くでより詳細で正確であるので、ネットワークは、境界アーチファクトを最小化するように働くことができる。デコーダ128は、ニューラルネットワークである。デコーダのニューラルネットワークのための例示的な再帰型アーキテクチャが、G. Toderici、D. Vincent、N. Johnston、S.J. Hwang、D. Minnen、J. Shor、およびM. Covell、「Full resolution image compression with recurrent neural networks」、CoRR、vol. abs/1608.05148、2016年に記載されており、この文献の内容全体は、特にデコーダのニューラルネットワークのための再帰型アーキテクチャに関連して、参照により本明細書に組み込まれる。
In some implementations, once the tiles are encoded, the residual network sends the encoded residuals 142, binary code or compressed binary code, to decoder 128 for decoding. there is a possibility. Image decoding proceeds tile by tile in raster order. The image compression and
画像圧縮および再構築システム100は、空間コンテキストプレディクタ108のための訓練エンジン116、および残差符号化ネットワーク130のための訓練エンジン118も含む。空間コンテキストプレディクタ108と残差符号化ネットワーク130との両方が、順番に訓練される。空間コンテキストプレディクタ108は、入力タイルの予測である出力タイルを生成するために入力タイルに関するコンテキストを処理するために訓練される。残差エンコーダのネットワークは、空間コンテキストプレディクタを実行した後、各タイル内の残差を圧縮するように訓練される。エンコーダのネットワークは、空間コンテキストの予測後に残る特定のピクセルの誤差を符号化することを学習する。各訓練プロセスは、32枚の画像のミニバッチサイズと、ステップサイズ20,000を用い、指数関数的減衰スケジュール(exponential decay schedule) (B = 0.95)に従う初期学習率0.5とを使用する可能性がある。一部の実装において、2つのネットワークは、一緒に訓練される可能性がある。その他の実装において、2つのネットワークは、別々に訓練される可能性がある。
Image compression and
訓練データは、コンテキスト画像パッチ、たとえば、図2a～図2dに示される64×64の画像パッチである可能性がある。これらの画像パッチは、画像の集合から刈り取られる可能性がある。訓練手順は、G. Toderici、D. Vincent、N. Johnston、S.J. Hwang、D. Minnen、J. Shor、およびM. Covell、「Full resolution image compression with recurrent neural networks」、CoRR、vol. abs/1608.05148、2016年に記載された訓練手順と同様である可能性があり、この文献の内容全体は、特に訓練手順に関連して、参照により本明細書に組み込まれる。 The training data can be context image patches, eg, the 64×64 image patches shown in FIGS. 2a-2d. These image patches may be pruned from the set of images. The training procedure was adapted from G. Toderici, D. Vincent, N. Johnston, S.J. Hwang, D. Minnen, J. Shor, and M. Covell, "Full resolution image compression with recurrent neural networks", CoRR, vol. abs/1608.05148. , 2016, and the entire content of this document is hereby incorporated by reference, particularly with regard to the training procedure.
図1は符号化構成要素および復号構成要素ならびに空間コンテキストプレディクタを同じシステムの一部として示すが、一部の実装において、構成要素は、別々のシステムであり、別々のコンピューティングデバイスに置かれることが可能である。たとえば、実施形態において、エンコーダ110は、サーバに置かれることが可能であり、デコーダ114は、クライアントデバイスに置かれることが可能である。空間コンテキストプレディクタ108は、第3のコンピューティングデバイス上にある可能性がある。
Although FIG. 1 shows the encoding and decoding components and the spatial context predictor as part of the same system, in some implementations the components are separate systems and reside on separate computing devices. is possible. For example, in an
図3は、空間コンテキストプレディクタのネットワークの例示的なアーキテクチャ300を示す。空間コンテキストプレディクタのネットワークは、コンテキストタイルから特徴を抽出するためにストライド付きの畳み込み(strided convolution)を使用し、目標タイルに関するRGBの予測を生成するためにフラクショナル畳み込み(fractional convolution)を使用する。 FIG. 3 shows an exemplary architecture 300 of a network of spatial context predictors. A network of spatial context predictors uses strided convolution to extract features from the context tile and fractional convolution to generate the RGB prediction for the target tile.
空間コンテキストプレディクタは、(3チャネル)コンテキストパッチ302を入力として取り込む。プレディクタは、4つの畳み込み層310、311、312、313を使用して入力を処理する。これらの層の各々は、削減された解像度およびより大きな深さ(depth)の特徴マップを学習する。そして、プレディクタは、Deepak Pathak、Philipp Krahenbuhl、Jeff Donahue、Trevor Darrell、およびAlexei Efrosによって「Context encoders: Feature learning by Inpainting」、CVPR、2016年において説明されたように、チャネル毎の全結合層(channel-wise, fully-connected layer)を実装するために深さ毎の畳み込み層(depth-wise convolutional layer) 320とそれに続く点毎の畳み込み層(pointwise convolutional layer) 321とを使用し、上記文献の内容全体は、特にチャネル毎の全結合層に関連して、参照により本明細書に組み込まれる。この層は、全結合層の2次のコスト全部を負うことなくタイル全体に情報が伝播することを可能にする。
The spatial context predictor takes the (3-channel)
ネットワークの最後の段階において、プレディクタは、最後の層が前の32×32×64の特徴マップから3チャネルの画像を生成して目標の予測340を生成するまで、フラクショナル畳み込み層330、331、332を使用して空間解像度を漸増させる。
In the final stage of the network, the predictor uses fractional
それから、システムは、実際のタイルと、空間コンテキスト予測ニューラルネットワークによって生成された目標の予測340との間の残差画像を決定する。残差ネットワークが、各タイル内の残差を圧縮するために残差画像タイルを処理する。
The system then determines the residual image between the actual tile and the
図4は、残差画像を圧縮し、再構築する例示的な残差ネットワーク400を示す。残差ネットワーク400は、各層が定義された高さ、幅、および深さを有する再帰型オートエンコーダのアーキテクチャを使用する。空間コンテキストプレディクタは、それぞれの新しいタイルに関する正確な低周波数(low frequency)データを生成することができる。空間コンテキストプレディクタが多くの画像の詳細を復元することができない場合、再構築の品質が、再帰型オートエンコーダのアーキテクチャによる残差画像の圧縮および再構築によって改善され得る。各反復で、残差エンコーダは、入力から特徴を抽出し、それらの特徴を量子化して128ビットを生成する。図4は、4回の反復を示す。
FIG. 4 shows an exemplary
各時間ステップにおいて、残差エンコーダのネットワークは、時間ステップのためのエンコーダ入力を受け取り、時間ステップに関する2進符号の組を生成するためにエンコーダ110を使用して入力を処理する。第1の時間ステップに関して、エンコーダ入力は、空間コンテキスト予測ニューラルネットワークの目標の予測と入力画像の実際のタイルとの間の残差画像である。
At each time step, the network of residual encoders receives the encoder input for the time step and processes the
システムは、データ圧縮アルゴリズム、たとえば、訓練されたエントロピーコーダを使用して符号化された表現の2進符号を圧縮することによって入力画像を圧縮する。システムは、入力画像の解凍のために、圧縮された入力画像を画像デコーダに送る可能性がある。 The system compresses the input image by compressing the binary code of the encoded representation using a data compression algorithm, eg, a trained entropy coder. The system may send the compressed input image to an image decoder for decompression of the input image.
デコーダ114は、これらの2進符号から入力を再構築することを学習する。
再構築は、タイルに関する2進符号のそれぞれの組を生成するために、圧縮された2進符号を解凍することを含む可能性がある。各反復は、前の反復から残っている残差(Pi)を捕捉しようと試み、したがって、反復の出力の総和が元の出力の継続的に向上する近似を提供する。 Reconstruction may include decompressing the compressed binary codes to generate respective sets of binary codes for the tiles. Each iteration attempts to capture the residuals (Pi) remaining from the previous iteration, so that the sum of the iteration outputs provides a continuously improving approximation of the original output.
第1の時間ステップの後の時間ステップのためのエンコーダ入力は、(i)残差と、(ii)前の時間ステップにおいて2進符号の組からデコーダのニューラルネットワークによって生成された再構築との間の暫定残差画像である。 The encoder input for the time step after the first time step is the combination of (i) the residual and (ii) the reconstruction generated by the decoder's neural network from the binary code set at the previous time step. is a provisional residual image between
ネットワークのエンコーダ部分は、入力残差画像から特徴を抽出するために1つの畳み込み層を使用し、その後に、空間解像度を減らし、特徴マップを生成する3つの畳み込みLSTM層を使用する。重みは、すべての反復で共有され、再帰型の結合が、情報が1つの反復から次の反復に伝播することを可能にする。 The encoder part of the network uses one convolutional layer to extract features from the input residual image, followed by three convolutional LSTM layers to reduce the spatial resolution and generate the feature map. Weights are shared by all iterations, and recursive combining allows information to propagate from one iteration to the next.
バイナリボトルネック層(binary bottleneck layer)402は、1×1畳み込みと、その後のtanh活性化関数とを使用して、入ってくる特徴を(-1, 1)にマッピングする。システムは、パラメータ空間の探索を促進するためにtanhの出力からサンプリングする(P(b=1) = 0.5-(1 + tanh(x)))。例示的なサンプリングのさらなる詳細は、Raiko、M. Berglund、G. Alain、およびL. Dinhによって「Techniques for learning binary stochastic feedforward neural networks」、ICLR、2015年において説明されており、サンプリングに関するこの文献の内容は、参照により本明細書に組み込まれる。システムが訓練されたネットワークを本物の画像に適用するとき、システムは、確定的に(deterministically) 2値化する(x = 0のときはb = 1であるものとして、b = sign (tanh(x)))。 A binary bottleneck layer 402 uses a 1×1 convolution followed by a tanh activation function to map incoming features to (−1, 1). The system samples from the output of tanh (P(b=1) = 0.5-(1 + tanh(x))) to facilitate searching the parameter space. Further details of exemplary sampling are described by Raiko, M. Berglund, G. Alain, and L. Dinh in "Techniques for learning binary stochastic feedforward neural networks", ICLR, 2015, and this paper on sampling. The contents are incorporated herein by reference. When the system applies the trained network to real images, the system deterministically binarizes (b = sign (tanh(x ))).
図4に示されていないが、デコーダ114は、エンコーダ110と同じ構造を有する。しかし、デコーダ114は、各特徴マップの解像度を上げるためにフラクショナル畳み込みを使用する。最後の層は、32×32×64の形状の特徴マップであるデコーダの出力を取得し、tanh活性化を使用して特徴を[-1, 1]の範囲内の3つの値にマッピングする。そして、出力は、8ビットのRGB値へとスケーリングされ、切り捨てられ、量子化される(R = round (min (max (R1 * 142 + 128,0), 255)))。システムは128ではなく142によりスケーリングして、非常に低速な学習につながり得るとても小さな勾配のtanhの範囲に入ることなくネットワークが極端なピクセル値をより容易に予測することを可能にする。
Although not shown in FIG. 4,
システムは、特定のタイルが現在の時間ステップまたは任意の以前の時間ステップにおいて既に生成された2進符号から再構築されるときに特定のタイルに関する品質の閾値が満たされたかどうかを判定することによって、各時間ステップにおいて特定のタイルに関する2進符号の組を生成する。品質の閾値は、たとえば、再構築された画像に関する目標品質を表す所定の閾値であることが可能である。品質の閾値が満たされた場合、システムは、既に生成された2進符号を、入力画像の符号化された表現における特定のタイルに関する2進符号の組として使用する。この適応的な手法は、残差エンコーダがいずれかのステップの後に停止され得る再帰型ネットワークであることによって容易にされる。各ステップがさらなるビットを生成するので、このメカニズムは、異なるタイルの間の適応的なビット割り当てを可能にし、したがって、単一のニューラルネットワークが異なるビットレートの符号化を生成することを可能にし得る。 The system determines whether a quality threshold for a particular tile was met when the particular tile was reconstructed from the binary code already generated at the current time step or any previous time step. , to generate a set of binary codes for a particular tile at each time step. The quality threshold can be, for example, a predetermined threshold representing a target quality for the reconstructed image. If the quality threshold is met, the system uses the already generated binary code as the set of binary codes for the particular tile in the encoded representation of the input image. This adaptive approach is facilitated by the residual encoder being a recursive network that can be stopped after any step. Since each step generates additional bits, this mechanism may allow adaptive bit allocation between different tiles, thus allowing a single neural network to generate different bitrate encodings. .
図5は、タイル型畳み込みニューラルネットワークを用いた空間適応的な手法を使用して画像を圧縮し、再構築するための例示的なプロセス500の流れ図である。便宜上、プロセス500は、1つまたは複数の場所に置かれ、本明細書に従って適切にプログラミングされた1つまたは複数のコンピュータのシステムによって実行されるものとして説明される。たとえば、適切にプログラミングされた画像圧縮および再構築システム、たとえば、図1の画像圧縮および再構築システム100が、プロセス500を実行することができる。
FIG. 5 is a flow diagram of an
図5aおよび図5bに示されるように、画像圧縮および再構築システムは、タイルに区分けされた入力画像の符号化された表現を生成する要求を受け取る(502)。次いでシステムは、入力画像の各タイルに関する2進符号のそれぞれの組を含む入力画像の符号化された表現を生成する(504)。システムは、空間コンテキスト予測ニューラルネットワークを使用して特定のタイルに関するコンテキストを最初に処理することによって符号化された表現を生成する(506)。上述のように、空間コンテキスト予測ニューラルネットワークは、入力タイルの予測である出力タイルを生成するために入力タイルに関するコンテキストを処理するために訓練される。それから、システムは、特定の入力タイルと、空間コンテキスト予測ニューラルネットワークによって生成された出力タイルとの間の残差画像を決定する(507)。システムは、エンコーダのニューラルネットワークを使用して残差画像を符号化することによって特定のタイルに関する2進符号の組を生成する(508)。この符号化プロセスは、図4に関連して上で説明されている。 As shown in FIGS. 5a and 5b, an image compression and reconstruction system receives a request to generate an encoded representation of a tiled input image (502). The system then generates (504) an encoded representation of the input image that includes a respective set of binary codes for each tile of the input image. The system generates an encoded representation by first processing the context for a particular tile using a spatial context prediction neural network (506). As described above, a spatial context prediction neural network is trained to process the context regarding an input tile to produce an output tile that is a prediction of the input tile. The system then determines (507) the residual image between the particular input tile and the output tile produced by the spatial context prediction neural network. The system generates a set of binary codes for a particular tile by encoding the residual image using a neural network of encoders (508). This encoding process is described above in connection with FIG.
図6は、空間適応的な手法を使用して圧縮された画像を復号するための例示的なプロセス600の流れ図である。便宜上、プロセス600は、1つまたは複数の場所に置かれ、本明細書に従って適切にプログラミングされた1つまたは複数のコンピュータのシステムによって実行されるものとして説明される。たとえば、適切にプログラミングされた画像圧縮および再構築システム、たとえば、図1の画像圧縮および再構築システム100が、プロセス600を実行することができる。
FIG. 6 is a flow diagram of an
図6に示されるように、画像圧縮および再構築システムは、既に復号された(または再構築された)特定のタイルに関するコンテキストタイル決定する(602)。そして、システムは、目標タイルの最初の再構築を生成するために空間コンテキスト予測ネットワークを使用してコンテキストタイルを処理する(604)。システムは、デコーダのニューラルネットワークを使用して特定のタイルに関する2進符号を処理することによって残差再構築画像を生成する(606)。それから、システムは、最後の再構築タイルを得るために残差再構築画像を最初の再構築と合成する(608)。 As shown in FIG. 6, the image compression and reconstruction system determines 602 a context tile for a particular tile that has already been decoded (or reconstructed). The system then processes the context tile using a spatial context prediction network to generate an initial reconstruction of the target tile (604). The system generates a residual reconstructed image by processing the binary code for a particular tile using a neural network of decoders (606). The system then combines the residual reconstructed image with the initial reconstruction to obtain the final reconstructed tile (608).
本明細書に記載の対象の実施形態および機能的動作は、本明細書で開示された構造およびそれらの構造的均等物を含むデジタル電子回路、有形で具現化されたコンピュータソフトウェアもしくはファームウェア、コンピュータハードウェア、またはそれらのうちの1つもしくは複数の組合せで実装されることが可能である。本明細書に記載の対象の実施形態は、1つまたは複数のコンピュータプログラム、すなわち、データ処理装置による実行のために、またはデータ処理装置の動作を制御するために有形の非一時的ストレージ媒体上に符号化されたコンピュータプログラム命令の1つまたは複数のモジュールとして実装されることが可能である。コンピュータ記憶媒体は、機械可読記憶装置、機械可読ストレージ基板、ランダムもしくはシリアルアクセスメモリデバイス、またはそれらのうちの1つもしくは複数の組合せであることが可能である。代替的にまたは追加的に、プログラム命令は、データ処理装置による実行のために好適なレシーバ装置に送信するために情報を符号化するように生成される人為的に生成された伝播信号、たとえば、機械によって生成された電気的信号、光学的信号、または電磁的信号上に符号化されることが可能である。 Embodiments and functional operations of the subject matter described herein may be implemented in digital electronic circuits, tangible embodied computer software or firmware, computer hardware, including the structures disclosed herein and their structural equivalents. hardware, or a combination of one or more thereof. Embodiments of the subject matter described herein may be stored in one or more computer programs, i.e., stored on tangible, non-transitory storage media for execution by or for controlling operation of a data processing apparatus. can be implemented as one or more modules of computer program instructions encoded in A computer storage medium can be a machine-readable storage device, a machine-readable storage substrate, a random or serial access memory device, or a combination of one or more thereof. Alternatively or additionally, the program instructions may be transferred to an artificially generated propagated signal generated to encode information for transmission to a suitable receiver device for execution by a data processing device, e.g. It can be encoded on a machine-generated electrical, optical, or electromagnetic signal.
用語「データ処理装置」は、データ処理ハードウェアを指し、例として、1つのプログラミング可能なプロセッサ、1台のコンピュータ、または複数のプロセッサもしくはコンピュータを含む、データを処理するためのすべての種類の装置、デバイス、およびマシンを包含する。装置は、専用の論理回路、たとえば、FPGA (フィールドプログラマブルゲートアレイ)またはASIC (特定用途向け集積回路)であることも可能であり、またはそのような専用論理回路をさらに含むことも可能である。任意で、装置は、ハードウェアに加えて、コンピュータプログラムのための実行環境を作成するコード、たとえば、プロセッサのファームウェア、プロトコルスタック、データベース管理システム、オペレーティングシステム、またはそれらのうちの1つもしくは複数の組合せを構成するコードを含むことが可能である。 The term "data processing device" refers to data processing hardware, and includes, by way of example, a programmable processor, a computer, or multiple processors or computers, all kinds of devices for processing data , devices, and machines. The device may be a dedicated logic circuit, such as an FPGA (Field Programmable Gate Array) or an ASIC (Application Specific Integrated Circuit), or may further include such dedicated logic circuitry. Optionally, the apparatus includes, in addition to hardware, code that creates an execution environment for computer programs, such as processor firmware, protocol stacks, database management systems, operating systems, or one or more of the same. It is possible to include code that constitutes a combination.
プログラム、ソフトウェア、ソフトウェアアプリケーション、アプリ、モジュール、ソフトウェアモジュール、スクリプト、またはコードと呼ばれるまたは記載される場合もあるコンピュータプログラムは、コンパイラ型言語もしくはインタープリタ型言語、または宣言型言語もしくは手続き型言語を含む任意の形態のプログラミング言語で記述されることが可能であり、独立型プログラムとしての形態、またはモジュール、コンポーネント、サブルーチン、もしくはコンピューティング環境内での使用に適したその他のユニットとしての形態を含む任意の形態で配置されることが可能である。プログラムは、ファイルシステム内のファイルに対応する可能性があるが、必ずそうであるとは限らない。プログラムは、その他のプログラムもしくはデータを保持するファイルの一部、たとえば、マークアップ言語のドキュメントに記憶された1つもしくは複数のスクリプト、問題にしているプログラムに専用の単一のファイル、または複数の組織されたファイル、たとえば、1つもしくは複数のモジュール、サブプログラム、もしくはコードの一部を記憶するファイルに記憶され得る。コンピュータプログラムは、1台のコンピュータ上で、または1つの場所に置かれるか、もしくは複数の場所に分散され、データ通信ネットワークによって相互に接続される複数のコンピュータ上で実行されるように配置されることが可能である。 A computer program, sometimes called or written as a program, software, software application, app, module, software module, script, or code, may be written in any language, including compiled or interpreted language, or declarative or procedural language. and can be written in any programming language, including as a stand-alone program or as modules, components, subroutines, or other units suitable for use within a computing environment. It can be arranged in a form. A program may correspond to a file in a file system, but this is not always the case. A program may be part of a file holding other programs or data, e.g., one or more scripts stored in a markup language document, a single file dedicated to the program in question, or multiple It may be stored in an organized file, eg, a file that stores one or more modules, subprograms, or portions of code. A computer program is arranged to be executed on one computer or on multiple computers located at one site or distributed across multiple sites and interconnected by a data communication network. Is possible.
本明細書に記載のプロセスおよび論理フローは、入力データに対して演算を行い、出力を生成することによって機能を実行するための1つまたは複数のコンピュータプログラムを1つまたは複数のプログラミング可能なコンピュータが実行することによって実行されることが可能である。また、プロセスおよび論理フローは、専用の論理回路、たとえば、FPGAもしくはASICによって、または専用の論理回路と1つもしくは複数のプログラミングされたコンピュータとの組合せによって実行されることが可能である。 The processes and logic flows described herein implement one or more computer programs on one or more programmable computers to perform functions by operating on input data and generating output. can be executed by executing Also, the processes and logic flows can be performed by dedicated logic circuits, such as FPGAs or ASICs, or by a combination of dedicated logic circuits and one or more programmed computers.
コンピュータプログラムの実行に好適なコンピュータは、汎用マイクロプロセッサもしくは専用マイクロプロセッサもしくはそれら両方、または任意のその他の種類の中央演算処理装置に基づくことが可能である。概して、中央演算処理装置は、読み出し専用メモリ、またはランダムアクセスメモリ、またはそれら両方から命令およびデータを受け取る。コンピュータの必須の要素は、命令を遂行または実行するための中央演算処理装置、ならびに命令およびデータを記憶するための1つまたは複数のメモリデバイスである。中央演算処理装置およびメモリは、専用の論理回路によって補完されるか、または専用の論理回路に組み込まれることが可能である。また、概してコンピュータは、データを記憶するための1つもしくは複数の大容量記憶装置、たとえば、磁気ディスク、光磁気ディスク、もしくは光ディスクを含むか、またはそれらの大容量記憶装置からデータを受信するか、もしくはそれらの大容量記憶装置にデータを転送するか、もしくはその両方を行うために動作可能なように結合される。しかし、コンピュータは、そのようなデバイスを有していなくてもよい。さらに、コンピュータは、別のデバイス、たとえば、ほんのいくつか例を挙げるとすれば、モバイル電話、携帯情報端末(PDA)、モバイルオーディオもしくはビデオプレイヤー、ゲームコンソール、全地球測位システム(GPS)レシーバ、またはポータブル記憶装置、たとえば、ユニバーサルシリアルバス(USB)フラッシュドライブに組み込まれることが可能である。 Computers suitable for the execution of a computer program may be based on general or special purpose microprocessors, or both, or any other kind of central processing unit. Generally, a central processing unit receives instructions and data from read-only memory, random-access memory, or both. The essential elements of a computer are a central processing unit for performing or executing instructions, and one or more memory devices for storing instructions and data. The central processing unit and memory may be supplemented by or incorporated into dedicated logic circuitry. Computers also generally include, or receive data from, one or more mass storage devices, such as magnetic, magneto-optical, or optical disks, for storing data. , or operatively coupled to transfer data to those mass storage devices, or both. However, a computer need not have such devices. In addition, the computer may be connected to another device such as a mobile phone, a personal digital assistant (PDA), a mobile audio or video player, a game console, a global positioning system (GPS) receiver, or It can be incorporated into a portable storage device, such as a Universal Serial Bus (USB) flash drive.
コンピュータプログラム命令およびデータを記憶するのに適したコンピュータ可読媒体は、例として、半導体メモリデバイス、たとえば、EPROM、EEPROM、およびフラッシュメモリデバイス、磁気ディスク、たとえば、内蔵ハードディスクまたはリムーバブルディスク、光磁気ディスク、ならびにCD-ROMディスクおよびDVD-ROMディスクを含む、すべての形態の不揮発性メモリ、媒体、およびメモリデバイスを含む。 Computer readable media suitable for storing computer program instructions and data include, by way of example, semiconductor memory devices such as EPROM, EEPROM and flash memory devices, magnetic disks such as internal or removable disks, magneto-optical disks, and all forms of non-volatile memory, media, and memory devices, including CD-ROM and DVD-ROM discs.
ユーザとのインタラクションを提供するために、本明細書に記載の対象の実施形態は、ユーザに対して情報を表示するためのディスプレイデバイス、たとえば、CRT (ブラウン管)またはLCD (液晶ディスプレイ)モニタ、ならびにユーザがコンピュータに入力を与えることができるキーボードおよびポインティングデバイス、たとえば、マウスまたはトラックボールを有するコンピュータ上に実装されることが可能である。その他の種類のデバイスが、ユーザとのインタラクションを提供するためにやはり使用されることが可能であり、たとえば、ユーザに提供されるフィードバックは、任意の形態の感覚フィードバック、たとえば、視覚フィードバック、聴覚フィードバック、または触覚フィードバックであることが可能であり、ユーザからの入力は、音響、発話、または触覚による入力を含む任意の形態で受け取られることが可能である。加えて、コンピュータは、ユーザによって使用されるデバイスにドキュメントを送信し、そのデバイスからドキュメントを受信することによって、たとえば、ウェブブラウザから受信された要求に応答してユーザのデバイスのウェブブラウザにウェブページを送信することによってユーザとインタラクションすることができる。また、コンピュータは、メッセージングアプリケーションを実行しているパーソナルデバイス、たとえば、スマートフォンにテキストメッセージまたはその他の形態のメッセージを送信し、返報としてユーザから応答メッセージを受信することによってユーザとインタラクションすることができる。 To provide interaction with a user, the subject embodiments described herein include a display device, such as a CRT (cathode ray tube) or LCD (liquid crystal display) monitor, for displaying information to the user, as well as It can be implemented on a computer having a keyboard and pointing device, such as a mouse or trackball, that allows a user to provide input to the computer. Other types of devices can also be used to provide interaction with the user, e.g., the feedback provided to the user can be any form of sensory feedback, e.g., visual feedback, auditory feedback, etc. , or haptic feedback, and input from the user can be received in any form, including acoustic, speech, or tactile input. In addition, the computer can send documents to and receive documents from a device used by a user to, for example, render a web page to the web browser of the user's device in response to a request received from the web browser. You can interact with the user by sending a A computer can also interact with a user by sending a text message or other form of message to a personal device running a messaging application, such as a smart phone, and receiving a reply message from the user in return.
本明細書に記載の対象の実施形態は、バックエンド構成要素を、たとえば、データサーバとして含むか、またはミドルウェア構成要素、たとえば、アプリケーションサーバを含むか、またはフロントエンド構成要素、たとえば、ユーザが本明細書に記載の対象の実装とインタラクションすることができるグラフィカルユーザインターフェース、ウェブブラウザ、もしくはアプリを有するクライアントコンピュータを含むか、または1つもしくは複数のそのようなバックエンド構成要素、ミドルウェア構成要素、もしくはフロントエンド構成要素の任意の組合せを含むコンピューティングシステムに実装されることが可能である。システムの構成要素は、任意の形態または媒体のデジタルデータ通信、たとえば、通信ネットワークによって相互に接続されることが可能である。通信ネットワークの例は、ローカルエリアネットワーク(LAN)および広域ネットワーク(WAN)、たとえば、インターネットを含む。 Embodiments of the subject matter described herein may include back-end components, e.g., data servers, or middleware components, e.g., application servers, or front-end components, e.g. includes a client computer having a graphical user interface, web browser, or app capable of interacting with the implementation of the subject matter described herein, or one or more such backend components, middleware components, or It can be implemented in a computing system including any combination of front-end components. The components of the system can be interconnected by any form or medium of digital data communication, eg, a communication network. Examples of communication networks include local area networks (LAN) and wide area networks (WAN), such as the Internet.
コンピューティングシステムは、クライアントおよびサーバを含み得る。クライアントおよびサーバは、概して互いに離れており、通常は通信ネットワークを通じてインタラクションする。クライアントとサーバとの関係は、それぞれのコンピュータ上で実行されており、互いにクライアント-サーバの関係にあるコンピュータプログラムによって生じる。一部の実施形態において、サーバは、たとえば、クライアントとして働くデバイスとインタラクションするユーザに対してデータを表示し、そのようなユーザからユーザ入力を受け取る目的でユーザデバイスにデータ、たとえば、HTMLページを送信する。ユーザデバイスにおいて生成されたデータ、たとえば、ユーザの結果 The computing system can include clients and servers. A client and server are generally remote from each other and typically interact through a communication network. The relationship of client and server arises by virtue of computer programs running on the respective computers and having a client-server relationship to each other. In some embodiments, the server sends data, e.g., HTML pages, to user devices for the purpose of displaying data to users interacting with the device, e.g., acting as a client, and receiving user input from such users. do. Data generated at the user device, e.g. user results
添付の請求項の実施形態および上述の実施形態に加えて、下の付番された実施形態も、革新的である。 In addition to the embodiments of the appended claims and the embodiments described above, the numbered embodiments below are also innovative.
本明細書は多くの特定の実装の詳細を含むが、これらは、いかなる発明の範囲または特許請求される可能性があるものの範囲に対する限定ともみなされるべきでなく、むしろ、特定の発明の特定の実施形態に特有である場合がある特徴の説明とみなされるべきである。別々の実施形態の文脈で本明細書において説明されている特定の特徴が、単一の実施形態において組み合わせて実装されることも可能である。反対に、単一の実施形態の文脈で説明されている様々な特徴が、複数の実施形態に別々にまたは任意の好適な部分的組合せで実装されることも可能である。さらに、特徴は、特定の組合せで動作するものとして上で説明されている可能性があり、最初にそのように主張されてさえいる可能性があるが、主張された組合せの1つまたは複数の特徴は、場合によっては組合せから削除されることが可能であり、主張された組合せは、部分的組合せ、または部分的組合せの変形を対象とする可能性がある。 While this specification contains many specific implementation details, these should not be construed as limitations on the scope of any invention or of what may be claimed, but rather the specific It should be considered a description of features that may be specific to an embodiment. Certain features that are described in this specification in the context of separate embodiments can also be implemented in combination in a single embodiment. Conversely, various features that are described in the context of a single embodiment can also be implemented in multiple embodiments separately or in any suitable subcombination. Moreover, although features may have been described above as operating in particular combinations, or even claimed to be so in the first place, one or more of the claimed combinations Features may optionally be omitted from a combination, and a claimed combination may cover subcombinations or variations of subcombinations.
同様に、動作が図中に特定の順序で示されているが、これは、そのような動作が示された特定の順序でもしくは逐次的順序で実行されること、または所望の結果を達成するために示されたすべての動作が実行されることを必要とするものと理解されるべきでない。特定の状況においては、マルチタスクおよび並列処理が有利である可能性がある。さらに、上述の実施形態における様々なシステムモジュールおよびコンポーネントの分割は、すべての実施形態においてそのような分割を必要とするものと理解されるべきでなく、説明されたプログラムコンポーネントおよびシステムは、概して、単一のソフトウェア製品に一緒に統合されるか、または複数のソフトウェア製品にパッケージングされることが可能であることが理解されるべきである。 Similarly, although acts are shown in the figures in a particular order, it does not mean that such acts are performed in the specific order shown or in a sequential order to achieve the desired result. It should not be understood as requiring that all actions shown for are performed. Multitasking and parallel processing can be advantageous in certain situations. Furthermore, the division of various system modules and components in the above-described embodiments should not be understood to require such division in all embodiments, and the described program components and systems are generally: It should be understood that they can be integrated together in a single software product or packaged in multiple software products.
実施形態1は、複数のタイルに区分けされた入力画像の符号化された表現を生成する要求を、1つまたは複数のコンピュータを含む画像エンコーダシステムによって受け取るステップと、入力画像の符号化された表現を画像エンコーダシステムによって生成するステップとを含み、符号化された表現が、複数のタイルの各々に関する2進符号のそれぞれの組を含み、生成するステップが、複数のタイルのうちの特定のタイルに関して、入力タイルの予測である出力タイルを生成するために入力タイルに関するコンテキストを処理するために訓練された空間コンテキスト予測ニューラルネットワークを使用して特定のタイルに関するコンテキストを処理することであって、コンテキストが、入力画像内で特定のタイルに隣接する1つまたは複数のタイルを含む、処理すること、特定のタイルと、特定のタイルに関するコンテキストを処理することによって空間コンテキスト予測ニューラルネットワークによって生成された出力タイルとの間の残差画像を決定すること、およびエンコーダのニューラルネットワークを使用して残差画像を符号化することによって特定のタイルに関する2進符号の組を生成することを含む方法である。 Embodiment 1 comprises the steps of receiving, by an image encoder system including one or more computers, a request to generate an encoded representation of an input image partitioned into a plurality of tiles; by an image encoder system, wherein the encoded representation includes a respective set of binary codes for each of the plurality of tiles, and generating for a particular one of the plurality of tiles , processing the context for a particular tile using a spatial context prediction neural network trained to process the context for the input tile to produce an output tile that is a prediction of the input tile, where the context is , including one or more tiles adjacent to a particular tile in the input image, an output tile generated by a spatial context prediction neural network by processing the particular tile and the context about the particular tile and generating a set of binary codes for a particular tile by encoding the residual image using a neural network of encoders.
実施形態2は、データ圧縮アルゴリズムを使用して、符号化された表現の2進符号を圧縮することによって入力画像を圧縮するステップをさらに含む実施形態1の方法である。
実施形態3は、データ圧縮アルゴリズムが訓練されたエントロピーコーダである実施形態2の方法である。
実施形態4は、圧縮された入力画像を入力画像の解凍のために画像デコーダシステムに送るステップをさらに含む実施形態2または3のいずれか1つの方法である。
実施形態5は、エンコーダのニューラルネットワークが、複数の時間ステップの各々において、時間ステップのためのエンコーダ入力を受け取ることと、時間ステップに関する2進符号の組を生成するためにエンコーダ入力を処理することとによって残差を符号化するように構成された再帰型ニューラルネットワークである実施形態1から4のいずれか1つの方法である。 Embodiment 5 comprises an encoder neural network receiving encoder input for a time step at each of a plurality of time steps and processing the encoder input to generate a binary code set for the time step. 5. The method of any one of embodiments 1-4, wherein the recurrent neural network is configured to encode the residual by and.
実施形態6は、複数の時間ステップのうちの第1の時間ステップのためのエンコーダ入力が残差画像である実施形態5の方法である。 Embodiment 6 is the method of embodiment 5, wherein the encoder input for a first time step of the plurality of time steps is the residual image.
実施形態7は、第1の時間ステップの後の複数の時間ステップのうちの時間ステップのためのエンコーダ入力が、(i)残差と、(ii)前の時間ステップにおいて2進符号の組からデコーダのニューラルネットワークによって生成された再構築との間の暫定残差画像であり、デコーダのニューラルネットワークが、複数の時間ステップの各々において、時間ステップに関する2進符号の組を含むデコーダ入力を受け取り、時間ステップにおいてエンコーダ入力の再構築を生成するためにデコーダ入力を処理するように構成される再帰型ニューラルネットワークである実施形態5または6のいずれか1つの方法である。 Embodiment 7 provides that the encoder inputs for the time step of the plurality of time steps after the first time step are (i) the residual and (ii) from the binary code set at the previous time step. an interim residual image between the reconstruction generated by the decoder neural network, the decoder neural network receiving, at each of a plurality of time steps, a decoder input comprising a set of binary codes for the time step; 7. The method of any one of embodiments 5 or 6, wherein the recurrent neural network is configured to process the decoder input to generate a reconstruction of the encoder input at time steps.
実施形態8は、特定のタイルに関する2進符号の組を生成することが、複数の時間ステップの各々において、時間ステップおよび任意の以前の時間ステップにおいて既に生成された2進符号から再構築されるときに特定のタイルに関する品質の閾値が満たされたかどうかを、時間ステップのためのエンコーダ入力の再構築から判定することを含む実施形態7の方法である。
実施形態9は、特定のタイルに関する2進符号の組を生成することが、品質の閾値が満たされたとの判定に応じて、既に生成された2進符号を、入力画像の符号化された表現における特定のタイルに関する2進符号の組として使用することを含む実施形態8の方法である。
Embodiment 9 converts the already generated binary code to an encoded representation of the input image in response to determining that generating a set of binary codes for a particular tile has satisfied a quality threshold. 8. The method of
実施形態10は、特定のタイルに関する2進符号の組を生成することが、複数の時間ステップの各々において、特定のタイルが現在の時間ステップにおいて生成された2進符号の組から再構築されるときに特定のタイルに関する品質の閾値が満たされたかどうかを判定することと、品質の閾値が満たされるとの判定に応じて、特定のタイルに関して現在の時間ステップにおいて生成された2進符号の組を、入力画像の符号化された表現における特定のタイルに関する2進符号の組として使用することとを含む実施形態1から6のいずれか1つの方法である。 Embodiment 10 generates a binary code set for a particular tile, wherein at each of a plurality of time steps the particular tile is reconstructed from the binary code set generated at the current time step. Determining whether a quality threshold for a particular tile has been met when, and in response to determining that the quality threshold has been met, the set of binary codes generated for the particular tile at the current time step. 7. The method of any one of embodiments 1-6 comprising using as the set of binary codes for a particular tile in the encoded representation of the input image.
実施形態11は、特定のタイルが入力画像の左または上の境界上にない場合、コンテキストが入力画像内の特定のタイルの左および上の隣接するタイルである実施形態1から10のいずれか1つの方法である。 Embodiment 11 is any one of embodiments 1-10 wherein if the particular tile is not on the left or top border of the input image, the context is the neighboring tiles to the left and above the particular tile in the input image There are two ways.
実施形態12は、特定のタイルが入力画像の左の境界上にあり、入力画像の左上の角にない場合、コンテキストが特定のタイルの上の隣接するタイルおよびプレースホルダコンテキストデータである実施形態11の方法である。 Embodiment 12 is embodiment 11, wherein if the particular tile is on the left border of the input image and not on the upper left corner of the input image, the context is the neighboring tile above the particular tile and the placeholder context data method.
実施形態13は、特定のタイルが入力画像の左上の角にある場合、コンテキストがプレースホルダコンテキストデータである実施形態12の方法である。 Embodiment 13 is the method of embodiment 12, wherein the context is placeholder context data if the particular tile is in the upper left corner of the input image.
実施形態14は、特定のタイルが入力画像の上の境界上にあり、入力画像の左上の角にない場合、コンテキストが特定のタイルの左の隣接するタイルおよびプレースホルダコンテキストデータである実施形態11から13のいずれか1つの方法である。 Embodiment 14 is embodiment 11, wherein if the particular tile is on the upper border of the input image and not in the upper left corner of the input image, the context is the left adjacent tile and placeholder context data of the particular tile any one of 13 methods from
実施形態15は、入力画像の符号化された表現から入力画像を再構築する要求を、1つまたは複数のコンピュータを含む画像デコーダシステムによって受け取るステップであって、入力画像が、複数のタイルに区分けされており、符号化された表現が、複数のタイルの各々に関する2進符号のそれぞれの組を含む、ステップと、入力画像の再構築を画像デコーダシステムによって生成するステップとを含み、生成するステップが、複数のタイルのうちの特定のタイルに関して、入力タイルの最初の再構築画像である出力タイルを生成するために入力タイルに関するコンテキストを処理するために訓練された空間コンテキスト予測ニューラルネットワークを使用して特定のタイルに関するコンテキストを処理することであって、コンテキストが、入力画像内で特定のタイルに隣接する1つまたは複数のタイルの再構築を含む、処理すること、デコーダのニューラルネットワークを使用してタイルに関する2進符号の組を処理することによって特定のタイルの残差再構築画像を生成すること、および特定のタイルの最後の再構築を生成するために最初の再構築画像と特定のタイルの残差再構築画像とを合成することを含む方法である。 Embodiment 15 is the step of receiving, by an image decoder system including one or more computers, a request to reconstruct an input image from an encoded representation of the input image, wherein the input image is partitioned into a plurality of tiles. wherein the encoded representation includes a respective set of binary codes for each of the plurality of tiles; and generating a reconstruction of the input image by an image decoder system. uses a spatial context prediction neural network trained to process the context about the input tile to generate an output tile that is the first reconstructed image of the input tile for a particular tile of the tiles. processing the context about a particular tile using a decoder neural network, where the context includes reconstructing one or more tiles adjacent to the particular tile in the input image; generating a residual reconstructed image of a particular tile by processing the set of binary codes for the tile with with a residual reconstructed image of .
実施形態16は、再構築を生成するステップが、圧縮された入力画像を受け取ることと、タイルに関する2進符号のそれぞれの組を生成するためにデータ解凍アルゴリズムを使用して、圧縮された入力画像を解凍することとをさらに含む実施形態15の方法である。
実施形態17は、データ解凍アルゴリズムが訓練されたエントロピーデコーダである実施形態16の方法である。
Embodiment 17 is the method of
実施形態18は、特定のタイルに関する2進符号の組が、複数の時間ステップの各々に関する2進符号のそれぞれのサブセットを含み、デコーダのニューラルネットワークが、複数の時間ステップの各々において、時間ステップ再構築残差画像を生成するために時間ステップに関する2進符号のサブセットを処理することによって残差を生成するように構成された再帰型ニューラルネットワークである実施形態15から17のいずれか1つの方法である。 Embodiment 18 provides that the set of binary codes for a particular tile includes a respective subset of binary codes for each of the multiple time steps, and the decoder's neural network repeats the time step repetitions at each of the multiple time steps. 18. The method of any one of embodiments 15-17, wherein the recurrent neural network is configured to generate a residual by processing a subset of binary codes for time steps to generate a constructed residual image. be.
実施形態19は、再構築残差画像を生成することが、複数の時間ステップに関する時間ステップ再構築残差画像を合成することを含む実施形態18の方法である。 Embodiment 19 is the method of embodiment 18, wherein generating the reconstructed residual image comprises combining time-step reconstructed residual images for multiple time-steps.
実施形態20は、特定のタイルが入力画像の左または上の境界上にない場合、コンテキストが入力画像内の特定のタイルの左および上の隣接するタイルの再構築である実施形態15から19のいずれか1つの方法である。 Embodiment 20 is a variant of embodiments 15-19 wherein if the particular tile is not on the left or top border of the input image, the context is reconstruction of neighboring tiles to the left and above the particular tile in the input image. Either way.
実施形態21は、特定のタイルが入力画像の左の境界上にあり、入力画像の左上の角にない場合、コンテキストが特定のタイルの上の隣接するタイルの再構築およびプレースホルダコンテキストデータである実施形態20の方法である。 Embodiment 21 is if the particular tile is on the left border of the input image and not on the upper left corner of the input image, the context is the reconstruction of the neighboring tiles above the particular tile and the placeholder context data 21 is the method of embodiment 20;
実施形態22は、特定のタイルが入力画像の左上の角にある場合、コンテキストがプレースホルダコンテキストデータである実施形態21の方法である。 Embodiment 22 is the method of embodiment 21, wherein the context is placeholder context data if the particular tile is in the upper left corner of the input image.
実施形態23は、特定のタイルが入力画像の上の境界上にあり、入力画像の左上の角にない場合、コンテキストが特定のタイルの左の隣接するタイルの再構築およびプレースホルダコンテキストデータである実施形態20から22のいずれか1つの方法である。 Embodiment 23 is if the particular tile is on the upper border of the input image and not in the upper left corner of the input image, the context is the reconstruction of the left adjacent tile of the particular tile and the placeholder context data 23. The method of any one of embodiments 20-22.
実施形態24は、1つまたは複数のコンピュータと、1つまたは複数のコンピュータによって実行されるときに1つまたは複数のコンピュータに実施形態1～23のいずれか1つのそれぞれの方法の動作を実行させる命令を記憶する1つまたは複数の記憶装置とを含むシステムである。 Embodiment 24 causes one or more computers and, when executed by one or more computers, to cause the one or more computers to perform the operations of the respective methods of any one of embodiments 1-23. and one or more storage devices for storing instructions.
実施形態25は、1つまたは複数のコンピュータによって実行されるときに1つまたは複数のコンピュータに実施形態1～23のいずれか1つのそれぞれの方法の動作を実行させる命令を記憶する1つまたは複数のコンピュータ記憶媒体である。 Embodiment 25 is one or more storing instructions that, when executed by one or more computers, cause the one or more computers to perform the operations of the respective methods of any one of embodiments 1-23. computer storage medium.
対象の特定の実施形態が、説明された。その他の実施形態は、添付の請求項の範囲内にある。たとえば、請求項に挙げられた行為は、異なる順序で実行され、それでも所望の結果を達成することができる。一例として、添付の図に示されたプロセスは、所望の結果を達成するために、必ずしも、示された特定の順序または逐次的順序を必要としない。場合によっては、マルチタスクおよび並列処理が有利である可能性がある。 A specific embodiment of the subject has been described. Other embodiments are within the scope of the following claims. For example, the acts recited in the claims can be performed in a different order and still achieve desirable results. As an example, the processes depicted in the accompanying figures do not necessarily require the particular order shown or sequential order to achieve desired results. In some cases, multitasking and parallel processing can be advantageous.
100 画像圧縮および再構築システム
104 入力画像
106 分割エグゼキュータ
108 空間コンテキストプレディクタ
110 エンコーダ
114 デコーダ
116 訓練エンジン
118 訓練エンジン
124 空間コンテキストプレディクタ
128 デコーダ
130 残差ネットワーク
132 コンバイナ
140 画像に関する圧縮された2進数
142 符号化された残差
150 既に再構築されたタイル、タイルの完全な再構築
200a～d コンテキストパッチ
202 目標タイル
202a 特定のタイル
202b 特定のタイル
202c 特定のタイル
202d 特定のタイル
204a 隣接するタイル
204a 隣接するタイル
206a 隣接するタイル
208 隣接するタイル
300 アーキテクチャ
302 コンテキストパッチ
310 畳み込み層
311 畳み込み層
312 畳み込み層
313 畳み込み層
320 深さ毎の畳み込み層
321 点毎の畳み込み層
330 フラクショナル畳み込み層
331 フラクショナル畳み込み層
332 フラクショナル畳み込み層
340 目標の予測
400 残差ネットワーク
402 バイナリボトルネック層
500 プロセス
600 プロセス
100 image compression and reconstruction system
104 input images
106 split executors
108 Spatial Context Predictor
110 Encoder
114 Decoder
116 Training Engine
118 Training Engine
124 Spatial Context Predictor
128 decoders
130 residual networks
132 Combiner
140 Compressed binary numbers for the image
142 encoded residuals
150 already reconstructed tiles, full reconstruction of tiles
200a-d Context Patch
202 Goal Tile
202a Specific Tile
202b Specific Tile
202c Specific tiles
202d specific tiles
204a Adjacent Tile
204a Adjacent Tile
206a Adjacent Tile
208 adjacent tiles
300 architecture
302 Context Patch
310 Convolutional Layers
311 Convolutional Layers
312 Convolutional Layers
313 Convolutional Layers
320 convolutional layers per depth
Convolutional layer every 321 points
330 Fractional Convolutional Layers
331 Fractional Convolutional Layer
332 Fractional Convolutional Layers
340 target predictions
400 Residual Network
402 Binary Bottleneck Layer
500 processes
600 processes
Claims (15)
前記画像エンコーダシステムによって、前記入力画像の前記符号化された表現を生成するステップであって、前記符号化された表現が、前記複数のタイルの各々に関する2進符号のそれぞれの組を含み、前記複数のタイルのうちの特定のタイルに関して、
(i)入力タイルの予測である出力タイルを生成するために前記入力タイルに関するコンテキストを処理するために訓練された空間コンテキスト予測ニューラルネットワークを使用して前記特定のタイルに関するコンテキストを処理するステップであって、前記コンテキストが、前記入力画像内で前記特定のタイルに隣接する1つまたは複数のタイルを含む、ステップと、
(ii)前記特定のタイルと、前記特定のタイルに関する前記コンテキストを処理することによって前記空間コンテキスト予測ニューラルネットワークによって生成された前記出力タイルとの間の残差画像を決定するステップと、
(iii)エンコーダのニューラルネットワークを使用して前記残差画像を符号化することによって、前記特定のタイルに関する2進符号の組を生成するステップであって、複数の時間ステップの各々において、
(iii-a)前記特定のタイルが現在の時間ステップにおいて生成された前記2進符号の組から再構築されるときに前記特定のタイルに関する品質の閾値が満たされたかどうかを判定するステップと、
(iii-b)前記品質の閾値が満たされるとの判定に応じて、前記入力画像の前記符号化された表現における前記特定のタイルに関する前記2進符号の組として、前記特定のタイルに関して前記現在の時間ステップにおいて生成された前記2進符号の組を使用するステップと
を備える、2進符号の組を生成するステップと
を備える、表現を生成するステップと
を備える、方法。 receiving a request to generate an encoded representation of an input image partitioned into a plurality of tiles by an image encoder system including one or more computers;
generating, by the image encoder system, the encoded representation of the input image, the encoded representation comprising a respective set of binary codes for each of the plurality of tiles; For a specific tile among multiple tiles,
(i) processing the context for the particular tile using a spatial context prediction neural network trained to process the context for the input tile to produce an output tile that is a prediction of the input tile; and said context includes one or more tiles adjacent to said particular tile in said input image;
(ii) determining a residual image between the particular tile and the output tile generated by the spatial context prediction neural network by processing the context for the particular tile;
(iii) encoding the residual image using a neural network of encoders to generate a set of binary codes for the particular tile, wherein at each of a plurality of time steps:
(iii-a) determining whether a quality threshold for the particular tile was met when the particular tile was reconstructed from the set of binary codes generated at the current time step;
(iii-b) responsive to determining that the quality threshold is met, the current encoding for the particular tile as the set of binary codes for the particular tile in the encoded representation of the input image; Generating a binary code set comprising: using the binary code set generated at a time step of .
前記時間ステップのためのエンコーダ入力を受け取ることと、
前記時間ステップに関する2進符号の組を生成するために前記エンコーダ入力を処理することと
によって、残差を符号化するように構成された再帰型ニューラルネットワークである、請求項1から4のいずれか一項に記載の方法。 A neural network of the encoder, at each of the plurality of time steps,
receiving an encoder input for the time step;
5. A recurrent neural network configured to encode a residual by processing the encoder input to generate a set of binary codes for the time step. The method according to item 1.
前記時間ステップおよび任意の以前の時間ステップにおいて既に生成された前記2進符号から再構築されるときに前記特定のタイルに関する品質の閾値が満たされたかどうかを、前記時間ステップのための前記エンコーダ入力の前記再構築から判定するステップ
を含む、請求項7に記載の方法。 generating the set of binary codes for the particular tile, at each of the plurality of time steps,
The encoder inputs for the time step whether a quality threshold for the particular tile was met when reconstructed from the binary code already generated at the time step and any previous time step. 8. The method of claim 7, comprising determining from the reconstruction of .
前記品質の閾値が満たされたとの判定に応じて、前記入力画像の前記符号化された表現における前記特定のタイルに関する2進符号の前記組として前記既に生成された2進符号を使用するステップ
を含む、請求項8に記載の方法。 generating the set of binary codes for the particular tile,
using the already generated binary code as the set of binary codes for the particular tile in the encoded representation of the input image, in response to determining that the quality threshold has been met; 9. The method of claim 8, comprising:
Applications Claiming Priority (3)
Application Number | Priority Date | Filing Date | Title |
---|---|---|---|
US201762511935P | 2017-05-26 | 2017-05-26 | |
US62/511,935 | 2017-05-26 | ||
JP2019559287A JP6956803B2 (en) | 2017-05-26 | 2018-05-29 | Tiling image compression using neural networks |
Related Parent Applications (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
JP2019559287A Division JP6956803B2 (en) | 2017-05-26 | 2018-05-29 | Tiling image compression using neural networks |
Publications (2)
Publication Number | Publication Date |
---|---|
JP2021192525A JP2021192525A (en) | 2021-12-16 |
JP7225333B2 true JP7225333B2 (en) | 2023-02-20 |
Family
ID=63080457
Family Applications (2)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
JP2019559287A Active JP6956803B2 (en) | 2017-05-26 | 2018-05-29 | Tiling image compression using neural networks |
JP2021134157A Active JP7225333B2 (en) | 2017-05-26 | 2021-08-19 | Tiled image compression using neural networks |
Family Applications Before (1)
Application Number | Title | Priority Date | Filing Date |
---|---|---|---|
JP2019559287A Active JP6956803B2 (en) | 2017-05-26 | 2018-05-29 | Tiling image compression using neural networks |
Country Status (6)
Country | Link |
---|---|
US (1) | US11250595B2 (en) |
EP (1) | EP3603070A1 (en) |
JP (2) | JP6956803B2 (en) |
KR (1) | KR102332476B1 (en) |
CN (1) | CN110915215B (en) |
WO (1) | WO2018218249A1 (en) |
Families Citing this family (19)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
CN110915215B (en) * | 2017-05-26 | 2024-03-08 | 谷歌有限责任公司 | Tiled image compression using neural networks |
US11082720B2 (en) * | 2017-11-21 | 2021-08-03 | Nvidia Corporation | Using residual video data resulting from a compression of original video data to improve a decompression of the original video data |
EP3776477A4 (en) * | 2018-04-09 | 2022-01-26 | Nokia Technologies Oy | An apparatus, a method and a computer program for video coding and decoding |
US10999606B2 (en) * | 2019-01-08 | 2021-05-04 | Intel Corporation | Method and system of neural network loop filtering for video coding |
US11182929B2 (en) * | 2019-02-25 | 2021-11-23 | Center For Deep Learning In Electronics Manufacturing, Inc. | Methods and systems for compressing shape data for electronic designs |
EP3705944A1 (en) | 2019-03-06 | 2020-09-09 | ASML Netherlands B.V. | Extracting a feature from a data set |
US10373300B1 (en) | 2019-04-29 | 2019-08-06 | Deep Render Ltd. | System and method for lossy image and video compression and transmission utilizing neural networks |
CN110728726B (en) * | 2019-10-24 | 2022-09-23 | 湖南大学 | Image compression method based on user interaction and deep neural network |
US20210406691A1 (en) | 2020-06-29 | 2021-12-30 | Tencent America LLC | Method and apparatus for multi-rate neural image compression with micro-structured masks |
CN114079776A (en) * | 2020-08-21 | 2022-02-22 | Oppo广东移动通信有限公司 | Image processing method, device, equipment, computer storage medium and system |
FR3114933B1 (en) * | 2020-10-06 | 2023-10-13 | Fond B Com | Method and electronic device for decoding a data stream, and associated computer program |
US11816871B2 (en) * | 2020-12-30 | 2023-11-14 | Advanced Micro Devices, Inc. | Real-time low latency computer vision/machine learning compute accelerator with smart convolutional neural network scheduler |
US20220345717A1 (en) * | 2021-04-16 | 2022-10-27 | Tencent America LLC | Method and apparatus for dynamic learning rates of substitution in neural image compression |
KR102620823B1 (en) * | 2021-07-06 | 2024-01-04 | 한국과학기술원 | Method for end-to-end generating and recognizing of deformable fiducial markers based on artificial intelligence and the system thereof |
CN113810693B (en) * | 2021-09-01 | 2022-11-11 | 上海交通大学 | Lossless compression and decompression method, system and device for JPEG image |
US11546614B1 (en) | 2021-10-25 | 2023-01-03 | Fraunhofer-Gesellschaft zur Förderung der angewandten Forschung e.V. | Encoder and decoder for encoding and decoding images |
CN114494569B (en) * | 2022-01-27 | 2023-09-19 | 光线云(杭州)科技有限公司 | Cloud rendering method and device based on lightweight neural network and residual streaming |
CN114501011B (en) * | 2022-02-22 | 2023-04-21 | 北京市商汤科技开发有限公司 | Image compression method, image decompression method and device |
CN115278257A (en) * | 2022-07-28 | 2022-11-01 | 北京大学深圳研究生院 | Image compression method and device, electronic equipment and storage medium |
Citations (4)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
JP2007503784A (en) | 2003-05-20 | 2007-02-22 | アーエムテー アドバンスド マルチメディア テクノロジー アクティエボラーグ | Hybrid video compression method |
WO2009025347A1 (en) | 2007-08-22 | 2009-02-26 | Shinichiro Yumura | Data compression method, image display method and display image enlargement method |
JP2011188129A (en) | 2010-03-05 | 2011-09-22 | Nippon Hoso Kyokai <Nhk> | Intra prediction apparatus, encoder, decoder, and program |
WO2016199330A1 (en) | 2015-06-12 | 2016-12-15 | パナソニックＩｐマネジメント株式会社 | Image coding method, image decoding method, image coding device and image decoding device |
Family Cites Families (7)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
US8615138B2 (en) * | 2011-11-03 | 2013-12-24 | Google Inc. | Image compression using sub-resolution images |
WO2015176280A1 (en) * | 2014-05-22 | 2015-11-26 | Microsoft Technology Licensing, Llc | Re-encoding image sets using frequency-domain differences |
US11321609B2 (en) * | 2016-10-19 | 2022-05-03 | Samsung Electronics Co., Ltd | Method and apparatus for neural network quantization |
US10748062B2 (en) * | 2016-12-15 | 2020-08-18 | WaveOne Inc. | Deep learning based adaptive arithmetic coding and codelength regularization |
CN110892419B (en) * | 2017-05-16 | 2023-08-08 | 谷歌有限责任公司 | Stop code tolerant image compression neural network |
CN110915215B (en) * | 2017-05-26 | 2024-03-08 | 谷歌有限责任公司 | Tiled image compression using neural networks |
CN108960333B (en) * | 2018-07-12 | 2021-12-17 | 西安电子科技大学 | Hyperspectral image lossless compression method based on deep learning |
-
2018
- 2018-05-29 CN CN201880028540.7A patent/CN110915215B/en active Active
- 2018-05-29 US US16/617,484 patent/US11250595B2/en active Active
- 2018-05-29 JP JP2019559287A patent/JP6956803B2/en active Active
- 2018-05-29 WO PCT/US2018/034933 patent/WO2018218249A1/en unknown
- 2018-05-29 KR KR1020197032378A patent/KR102332476B1/en active IP Right Grant
- 2018-05-29 EP EP18749605.4A patent/EP3603070A1/en not_active Ceased
-
2021
- 2021-08-19 JP JP2021134157A patent/JP7225333B2/en active Active
Patent Citations (4)
Publication number | Priority date | Publication date | Assignee | Title |
---|---|---|---|---|
JP2007503784A (en) | 2003-05-20 | 2007-02-22 | アーエムテー アドバンスド マルチメディア テクノロジー アクティエボラーグ | Hybrid video compression method |
WO2009025347A1 (en) | 2007-08-22 | 2009-02-26 | Shinichiro Yumura | Data compression method, image display method and display image enlargement method |
JP2011188129A (en) | 2010-03-05 | 2011-09-22 | Nippon Hoso Kyokai <Nhk> | Intra prediction apparatus, encoder, decoder, and program |
WO2016199330A1 (en) | 2015-06-12 | 2016-12-15 | パナソニックＩｐマネジメント株式会社 | Image coding method, image decoding method, image coding device and image decoding device |
Non-Patent Citations (5)
Title |
---|
Adna Sento，Image Compression with Auto-encoder Algorithm using Deep Neural Network (DNN)，The 2016 Management and Innovation Technology International Conference (MITiCON-2016)，IEEE，2016年，pp.99-103 |
D. Minnen et al.，SPATIALLY ADAPTIVE IMAGE COMPRESSION USING A TILED DEEP NETWORK，ICIP 2017，IEEE，2017年，pp.2796-2800 |
George Toderici et al.，Full Resolution Image Compression with Recurrent Neural Networks，arXiv，2016年08月18日，arXiv:1608.05148v1，pp.1-10 |
George Toderici et al.，VARIABLE RATE IMAGE COMPRESSION WITH RECURRENT NEURAL NETWORKS，arXiv，ICLR 2016，2016年03月01日，arXiv:1511.06085v5，pp.1-12 |
Yann LeCun, Yoshua Bengio and Geoffrey Hinton，Deep learning，NATURE，2015年05月28日，Vol.521，pp.436-444 |
Also Published As
Publication number | Publication date |
---|---|
CN110915215B (en) | 2024-03-08 |
US20200111238A1 (en) | 2020-04-09 |
EP3603070A1 (en) | 2020-02-05 |
JP6956803B2 (en) | 2021-11-02 |
US11250595B2 (en) | 2022-02-15 |
KR102332476B1 (en) | 2021-11-30 |
JP2020522153A (en) | 2020-07-27 |
KR20190133044A (en) | 2019-11-29 |
WO2018218249A1 (en) | 2018-11-29 |
CN110915215A (en) | 2020-03-24 |
JP2021192525A (en) | 2021-12-16 |
Similar Documents
Publication | Publication Date | Title |
---|---|---|
JP7225333B2 (en) | Tiled image compression using neural networks | |
US11257254B2 (en) | Data compression using conditional entropy models | |
US10713818B1 (en) | Image compression with recurrent neural networks | |
Minnen et al. | Spatially adaptive image compression using a tiled deep network | |
US20200029084A1 (en) | Compressing images using neural networks | |
CN109451308B (en) | Video compression processing method and device, electronic equipment and storage medium | |
US11538197B2 (en) | Channel-wise autoregressive entropy models for image compression | |
US11335034B2 (en) | Systems and methods for image compression at multiple, different bitrates | |
US11354822B2 (en) | Stop code tolerant image compression neural networks | |
CN108632630B (en) | Binary image coding method combining bit operation and probability prediction | |
CN111432213A (en) | Adaptive tile data size coding for video and image compression | |
KR20210070944A (en) | Method, apparatus and recording medium for end-to-end compression using pixel-space prediction | |
US11259051B2 (en) | Pyramid algorithm for video compression and video analysis | |
Nortje et al. | BINet: A binary inpainting network for deep patch-based image compression | |
US20230105257A1 (en) | Compressing lidar range images | |
KR20240025629A (en) | Video compression using optical flow | |
Shrikhande et al. | Image compression using calic | |
WO2023208948A1 (en) | Method and data processing system for lossy image or video encoding, transmission and decoding | |
CN114339216A (en) | Video processing method and device, electronic equipment and storage medium |
Legal Events
Date | Code | Title | Description |
---|---|---|---|
A521 | Request for written amendment filed |
Free format text: JAPANESE INTERMEDIATE CODE: A523Effective date: 20210917 |
|
A621 | Written request for application examination |
Free format text: JAPANESE INTERMEDIATE CODE: A621Effective date: 20210917 |
|
A521 | Request for written amendment filed |
Free format text: JAPANESE INTERMEDIATE CODE: A523Effective date: 20211004 |
|
A131 | Notification of reasons for refusal |
Free format text: JAPANESE INTERMEDIATE CODE: A131Effective date: 20220822 |
|
A521 | Request for written amendment filed |
Free format text: JAPANESE INTERMEDIATE CODE: A523Effective date: 20221012 |
|
A131 | Notification of reasons for refusal |
Free format text: JAPANESE INTERMEDIATE CODE: A131Effective date: 20221031 |
|
A521 | Request for written amendment filed |
Free format text: JAPANESE INTERMEDIATE CODE: A523Effective date: 20221216 |
|
TRDD | Decision of grant or rejection written | ||
A01 | Written decision to grant a patent or to grant a registration (utility model) |
Free format text: JAPANESE INTERMEDIATE CODE: A01Effective date: 20230116 |
|
A61 | First payment of annual fees (during grant procedure) |
Free format text: JAPANESE INTERMEDIATE CODE: A61Effective date: 20230208 |
|
R150 | Certificate of patent or registration of utility model |
Ref document number: 7225333Country of ref document: JPFree format text: JAPANESE INTERMEDIATE CODE: R150 |